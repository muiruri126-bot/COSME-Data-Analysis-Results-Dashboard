<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="COSME & GJJ Professional Survey Dashboard - Comprehensive analysis of Women, Men, Forestry, Schools, Seaweed, and VSLA monitoring data across Kilifi & Kwale counties.">
    <meta name="theme-color" content="#0072CE">
    <title>COSME & GJJ Surveys Dashboard | Professional Analysis</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-datalabels@2.2.0/dist/chartjs-plugin-datalabels.min.js"></script>
    <!-- Firebase Compat SDKs -->
    <script src="https://www.gstatic.com/firebasejs/10.12.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.12.0/firebase-database-compat.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            scroll-behavior: smooth;
        }

        /* LIVE VIEWERS BADGE */
        #live-viewers-badge {
            position: fixed;
            top: 14px;
            right: 18px;
            z-index: 9999;
            background: linear-gradient(135deg, #1b5e20 0%, #2e7d32 100%);
            color: #fff;
            padding: 8px 16px;
            border-radius: 24px;
            font-size: 0.82em;
            font-weight: 600;
            box-shadow: 0 3px 12px rgba(0,0,0,0.25);
            display: flex;
            align-items: center;
            gap: 8px;
            cursor: pointer;
            transition: all 0.3s;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
        }
        #live-viewers-badge:hover {
            transform: translateY(-1px);
            box-shadow: 0 5px 18px rgba(0,0,0,0.3);
        }
        #live-viewers-badge .pulse-dot {
            width: 8px; height: 8px;
            background: #69f0ae;
            border-radius: 50%;
            animation: pulse-glow 1.5s ease-in-out infinite;
        }
        @keyframes pulse-glow {
            0%, 100% { box-shadow: 0 0 0 0 rgba(105, 240, 174, 0.7); }
            50% { box-shadow: 0 0 0 6px rgba(105, 240, 174, 0); }
        }
        #viewer-panel {
            position: fixed;
            top: 50px;
            right: 18px;
            z-index: 9998;
            background: #fff;
            border-radius: 12px;
            box-shadow: 0 8px 30px rgba(0,0,0,0.18);
            width: 300px;
            max-height: 400px;
            overflow-y: auto;
            display: none;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
        }
        #viewer-panel.open { display: block; }
        #viewer-panel .vp-header {
            background: linear-gradient(135deg, #1b5e20, #2e7d32);
            color: #fff;
            padding: 14px 18px;
            border-radius: 12px 12px 0 0;
            font-weight: 700;
            font-size: 0.9em;
        }
        #viewer-panel .vp-list { padding: 10px 0; }
        #viewer-panel .vp-item {
            padding: 8px 18px;
            border-bottom: 1px solid #f0f0f0;
            font-size: 0.82em;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        #viewer-panel .vp-item:last-child { border-bottom: none; }
        #viewer-panel .vp-name { font-weight: 600; color: #333; }
        #viewer-panel .vp-time { color: #999; font-size: 0.75em; }
        #viewer-panel .vp-tab {
            background: #e8eaf6;
            color: #283593;
            padding: 2px 8px;
            border-radius: 10px;
            font-size: 0.75em;
            font-weight: 600;
        }
        #viewer-panel .vp-tabs {
            display: flex;
            border-bottom: 2px solid #e0e0e0;
        }
        #viewer-panel .vp-tabs button {
            flex: 1;
            padding: 10px;
            border: none;
            background: #f5f5f5;
            cursor: pointer;
            font-size: 0.8em;
            font-weight: 600;
            color: #666;
            transition: all 0.2s;
        }
        #viewer-panel .vp-tabs button.active {
            background: #fff;
            color: #1b5e20;
            border-bottom: 2px solid #2e7d32;
            margin-bottom: -2px;
        }
        .vp-stats {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 8px;
            padding: 12px 16px;
            background: #f9f9f9;
        }
        .vp-stat {
            text-align: center;
            padding: 8px;
            background: #fff;
            border-radius: 8px;
            border: 1px solid #e8eaf6;
        }
        .vp-stat .stat-val {
            font-size: 1.3em;
            font-weight: 700;
            color: #1b5e20;
        }
        .vp-stat .stat-lbl {
            font-size: 0.7em;
            color: #888;
            margin-top: 2px;
        }
        .vp-history-item {
            padding: 8px 18px;
            border-bottom: 1px solid #f0f0f0;
            font-size: 0.8em;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .vp-history-item:last-child { border-bottom: none; }
        .vp-history-item .hi-name { font-weight: 600; color: #333; }
        .vp-history-item .hi-date { color: #999; font-size: 0.78em; }
        .vp-history-item .hi-duration {
            background: #e8f5e9;
            color: #2e7d32;
            padding: 2px 7px;
            border-radius: 10px;
            font-size: 0.72em;
            font-weight: 600;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            color: #333;
            line-height: 1.6;
        }

        .container {
            max-width: 1600px;
            margin: 0 auto;
            padding: 20px;
            padding-top: 20px;
            padding-bottom: 5px;
        }

        /* SURVEY SELECTOR - Fixed at top */
        .survey-selector {
            background: white;
            padding: 16px 20px;
            border-radius: 0 0 12px 12px;
            margin-bottom: 0;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.12);
            display: flex;
            align-items: center;
            gap: 20px;
            flex-wrap: wrap;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            z-index: 1050;
            transition: box-shadow 0.3s ease, background 0.3s ease;
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            background: rgba(255, 255, 255, 0.97);
        }

        .survey-selector.scrolled {
            box-shadow: 0 4px 24px rgba(0, 0, 0, 0.18);
        }

        /* Spacer to push content below fixed survey selector */
        .survey-selector-spacer {
            height: 72px;
            flex-shrink: 0;
        }

        .survey-selector label {
            font-weight: 600;
            color: #333;
            font-size: 1.1em;
        }

        .survey-buttons {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }

        .survey-btn {
            padding: 10px 20px;
            border: 2px solid #0072CE;
            background: white;
            color: #0072CE;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s ease;
            font-size: 0.95em;
        }

        .survey-btn:hover {
            background: #f0f0f0;
        }

        .survey-btn.active {
            background: linear-gradient(135deg, #0072CE 0%, #005a9e 100%);
            color: white;
            border-color: #0072CE;
        }

        /* HEADER */
        .header {
            background: linear-gradient(135deg, #0072CE 0%, #005a9e 100%);
            color: white;
            padding: 20px 40px;
            border-radius: 12px;
            margin-bottom: 15px;
            box-shadow: 0 8px 32px rgba(0, 114, 206, 0.3);
        }

        .header h1 {
            font-size: 2.5em;
            margin-bottom: 0;
        }

        .header-subtitle {
            font-size: 1.1em;
            opacity: 0.95;
            margin-bottom: 20px;
        }

        .header-meta {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-top: 20px;
            font-size: 0.95em;
        }

        .meta-item {
            font-weight: 500;
        }

        /* EXECUTIVE SUMMARY */
        .executive-summary {
            background: white;
            padding: 30px;
            border-radius: 12px;
            margin-bottom: 30px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.08);
        }

        .summary-title {
            font-size: 1.5em;
            color: #0072CE;
            margin-bottom: 20px;
            border-bottom: 3px solid #0072CE;
            padding-bottom: 10px;
        }

        .key-findings {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 20px;
        }

        .finding-card {
            background: linear-gradient(135deg, #f8faff 0%, #ffffff 100%);
            padding: 24px 22px;
            border-radius: 12px;
            border-left: 5px solid #0072CE;
            box-shadow: 0 4px 16px rgba(0, 114, 206, 0.10);
            text-align: left;
            transition: transform 0.22s ease, box-shadow 0.22s ease;
            position: relative;
            overflow: hidden;
        }

        .finding-card::before {
            content: '';
            position: absolute;
            top: 0; left: 0; right: 0;
            height: 4px;
            background: linear-gradient(90deg, #0072CE, #005a9e);
            border-radius: 12px 12px 0 0;
        }

        .finding-card:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 28px rgba(0, 114, 206, 0.18);
        }

        .finding-card.negative {
            border-left: 5px solid #c62828;
            background: linear-gradient(135deg, #fff5f5 0%, #ffffff 100%);
            box-shadow: 0 4px 16px rgba(198, 40, 40, 0.08);
        }

        .finding-card.negative::before {
            background: linear-gradient(90deg, #c62828, #ef5350);
        }

        .finding-card.negative:hover {
            box-shadow: 0 8px 28px rgba(198, 40, 40, 0.16);
        }

        .finding-title {
            font-weight: 700;
            color: #0072CE;
            margin-bottom: 10px;
            font-size: 1.05em;
            letter-spacing: 0.01em;
            text-transform: uppercase;
        }

        .finding-card.negative .finding-title {
            color: #c62828;
        }

        .finding-metric {
            font-size: 2.2em;
            font-weight: 800;
            color: #2e7d32;
            margin-bottom: 6px;
            line-height: 1.1;
        }

        .finding-card.negative .finding-metric {
            color: #c62828;
        }

        .finding-description {
            font-size: 0.92em;
            color: #555;
            line-height: 1.6;
        }

        /* KPI DASHBOARD */
        .kpi-section {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .kpi-card {
            background: white;
            padding: 25px;
            border-radius: 10px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.08);
            text-align: left;
            border-top: 5px solid #0072CE;
            display: flex;
            flex-direction: column;
            gap: 0;
        }

        .kpi-card.positive { border-top-color: #2e7d32; }
        .kpi-card.negative { border-top-color: #c62828; }
        .kpi-card.warning { border-top-color: #f57c00; }
        .kpi-card.critical { border-top-color: #c62828; }

        .kpi-label {
            font-size: 0.8em;
            color: #999;
            text-transform: uppercase;
            letter-spacing: 1px;
            margin-bottom: 12px;
            line-height: 1.3;
            flex-shrink: 0;
        }

        .kpi-value {
            font-size: 2.2em;
            font-weight: bold;
            color: #0072CE;
            margin-bottom: 8px;
            line-height: 1.1;
            flex-shrink: 0;
        }

        .kpi-change {
            font-size: 0.9em;
            font-weight: 600;
            padding: 5px 10px;
            border-radius: 4px;
            display: inline-block;
            margin-top: auto;
        }

        .kpi-change.positive { background: #e8f5e9; color: #2e7d32; }
        .kpi-change.negative { background: #ffebee; color: #c62828; }

        /* TABS */
        .tabs-container {
            display: flex;
            gap: 10px;
            margin-bottom: 30px;
            border-bottom: 2px solid #ddd;
            overflow-x: auto;
            background: rgba(255, 255, 255, 0.97);
            backdrop-filter: blur(8px);
            -webkit-backdrop-filter: blur(8px);
            padding: 0 20px;
            border-radius: 8px 8px 0 0;
            position: sticky;
            top: 72px;
            z-index: 999;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.08);
            transition: top 0.3s ease, box-shadow 0.3s ease;
        }

        .tab-button {
            background: white;
            border: none;
            padding: 15px 20px;
            cursor: pointer;
            font-size: 0.95em;
            font-weight: 500;
            color: #666;
            border-bottom: 3px solid transparent;
            transition: all 0.3s ease;
            white-space: nowrap;
        }

        .tab-button:hover {
            color: #0072CE;
            background: #f5f7fa;
        }

        .tab-button.active {
            color: #0072CE;
            border-bottom-color: #0072CE;
        }

        .tab-content {
            display: none;
            animation: fadeIn 0.3s ease;
        }

        .tab-content.active {
            display: block;
        }

        .forestry-tab-content {
            display: none;
            animation: fadeIn 0.3s ease;
        }

        .forestry-tab-content.active {
            display: block;
        }

        .prepost-tab-content {
            display: none;
            animation: fadeIn 0.3s ease;
        }

        .prepost-tab-content.active {
            display: block;
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        /* SECTION STYLING */
        .section {
            background: white;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.08);
            margin-bottom: 30px;
        }

        .section-title {
            font-size: 1.5em;
            color: white;
            background: linear-gradient(135deg, #0072CE 0%, #005a9e 100%);
            padding: 20px;
            border-radius: 8px 8px 0 0;
            margin: -30px -30px 20px -30px;
            position: sticky;
            top: 120px; /* JS updateSpacerHeight() overrides dynamically */
            z-index: 998;
            transition: top 0.3s ease;
        }

        .charts-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(500px, 1fr));
            gap: 30px;
            margin-top: 20px;
        }

        .chart-wrapper {
            background: #f9fafb;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);
        }

        .chart-wrapper.full-width {
            grid-column: 1 / -1;
        }

        .chart-title {
            font-size: 1.1em;
            font-weight: 600;
            color: #333;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 2px solid #0072CE;
        }

        .chart-container {
            position: relative;
            height: 350px;
            margin-bottom: 15px;
        }

        .chart-insight {
            background: linear-gradient(135deg, #f0f4ff 0%, #f8faff 100%);
            padding: 14px 18px;
            border-radius: 10px;
            font-size: 0.88em;
            color: #3a3d4a;
            margin-top: 14px;
            border-left: 5px solid #0072CE;
            line-height: 1.7;
            position: relative;
            box-shadow: 0 2px 8px rgba(0, 114, 206, 0.06);
        }

        .chart-insight::before {
            content: '\1F4A1';
            position: absolute;
            top: -10px;
            right: 12px;
            font-size: 1.1em;
            background: #fff;
            border-radius: 50%;
            width: 24px;
            height: 24px;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 1px 4px rgba(0,0,0,0.08);
        }

        .insight-highlight {
            color: #0072CE;
            font-weight: 700;
            background: linear-gradient(135deg, rgba(0, 114, 206,0.1), rgba(0, 90, 158,0.1));
            padding: 1px 6px;
            border-radius: 4px;
        }

        /* COMPARISON TABLE */
        .comparison-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
        }

        .comparison-table th {
            background: #0072CE;
            color: white;
            padding: 15px;
            text-align: left;
            font-weight: 600;
        }

        .comparison-table td {
            padding: 12px 15px;
            border-bottom: 1px solid #eee;
        }

        .comparison-table tr:nth-child(even) {
            background: #f9fafb;
        }

        .comparison-table tr:hover {
            background: #f0f4ff;
        }

        .positive-change { color: #2e7d32; font-weight: 600; }
        .negative-change { color: #c62828; font-weight: 600; }

        /* PROJECT OUTPUT STYLES */
        .output-header {
            background: linear-gradient(135deg, #1a237e 0%, #283593 100%);
            color: white;
            padding: 25px 30px;
            border-radius: 12px;
            margin-bottom: 25px;
        }
        .output-header h2 {
            margin: 0 0 5px 0;
            font-size: 1.5em;
        }
        .output-header p {
            margin: 0;
            opacity: 0.85;
            font-size: 0.95em;
        }
        .output-card {
            background: white;
            border-radius: 12px;
            padding: 25px;
            margin-bottom: 25px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.08);
        }
        .output-card h3 {
            color: #1a237e;
            margin: 0 0 15px 0;
            font-size: 1.2em;
            border-bottom: 2px solid #e8eaf6;
            padding-bottom: 10px;
        }
        .output-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 10px;
            font-size: 0.92em;
        }
        .output-table th {
            background: #283593;
            color: white;
            padding: 10px 14px;
            text-align: center;
            font-weight: 600;
            font-size: 0.9em;
        }
        .output-table td {
            padding: 9px 14px;
            border-bottom: 1px solid #e0e0e0;
            text-align: center;
        }
        .output-table tr:nth-child(even) {
            background: #f5f5f5;
        }
        .output-table tr:hover {
            background: #e8eaf6;
        }
        .output-table .total-row {
            background: #e8eaf6 !important;
            font-weight: 700;
        }
        .output-table .total-row td {
            border-top: 2px solid #283593;
        }
        .output-kpi-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
            gap: 15px;
            margin-bottom: 20px;
        }
        .output-kpi {
            background: linear-gradient(135deg, #e8eaf6 0%, #f5f5f5 100%);
            padding: 18px;
            border-radius: 10px;
            text-align: center;
            border-left: 4px solid #283593;
            display: flex;
            flex-direction: column;
            align-items: center;
        }
        .output-kpi .kpi-label {
            font-size: 0.8em;
            color: #666;
            margin-bottom: 8px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            line-height: 1.3;
            flex-shrink: 0;
        }
        .output-kpi .kpi-value {
            font-size: 1.8em;
            font-weight: 700;
            color: #1a237e;
            line-height: 1.1;
            flex-shrink: 0;
        }
        .output-kpi .kpi-sub {
            font-size: 0.75em;
            color: #888;
            margin-top: 3px;
        }
        .output-kpi.green { border-left-color: #2e7d32; }
        .output-kpi.green .kpi-value { color: #2e7d32; }
        .output-kpi.orange { border-left-color: #e65100; }
        .output-kpi.orange .kpi-value { color: #e65100; }
        .output-charts-row {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(400px, 1fr));
            gap: 25px;
            margin-top: 20px;
        }
        .output-chart-box {
            background: white;
            border-radius: 12px;
            padding: 20px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.06);
        }
        .output-chart-box h4 {
            color: #283593;
            margin: 0 0 15px 0;
            font-size: 1em;
        }
        .output-chart-box canvas {
            max-height: 320px;
        }
        .output-placeholder {
            background: linear-gradient(135deg, #f5f5f5 0%, #e8eaf6 100%);
            padding: 60px 30px;
            border-radius: 12px;
            text-align: center;
            color: #666;
        }
        .output-placeholder h3 {
            color: #283593;
            margin-bottom: 10px;
            border: none;
        }

        /* FOOTER */
        .footer {
            text-align: center;
            padding: 20px;
            color: #666;
            margin-top: 10px;
            border-top: 2px solid #ddd;
        }

        .footer p {
            margin: 5px 0;
            font-size: 0.9em;
        }

        /* HIGHLIGHTS */
        .highlight-box {
            background: linear-gradient(135deg, rgba(46, 125, 50, 0.08) 0%, rgba(76, 175, 80, 0.06) 100%);
            padding: 22px 24px;
            border-radius: 12px;
            border-left: 5px solid #2e7d32;
            margin: 22px 0;
            box-shadow: 0 2px 10px rgba(46,125,50,0.06);
            transition: box-shadow 0.2s ease;
        }

        .highlight-box:hover {
            box-shadow: 0 4px 18px rgba(46,125,50,0.12);
        }

        .highlight-box.warning {
            background: linear-gradient(135deg, rgba(255, 152, 0, 0.08) 0%, rgba(255, 193, 7, 0.06) 100%);
            border-left-color: #f57c00;
            box-shadow: 0 2px 10px rgba(255,152,0,0.06);
        }

        .highlight-box.warning:hover {
            box-shadow: 0 4px 18px rgba(255,152,0,0.12);
        }

        .highlight-box h4 {
            color: #2e7d32;
            margin-bottom: 10px;
            font-size: 1.05em;
        }

        .highlight-box.warning h4 {
            color: #f57c00;
        }

        /* INSIGHT & RECOMMENDATION PANELS (Schools Dashboard & shared) */
        .insight-panel {
            padding: 24px 28px;
            border-radius: 14px;
            position: relative;
            overflow: hidden;
            transition: transform 0.2s ease, box-shadow 0.2s ease;
        }

        .insight-panel:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 28px rgba(0,0,0,0.10);
        }

        .insight-panel::before {
            content: '';
            position: absolute;
            top: 0; right: 0;
            width: 80px; height: 80px;
            border-radius: 0 14px 0 80px;
            opacity: 0.12;
        }

        .insight-panel.green {
            background: linear-gradient(135deg, #e8f5e9 0%, #f1f8e9 100%);
            border-left: 5px solid #2e7d32;
            box-shadow: 0 3px 14px rgba(46,125,50,0.08);
        }

        .insight-panel.green::before {
            background: radial-gradient(circle, #2e7d32, transparent);
        }

        .insight-panel.blue {
            background: linear-gradient(135deg, #e3f2fd 0%, #e8eaf6 100%);
            border-left: 5px solid #1565C0;
            box-shadow: 0 3px 14px rgba(21,101,192,0.08);
        }

        .insight-panel.blue::before {
            background: radial-gradient(circle, #1565C0, transparent);
        }

        .insight-panel.amber {
            background: linear-gradient(135deg, #fff3e0 0%, #fff8e1 100%);
            border-left: 5px solid #e65100;
            box-shadow: 0 3px 14px rgba(230,81,0,0.08);
        }

        .insight-panel.amber::before {
            background: radial-gradient(circle, #e65100, transparent);
        }

        .insight-panel.teal {
            background: linear-gradient(135deg, #e0f2f1 0%, #e0f7fa 100%);
            border-left: 5px solid #00695C;
            box-shadow: 0 3px 14px rgba(0,105,92,0.08);
        }

        .insight-panel.teal::before {
            background: radial-gradient(circle, #00695C, transparent);
        }

        .insight-panel h4 {
            font-size: 1.1em;
            margin-bottom: 14px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .insight-panel ul {
            padding-left: 20px;
            line-height: 2.0;
            color: #333;
        }

        .insight-panel ul li {
            position: relative;
            padding-left: 4px;
            margin-bottom: 4px;
        }

        .insight-panel ul li::marker {
            color: inherit;
        }

        .insights-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 22px;
            margin-bottom: 30px;
        }

        @media (max-width: 768px) {
            .insights-grid {
                grid-template-columns: 1fr;
            }
        }

        /* OVERALL INSIGHT CARDS (Schools Dashboard) */
        .insight-card {
            background: #fff;
            padding: 24px 28px;
            border-radius: 14px;
            box-shadow: 0 3px 14px rgba(0,0,0,0.06);
            margin-bottom: 20px;
            border-left: 5px solid #ccc;
            transition: transform 0.2s ease, box-shadow 0.2s ease;
            position: relative;
            overflow: hidden;
        }

        .insight-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 24px rgba(0,0,0,0.10);
        }

        .insight-card::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            height: 3px;
            background: linear-gradient(90deg, transparent, rgba(0,0,0,0.03), transparent);
        }

        .insight-card h3 {
            margin-bottom: 12px;
            font-size: 1.15em;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .insight-card p, .insight-card ul {
            line-height: 1.9;
            color: #444;
        }

        .insight-card.red { border-left-color: #c62828; }
        .insight-card.orange { border-left-color: #e65100; }
        .insight-card.brown { border-left-color: #795548; }
        .insight-card.darkblue { border-left-color: #0277BD; }
        .insight-card.green { border-left-color: #2E7D32; background: linear-gradient(135deg, #f1f8e9, #fff); }
        .insight-card.amber { border-left-color: #e65100; background: linear-gradient(135deg, #fff3e0, #fff); }

        /* OLD RESPONSIVE BREAKPOINTS REPLACED BY ENHANCED VERSION BELOW */

        /* COLLAPSIBLE SECTION */
        .collapsible-header {
            background: linear-gradient(135deg, #0072CE 0%, #005a9e 100%);
            color: white;
            padding: 15px 20px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 1.1em;
            font-weight: 600;
            border: none;
            width: 100%;
            text-align: left;
            display: flex;
            justify-content: space-between;
            align-items: center;
            transition: all 0.3s ease;
        }

        .collapsible-header:hover {
            background: linear-gradient(135deg, #005a9e 0%, #0072CE 100%);
            box-shadow: 0 4px 12px rgba(0, 114, 206, 0.3);
        }

        .collapsible-header::after {
            content: 'v';
            transition: transform 0.3s ease;
            font-size: 0.8em;
        }

        .collapsible-header.collapsed::after {
            transform: rotate(-90deg);
        }

        .collapsible-content {
            max-height: 2000px;
            overflow: hidden;
            transition: max-height 0.3s ease, padding 0.3s ease;
            padding: 20px 0;
        }

        .collapsible-content.collapsed {
            max-height: 0;
            padding: 0;
        }

        /* OVERRIDE EXECUTIVE SUMMARY COLLAPSIBLE STYLING */
        .executive-summary .collapsible-header {
            background: linear-gradient(135deg, #0072CE 0%, #005a9e 100%);
            margin: -30px -30px 0 -30px;
            border-radius: 12px 12px 0 0;
            padding: 20px;
        }

        .executive-summary .collapsible-content {
            padding: 30px 0 0 0;
        }

        .section > .collapsible-header {
            margin: -30px -30px 0 -30px;
            border-radius: 8px 8px 0 0;
        }

        .section > .collapsible-content {
            padding: 30px 0 0 0;
        }

        /* BACK-TO-TOP BUTTON */
        #backToTop {
            position: fixed;
            bottom: 30px;
            right: 30px;
            background: linear-gradient(135deg, #0072CE 0%, #005a9e 100%);
            color: white;
            border: none;
            width: 50px;
            height: 50px;
            border-radius: 50%;
            cursor: pointer;
            display: none;
            opacity: 0;
            z-index: 500;
            transition: all 0.3s ease;
            font-size: 20px;
            line-height: 1;
            padding: 0;
            box-shadow: 0 4px 15px rgba(0, 114, 206, 0.4);
        }

        #backToTop:hover {
            transform: translateY(-5px);
            box-shadow: 0 6px 20px rgba(0, 114, 206, 0.6);
            background: linear-gradient(135deg, #005a9e 0%, #0072CE 100%);
        }

        #backToTop.show {
            display: block;
            opacity: 1;
        }

        /* SECTION INDICATOR */
        .scroll-indicator {
            position: fixed;
            top: 100px;
            right: 20px;
            background: white;
            padding: 15px 20px;
            border-radius: 8px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
            font-size: 0.9em;
            color: #0072CE;
            font-weight: 600;
            z-index: 500;
            max-width: 200px;
            text-align: center;
            display: none;
        }

        .scroll-indicator.show {
            display: block;
        }

        /* ======================================== */
        /* MOBILE HAMBURGER MENU & DRAWER           */
        /* ======================================== */
        .mobile-menu-toggle {
            display: none;
            background: linear-gradient(135deg, #0072CE 0%, #005a9e 100%);
            color: white;
            border: none;
            padding: 10px 16px;
            border-radius: 8px;
            font-size: 1em;
            font-weight: 600;
            cursor: pointer;
            align-items: center;
            gap: 10px;
            width: 100%;
            justify-content: space-between;
            min-height: 48px;
            transition: all 0.3s ease;
            box-shadow: 0 2px 8px rgba(0, 114, 206,0.2);
        }

        .mobile-menu-toggle .current-survey-label {
            flex: 1;
            text-align: left;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .mobile-menu-toggle .hamburger-icon {
            display: flex;
            flex-direction: column;
            gap: 4px;
            width: 22px;
            flex-shrink: 0;
        }

        .mobile-menu-toggle .hamburger-icon span {
            display: block;
            height: 2.5px;
            background: white;
            border-radius: 2px;
            transition: all 0.3s ease;
        }

        .mobile-menu-toggle.open .hamburger-icon span:nth-child(1) {
            transform: translateY(6.5px) rotate(45deg);
        }

        .mobile-menu-toggle.open .hamburger-icon span:nth-child(2) {
            opacity: 0;
        }

        .mobile-menu-toggle.open .hamburger-icon span:nth-child(3) {
            transform: translateY(-6.5px) rotate(-45deg);
        }

        .mobile-nav-overlay {
            display: none;
            position: fixed;
            inset: 0;
            background: rgba(0,0,0,0.4);
            z-index: 1099;
            opacity: 0;
            transition: opacity 0.3s ease;
        }

        .mobile-nav-overlay.open {
            display: block;
            opacity: 1;
        }

        .mobile-nav-drawer {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 85%;
            max-width: 320px;
            height: 100vh;
            background: white;
            z-index: 1100;
            transform: translateX(-100%);
            transition: transform 0.35s cubic-bezier(0.4, 0, 0.2, 1);
            overflow-y: auto;
            -webkit-overflow-scrolling: touch;
            box-shadow: 4px 0 25px rgba(0,0,0,0.15);
        }

        .mobile-nav-drawer.open {
            transform: translateX(0);
        }

        .mobile-nav-drawer .drawer-header {
            background: linear-gradient(135deg, #0072CE 0%, #005a9e 100%);
            color: white;
            padding: 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            position: sticky;
            top: 0;
            z-index: 1;
        }

        .mobile-nav-drawer .drawer-header h3 {
            margin: 0;
            font-size: 1.1em;
        }

        .mobile-nav-drawer .drawer-close {
            background: rgba(255,255,255,0.2);
            border: none;
            color: white;
            width: 36px;
            height: 36px;
            border-radius: 50%;
            font-size: 1.3em;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: background 0.2s;
        }

        .mobile-nav-drawer .drawer-close:hover {
            background: rgba(255,255,255,0.35);
        }

        .mobile-nav-drawer .drawer-nav-list {
            padding: 12px;
            display: flex;
            flex-direction: column;
            gap: 6px;
        }

        .mobile-nav-drawer .drawer-nav-item {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 14px 16px;
            border: none;
            background: #f8f9fa;
            border-radius: 10px;
            font-size: 0.95em;
            font-weight: 500;
            color: #333;
            cursor: pointer;
            transition: all 0.2s ease;
            text-align: left;
            width: 100%;
            min-height: 48px;
            border-left: 4px solid transparent;
        }

        .mobile-nav-drawer .drawer-nav-item:hover {
            background: #f0f4ff;
            border-left-color: #0072CE;
        }

        .mobile-nav-drawer .drawer-nav-item.active {
            background: linear-gradient(135deg, #e3f2fd 0%, #f0f4ff 100%);
            color: #0072CE;
            font-weight: 700;
            border-left-color: #0072CE;
            box-shadow: 0 2px 8px rgba(0, 114, 206,0.1);
        }

        /* ======================================== */
        /* TABLE SCROLL WRAPPER - MOBILE            */
        /* ======================================== */
        .table-scroll-wrapper {
            width: 100%;
            overflow-x: auto;
            -webkit-overflow-scrolling: touch;
            margin-bottom: 10px;
        }

        .table-scroll-wrapper table {
            min-width: 500px;
        }

        /* ======================================== */
        /* ENHANCED RESPONSIVE - TABLET (<=900px)   */
        /* ======================================== */
        @media (max-width: 900px) {
            .charts-grid {
                grid-template-columns: 1fr;
            }

            .output-charts-row {
                grid-template-columns: 1fr;
            }

            .header h1 {
                font-size: 1.8em;
            }

            .tabs-container {
                flex-wrap: nowrap;
                overflow-x: auto;
                -webkit-overflow-scrolling: touch;
                gap: 6px;
                padding: 8px 12px;
                scroll-snap-type: x mandatory;
            }

            .tab-button {
                flex-shrink: 0;
                scroll-snap-align: start;
            }

            .output-kpi-grid {
                grid-template-columns: repeat(2, 1fr);
            }

            #live-viewers-badge {
                top: 8px;
                right: 10px;
                padding: 6px 12px;
                font-size: 0.75em;
            }

            #viewer-panel {
                width: 260px;
                right: 10px;
                top: 42px;
            }
        }

        /* ======================================== */
        /* ENHANCED RESPONSIVE - TABLET (<=768px)   */
        /* ======================================== */
        @media (max-width: 768px) {
            .container {
                padding: 12px;
            }

            /* Show hamburger, hide desktop survey buttons */
            .mobile-menu-toggle {
                display: flex;
            }

            .mobile-nav-drawer {
                display: block;
            }

            .survey-buttons {
                display: none !important;
            }

            .survey-selector label {
                display: none;
            }

            .survey-selector {
                padding: 10px;
                gap: 8px;
                margin-bottom: 0;
                border-radius: 0;
            }

            /* Spacer adjustment for mobile */
            .survey-selector-spacer {
                height: 60px;
            }

            /* Header */
            .header {
                padding: 18px 20px;
                margin-bottom: 18px;
                border-radius: 10px;
            }

            .header h1 {
                font-size: 1.5em;
                line-height: 1.3;
                margin-bottom: 8px;
            }

            .header-subtitle {
                font-size: 0.9em;
            }

            .header-meta {
                display: grid;
                grid-template-columns: 1fr 1fr;
                gap: 12px;
            }

            .meta-item {
                font-size: 0.85em;
            }

            /* Tabs - horizontal scroll */
            .tabs-container {
                position: sticky;
                top: 60px;
                gap: 6px;
                padding: 8px 10px;
                overflow-x: auto;
                -webkit-overflow-scrolling: touch;
                scroll-snap-type: x mandatory;
                margin-bottom: 15px;
                border-radius: 8px;
                z-index: 999;
            }

            .tab-button {
                min-width: auto;
                padding: 10px 14px;
                font-size: 0.82em;
                white-space: nowrap;
                flex-shrink: 0;
                min-height: 44px;
                scroll-snap-align: start;
                border-radius: 6px;
            }

            /* Sub-selectors scroll */
            #prepost-type-selector,
            #schools-dash-type-selector,
            #output-type-selector {
                overflow-x: auto;
                -webkit-overflow-scrolling: touch;
                flex-wrap: nowrap !important;
                gap: 6px;
                padding: 8px 10px;
                scroll-snap-type: x mandatory;
                position: sticky;
                top: 60px;
                z-index: 998;
            }

            #prepost-type-selector .tab-button,
            #schools-dash-type-selector .tab-button,
            #output-type-selector .tab-button {
                flex-shrink: 0;
                min-width: auto;
                padding: 10px 14px;
                font-size: 0.82em;
                scroll-snap-align: start;
                white-space: nowrap;
            }

            /* Charts */
            .charts-grid {
                grid-template-columns: 1fr;
                gap: 15px;
            }

            .chart-container {
                height: 280px;
            }

            .chart-title {
                font-size: 0.95em;
                margin-bottom: 10px;
            }

            .chart-insight {
                font-size: 0.82em;
                padding: 10px 12px;
            }

            /* Key Findings */
            .key-findings {
                grid-template-columns: 1fr;
                gap: 12px;
            }

            .finding-card {
                padding: 16px;
            }

            .finding-title {
                font-size: 0.95em;
            }

            .finding-metric {
                font-size: 1.6em;
            }

            .finding-description {
                font-size: 0.88em;
            }

            /* KPI Cards */
            .kpi-section {
                grid-template-columns: 1fr 1fr;
                gap: 10px;
            }

            .kpi-card {
                padding: 14px;
            }

            .kpi-label {
                font-size: 0.8em;
            }

            .kpi-value {
                font-size: 1.5em;
                margin: 6px 0;
            }

            /* Output section */
            .output-header {
                padding: 18px 20px;
                border-radius: 10px;
                margin-bottom: 18px;
            }

            .output-header h2 {
                font-size: 1.25em;
            }

            .output-card {
                padding: 18px;
                margin-bottom: 18px;
            }

            .output-card h3 {
                font-size: 1.05em;
            }

            .output-kpi-grid {
                grid-template-columns: 1fr 1fr;
                gap: 10px;
            }

            .output-kpi {
                padding: 14px;
            }

            .output-kpi .kpi-value {
                font-size: 1.4em;
            }

            .output-charts-row {
                grid-template-columns: 1fr;
                gap: 15px;
            }

            /* Tables - horizontal scroll */
            .comparison-table,
            .output-table {
                display: block;
                overflow-x: auto;
                -webkit-overflow-scrolling: touch;
                font-size: 0.82em;
            }

            .comparison-table th,
            .comparison-table td {
                padding: 10px 8px;
                white-space: nowrap;
            }

            .output-table th,
            .output-table td {
                padding: 8px 10px;
                white-space: nowrap;
            }

            /* Sections */
            .section {
                padding: 18px;
                margin-bottom: 18px;
                border-radius: 8px;
            }

            .section-title {
                font-size: 1.05em;
                padding: 14px 16px;
                margin: -18px -18px 15px -18px;
                position: sticky;
                top: 108px;
                z-index: 997;
            }

            /* Executive Summary */
            .executive-summary {
                padding: 18px;
                margin-bottom: 18px;
            }

            .executive-summary .collapsible-header {
                margin: -18px -18px 0 -18px;
                padding: 16px;
                font-size: 1em;
            }

            .executive-summary .collapsible-content {
                padding: 16px 0 0 0;
            }

            .summary-title {
                font-size: 1.2em;
            }

            /* Collapsible Headers */
            .collapsible-header {
                padding: 14px 16px;
                font-size: 0.95em;
            }

            /* Insight panels */
            .insights-grid {
                grid-template-columns: 1fr;
                gap: 15px;
            }

            .insight-panel {
                padding: 18px 20px;
            }

            .insight-card {
                padding: 18px 20px;
            }

            /* Highlight Box */
            .highlight-box {
                padding: 16px 18px;
                margin: 15px 0;
            }

            /* Back-to-Top Button */
            #backToTop {
                bottom: 18px;
                right: 18px;
                width: 46px;
                height: 46px;
                font-size: 18px;
            }

            /* Scroll Indicator */
            .scroll-indicator {
                top: 70px;
                right: 8px;
                font-size: 0.7em;
                padding: 6px 10px;
                max-width: 160px;
            }

            /* Footer */
            .footer {
                padding: 20px 15px;
                margin-top: 25px;
            }

            .footer p {
                font-size: 0.82em;
            }

            /* Live viewers */
            #live-viewers-badge {
                top: 6px;
                right: 8px;
                padding: 5px 10px;
                font-size: 0.72em;
                border-radius: 20px;
            }

            #viewer-panel {
                width: 250px;
                right: 8px;
                top: 38px;
            }
        }

        /* ======================================== */
        /* ENHANCED RESPONSIVE - PHONE (<=480px)    */
        /* ======================================== */
        @media (max-width: 480px) {
            .container {
                padding: 8px;
            }

            /* Survey Selector - minimal on phone */
            .survey-selector {
                padding: 8px;
                gap: 6px;
                border-radius: 0;
                margin-bottom: 0;
            }

            .survey-selector-spacer {
                height: 56px;
            }

            .mobile-menu-toggle {
                padding: 10px 14px;
                font-size: 0.9em;
            }

            /* Mobile nav drawer full width on small phones */
            .mobile-nav-drawer {
                width: 90%;
                max-width: 300px;
            }

            .mobile-nav-drawer .drawer-nav-item {
                padding: 12px 14px;
                font-size: 0.9em;
            }

            /* Header */
            .header {
                padding: 14px 14px;
                margin-bottom: 12px;
                border-radius: 8px;
            }

            .header h1 {
                font-size: 1.3em;
                line-height: 1.3;
                margin-bottom: 6px;
            }

            .header-subtitle {
                font-size: 0.82em;
                margin-bottom: 10px;
            }

            .header-meta {
                grid-template-columns: 1fr;
                gap: 6px;
            }

            .meta-item {
                font-size: 0.78em;
            }

            .meta-item strong {
                display: block;
                font-weight: 700;
            }

            /* Tabs - Horizontal Scroll */
            .tabs-container {
                display: flex;
                gap: 5px;
                padding: 6px 8px;
                overflow-x: auto;
                -webkit-overflow-scrolling: touch;
                scroll-snap-type: x mandatory;
                border-radius: 6px;
                margin-bottom: 12px;
                position: sticky;
                top: 56px;
                z-index: 999;
            }

            .tab-button {
                min-width: 65px;
                padding: 9px 10px;
                font-size: 0.72em;
                white-space: nowrap;
                flex-shrink: 0;
                min-height: 44px;
                scroll-snap-align: start;
                border-radius: 6px;
            }

            /* Sub-selectors */
            #prepost-type-selector,
            #schools-dash-type-selector,
            #output-type-selector {
                padding: 6px 8px;
                gap: 5px;
            }

            #prepost-type-selector .tab-button,
            #schools-dash-type-selector .tab-button,
            #output-type-selector .tab-button {
                padding: 9px 10px;
                font-size: 0.72em;
            }

            /* Charts */
            .chart-container {
                height: 230px;
                margin-bottom: 8px;
            }

            .chart-title {
                font-size: 0.88em;
                margin-bottom: 8px;
            }

            .chart-insight {
                font-size: 0.78em;
                padding: 8px 10px;
                margin-top: 8px;
                line-height: 1.5;
            }

            .chart-insight::before {
                width: 20px;
                height: 20px;
                font-size: 0.9em;
                top: -8px;
                right: 8px;
            }

            .charts-grid {
                gap: 10px;
            }

            .chart-wrapper {
                padding: 14px;
            }

            /* Key Findings */
            .key-findings {
                grid-template-columns: 1fr;
                gap: 10px;
            }

            .finding-card {
                padding: 12px 14px;
                border-radius: 8px;
            }

            .finding-title {
                font-size: 0.88em;
                margin-bottom: 6px;
            }

            .finding-metric {
                font-size: 1.4em;
                margin-bottom: 4px;
            }

            .finding-description {
                font-size: 0.82em;
                line-height: 1.4;
            }

            /* KPI Cards */
            .kpi-section {
                grid-template-columns: 1fr;
                gap: 8px;
            }

            .kpi-card {
                padding: 12px;
                border-radius: 8px;
            }

            .kpi-label {
                font-size: 0.78em;
            }

            .kpi-value {
                font-size: 1.3em;
                margin: 5px 0;
            }

            .kpi-change {
                font-size: 0.78em;
            }

            /* Output Section */
            .output-header {
                padding: 14px 16px;
                border-radius: 8px;
                margin-bottom: 12px;
            }

            .output-header h2 {
                font-size: 1.1em;
            }

            .output-header p {
                font-size: 0.82em;
            }

            .output-card {
                padding: 12px;
                margin-bottom: 12px;
                border-radius: 8px;
            }

            .output-card h3 {
                font-size: 1em;
                padding-bottom: 8px;
            }

            .output-kpi-grid {
                grid-template-columns: 1fr 1fr;
                gap: 8px;
            }

            .output-kpi {
                padding: 10px;
                border-radius: 8px;
            }

            .output-kpi .kpi-label {
                font-size: 0.7em;
            }

            .output-kpi .kpi-value {
                font-size: 1.2em;
            }

            .output-charts-row {
                grid-template-columns: 1fr;
                gap: 10px;
            }

            .output-chart-box {
                padding: 14px;
            }

            .output-chart-box h4 {
                font-size: 0.9em;
            }

            .output-chart-box canvas {
                max-height: 240px;
            }

            /* Tables */
            .comparison-table {
                font-size: 0.72em;
            }

            .comparison-table th,
            .comparison-table td {
                padding: 7px 6px;
            }

            .output-table {
                font-size: 0.78em;
            }

            .output-table th,
            .output-table td {
                padding: 7px 8px;
            }

            /* Collapsibles */
            .collapsible-header {
                padding: 12px 14px;
                font-size: 0.88em;
                border-radius: 6px;
            }

            .collapsible-header::after {
                font-size: 0.7em;
            }

            .collapsible-content {
                padding: 12px 0;
            }

            /* Sections */
            .section {
                padding: 14px;
                margin-bottom: 12px;
                border-radius: 8px;
            }

            .section-title {
                font-size: 0.92em;
                padding: 12px 14px;
                margin: -14px -14px 12px -14px;
                position: sticky;
                top: 100px;
                z-index: 997;
            }

            .section > .collapsible-header {
                margin: -14px -14px 0 -14px;
                border-radius: 8px 8px 0 0;
            }

            .section > .collapsible-content {
                padding: 14px 0 0 0;
            }

            /* Executive Summary */
            .executive-summary {
                padding: 14px;
                margin-bottom: 14px;
            }

            .executive-summary .collapsible-header {
                margin: -14px -14px 0 -14px;
                padding: 14px;
                font-size: 0.92em;
            }

            .executive-summary .collapsible-content {
                padding: 14px 0 0 0;
            }

            .summary-title {
                font-size: 1.1em;
                padding-bottom: 8px;
            }

            /* Insight panels & cards */
            .insights-grid {
                grid-template-columns: 1fr;
                gap: 10px;
            }

            .insight-panel {
                padding: 14px 16px;
            }

            .insight-panel h4 {
                font-size: 0.95em;
                margin-bottom: 10px;
            }

            .insight-panel ul {
                padding-left: 16px;
                line-height: 1.7;
                font-size: 0.88em;
            }

            .insight-card {
                padding: 14px 16px;
            }

            .insight-card h3 {
                font-size: 1em;
            }

            .insight-card p, .insight-card ul {
                font-size: 0.88em;
                line-height: 1.6;
            }

            /* Highlight Box */
            .highlight-box {
                padding: 12px 14px;
                margin: 10px 0;
            }

            .highlight-box h4 {
                font-size: 0.9em;
                margin-bottom: 6px;
            }

            .highlight-box p {
                font-size: 0.82em;
                line-height: 1.5;
                margin-bottom: 6px;
            }

            /* Back-to-Top Button */
            #backToTop {
                bottom: 14px;
                right: 14px;
                width: 44px;
                height: 44px;
                font-size: 16px;
                border-radius: 50%;
            }

            /* Scroll Indicator */
            .scroll-indicator {
                display: none;
            }

            /* Dashboard switcher */
            .dashboard-switcher {
                flex-wrap: wrap;
                gap: 6px;
            }

            .dashboard-btn {
                flex: 1;
                min-width: 90px;
                padding: 8px;
                font-size: 0.78em;
            }

            /* Footer */
            .footer {
                padding: 18px 12px;
                margin-top: 20px;
            }

            .footer p {
                font-size: 0.78em;
            }

            /* Live viewers badge - minimal on phone */
            #live-viewers-badge {
                top: 5px;
                right: 6px;
                padding: 4px 8px;
                font-size: 0.68em;
                border-radius: 16px;
                gap: 5px;
            }

            #live-viewers-badge .pulse-dot {
                width: 6px;
                height: 6px;
            }

            #viewer-panel {
                width: calc(100vw - 20px);
                max-width: 300px;
                right: 10px;
                top: 34px;
            }
        }

        /* ======================================== */
        /* EXTRA SMALL DEVICES (<=375px)            */
        /* ======================================== */
        @media (max-width: 375px) {
            .container {
                padding: 6px;
            }

            .survey-selector {
                padding: 6px;
            }

            .mobile-menu-toggle {
                padding: 9px 12px;
                font-size: 0.85em;
            }

            .header {
                padding: 12px;
            }

            .header h1 {
                font-size: 1.15em;
            }

            .header-subtitle {
                font-size: 0.78em;
            }

            .tab-button {
                min-width: 55px;
                font-size: 0.68em;
                padding: 8px 8px;
            }

            .chart-container {
                height: 200px;
            }

            .section {
                padding: 10px;
            }

            .section-title {
                font-size: 0.85em;
                padding: 10px 12px;
                margin: -10px -10px 10px -10px;
            }

            .kpi-section {
                grid-template-columns: 1fr;
            }

            .output-kpi-grid {
                grid-template-columns: 1fr;
                gap: 6px;
            }

            .finding-metric {
                font-size: 1.2em;
            }

            .executive-summary {
                padding: 10px;
            }

            .executive-summary .collapsible-header {
                margin: -10px -10px 0 -10px;
                padding: 12px;
            }
        }

        /* ======================================== */
        /* LANDSCAPE PHONE                          */
        /* ======================================== */
        @media (max-width: 768px) and (orientation: landscape) {
            .mobile-nav-drawer {
                width: 50%;
                max-width: 300px;
            }

            .chart-container {
                height: 260px;
            }

            .kpi-section {
                grid-template-columns: 1fr 1fr;
            }

            .key-findings {
                grid-template-columns: 1fr 1fr;
            }

            .output-kpi-grid {
                grid-template-columns: repeat(3, 1fr);
            }
        }

        /* ======================================== */
        /* PRODUCTION ANIMATIONS                    */
        /* Subtle, performance-friendly transitions */
        /* ======================================== */

        /* 1. FADE-IN + SLIDE-UP — scroll-triggered entrance for cards & charts */
        @keyframes anim-fadeSlideUp {
            from { opacity: 0; transform: translateY(18px); }
            to   { opacity: 1; transform: translateY(0); }
        }

        /* Applied via JS IntersectionObserver — hidden by default, revealed on scroll */
        .anim-observe {
            opacity: 0;
            transform: translateY(18px);
            will-change: opacity, transform;
        }
        .anim-visible {
            animation: anim-fadeSlideUp 0.35s ease-out forwards;
        }

        /* Staggered entrance for grid children (cards, KPIs) */
        .anim-stagger > .anim-visible:nth-child(1)  { animation-delay: 0ms; }
        .anim-stagger > .anim-visible:nth-child(2)  { animation-delay: 60ms; }
        .anim-stagger > .anim-visible:nth-child(3)  { animation-delay: 120ms; }
        .anim-stagger > .anim-visible:nth-child(4)  { animation-delay: 180ms; }
        .anim-stagger > .anim-visible:nth-child(5)  { animation-delay: 240ms; }
        .anim-stagger > .anim-visible:nth-child(6)  { animation-delay: 300ms; }
        .anim-stagger > .anim-visible:nth-child(7)  { animation-delay: 360ms; }
        .anim-stagger > .anim-visible:nth-child(8)  { animation-delay: 420ms; }

        /* 2. COUNT-UP NUMBER — smooth font-feature for tabular numbers */
        .anim-countup {
            font-variant-numeric: tabular-nums;
            display: inline-block;
        }

        /* 3. FILTER/TAB TRANSITION — smooth cross-fade when content switches */
        @keyframes anim-filterFade {
            from { opacity: 0; transform: translateY(10px); }
            to   { opacity: 1; transform: translateY(0); }
        }
        .anim-section-enter {
            animation: anim-filterFade 0.3s ease-out forwards;
        }

        /* 4. ANIMATED PROGRESS BAR — for indicator performance */
        .anim-progress-wrap {
            width: 100%;
            height: 8px;
            background: #e9ecef;
            border-radius: 4px;
            overflow: hidden;
            margin-top: 6px;
        }
        .anim-progress-bar {
            height: 100%;
            width: 0;                          /* JS will animate to target */
            border-radius: 4px;
            background: linear-gradient(90deg, #0072CE, #005a9e);
            transition: width 0.8s cubic-bezier(0.4, 0, 0.2, 1);
        }
        .anim-progress-bar.green  { background: linear-gradient(90deg, #2e7d32, #43a047); }
        .anim-progress-bar.orange { background: linear-gradient(90deg, #e65100, #fb8c00); }
        .anim-progress-bar.red    { background: linear-gradient(90deg, #c62828, #ef5350); }

        /* 5. SKELETON LOADER — placeholder while data loads */
        @keyframes anim-shimmer {
            0%   { background-position: -400px 0; }
            100% { background-position: 400px 0; }
        }
        .skeleton {
            background: linear-gradient(90deg, #f0f0f0 25%, #e0e0e0 50%, #f0f0f0 75%);
            background-size: 800px 100%;
            animation: anim-shimmer 1.5s ease-in-out infinite;
            border-radius: 6px;
            display: block;
        }
        .skeleton-text   { height: 14px; margin-bottom: 10px; width: 80%; }
        .skeleton-title  { height: 22px; margin-bottom: 14px; width: 50%; }
        .skeleton-chart  { height: 200px; margin-bottom: 16px; width: 100%; border-radius: 8px; }
        .skeleton-kpi    { height: 90px;  width: 100%; border-radius: 10px; }
        .skeleton-card   { height: 120px; width: 100%; border-radius: 12px; }

        /* Respect reduced-motion preference */
        @media (prefers-reduced-motion: reduce) {
            .anim-observe { opacity: 1; transform: none; }
            .anim-visible { animation: none; opacity: 1; transform: none; }
            .anim-section-enter { animation: none; opacity: 1; transform: none; }
            .anim-progress-bar { transition: none; }
            .skeleton { animation: none; }
            .anim-countup { transition: none; }
        }

        /* Hide animations in print */
        @media print {
            .anim-observe { opacity: 1 !important; transform: none !important; }
            .anim-visible { animation: none !important; }
            .skeleton { display: none !important; }
        }

        /* ======================================== */
        /* PRINT STYLESHEET                         */
        /* ======================================== */
        @media print {
            /* Hide non-printable UI elements */
            .survey-selector,
            .survey-selector-spacer,
            .mobile-nav-overlay,
            .mobile-nav-drawer,
            .tabs-container,
            #backToTop,
            .scroll-indicator,
            #live-viewers-badge,
            #viewer-panel,
            .collapsible-header::after,
            .footer {
                display: none !important;
            }

            /* Reset positioning so content flows naturally */
            * {
                position: static !important;
                float: none !important;
            }

            body, .container {
                margin: 0;
                padding: 0;
                width: 100%;
                max-width: 100%;
                background: white;
                color: black;
                font-size: 11pt;
            }

            .container {
                box-shadow: none;
            }

            /* Show the header */
            .header {
                background: none !important;
                color: black !important;
                text-align: center;
                padding: 10px 0 !important;
                border-bottom: 2px solid #0072CE;
                margin-bottom: 15px;
                page-break-after: avoid;
            }

            .header h1 {
                color: #0072CE !important;
                font-size: 18pt;
            }

            .header-subtitle {
                color: #333 !important;
            }

            /* Force all collapsible sections open */
            .collapsible-content {
                display: block !important;
                max-height: none !important;
                overflow: visible !important;
            }

            /* Sections */
            .section {
                box-shadow: none !important;
                border: 1px solid #ddd;
                page-break-inside: avoid;
                margin-bottom: 10px;
                padding: 12px !important;
            }

            .section-title {
                background: none !important;
                color: #0072CE !important;
                border-bottom: 2px solid #0072CE;
                border-radius: 0 !important;
                padding: 8px 0 !important;
                margin: 0 0 10px 0 !important;
                font-size: 13pt;
            }

            /* KPI cards — compact grid for print */
            .kpi-section {
                grid-template-columns: repeat(4, 1fr) !important;
                gap: 8px;
            }

            .kpi-card {
                box-shadow: none !important;
                border: 1px solid #ccc;
                padding: 8px !important;
                page-break-inside: avoid;
            }

            .kpi-value {
                color: #0072CE !important;
            }

            /* Key findings */
            .key-findings {
                grid-template-columns: repeat(3, 1fr) !important;
                gap: 8px;
            }

            .finding-card {
                box-shadow: none !important;
                border: 1px solid #ccc;
                page-break-inside: avoid;
            }

            /* Charts — ensure they print with background colors */
            .chart-container {
                height: auto !important;
                min-height: 200px;
                page-break-inside: avoid;
            }

            canvas {
                max-width: 100% !important;
                height: auto !important;
            }

            .charts-grid {
                grid-template-columns: 1fr 1fr !important;
                gap: 10px;
            }

            .chart-wrapper {
                box-shadow: none !important;
                border: 1px solid #ddd;
                page-break-inside: avoid;
            }

            .chart-insight {
                border: 1px solid #e0e0e0;
                background: #f9f9f9 !important;
                color: #333 !important;
            }

            /* Tables */
            .comparison-table, .output-table {
                font-size: 9pt;
                page-break-inside: avoid;
            }

            .comparison-table th, .output-table th {
                background: #0072CE !important;
                color: white !important;
                -webkit-print-color-adjust: exact;
                print-color-adjust: exact;
            }

            /* Output section */
            .output-header {
                background: none !important;
                color: black !important;
                border: 2px solid #0072CE;
            }

            .output-header h2 {
                color: #0072CE !important;
            }

            .output-card {
                box-shadow: none !important;
                border: 1px solid #ddd;
                page-break-inside: avoid;
            }

            .output-kpi-grid {
                grid-template-columns: repeat(3, 1fr) !important;
            }

            .output-charts-row {
                grid-template-columns: 1fr 1fr !important;
            }

            /* Insight panels */
            .insight-panel, .insight-card {
                box-shadow: none !important;
                border: 1px solid #ddd;
                page-break-inside: avoid;
            }

            .highlight-box {
                border: 1px solid #0072CE !important;
                background: #f0f7ff !important;
                -webkit-print-color-adjust: exact;
                print-color-adjust: exact;
            }

            /* Executive summary */
            .executive-summary {
                box-shadow: none !important;
                border: 1px solid #ddd;
            }

            /* Links show URL */
            a[href]::after {
                content: " (" attr(href) ")";
                font-size: 0.8em;
                color: #666;
            }
        }

        /* ============================================================
           CROSS-DATASET SYNTHESIS & AUTOMATED INSIGHTS TABS
           ============================================================ */

        /* Synthesis KPI row */
        .synthesis-kpi-row {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 16px;
            margin-bottom: 28px;
        }
        .synthesis-kpi {
            background: #fff;
            border-radius: 10px;
            padding: 20px 18px;
            text-align: center;
            border-top: 4px solid #0072CE;
            box-shadow: 0 3px 12px rgba(0,0,0,0.07);
            transition: transform 0.2s, box-shadow 0.2s;
            display: flex;
            flex-direction: column;
            align-items: center;
        }
        .synthesis-kpi:hover {
            transform: translateY(-3px);
            box-shadow: 0 6px 20px rgba(0,0,0,0.12);
        }
        .synthesis-kpi .sk-label {
            font-size: 0.78em;
            text-transform: uppercase;
            letter-spacing: 1px;
            color: #777;
            margin-bottom: 10px;
            line-height: 1.3;
            flex-shrink: 0;
        }
        .synthesis-kpi .sk-value {
            font-size: 2em;
            font-weight: 800;
            color: #0072CE;
            margin-bottom: 6px;
            line-height: 1.1;
            flex-shrink: 0;
        }
        .synthesis-kpi .sk-sub {
            font-size: 0.82em;
            color: #555;
        }
        .synthesis-kpi.green { border-top-color: #2e7d32; }
        .synthesis-kpi.green .sk-value { color: #2e7d32; }
        .synthesis-kpi.orange { border-top-color: #f57c00; }
        .synthesis-kpi.orange .sk-value { color: #f57c00; }
        .synthesis-kpi.red { border-top-color: #c62828; }
        .synthesis-kpi.red .sk-value { color: #c62828; }

        /* Cross-dataset comparison table */
        .cross-table {
            width: 100%;
            border-collapse: collapse;
            font-size: 0.88em;
            margin: 18px 0;
            background: #fff;
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 2px 8px rgba(0,0,0,0.06);
        }
        .cross-table th {
            background: linear-gradient(135deg, #0072CE, #005a9e);
            color: #fff;
            padding: 12px 14px;
            text-align: left;
            font-weight: 600;
            font-size: 0.85em;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }
        .cross-table td {
            padding: 10px 14px;
            border-bottom: 1px solid #eef1f5;
            vertical-align: middle;
        }
        .cross-table tr:nth-child(even) { background: #f8fafd; }
        .cross-table tr:hover { background: #eef4fb; }
        .cross-table .status-pill {
            display: inline-block;
            padding: 3px 10px;
            border-radius: 12px;
            font-size: 0.82em;
            font-weight: 700;
            text-transform: uppercase;
        }
        .status-pill.exceeded { background: #e8f5e9; color: #2e7d32; }
        .status-pill.on-track { background: #e3f2fd; color: #1565c0; }
        .status-pill.at-risk  { background: #fff3e0; color: #e65100; }
        .status-pill.declined { background: #ffebee; color: #c62828; }

        /* Sparkline canvas */
        .sparkline-box {
            display: inline-block;
            width: 80px;
            height: 28px;
            vertical-align: middle;
        }

        /* Domain filter bar */
        .domain-filter-bar {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            margin-bottom: 20px;
        }
        .domain-chip {
            padding: 6px 14px;
            border-radius: 20px;
            border: 2px solid #0072CE;
            background: #fff;
            color: #0072CE;
            font-weight: 600;
            font-size: 0.82em;
            cursor: pointer;
            transition: all 0.2s;
        }
        .domain-chip.active,
        .domain-chip:hover {
            background: #0072CE;
            color: #fff;
        }

        /* Insight cards (Automated Insights tab) */
        .insight-feed {
            display: flex;
            flex-direction: column;
            gap: 18px;
        }
        .insight-card {
            background: #fff;
            border-radius: 10px;
            padding: 20px 22px;
            box-shadow: 0 3px 12px rgba(0,0,0,0.07);
            border-left: 5px solid #0072CE;
            transition: transform 0.2s;
        }
        .insight-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 18px rgba(0,0,0,0.1);
        }
        .insight-card.trend     { border-left-color: #1976d2; }
        .insight-card.anomaly   { border-left-color: #f57c00; }
        .insight-card.milestone { border-left-color: #2e7d32; }
        .insight-card.gap       { border-left-color: #c62828; }
        .insight-card.crosslink { border-left-color: #7b1fa2; }
        .insight-card.recommendation { border-left-color: #00838f; }
        .insight-card.opportunity    { border-left-color: #558b2f; }

        .insight-badge {
            display: inline-block;
            padding: 3px 10px;
            border-radius: 12px;
            font-size: 0.75em;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            margin-bottom: 8px;
        }
        .insight-badge.trend     { background: #e3f2fd; color: #1565c0; }
        .insight-badge.anomaly   { background: #fff3e0; color: #e65100; }
        .insight-badge.milestone { background: #e8f5e9; color: #2e7d32; }
        .insight-badge.gap       { background: #ffebee; color: #c62828; }
        .insight-badge.crosslink { background: #f3e5f5; color: #6a1b9a; }
        .insight-badge.recommendation { background: #e0f7fa; color: #00696b; }
        .insight-badge.opportunity    { background: #f1f8e9; color: #33691e; }

        /* Confidence & severity badges */
        .confidence-badge {
            display: inline-block;
            padding: 2px 8px;
            border-radius: 10px;
            font-size: 0.7em;
            font-weight: 700;
            margin-left: 8px;
            vertical-align: middle;
        }
        .confidence-badge.high   { background: #e8f5e9; color: #2e7d32; }
        .confidence-badge.medium { background: #fff8e1; color: #f57f17; }
        .confidence-badge.low    { background: #fce4ec; color: #c62828; }

        .severity-indicator {
            display: inline-flex;
            gap: 3px;
            margin-left: 8px;
            vertical-align: middle;
        }
        .severity-dot {
            width: 8px; height: 8px;
            border-radius: 50%;
            background: #ddd;
        }
        .severity-dot.filled { background: #f57c00; }
        .severity-dot.filled.high { background: #c62828; }
        .severity-dot.filled.low { background: #66bb6a; }

        /* Insight card metadata row */
        .insight-meta {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            align-items: center;
            margin-top: 10px;
            padding-top: 10px;
            border-top: 1px solid #f0f0f0;
            font-size: 0.78em;
            color: #888;
        }
        .insight-meta-item {
            display: inline-flex;
            align-items: center;
            gap: 4px;
        }
        .insight-meta-icon {
            width: 14px; height: 14px;
            display: inline-block;
            vertical-align: middle;
        }

        /* Recommendation card special styling */
        .insight-card.recommendation {
            background: linear-gradient(135deg, #e0f7fa 0%, #fff 40%);
        }
        .insight-card.opportunity {
            background: linear-gradient(135deg, #f1f8e9 0%, #fff 40%);
        }

        /* Expandable evidence */
        .insight-evidence-toggle {
            cursor: pointer;
            font-size: 0.8em;
            color: #0072CE;
            font-weight: 600;
            margin-top: 8px;
            display: inline-block;
        }
        .insight-evidence-toggle:hover { text-decoration: underline; }
        .insight-evidence-body {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.3s ease;
        }
        .insight-evidence-body.open {
            max-height: 300px;
        }

        /* Stat box color variants */
        .insight-stat-box.trend .isb-num     { color: #1976d2; }
        .insight-stat-box.milestone .isb-num  { color: #2e7d32; }
        .insight-stat-box.anomaly .isb-num    { color: #f57c00; }
        .insight-stat-box.gap .isb-num        { color: #c62828; }
        .insight-stat-box.crosslink .isb-num  { color: #7b1fa2; }
        .insight-stat-box.recommendation .isb-num { color: #00838f; }
        .insight-stat-box.opportunity .isb-num { color: #558b2f; }

        .insight-filter-chip[data-cat="recommendation"] { border-color: #00838f; }
        .insight-filter-chip[data-cat="opportunity"]    { border-color: #558b2f; }

        .insight-title {
            font-size: 1.05em;
            font-weight: 700;
            color: #222;
            margin-bottom: 6px;
        }
        .insight-narrative {
            font-size: 0.9em;
            color: #444;
            line-height: 1.65;
            margin-bottom: 10px;
        }
        .insight-evidence {
            font-size: 0.82em;
            color: #666;
            background: #f8f9fb;
            padding: 10px 14px;
            border-radius: 8px;
            border-left: 3px solid #ddd;
        }

        /* Stats summary row */
        .insight-stats-row {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(160px, 1fr));
            gap: 10px;
            margin-bottom: 14px;
        }
        .insight-stat-box {
            text-align: center;
            padding: 10px;
            background: #fff;
            border-radius: 8px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.05);
        }
        .insight-stat-box .isb-num {
            font-size: 1.8em;
            font-weight: 800;
            color: #0072CE;
        }
        .insight-stat-box .isb-label {
            font-size: 0.78em;
            color: #777;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        /* Insight category filter */
        .insight-filter-bar {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            margin-bottom: 10px;
        }
        .insight-filter-chip {
            padding: 5px 12px;
            border-radius: 16px;
            border: 2px solid #ccc;
            background: #fff;
            color: #555;
            font-weight: 600;
            font-size: 0.8em;
            cursor: pointer;
            transition: all 0.2s;
        }
        .insight-filter-chip.active { border-color: #0072CE; background: #0072CE; color: #fff; }
        .insight-filter-chip[data-cat="trend"]     { border-color: #1976d2; }
        .insight-filter-chip[data-cat="anomaly"]   { border-color: #f57c00; }
        .insight-filter-chip[data-cat="milestone"] { border-color: #2e7d32; }
        .insight-filter-chip[data-cat="gap"]       { border-color: #c62828; }
        .insight-filter-chip[data-cat="crosslink"] { border-color: #7b1fa2; }

        @media (max-width: 768px) {
            .synthesis-kpi-row { grid-template-columns: repeat(2, 1fr); }
            .insight-stats-row { grid-template-columns: repeat(2, 1fr); }
            .synthesis-kpi .sk-value { font-size: 1.5em; }
            .perf-table { font-size: 0.72em; }
            .domain-dive-card { padding: 16px; }
            .toc-pathway { flex-direction: column; }
            .toc-pathway .toc-arrow { transform: rotate(90deg); }
        }
        @media (max-width: 480px) {
            .synthesis-kpi-row { grid-template-columns: 1fr; }
            .insight-stats-row { grid-template-columns: 1fr; }
        }

        /* ── DOMAIN DEEP DIVE ── */
        #automated-insights-section .section {
            margin-bottom: 10px;
            padding: 16px;
        }
        #automated-insights-section .section-title {
            margin: -16px -16px 12px -16px;
            padding: 12px 16px;
            font-size: 1.2em;
        }
        #automated-insights-section .charts-grid {
            gap: 14px;
            margin-top: 10px;
        }
        #automated-insights-section .chart-wrapper {
            padding: 12px;
        }
        #automated-insights-section .chart-container {
            margin-bottom: 8px;
        }
        #automated-insights-section .insight-feed {
            gap: 10px;
        }
        #automated-insights-section .insight-card {
            padding: 14px 16px;
        }
        #automated-insights-section .insight-stats-row {
            margin-bottom: 12px;
        }
        #automated-insights-section .section:last-child {
            margin-bottom: 0;
        }
        .domain-dive-card {
            background: #fff;
            border-radius: 12px;
            padding: 16px 20px;
            margin-bottom: 10px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.06);
            border-left: 5px solid #0072CE;
            transition: box-shadow 0.2s;
        }
        .domain-dive-card:hover { box-shadow: 0 4px 16px rgba(0,0,0,0.12); }
        .domain-dive-header {
            display: flex; align-items: center; justify-content: space-between;
            flex-wrap: wrap; gap: 10px; margin-bottom: 14px;
        }
        .domain-dive-name {
            font-size: 1.08em; font-weight: 700; color: #222; text-transform: capitalize;
        }
        .domain-dive-score {
            font-size: 0.82em; font-weight: 700; padding: 4px 14px;
            border-radius: 20px; color: #fff;
        }
        .domain-dive-score.healthy { background: #2e7d32; }
        .domain-dive-score.moderate { background: #f57c00; }
        .domain-dive-score.weak { background: #c62828; }
        .domain-dive-indicators { display: flex; flex-direction: column; gap: 10px; }
        .dd-indicator-row {
            display: flex; align-items: center; gap: 10px; flex-wrap: wrap;
        }
        .dd-ind-label {
            flex: 0 0 200px; font-size: 0.82em; font-weight: 600; color: #444;
        }
        .dd-ind-bar-wrap {
            flex: 1; min-width: 120px; height: 22px; background: #eee; border-radius: 11px;
            position: relative; overflow: hidden;
        }
        .dd-ind-bar {
            height: 100%; border-radius: 11px;
            transition: width 0.8s ease;
            display: flex; align-items: center; justify-content: flex-end;
            padding-right: 8px; font-size: 0.7em; font-weight: 700; color: #fff;
            min-width: 20px;
        }
        .dd-ind-bar.green { background: linear-gradient(90deg, #66bb6a, #2e7d32); }
        .dd-ind-bar.orange { background: linear-gradient(90deg, #ffb74d, #f57c00); }
        .dd-ind-bar.red { background: linear-gradient(90deg, #ef9a9a, #c62828); }
        .dd-ind-change {
            flex: 0 0 80px; font-size: 0.78em; font-weight: 700; text-align: right;
        }
        .dd-ind-change.pos { color: #2e7d32; }
        .dd-ind-change.neg { color: #c62828; }
        .dd-target-marker {
            position: absolute; top: 0; height: 100%; width: 3px;
            background: #333; z-index: 2; opacity: 0.7;
        }

        /* ── PERFORMANCE TABLE ── */
        .perf-table {
            width: 100%; border-collapse: separate; border-spacing: 0;
            font-size: 0.82em; border-radius: 10px; overflow: hidden;
            box-shadow: 0 2px 8px rgba(0,0,0,0.06);
        }
        .perf-table thead th {
            background: #0072CE; color: #fff; padding: 10px 12px;
            text-align: left; font-weight: 700; font-size: 0.88em;
            position: sticky; top: 0; z-index: 2;
            white-space: nowrap;
        }
        .perf-table tbody td {
            padding: 8px 12px; border-bottom: 1px solid #eee;
            vertical-align: middle;
        }
        .perf-table tbody tr:nth-child(even) { background: #f8f9fa; }
        .perf-table tbody tr:hover { background: #e3f2fd; }
        .perf-table .status-pill {
            display: inline-block; padding: 3px 10px; border-radius: 12px;
            font-size: 0.8em; font-weight: 700; color: #fff;
        }
        .perf-table .status-pill.exceeded { background: #2e7d32; }
        .perf-table .status-pill.on-track { background: #f57c00; }
        .perf-table .status-pill.below { background: #c62828; }
        .perf-table .status-pill.no-target { background: #9e9e9e; }

        /* ── THEORY OF CHANGE PATHWAYS ── */
        .toc-pathway-title {
            font-size: 1.1em; font-weight: 800; padding: 10px 16px;
            border-radius: 8px; margin-bottom: 10px;
            display: flex; align-items: center; gap: 10px;
        }
        .toc-pathway-title::before {
            content: ''; display: inline-block; width: 5px; height: 24px;
            border-radius: 3px; flex-shrink: 0;
        }
        .toc-pathway {
            display: flex; align-items: stretch; gap: 0;
            margin-bottom: 24px; background: #fff;
            border-radius: 12px; box-shadow: 0 3px 14px rgba(0,0,0,0.10);
            overflow: hidden; border: 1px solid rgba(0,0,0,0.06);
        }
        .toc-step {
            flex: 1; padding: 22px 18px; text-align: center;
            position: relative; min-width: 0;
            transition: background 0.2s;
        }
        .toc-step:hover { filter: brightness(0.97); }
        .toc-step-label {
            font-size: 0.78em; font-weight: 800; text-transform: uppercase;
            letter-spacing: 1px; margin-bottom: 8px; opacity: 1;
            padding: 3px 10px; border-radius: 12px; display: inline-block;
        }
        .toc-step-title {
            font-size: 1em; font-weight: 800; color: #111; margin-bottom: 8px;
            word-wrap: break-word;
        }
        .toc-step-data {
            font-size: 0.88em; color: #444; line-height: 1.6;
        }
        .toc-step-data strong { color: #0072CE; font-size: 1.05em; }
        .toc-arrow {
            display: flex; align-items: center; justify-content: center;
            font-size: 1.8em; font-weight: 900;
            flex: 0 0 44px; background: #f0f4ff;
        }
        .toc-outcome-divider {
            height: 2px; background: linear-gradient(90deg, transparent, #ccc 20%, #ccc 80%, transparent);
            margin: 6px 0 2px 0;
        }
        .toc-conn-outcome-badge {
            font-size: 0.68em; font-weight: 700; color: #fff; padding: 2px 8px;
            border-radius: 8px; background: #555; white-space: nowrap;
        }
        .toc-outcome-header {
            padding: 14px 18px; border-radius: 10px; margin-bottom: 14px;
            margin-top: 26px; border-left: 5px solid;
        }
        .toc-outcome-header:first-of-type { margin-top: 0; }
        .toc-outcome-id {
            font-size: 0.72em; font-weight: 800; text-transform: uppercase;
            letter-spacing: 1.5px; display: inline-block; padding: 2px 10px;
            border-radius: 10px; color: #fff; margin-bottom: 6px;
        }
        .toc-outcome-title {
            font-size: 1.02em; font-weight: 700; color: #222; line-height: 1.45;
        }
        .toc-outcome-summary {
            font-size: 0.82em; color: #555; margin-top: 5px; line-height: 1.5;
        }
        .toc-connections-grid {
            display: grid; grid-template-columns: 1fr 1fr; gap: 14px;
        }
        .toc-connection-card {
            background: #fff; border-radius: 10px; padding: 14px 16px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.07); border: 1px solid rgba(0,0,0,0.06);
        }
        .toc-conn-header {
            display: flex; align-items: center; gap: 6px; flex-wrap: wrap;
            margin-bottom: 8px;
        }
        .toc-conn-dot {
            width: 12px; height: 12px; border-radius: 50%; display: inline-block; flex-shrink: 0;
        }
        .toc-conn-name {
            font-size: 0.85em; font-weight: 700; color: #333;
        }
        .toc-conn-arrow {
            font-size: 0.9em; color: #999; margin: 0 2px;
        }
        .toc-conn-strength {
            font-size: 0.7em; font-weight: 700; color: #fff; padding: 2px 8px;
            border-radius: 10px; margin-left: auto;
        }
        .toc-conn-detail {
            font-size: 0.82em; color: #555; line-height: 1.55;
        }
        .toc-tensions-grid {
            display: grid; grid-template-columns: 1fr 1fr; gap: 14px;
        }
        .toc-tension-card {
            background: #fff; border-radius: 10px; padding: 14px 16px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.07);
        }
        .toc-tension-title {
            font-size: 0.95em; font-weight: 800; margin-bottom: 6px;
        }
        .toc-tension-detail {
            font-size: 0.82em; color: #444; line-height: 1.55; margin-bottom: 8px;
        }
        .toc-tension-detail strong { color: #c62828; font-size: 1.02em; }
        .toc-tension-pathways {
            font-size: 0.78em; color: #777;
        }
        .toc-tension-tag {
            display: inline-block; background: #f0f0f0; color: #555;
            padding: 2px 8px; border-radius: 10px; font-weight: 600;
            margin-right: 4px; font-size: 0.95em;
        }
        @media (max-width: 900px) {
            .toc-pathway { flex-wrap: wrap; }
            .toc-step { flex: 1 1 100%; }
            .toc-arrow { flex: 0 0 100%; font-size: 1.4em; padding: 4px 0;
                         background: transparent; transform: rotate(90deg); }
            .toc-connections-grid, .toc-tensions-grid { grid-template-columns: 1fr; }
        }
        @media print {
            .toc-pathway { flex-wrap: wrap; page-break-inside: avoid; }
            .toc-step { flex: 1 1 45%; }
            .toc-arrow { flex: 0 0 30px; font-size: 1.2em; background: transparent !important; }
            .toc-outcome-header { page-break-inside: avoid; page-break-after: avoid; }
            .toc-connections-grid, .toc-tensions-grid { grid-template-columns: 1fr; }
            .toc-connection-card, .toc-tension-card { page-break-inside: avoid; box-shadow: none !important; border: 1px solid #ddd; }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- LIVE VIEWERS BADGE -->
        <div id="live-viewers-badge" onclick="document.getElementById('viewer-panel').classList.toggle('open')">
            <span class="pulse-dot"></span>
            <span id="viewer-count">0</span> viewing now
        </div>
        <div id="viewer-panel">
            <div class="vp-header">Dashboard Viewers</div>
            <div class="vp-tabs">
                <button class="active" onclick="switchViewerTab('live', this)">Live Now</button>
                <button onclick="switchViewerTab('history', this)">Visit History</button>
            </div>
            <div id="vp-live-tab">
                <div class="vp-list" id="viewer-list">
                    <div class="vp-item" style="color:#999; text-align:center;">Connecting...</div>
                </div>
            </div>
            <div id="vp-history-tab" style="display:none;">
                <div class="vp-stats" id="visit-stats">
                    <div class="vp-stat"><div class="stat-val" id="stat-total">--</div><div class="stat-lbl">Total Visits</div></div>
                    <div class="vp-stat"><div class="stat-val" id="stat-today">--</div><div class="stat-lbl">Today</div></div>
                    <div class="vp-stat"><div class="stat-val" id="stat-week">--</div><div class="stat-lbl">This Week</div></div>
                    <div class="vp-stat"><div class="stat-val" id="stat-unique">--</div><div class="stat-lbl">Unique Names</div></div>
                </div>
                <div class="vp-list" id="visit-history-list">
                    <div class="vp-item" style="color:#999; text-align:center;">Loading...</div>
                </div>
            </div>
        </div>

        <!-- MOBILE NAV OVERLAY & DRAWER -->
        <div class="mobile-nav-overlay" id="mobileNavOverlay" onclick="closeMobileNav()" aria-hidden="true"></div>
        <nav class="mobile-nav-drawer" id="mobileNavDrawer" role="navigation" aria-label="Mobile dashboard navigation">
            <div class="drawer-header">
                <h3>Select Tab</h3>
                <button class="drawer-close" onclick="closeMobileNav()">&times;</button>
            </div>
            <div class="drawer-nav-list">
                <button class="drawer-nav-item active" onclick="mobileNavSelect('project-outputs', this)">
                    Project Outputs
                </button>
                <button class="drawer-nav-item" onclick="mobileNavSelect('women-cosme', this)">
                    Women Survey (Midline)
                </button>
                <button class="drawer-nav-item" onclick="mobileNavSelect('men-cosme', this)">
                    Men Survey (Midline)
                </button>
                <button class="drawer-nav-item" onclick="mobileNavSelect('gjj-women', this)">
                    GJJ KAP Women (Endline)
                </button>
                <button class="drawer-nav-item" onclick="mobileNavSelect('gjj-men', this)">
                    GJJ KAP Men (Endline)
                </button>
                <button class="drawer-nav-item" onclick="mobileNavSelect('forestry', this)">
                    Forestry Functionality (Midline)
                </button>
                <button class="drawer-nav-item" onclick="mobileNavSelect('prepost-forest', this)">
                    Trainings Pre & Post
                </button>
                <button class="drawer-nav-item" onclick="mobileNavSelect('schools-dashboard', this)">
                    Schools Dashboard
                </button>
                <button class="drawer-nav-item" onclick="mobileNavSelect('seaweed-assessment', this)">
                    Seaweed Assessment
                </button>
                <button class="drawer-nav-item" onclick="mobileNavSelect('vsla-monitoring', this)">
                    VSLA Monitoring
                </button>
                <button class="drawer-nav-item" onclick="mobileNavSelect('cross-dataset', this)">
                    Cross-Dataset Synthesis
                </button>
                <button class="drawer-nav-item" onclick="mobileNavSelect('automated-insights', this)">
                    Impact & Evidence
                </button>
                <button class="drawer-nav-item" onclick="mobileNavSelect('report-generation', this)">
                    📄 Report Generation
                </button>
                <button class="drawer-nav-item" onclick="mobileNavSelect('analytics-dashboard', this)">
                    📊 Analytics
                </button>
            </div>
        </nav>

        <!-- SURVEY SELECTOR -->
        <nav class="survey-selector" role="navigation" aria-label="Dashboard selector">
            <!-- Mobile hamburger toggle (shown on <=768px) -->
            <button class="mobile-menu-toggle" id="mobileMenuToggle" onclick="toggleMobileNav()" aria-expanded="false" aria-controls="mobileNavDrawer" aria-label="Open navigation menu">
                <span class="current-survey-label" id="currentSurveyLabel">Project Outputs</span>
                <span class="hamburger-icon">
                    <span></span>
                    <span></span>
                    <span></span>
                </span>
            </button>
            <label>Select Tab:</label>
            <div class="survey-buttons" role="tablist" aria-label="Survey dashboards">
                <button class="survey-btn active" role="tab" aria-selected="true" onclick="switchSurvey('project-outputs')">Project Outputs</button>
                <button class="survey-btn" onclick="switchSurvey('women-cosme')">Women Survey (Midline)</button>
                <button class="survey-btn" onclick="switchSurvey('men-cosme')">Men Survey (Midline)</button>
                <button class="survey-btn" onclick="switchSurvey('gjj-women')">GJJ KAP Women (Endline)</button>
                <button class="survey-btn" onclick="switchSurvey('gjj-men')">GJJ KAP Men (Endline)</button>
                <button class="survey-btn" onclick="switchSurvey('forestry')">Forestry Functionality (Midline)</button>
                <button class="survey-btn" onclick="switchSurvey('prepost-forest')">Trainings Pre & Post</button>
                <button class="survey-btn" onclick="switchSurvey('schools-dashboard')">Schools Dashboard</button>
                <button class="survey-btn" onclick="switchSurvey('seaweed-assessment')">Seaweed Assessment</button>
                <button class="survey-btn" onclick="switchSurvey('vsla-monitoring')">VSLA Monitoring</button>
                <button class="survey-btn" onclick="switchSurvey('cross-dataset')">Cross-Dataset Synthesis</button>
                <button class="survey-btn" onclick="switchSurvey('automated-insights')">Impact & Evidence</button>
                <button class="survey-btn report-gen-btn" onclick="switchSurvey('report-generation')">📄 Report Generation</button>
                <button class="survey-btn" onclick="switchSurvey('analytics-dashboard')">📊 Analytics</button>
            </div>
        </nav>

        <!-- Spacer to offset fixed survey selector -->
        <div class="survey-selector-spacer"></div>

        <!-- HEADER -->
        <header class="header" role="banner">
            <h1 id="survey-title">Project Output Dashboard</h1>
        </header>

        <!-- PRE & POST TEST SUB-SELECTOR (Forest / Seaweed / Mangrove) -->
        <div class="tabs-container" id="prepost-type-selector" style="display: none; margin-bottom: 20px; margin-top: 15px;">
            <button class="tab-button active" onclick="showPrePostType(event, 'forest')" style="background: #0D47A1; color: #fff;">Forest Conservation</button>
            <button class="tab-button" onclick="showPrePostType(event, 'seaweed')" disabled style="opacity: 0.5; cursor: not-allowed;" title="Coming Soon">Seaweed Farming</button>
            <button class="tab-button" onclick="showPrePostType(event, 'mangrove')">Mangrove Restoration</button>
        </div>

        <!-- SCHOOLS DASHBOARD SUB-SELECTOR (Clean Water / Water in Schools / 4K Clubs) -->
        <div class="tabs-container" id="schools-dash-type-selector" style="display: none; margin-bottom: 20px; margin-top: 15px;">
            <button class="tab-button active" onclick="showSchoolsDashType(event, 'clean-water')" style="background: #283593; color: #fff;">A. Access to Clean Water</button>
            <button class="tab-button" onclick="showSchoolsDashType(event, 'water-midline')">B. Water in Schools</button>
            <button class="tab-button" onclick="showSchoolsDashType(event, 'four-k-clubs')">C. 4K Clubs</button>
            <button class="tab-button" onclick="showSchoolsDashType(event, 'overall-insights')">Overall Insights</button>
        </div>

        <!-- PROJECT OUTPUTS SUB-SELECTOR -->
        <div class="tabs-container" id="output-type-selector" style="display: flex; margin-bottom: 20px; margin-top: 15px;">
            <button class="tab-button active" onclick="showOutputType(event, 'mangrove')" style="background: #283593; color: #fff;">Mangrove</button>
            <button class="tab-button" onclick="showOutputType(event, 'forestry')">Forestry</button>
            <button class="tab-button" onclick="showOutputType(event, 'seaweed')">Seaweed</button>
            <button class="tab-button" onclick="showOutputType(event, 'gjj')">GJJ</button>
            <button class="tab-button" onclick="showOutputType(event, 'vsla')">VSLA</button>
            <button class="tab-button" onclick="showOutputType(event, 'schools')">Schools</button>
        </div>

        <!-- PROJECT OUTPUT SECTION -->
        <div id="output-section">

            <!-- MANGROVE OUTPUT -->
            <div id="output-mangrove">
                <div class="output-header">
                    <h2>Output 1112: Mangrove Restoration Training & Coaching</h2>
                    <p>Members of mangrove groups trained and coached in mangrove restoration and conservation</p>
                </div>

                <!-- Registration KPIs -->
                <div class="output-card">
                    <h3>Registration Summary</h3>
                    <div class="output-kpi-grid">
                        <div class="output-kpi green">
                            <div class="kpi-label">Groups Registered</div>
                            <div class="kpi-value">42</div>
                            <div class="kpi-sub">Target: 40 | 105% Achieved</div>
                        </div>
                        <div class="output-kpi">
                            <div class="kpi-label">Members Registered</div>
                            <div class="kpi-value">1,344</div>
                            <div class="kpi-sub">Target: 1,200 | 112%</div>
                        </div>
                        <div class="output-kpi">
                            <div class="kpi-label">Female Members</div>
                            <div class="kpi-value">973</div>
                            <div class="kpi-sub">Target: 840 | 72% of total</div>
                        </div>
                        <div class="output-kpi">
                            <div class="kpi-label">Male Members</div>
                            <div class="kpi-value">371</div>
                            <div class="kpi-sub">Target: 360 | 28% of total</div>
                        </div>
                        <div class="output-kpi">
                            <div class="kpi-label">Modules Imparted</div>
                            <div class="kpi-value">5</div>
                            <div class="kpi-sub">Target: 5 | 100% Achieved</div>
                        </div>
                    </div>
                </div>

                <!-- Training Completion - All -->
                <div class="output-card">
                    <h3>Training Completion by Module - All Participants</h3>
                    <table class="output-table">
                        <thead>
                            <tr>
                                <th style="text-align:left;">Module</th>
                                <th>Target</th>
                                <th>Registered</th>
                                <th>Completed</th>
                                <th>Target(%)</th>
                                <th>Reg(%)</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr><td style="text-align:left;">Module 1</td><td>1,200</td><td>1,344</td><td>899</td><td>75%</td><td>67%</td></tr>
                            <tr><td style="text-align:left;">Module 2</td><td>1,200</td><td>1,344</td><td>791</td><td>66%</td><td>59%</td></tr>
                            <tr><td style="text-align:left;">Module 3</td><td>1,200</td><td>1,344</td><td>798</td><td>67%</td><td>59%</td></tr>
                            <tr><td style="text-align:left;">Module 4</td><td>1,200</td><td>1,344</td><td>881</td><td>73%</td><td>66%</td></tr>
                            <tr><td style="text-align:left;">Module 5</td><td>1,200</td><td>1,344</td><td>816</td><td>68%</td><td>61%</td></tr>
                            <tr class="total-row"><td style="text-align:left;"><strong>Grand Total</strong></td><td><strong>1,200</strong></td><td><strong>1,344</strong></td><td><strong>842</strong></td><td><strong>70%</strong></td><td><strong>63%</strong></td></tr>
                        </tbody>
                    </table>
                </div>

                <!-- Training Completion - Male -->
                <div class="output-card">
                    <h3>Training Completion by Module - Male Participants</h3>
                    <table class="output-table">
                        <thead>
                            <tr>
                                <th style="text-align:left;">Module</th>
                                <th>Target</th>
                                <th>Registered</th>
                                <th>Completed</th>
                                <th>Target(%)</th>
                                <th>Reg(%)</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr><td style="text-align:left;">Module 1</td><td>360</td><td>371</td><td>216</td><td>60%</td><td>58%</td></tr>
                            <tr><td style="text-align:left;">Module 2</td><td>360</td><td>371</td><td>195</td><td>54%</td><td>53%</td></tr>
                            <tr><td style="text-align:left;">Module 3</td><td>360</td><td>371</td><td>166</td><td>46%</td><td>45%</td></tr>
                            <tr><td style="text-align:left;">Module 4</td><td>360</td><td>371</td><td>198</td><td>55%</td><td>53%</td></tr>
                            <tr><td style="text-align:left;">Module 5</td><td>360</td><td>371</td><td>177</td><td>49%</td><td>48%</td></tr>
                            <tr class="total-row"><td style="text-align:left;"><strong>Grand Total</strong></td><td><strong>360</strong></td><td><strong>371</strong></td><td><strong>194</strong></td><td><strong>54%</strong></td><td><strong>52%</strong></td></tr>
                        </tbody>
                    </table>
                </div>

                <!-- Training Completion - Female -->
                <div class="output-card">
                    <h3>Training Completion by Module - Female Participants</h3>
                    <table class="output-table">
                        <thead>
                            <tr>
                                <th style="text-align:left;">Module</th>
                                <th>Target</th>
                                <th>Registered</th>
                                <th>Completed</th>
                                <th>Target(%)</th>
                                <th>Reg(%)</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr><td style="text-align:left;">Module 1</td><td>840</td><td>973</td><td>683</td><td>81%</td><td>70%</td></tr>
                            <tr><td style="text-align:left;">Module 2</td><td>840</td><td>973</td><td>596</td><td>71%</td><td>61%</td></tr>
                            <tr><td style="text-align:left;">Module 3</td><td>840</td><td>973</td><td>632</td><td>75%</td><td>65%</td></tr>
                            <tr><td style="text-align:left;">Module 4</td><td>840</td><td>973</td><td>683</td><td>81%</td><td>70%</td></tr>
                            <tr><td style="text-align:left;">Module 5</td><td>840</td><td>973</td><td>639</td><td>76%</td><td>66%</td></tr>
                            <tr class="total-row"><td style="text-align:left;"><strong>Grand Total</strong></td><td><strong>840</strong></td><td><strong>973</strong></td><td><strong>649</strong></td><td><strong>77%</strong></td><td><strong>67%</strong></td></tr>
                        </tbody>
                    </table>
                </div>

                <!-- Charts -->
                <div class="output-charts-row">
                    <div class="output-chart-box">
                        <h4>Module Completion by Gender</h4>
                        <div style="height: 320px;"><canvas id="output-mangrove-gender"></canvas></div>
                    </div>
                    <div class="output-chart-box">
                        <h4>Completion Rate vs Target (%)</h4>
                        <div style="height: 320px;"><canvas id="output-mangrove-target"></canvas></div>
                    </div>
                </div>
                <div class="output-charts-row">
                    <div class="output-chart-box">
                        <h4>Registration vs Completion (All)</h4>
                        <div style="height: 320px;"><canvas id="output-mangrove-regcomp"></canvas></div>
                    </div>
                    <div class="output-chart-box">
                        <h4>Overall Gender Split</h4>
                        <div style="height: 320px;"><canvas id="output-mangrove-split"></canvas></div>
                    </div>
                </div>
            </div>

            <!-- FORESTRY OUTPUT -->
            <div id="output-forestry" style="display:none;">
                <div class="output-header" style="background: linear-gradient(135deg, #1b5e20 0%, #2e7d32 100%);">
                    <h2>Output 1131: Forestry Training & Conservation</h2>
                    <p>Targeted local communities, especially women, trained in gender-responsive forest management and community-centred conservation</p>
                </div>

                <!-- Registration KPIs -->
                <div class="output-card">
                    <h3>Registration Summary</h3>
                    <div class="output-kpi-grid">
                        <div class="output-kpi green">
                            <div class="kpi-label">Groups Registered</div>
                            <div class="kpi-value">52</div>
                            <div class="kpi-sub">Target: 45 | 116% Achieved</div>
                        </div>
                        <div class="output-kpi green">
                            <div class="kpi-label">Members Registered</div>
                            <div class="kpi-value">1,440</div>
                            <div class="kpi-sub">Target: 1,350 | 107%</div>
                        </div>
                        <div class="output-kpi">
                            <div class="kpi-label">Female Members</div>
                            <div class="kpi-value">1,141</div>
                            <div class="kpi-sub">Target: 945 | 79% of total</div>
                        </div>
                        <div class="output-kpi">
                            <div class="kpi-label">Male Members</div>
                            <div class="kpi-value">299</div>
                            <div class="kpi-sub">Target: 405 | 21% of total</div>
                        </div>
                        <div class="output-kpi green">
                            <div class="kpi-label">Modules Imparted</div>
                            <div class="kpi-value">7</div>
                            <div class="kpi-sub">Target: 7 | 100%</div>
                        </div>
                        <div class="output-kpi orange">
                            <div class="kpi-label">Trained (Strict, 5m+)</div>
                            <div class="kpi-value">550</div>
                            <div class="kpi-sub">Target: 1,350 | 41%</div>
                        </div>
                    </div>
                </div>

                <!-- Training Completion - All -->
                <div class="output-card">
                    <h3>Training Completion by Module (Soft Threshold) - All Participants</h3>
                    <table class="output-table">
                        <thead>
                            <tr>
                                <th style="text-align:left;">Module</th>
                                <th>Target</th>
                                <th>Registered</th>
                                <th>Completed</th>
                                <th>Target(%)</th>
                                <th>Reg(%)</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr><td style="text-align:left;">Module 1</td><td>1,350</td><td>1,440</td><td>1,059</td><td>78%</td><td>74%</td></tr>
                            <tr><td style="text-align:left;">Module 2</td><td>1,350</td><td>1,440</td><td>947</td><td>70%</td><td>66%</td></tr>
                            <tr><td style="text-align:left;">Module 3</td><td>1,350</td><td>1,440</td><td>954</td><td>71%</td><td>66%</td></tr>
                            <tr><td style="text-align:left;">Module 4</td><td>1,350</td><td>1,440</td><td>1,068</td><td>79%</td><td>74%</td></tr>
                            <tr><td style="text-align:left;">Module 5</td><td>1,350</td><td>1,440</td><td>1,150</td><td>85%</td><td>80%</td></tr>
                            <tr><td style="text-align:left;">Module 6</td><td>1,350</td><td>1,440</td><td>986</td><td>73%</td><td>68%</td></tr>
                            <tr><td style="text-align:left;">Module 7</td><td>1,350</td><td>1,440</td><td>1,047</td><td>78%</td><td>73%</td></tr>
                            <tr class="total-row"><td style="text-align:left;"><strong>Grand Total</strong></td><td><strong>1,350</strong></td><td><strong>1,440</strong></td><td><strong>1,030</strong></td><td><strong>76%</strong></td><td><strong>72%</strong></td></tr>
                        </tbody>
                    </table>
                </div>

                <!-- Training Completion - Male -->
                <div class="output-card">
                    <h3>Training Completion by Module (Soft Threshold) - Male Participants</h3>
                    <table class="output-table">
                        <thead>
                            <tr>
                                <th style="text-align:left;">Module</th>
                                <th>Target</th>
                                <th>Registered</th>
                                <th>Completed</th>
                                <th>Target(%)</th>
                                <th>Reg(%)</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr><td style="text-align:left;">Module 1</td><td>405</td><td>299</td><td>200</td><td>49%</td><td>67%</td></tr>
                            <tr><td style="text-align:left;">Module 2</td><td>405</td><td>299</td><td>164</td><td>40%</td><td>55%</td></tr>
                            <tr><td style="text-align:left;">Module 3</td><td>405</td><td>299</td><td>167</td><td>41%</td><td>56%</td></tr>
                            <tr><td style="text-align:left;">Module 4</td><td>405</td><td>299</td><td>229</td><td>57%</td><td>77%</td></tr>
                            <tr><td style="text-align:left;">Module 5</td><td>405</td><td>299</td><td>219</td><td>54%</td><td>73%</td></tr>
                            <tr><td style="text-align:left;">Module 6</td><td>405</td><td>299</td><td>188</td><td>46%</td><td>63%</td></tr>
                            <tr><td style="text-align:left;">Module 7</td><td>405</td><td>299</td><td>217</td><td>54%</td><td>73%</td></tr>
                            <tr class="total-row"><td style="text-align:left;"><strong>Grand Total</strong></td><td><strong>405</strong></td><td><strong>299</strong></td><td><strong>198</strong></td><td><strong>49%</strong></td><td><strong>66%</strong></td></tr>
                        </tbody>
                    </table>
                </div>

                <!-- Training Completion - Female -->
                <div class="output-card">
                    <h3>Training Completion by Module (Soft Threshold) - Female Participants</h3>
                    <table class="output-table">
                        <thead>
                            <tr>
                                <th style="text-align:left;">Module</th>
                                <th>Target</th>
                                <th>Registered</th>
                                <th>Completed</th>
                                <th>Target(%)</th>
                                <th>Reg(%)</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr><td style="text-align:left;">Module 1</td><td>945</td><td>1,141</td><td>859</td><td>91%</td><td>75%</td></tr>
                            <tr><td style="text-align:left;">Module 2</td><td>945</td><td>1,141</td><td>783</td><td>83%</td><td>69%</td></tr>
                            <tr><td style="text-align:left;">Module 3</td><td>945</td><td>1,141</td><td>787</td><td>83%</td><td>69%</td></tr>
                            <tr><td style="text-align:left;">Module 4</td><td>945</td><td>1,141</td><td>839</td><td>89%</td><td>74%</td></tr>
                            <tr><td style="text-align:left;">Module 5</td><td>945</td><td>1,141</td><td>931</td><td>99%</td><td>82%</td></tr>
                            <tr><td style="text-align:left;">Module 6</td><td>945</td><td>1,141</td><td>798</td><td>84%</td><td>70%</td></tr>
                            <tr><td style="text-align:left;">Module 7</td><td>945</td><td>1,141</td><td>830</td><td>88%</td><td>73%</td></tr>
                            <tr class="total-row"><td style="text-align:left;"><strong>Grand Total</strong></td><td><strong>945</strong></td><td><strong>1,141</strong></td><td><strong>832</strong></td><td><strong>88%</strong></td><td><strong>73%</strong></td></tr>
                        </tbody>
                    </table>
                </div>

                <!-- Strict Threshold Summary -->
                <div class="output-card">
                    <h3>Training Completion - Strict Threshold (5 Modules and Above)</h3>
                    <table class="output-table">
                        <thead>
                            <tr>
                                <th style="text-align:left;">Category</th>
                                <th>Trained</th>
                                <th>Target</th>
                                <th>Achievement</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr><td style="text-align:left;">Female</td><td>461</td><td>945</td><td>49%</td></tr>
                            <tr><td style="text-align:left;">Male</td><td>89</td><td>405</td><td>22%</td></tr>
                            <tr class="total-row"><td style="text-align:left;"><strong>All</strong></td><td><strong>550</strong></td><td><strong>1,350</strong></td><td><strong>41%</strong></td></tr>
                        </tbody>
                    </table>
                    <table class="output-table" style="margin-top:15px;">
                        <thead>
                            <tr>
                                <th style="text-align:left;">Location</th>
                                <th>Trained</th>
                                <th>Target</th>
                                <th>Achievement</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr><td style="text-align:left;">Kilifi</td><td>366</td><td>594</td><td>62%</td></tr>
                            <tr><td style="text-align:left;">Kwale</td><td>184</td><td>756</td><td>24%</td></tr>
                            <tr class="total-row"><td style="text-align:left;"><strong>All</strong></td><td><strong>550</strong></td><td><strong>1,350</strong></td><td><strong>41%</strong></td></tr>
                        </tbody>
                    </table>
                </div>

                <!-- Charts -->
                <div class="output-charts-row">
                    <div class="output-chart-box">
                        <h4>Module Completion by Gender (Soft Threshold)</h4>
                        <div style="height: 320px;"><canvas id="output-forestry-gender"></canvas></div>
                    </div>
                    <div class="output-chart-box">
                        <h4>Completion Rate vs Target (%)</h4>
                        <div style="height: 320px;"><canvas id="output-forestry-target"></canvas></div>
                    </div>
                </div>
                <div class="output-charts-row">
                    <div class="output-chart-box">
                        <h4>Registration vs Completion (All)</h4>
                        <div style="height: 320px;"><canvas id="output-forestry-regcomp"></canvas></div>
                    </div>
                    <div class="output-chart-box">
                        <h4>Overall Gender Split</h4>
                        <div style="height: 320px;"><canvas id="output-forestry-split"></canvas></div>
                    </div>
                </div>
            </div>

            <!-- SEAWEED OUTPUT -->
            <div id="output-seaweed" style="display:none;">
                <div class="output-header" style="background: linear-gradient(135deg, #00695c 0%, #00897b 100%);">
                    <h2>Output 1122: Seaweed Production, Value Addition & Commercialization</h2>
                    <p>Women-led seaweed groups trained in seaweed production, value addition and commercialization</p>
                </div>

                <!-- Registration KPIs -->
                <div class="output-card">
                    <h3>Registration Summary</h3>
                    <div class="output-kpi-grid">
                        <div class="output-kpi green">
                            <div class="kpi-label">Groups Registered</div>
                            <div class="kpi-value">19</div>
                            <div class="kpi-sub">Target: 20 | 95% Achieved</div>
                        </div>
                        <div class="output-kpi">
                            <div class="kpi-label">Members Registered</div>
                            <div class="kpi-value">842</div>
                            <div class="kpi-sub">Target: 600 | 140%</div>
                        </div>
                        <div class="output-kpi">
                            <div class="kpi-label">Female Members</div>
                            <div class="kpi-value">651</div>
                            <div class="kpi-sub">Target: 600 | 77% of total</div>
                        </div>
                        <div class="output-kpi">
                            <div class="kpi-label">Male Members</div>
                            <div class="kpi-value">191</div>
                            <div class="kpi-sub">Target: 0 | 23% of total</div>
                        </div>
                        <div class="output-kpi">
                            <div class="kpi-label">Modules Imparted</div>
                            <div class="kpi-value">5</div>
                            <div class="kpi-sub">Target: 5 | 100%</div>
                        </div>
                    </div>
                </div>

                <!-- Training Completion - All -->
                <div class="output-card">
                    <h3>Training Completion by Module - All Participants</h3>
                    <table class="output-table">
                        <thead>
                            <tr>
                                <th style="text-align:left;">Module</th>
                                <th>Target</th>
                                <th>Registered</th>
                                <th>Completed</th>
                                <th>Target(%)</th>
                                <th>Reg(%)</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr><td style="text-align:left;">Module 1</td><td>600</td><td>842</td><td>314</td><td>52%</td><td>37%</td></tr>
                            <tr><td style="text-align:left;">Module 2</td><td>600</td><td>842</td><td>375</td><td>63%</td><td>45%</td></tr>
                            <tr><td style="text-align:left;">Module 3</td><td>600</td><td>842</td><td>603</td><td>101%</td><td>72%</td></tr>
                            <tr><td style="text-align:left;">Module 4</td><td>600</td><td>842</td><td>508</td><td>85%</td><td>60%</td></tr>
                            <tr><td style="text-align:left;">Module 5</td><td>600</td><td>842</td><td>512</td><td>85%</td><td>61%</td></tr>
                            <tr class="total-row"><td style="text-align:left;"><strong>Grand Total</strong></td><td><strong>600</strong></td><td><strong>842</strong></td><td><strong>462</strong></td><td><strong>77%</strong></td><td><strong>55%</strong></td></tr>
                        </tbody>
                    </table>
                </div>

                <!-- Training Completion - Male -->
                <div class="output-card">
                    <h3>Training Completion by Module - Male Participants</h3>
                    <table class="output-table">
                        <thead>
                            <tr>
                                <th style="text-align:left;">Module</th>
                                <th>Target</th>
                                <th>Registered</th>
                                <th>Completed</th>
                                <th>Target(%)</th>
                                <th>Reg(%)</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr><td style="text-align:left;">Module 1</td><td>0</td><td>371</td><td>0</td><td>N/A</td><td>0%</td></tr>
                            <tr><td style="text-align:left;">Module 2</td><td>0</td><td>371</td><td>0</td><td>N/A</td><td>0%</td></tr>
                            <tr><td style="text-align:left;">Module 3</td><td>0</td><td>371</td><td>0</td><td>N/A</td><td>0%</td></tr>
                            <tr><td style="text-align:left;">Module 4</td><td>0</td><td>371</td><td>0</td><td>N/A</td><td>0%</td></tr>
                            <tr><td style="text-align:left;">Module 5</td><td>0</td><td>371</td><td>0</td><td>N/A</td><td>0%</td></tr>
                            <tr class="total-row"><td style="text-align:left;"><strong>Grand Total</strong></td><td><strong>0</strong></td><td><strong>371</strong></td><td><strong>0</strong></td><td><strong>N/A</strong></td><td><strong>0%</strong></td></tr>
                        </tbody>
                    </table>
                </div>

                <!-- Training Completion - Female -->
                <div class="output-card">
                    <h3>Training Completion by Module - Female Participants</h3>
                    <table class="output-table">
                        <thead>
                            <tr>
                                <th style="text-align:left;">Module</th>
                                <th>Target</th>
                                <th>Registered</th>
                                <th>Completed</th>
                                <th>Target(%)</th>
                                <th>Reg(%)</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr><td style="text-align:left;">Module 1</td><td>600</td><td>651</td><td>314</td><td>52%</td><td>48%</td></tr>
                            <tr><td style="text-align:left;">Module 2</td><td>600</td><td>651</td><td>375</td><td>63%</td><td>58%</td></tr>
                            <tr><td style="text-align:left;">Module 3</td><td>600</td><td>651</td><td>603</td><td>101%</td><td>93%</td></tr>
                            <tr><td style="text-align:left;">Module 4</td><td>600</td><td>651</td><td>508</td><td>85%</td><td>78%</td></tr>
                            <tr><td style="text-align:left;">Module 5</td><td>600</td><td>651</td><td>512</td><td>85%</td><td>79%</td></tr>
                            <tr class="total-row"><td style="text-align:left;"><strong>Grand Total</strong></td><td><strong>600</strong></td><td><strong>651</strong></td><td><strong>462</strong></td><td><strong>77%</strong></td><td><strong>71%</strong></td></tr>
                        </tbody>
                    </table>
                </div>

                <!-- Charts -->
                <div class="output-charts-row">
                    <div class="output-chart-box">
                        <h4>Module Completion by Gender</h4>
                        <div style="height: 320px;"><canvas id="output-seaweed-gender"></canvas></div>
                    </div>
                    <div class="output-chart-box">
                        <h4>Completion Rate vs Target (%)</h4>
                        <div style="height: 320px;"><canvas id="output-seaweed-target"></canvas></div>
                    </div>
                </div>
                <div class="output-charts-row">
                    <div class="output-chart-box">
                        <h4>Target vs Completion (All)</h4>
                        <div style="height: 320px;"><canvas id="output-seaweed-regcomp"></canvas></div>
                    </div>
                    <div class="output-chart-box">
                        <h4>Overall Gender Split</h4>
                        <div style="height: 320px;"><canvas id="output-seaweed-split"></canvas></div>
                    </div>
                </div>
            </div>

            <!-- GJJ OUTPUT -->
            <div id="output-gjj" style="display:none;">
                <div class="output-header" style="background: linear-gradient(135deg, #6a1b9a 0%, #8e24aa 100%);">
                    <h2>Output 1211: Gender Justice Journey (GJJ) Training</h2>
                    <p>Targeted women trained on gender responsive NbS, economic rights, life skills, & GE&I, including UPCW</p>
                </div>

                <!-- Registration KPIs -->
                <div class="output-card">
                    <h3>Registration Summary</h3>
                    <div class="output-kpi-grid">
                        <div class="output-kpi green">
                            <div class="kpi-label">Groups Registered</div>
                            <div class="kpi-value">113</div>
                            <div class="kpi-sub">Target: 110 | 103% Achieved</div>
                        </div>
                        <div class="output-kpi">
                            <div class="kpi-label">Members Registered</div>
                            <div class="kpi-value">3,626</div>
                            <div class="kpi-sub">Target: 3,000 | 121%</div>
                        </div>
                        <div class="output-kpi">
                            <div class="kpi-label">Female Members</div>
                            <div class="kpi-value">2,765</div>
                            <div class="kpi-sub">Target: 3,000 | 76% of total</div>
                        </div>
                        <div class="output-kpi">
                            <div class="kpi-label">Male Members</div>
                            <div class="kpi-value">861</div>
                            <div class="kpi-sub">Target: 0 | 24% of total</div>
                        </div>
                        <div class="output-kpi">
                            <div class="kpi-label">Modules Imparted</div>
                            <div class="kpi-value">5</div>
                            <div class="kpi-sub">Target: 6 | 83%</div>
                        </div>
                    </div>
                </div>

                <!-- Training Completion - All -->
                <div class="output-card">
                    <h3>Training Completion by Module - All Participants</h3>
                    <table class="output-table">
                        <thead>
                            <tr>
                                <th style="text-align:left;">Module</th>
                                <th>Target</th>
                                <th>Registered</th>
                                <th>Completed</th>
                                <th>Target(%)</th>
                                <th>Reg(%)</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr><td style="text-align:left;">Module 1</td><td>3,000</td><td>3,626</td><td>2,072</td><td>69%</td><td>57%</td></tr>
                            <tr><td style="text-align:left;">Module 2</td><td>3,000</td><td>3,626</td><td>1,843</td><td>61%</td><td>51%</td></tr>
                            <tr><td style="text-align:left;">Module 3</td><td>3,000</td><td>3,626</td><td>2,246</td><td>75%</td><td>62%</td></tr>
                            <tr><td style="text-align:left;">Module 4</td><td>3,000</td><td>3,626</td><td>2,328</td><td>78%</td><td>64%</td></tr>
                            <tr><td style="text-align:left;">Module 5</td><td>3,000</td><td>3,626</td><td>2,083</td><td>69%</td><td>57%</td></tr>
                            <tr class="total-row"><td style="text-align:left;"><strong>Grand Total</strong></td><td><strong>3,000</strong></td><td><strong>3,626</strong></td><td><strong>2,114</strong></td><td><strong>70%</strong></td><td><strong>58%</strong></td></tr>
                        </tbody>
                    </table>
                </div>

                <!-- Training Completion - Male -->
                <div class="output-card">
                    <h3>Training Completion by Module - Male Participants</h3>
                    <table class="output-table">
                        <thead>
                            <tr>
                                <th style="text-align:left;">Module</th>
                                <th>Target</th>
                                <th>Registered</th>
                                <th>Completed</th>
                                <th>Target(%)</th>
                                <th>Reg(%)</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr><td style="text-align:left;">Module 1</td><td>0</td><td>861</td><td>0</td><td>N/A</td><td>0%</td></tr>
                            <tr><td style="text-align:left;">Module 2</td><td>0</td><td>861</td><td>0</td><td>N/A</td><td>0%</td></tr>
                            <tr><td style="text-align:left;">Module 3</td><td>0</td><td>861</td><td>0</td><td>N/A</td><td>0%</td></tr>
                            <tr><td style="text-align:left;">Module 4</td><td>0</td><td>861</td><td>0</td><td>N/A</td><td>0%</td></tr>
                            <tr><td style="text-align:left;">Module 5</td><td>0</td><td>861</td><td>0</td><td>N/A</td><td>0%</td></tr>
                            <tr class="total-row"><td style="text-align:left;"><strong>Grand Total</strong></td><td><strong>0</strong></td><td><strong>861</strong></td><td><strong>0</strong></td><td><strong>N/A</strong></td><td><strong>0%</strong></td></tr>
                        </tbody>
                    </table>
                </div>

                <!-- Training Completion - Female -->
                <div class="output-card">
                    <h3>Training Completion by Module - Female Participants</h3>
                    <table class="output-table">
                        <thead>
                            <tr>
                                <th style="text-align:left;">Module</th>
                                <th>Target</th>
                                <th>Registered</th>
                                <th>Completed</th>
                                <th>Target(%)</th>
                                <th>Reg(%)</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr><td style="text-align:left;">Module 1</td><td>3,000</td><td>2,765</td><td>2,072</td><td>69%</td><td>75%</td></tr>
                            <tr><td style="text-align:left;">Module 2</td><td>3,000</td><td>2,765</td><td>1,843</td><td>61%</td><td>67%</td></tr>
                            <tr><td style="text-align:left;">Module 3</td><td>3,000</td><td>2,765</td><td>2,246</td><td>75%</td><td>81%</td></tr>
                            <tr><td style="text-align:left;">Module 4</td><td>3,000</td><td>2,765</td><td>2,328</td><td>78%</td><td>84%</td></tr>
                            <tr><td style="text-align:left;">Module 5</td><td>3,000</td><td>2,765</td><td>2,083</td><td>69%</td><td>75%</td></tr>
                            <tr class="total-row"><td style="text-align:left;"><strong>Grand Total</strong></td><td><strong>3,000</strong></td><td><strong>2,765</strong></td><td><strong>2,114</strong></td><td><strong>70%</strong></td><td><strong>76%</strong></td></tr>
                        </tbody>
                    </table>
                </div>

                <!-- Charts -->
                <div class="output-charts-row">
                    <div class="output-chart-box">
                        <h4>Module Completion by Gender</h4>
                        <div style="height: 320px;"><canvas id="output-gjj-gender"></canvas></div>
                    </div>
                    <div class="output-chart-box">
                        <h4>Completion Rate vs Target (%)</h4>
                        <div style="height: 320px;"><canvas id="output-gjj-target"></canvas></div>
                    </div>
                </div>
                <div class="output-charts-row">
                    <div class="output-chart-box">
                        <h4>Target vs Completion (All)</h4>
                        <div style="height: 320px;"><canvas id="output-gjj-regcomp"></canvas></div>
                    </div>
                    <div class="output-chart-box">
                        <h4>Overall Gender Split</h4>
                        <div style="height: 320px;"><canvas id="output-gjj-split"></canvas></div>
                    </div>
                </div>
            </div>

            <!-- VSLA OUTPUT -->
            <div id="output-vsla" style="display:none;">
                <div class="output-header" style="background: linear-gradient(135deg, #e65100 0%, #f57c00 100%);">
                    <h2>Output 1221: VSLA - Women's Savings Groups</h2>
                    <p>Women's savings groups established or strengthened</p>
                </div>

                <!-- Registration KPIs -->
                <div class="output-card">
                    <h3>Registration Summary</h3>
                    <div class="output-kpi-grid">
                        <div class="output-kpi green">
                            <div class="kpi-label">Groups Registered</div>
                            <div class="kpi-value">140</div>
                            <div class="kpi-sub">Target: 130 | 108% Achieved</div>
                        </div>
                        <div class="output-kpi">
                            <div class="kpi-label">Members Registered</div>
                            <div class="kpi-value">3,626</div>
                            <div class="kpi-sub">Target: 3,000 | 121%</div>
                        </div>
                        <div class="output-kpi">
                            <div class="kpi-label">Female Members</div>
                            <div class="kpi-value">2,765</div>
                            <div class="kpi-sub">Target: 3,000 | 76% of total</div>
                        </div>
                        <div class="output-kpi">
                            <div class="kpi-label">Male Members</div>
                            <div class="kpi-value">861</div>
                            <div class="kpi-sub">Target: 0 | 24% of total</div>
                        </div>
                        <div class="output-kpi">
                            <div class="kpi-label">Modules Imparted</div>
                            <div class="kpi-value">14</div>
                            <div class="kpi-sub">Target: 27 | 74% (cumulative 20/27)</div>
                        </div>
                    </div>
                </div>

                <!-- Training Completion - All -->
                <div class="output-card">
                    <h3>Training Completion by Module - All Participants</h3>
                    <table class="output-table">
                        <thead>
                            <tr>
                                <th style="text-align:left;">Module</th>
                                <th>Target</th>
                                <th>Registered</th>
                                <th>Completed</th>
                                <th>Target(%)</th>
                                <th>Reg(%)</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr><td style="text-align:left;">Module 1&amp;2</td><td>3,000</td><td>3,626</td><td>1,949</td><td>65%</td><td>54%</td></tr>
                            <tr><td style="text-align:left;">Module 3&amp;4</td><td>3,000</td><td>3,626</td><td>1,704</td><td>57%</td><td>47%</td></tr>
                            <tr><td style="text-align:left;">Module 5</td><td>3,000</td><td>3,626</td><td>1,803</td><td>60%</td><td>50%</td></tr>
                            <tr><td style="text-align:left;">Module 6</td><td>3,000</td><td>3,626</td><td>1,958</td><td>65%</td><td>54%</td></tr>
                            <tr><td style="text-align:left;">Module 7</td><td>3,000</td><td>3,626</td><td>2,140</td><td>71%</td><td>59%</td></tr>
                            <tr><td style="text-align:left;">Module 8</td><td>3,000</td><td>3,626</td><td>2,052</td><td>68%</td><td>57%</td></tr>
                            <tr><td style="text-align:left;">Module 9</td><td>3,000</td><td>3,626</td><td>1,947</td><td>65%</td><td>54%</td></tr>
                            <tr><td style="text-align:left;">Module 10</td><td>3,000</td><td>3,626</td><td>1,883</td><td>63%</td><td>52%</td></tr>
                            <tr><td style="text-align:left;">Module 11</td><td>3,000</td><td>3,626</td><td>1,934</td><td>64%</td><td>53%</td></tr>
                            <tr><td style="text-align:left;">Module 12</td><td>3,000</td><td>3,626</td><td>2,020</td><td>67%</td><td>56%</td></tr>
                            <tr><td style="text-align:left;">Module 13</td><td>3,000</td><td>3,626</td><td>1,704</td><td>57%</td><td>47%</td></tr>
                            <tr><td style="text-align:left;">Module 14</td><td>3,000</td><td>3,626</td><td>1,829</td><td>61%</td><td>50%</td></tr>
                            <tr><td style="text-align:left;">Module 15</td><td>3,000</td><td>3,626</td><td>1,953</td><td>65%</td><td>54%</td></tr>
                            <tr><td style="text-align:left;">Module 16</td><td>3,000</td><td>3,626</td><td>1,886</td><td>63%</td><td>52%</td></tr>
                            <tr><td style="text-align:left;">Module 17</td><td>3,000</td><td>3,626</td><td>1,975</td><td>66%</td><td>54%</td></tr>
                            <tr><td style="text-align:left;">Module 18</td><td>3,000</td><td>3,626</td><td>1,251</td><td>42%</td><td>35%</td></tr>
                            <tr><td style="text-align:left;">Module 19</td><td>3,000</td><td>3,626</td><td>621</td><td>21%</td><td>17%</td></tr>
                            <tr><td style="text-align:left;">Module 20</td><td>3,000</td><td>3,626</td><td>613</td><td>20%</td><td>17%</td></tr>
                            <tr class="total-row"><td style="text-align:left;"><strong>Grand Total</strong></td><td><strong>3,000</strong></td><td><strong>3,626</strong></td><td><strong>1,911</strong></td><td><strong>64%</strong></td><td><strong>53%</strong></td></tr>
                        </tbody>
                    </table>
                </div>

                <!-- Training Completion - Male -->
                <div class="output-card">
                    <h3>Training Completion by Module - Male Participants</h3>
                    <table class="output-table">
                        <thead>
                            <tr>
                                <th style="text-align:left;">Module</th>
                                <th>Target</th>
                                <th>Registered</th>
                                <th>Completed</th>
                                <th>Target(%)</th>
                                <th>Reg(%)</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr><td style="text-align:left;">Module 1&amp;2</td><td>0</td><td>861</td><td>0</td><td>N/A</td><td>0%</td></tr>
                            <tr><td style="text-align:left;">Module 3&amp;4</td><td>0</td><td>861</td><td>0</td><td>N/A</td><td>0%</td></tr>
                            <tr><td style="text-align:left;">Module 5</td><td>0</td><td>861</td><td>0</td><td>N/A</td><td>0%</td></tr>
                            <tr><td style="text-align:left;">Module 6</td><td>0</td><td>861</td><td>0</td><td>N/A</td><td>0%</td></tr>
                            <tr><td style="text-align:left;">Module 7</td><td>0</td><td>861</td><td>0</td><td>N/A</td><td>0%</td></tr>
                            <tr><td style="text-align:left;">Module 8</td><td>0</td><td>861</td><td>0</td><td>N/A</td><td>0%</td></tr>
                            <tr><td style="text-align:left;">Module 9</td><td>0</td><td>861</td><td>0</td><td>N/A</td><td>0%</td></tr>
                            <tr><td style="text-align:left;">Module 10</td><td>0</td><td>861</td><td>0</td><td>N/A</td><td>0%</td></tr>
                            <tr><td style="text-align:left;">Module 11</td><td>0</td><td>861</td><td>0</td><td>N/A</td><td>0%</td></tr>
                            <tr><td style="text-align:left;">Module 12</td><td>0</td><td>861</td><td>0</td><td>N/A</td><td>0%</td></tr>
                            <tr><td style="text-align:left;">Module 13</td><td>0</td><td>861</td><td>0</td><td>N/A</td><td>0%</td></tr>
                            <tr><td style="text-align:left;">Module 14</td><td>0</td><td>861</td><td>0</td><td>N/A</td><td>0%</td></tr>
                            <tr><td style="text-align:left;">Module 15</td><td>0</td><td>861</td><td>0</td><td>N/A</td><td>0%</td></tr>
                            <tr><td style="text-align:left;">Module 16</td><td>0</td><td>861</td><td>0</td><td>N/A</td><td>0%</td></tr>
                            <tr><td style="text-align:left;">Module 17</td><td>0</td><td>861</td><td>0</td><td>N/A</td><td>0%</td></tr>
                            <tr><td style="text-align:left;">Module 18</td><td>0</td><td>861</td><td>0</td><td>N/A</td><td>0%</td></tr>
                            <tr><td style="text-align:left;">Module 19</td><td>0</td><td>861</td><td>0</td><td>N/A</td><td>0%</td></tr>
                            <tr><td style="text-align:left;">Module 20</td><td>0</td><td>861</td><td>0</td><td>N/A</td><td>0%</td></tr>
                            <tr class="total-row"><td style="text-align:left;"><strong>Grand Total</strong></td><td><strong>0</strong></td><td><strong>861</strong></td><td><strong>0</strong></td><td><strong>N/A</strong></td><td><strong>0%</strong></td></tr>
                        </tbody>
                    </table>
                </div>

                <!-- Training Completion - Female -->
                <div class="output-card">
                    <h3>Training Completion by Module - Female Participants</h3>
                    <table class="output-table">
                        <thead>
                            <tr>
                                <th style="text-align:left;">Module</th>
                                <th>Target</th>
                                <th>Registered</th>
                                <th>Completed</th>
                                <th>Target(%)</th>
                                <th>Reg(%)</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr><td style="text-align:left;">Module 1&amp;2</td><td>3,000</td><td>2,765</td><td>1,949</td><td>65%</td><td>70%</td></tr>
                            <tr><td style="text-align:left;">Module 3&amp;4</td><td>3,000</td><td>2,765</td><td>1,704</td><td>57%</td><td>62%</td></tr>
                            <tr><td style="text-align:left;">Module 5</td><td>3,000</td><td>2,765</td><td>1,803</td><td>60%</td><td>65%</td></tr>
                            <tr><td style="text-align:left;">Module 6</td><td>3,000</td><td>2,765</td><td>1,958</td><td>65%</td><td>71%</td></tr>
                            <tr><td style="text-align:left;">Module 7</td><td>3,000</td><td>2,765</td><td>2,140</td><td>71%</td><td>77%</td></tr>
                            <tr><td style="text-align:left;">Module 8</td><td>3,000</td><td>2,765</td><td>2,052</td><td>68%</td><td>74%</td></tr>
                            <tr><td style="text-align:left;">Module 9</td><td>3,000</td><td>2,765</td><td>1,947</td><td>65%</td><td>70%</td></tr>
                            <tr><td style="text-align:left;">Module 10</td><td>3,000</td><td>2,765</td><td>1,883</td><td>63%</td><td>68%</td></tr>
                            <tr><td style="text-align:left;">Module 11</td><td>3,000</td><td>2,765</td><td>1,934</td><td>64%</td><td>70%</td></tr>
                            <tr><td style="text-align:left;">Module 12</td><td>3,000</td><td>2,765</td><td>2,020</td><td>67%</td><td>73%</td></tr>
                            <tr><td style="text-align:left;">Module 13</td><td>3,000</td><td>2,765</td><td>1,704</td><td>57%</td><td>62%</td></tr>
                            <tr><td style="text-align:left;">Module 14</td><td>3,000</td><td>2,765</td><td>1,829</td><td>61%</td><td>66%</td></tr>
                            <tr><td style="text-align:left;">Module 15</td><td>3,000</td><td>2,765</td><td>1,953</td><td>65%</td><td>71%</td></tr>
                            <tr><td style="text-align:left;">Module 16</td><td>3,000</td><td>2,765</td><td>1,886</td><td>63%</td><td>68%</td></tr>
                            <tr><td style="text-align:left;">Module 17</td><td>3,000</td><td>2,765</td><td>1,975</td><td>66%</td><td>71%</td></tr>
                            <tr><td style="text-align:left;">Module 18</td><td>3,000</td><td>2,765</td><td>1,251</td><td>42%</td><td>45%</td></tr>
                            <tr><td style="text-align:left;">Module 19</td><td>3,000</td><td>2,765</td><td>621</td><td>21%</td><td>22%</td></tr>
                            <tr><td style="text-align:left;">Module 20</td><td>3,000</td><td>2,765</td><td>613</td><td>20%</td><td>22%</td></tr>
                            <tr class="total-row"><td style="text-align:left;"><strong>Grand Total</strong></td><td><strong>3,000</strong></td><td><strong>2,765</strong></td><td><strong>1,834</strong></td><td><strong>62%</strong></td><td><strong>67%</strong></td></tr>
                        </tbody>
                    </table>
                </div>

                <!-- Charts -->
                <div class="output-charts-row">
                    <div class="output-chart-box">
                        <h4>Module Completion - Female Participants</h4>
                        <div style="height: 380px;"><canvas id="output-vsla-gender"></canvas></div>
                    </div>
                    <div class="output-chart-box">
                        <h4>Completion Rate vs Target (%)</h4>
                        <div style="height: 380px;"><canvas id="output-vsla-target"></canvas></div>
                    </div>
                </div>
                <div class="output-charts-row">
                    <div class="output-chart-box">
                        <h4>Target vs Completion (All)</h4>
                        <div style="height: 380px;"><canvas id="output-vsla-regcomp"></canvas></div>
                    </div>
                    <div class="output-chart-box">
                        <h4>Overall Gender Split</h4>
                        <div style="height: 320px;"><canvas id="output-vsla-split"></canvas></div>
                    </div>
                </div>
            </div>

            <!-- SCHOOLS OUTPUT -->
            <div id="output-schools" style="display:none;">
                <div class="output-header" style="background: linear-gradient(135deg, #0277bd 0%, #0288d1 100%);">
                    <h2>Schools: 4K Clubs in Targeted Schools</h2>
                    <p>School enrollment and 4K Club membership across Kwale and Kilifi counties</p>
                </div>

                <!-- Summary KPIs -->
                <div class="output-card">
                    <h3>School Enrollment Summary</h3>
                    <div class="output-kpi-grid">
                        <div class="output-kpi green">
                            <div class="kpi-label">Total Schools</div>
                            <div class="kpi-value">65</div>
                            <div class="kpi-sub">Kwale: 35 | Kilifi: 30</div>
                        </div>
                        <div class="output-kpi">
                            <div class="kpi-label">Total Students</div>
                            <div class="kpi-value">44,301</div>
                            <div class="kpi-sub">Boys: 22,699 | Girls: 21,602</div>
                        </div>
                        <div class="output-kpi">
                            <div class="kpi-label">4K Club Members</div>
                            <div class="kpi-value">5,065</div>
                            <div class="kpi-sub">Female: 2,917 | Male: 2,148</div>
                        </div>
                        <div class="output-kpi">
                            <div class="kpi-label">Avg 4K Female/School</div>
                            <div class="kpi-value">44.9</div>
                            <div class="kpi-sub">Min: 15 | Max: 123</div>
                        </div>
                        <div class="output-kpi">
                            <div class="kpi-label">Avg 4K Male/School</div>
                            <div class="kpi-value">33.0</div>
                            <div class="kpi-sub">Min: 6 | Max: 103</div>
                        </div>
                    </div>
                </div>

                <!-- Enrollment by County -->
                <div class="output-card">
                    <h3>School Enrollment by County</h3>
                    <table class="output-table">
                        <thead>
                            <tr>
                                <th style="text-align:left;">County</th>
                                <th>Schools</th>
                                <th>Boys</th>
                                <th>Girls</th>
                                <th>Total</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr><td style="text-align:left;">Kwale</td><td>35</td><td>9,960</td><td>9,433</td><td>19,393</td></tr>
                            <tr><td style="text-align:left;">Kilifi</td><td>30</td><td>12,739</td><td>12,169</td><td>24,908</td></tr>
                            <tr class="total-row"><td style="text-align:left;"><strong>Total</strong></td><td><strong>65</strong></td><td><strong>22,699</strong></td><td><strong>21,602</strong></td><td><strong>44,301</strong></td></tr>
                        </tbody>
                    </table>
                </div>

                <!-- 4K Club Membership -->
                <div class="output-card">
                    <h3>4K Club Membership Statistics</h3>
                    <table class="output-table">
                        <thead>
                            <tr>
                                <th style="text-align:left;">Statistic</th>
                                <th>Female</th>
                                <th>Male</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr><td style="text-align:left;">Average per School</td><td>44.9</td><td>33.0</td></tr>
                            <tr><td style="text-align:left;">Maximum</td><td>123</td><td>103</td></tr>
                            <tr><td style="text-align:left;">Minimum</td><td>15</td><td>6</td></tr>
                            <tr class="total-row"><td style="text-align:left;"><strong>Total Members</strong></td><td><strong>2,917</strong></td><td><strong>2,148</strong></td></tr>
                        </tbody>
                    </table>
                </div>

                <!-- Charts -->
                <div class="output-charts-row">
                    <div class="output-chart-box">
                        <h4>Student Enrollment by County & Gender</h4>
                        <div style="height: 320px;"><canvas id="output-schools-county"></canvas></div>
                    </div>
                    <div class="output-chart-box">
                        <h4>4K Club Gender Split</h4>
                        <div style="height: 320px;"><canvas id="output-schools-4ksplit"></canvas></div>
                    </div>
                </div>
                <div class="output-charts-row">
                    <div class="output-chart-box">
                        <h4>County Comparison - Total Students</h4>
                        <div style="height: 320px;"><canvas id="output-schools-comparison"></canvas></div>
                    </div>
                    <div class="output-chart-box">
                        <h4>Overall Gender Split (All Students)</h4>
                        <div style="height: 320px;"><canvas id="output-schools-gendersplit"></canvas></div>
                    </div>
                </div>
            </div>

        </div>

        <!-- EXECUTIVE SUMMARY -->
        <div class="executive-summary" style="display: none;">
            <button id="highlights-header" class="collapsible-header" onclick="toggleCollapsible(this)">Women Survey (Midline) Key Highlights</button>
            <div class="collapsible-content">
                <div class="key-findings">
                <div class="finding-card">
                    <div class="finding-title">Savings Transformation</div>
                    <div class="finding-metric">+48.8%</div>
                    <div class="finding-description">average improvement across savings rates, VSLA participation, and loan access. Personal saving (43.1%→93.4%), VSLA participation (43.6%→98%), women taking loans (28%→79.1%).</div>
                </div>
                <div class="finding-card">
                    <div class="finding-title">Disaster Preparedness</div>
                    <div class="finding-metric">+35%</div>
                    <div class="finding-description">average improvement across preparedness knowledge, action knowledge, and early warning access. From 4.7%→37.8%, 11.8%→46.3%, 8.9%→45.0%.</div>
                </div>
                <div class="finding-card">
                    <div class="finding-title">Climate Awareness</div>
                    <div class="finding-metric">+45%</div>
                    <div class="finding-description">average improvement across climate awareness and NbS understanding. Climate change awareness: 60.5%→96.3%, NbS solutions understanding: 23.1%→77.8%.</div>
                </div>
                <div class="finding-card">
                    <div class="finding-title">Women Empowerment</div>
                    <div class="finding-metric">+24%</div>
                    <div class="finding-description">average improvement across 5 key household decisions: market access (+34.6pp), mangrove work (+39.3pp), routine purchases (+25pp), business/loans (+19.2pp), child education (+1.6pp).</div>
                </div>
                <div class="finding-card">
                    <div class="finding-title">NbS Participation</div>
                    <div class="finding-metric">+45%</div>
                    <div class="finding-description">average improvement across conservation activities. Mangrove restoration: 36.9%→86.5%, Seaweed farming: 19.8%→74.7%, Forest management: 67.4%→98.4%.</div>
                </div>
                <div class="finding-card">
                    <div class="finding-title">Life Skills Growth</div>
                    <div class="finding-metric">+26%</div>
                    <div class="finding-description">average improvement across self-esteem (5.9%-19.6%), aspirations (9%-18%), leadership (31%-37.4%), and communication skills (15%-35%).</div>
                </div>
            </div>
            </div>
        </div>

        <!-- KPI DASHBOARD -->
        <div class="section" id="kpi-wrapper-section" style="display: none;">
            <button id="performance-header" class="collapsible-header" onclick="toggleCollapsible(this)">Women Survey (Midline) Critical Performance Pointers</button>
            <div class="collapsible-content">
                <div class="kpi-section">
                <div class="kpi-card positive">
                    <div class="kpi-label">Women Taking Loans</div>
                    <div class="kpi-value">79.1%</div>
                    <div class="kpi-change positive">↑ 51.1pp from 28.0% baseline</div>
                </div>
                <div class="kpi-card positive">
                    <div class="kpi-label">VSLA Participation</div>
                    <div class="kpi-value">98.0%</div>
                    <div class="kpi-change positive">↑ 54.4pp from 43.6% baseline</div>
                </div>
                <div class="kpi-card positive">
                    <div class="kpi-label">Climate Knowledge</div>
                    <div class="kpi-value">96.3%</div>
                    <div class="kpi-change positive">↑ 35.8pp from 60.5% baseline</div>
                </div>
                <div class="kpi-card positive">
                    <div class="kpi-label">Preparedness Training</div>
                    <div class="kpi-value">80.6%</div>
                    <div class="kpi-change positive">↑ 34.5pp from 11.8% baseline</div>
                </div>
                <div class="kpi-card positive">
                    <div class="kpi-label">Joint Decisions</div>
                    <div class="kpi-value">58.8%</div>
                    <div class="kpi-change positive">↑ 13.8pp from 45.0% baseline</div>
                </div>
                <div class="kpi-card warning">
                    <div class="kpi-label">Household Electricity</div>
                    <div class="kpi-value">19.4%</div>
                    <div class="kpi-change negative">↓ 8.3pp from 27.7% baseline</div>
                </div>
                </div>
            </div>
        </div>

        <!-- PROJECT TARGETS VS RESULTS -->
        <div class="section" id="logframe-section" style="display: none;">
            <button class="collapsible-header" onclick="toggleCollapsible(this)">Program Targets vs Results Alignment</button>
            <div class="collapsible-content">
                <div class="highlight-box" id="logframe-highlight">
                    <h4>COSME Logframe Indicator Performance</h4>
                    <p>Midline achievement against official M&E targets. Exceptional performance across 8 indicators: 7 out of 8 indicators EXCEEDED targets. Strongest gains in decision-making involvement (1200a: 57.6%→95.9%), NbS knowledge (1210a: 20.7%→80.9%), savings groups (1220a: 28.8%→91.9%), and clean energy access (1220b: 50.8%→83.1%). Unpaid work time reduced below target (1200b: 9.3→7.7 hours). Gender equality perception improved significantly (1210c: 42.1→64.7/100). One indicator (1210b: skills & confidence at 46.3%) is on track but has not yet reached the 55% target.</p>
                </div>
                
                <table class="comparison-table">
                <thead>
                    <tr>
                        <th style="width: 25%;">Indicator</th>
                        <th style="width: 15%;">Baseline</th>
                        <th style="width: 15%;">Target</th>
                        <th style="width: 15%;">Midline</th>
                        <th style="width: 15%;">Achievement</th>
                        <th style="width: 15%;">Status</th>
                    </tr>
                </thead>
                <tbody>
                    <tr style="background: #005a9e; font-weight: 600;">
                        <td colspan="6"><strong style="color: white;">INTERMEDIATE OUTCOME - Behavior & Practice Change (1200-series)</strong></td>
                    </tr>
                    <tr>
                        <td><strong>1200a. Percentage of targeted women with adequate involvement in HH, group and enterprise decision making</strong></td>
                        <td>57.6%</td>
                        <td>65.0%</td>
                        <td>95.9%</td>
                        <td>+38.3pp</td>
                        <td><span style="background: #c8e6c9; color: #1b5e20; padding: 4px 8px; border-radius: 4px; font-weight: 600;">EXCEEDED</span></td>
                    </tr>
                    <tr>
                        <td><strong>1200b. Average time women spend in unpaid work</strong></td>
                        <td>9.3 hours</td>
                        <td>8.3 hours</td>
                        <td>7.7 hours</td>
                        <td>-1.6 hrs</td>
                        <td><span style="background: #c8e6c9; color: #1b5e20; padding: 4px 8px; border-radius: 4px; font-weight: 600;">EXCEEDED</span></td>
                    </tr>
                    <tr>
                        <td><strong>1200c. Percentage of targeted women with adequate access and control over household and enterprise resources</strong></td>
                        <td>41.2%</td>
                        <td>50.0%</td>
                        <td>53.8%</td>
                        <td>+12.6pp</td>
                        <td><span style="background: #c8e6c9; color: #1b5e20; padding: 4px 8px; border-radius: 4px; font-weight: 600;">EXCEEDED</span></td>
                    </tr>
                    <tr style="background: #2e7d32; font-weight: 600;">
                        <td colspan="6"><strong style="color: white;">IMMEDIATE OUTCOME - Knowledge, Skills & Assets (1210/1220-series)</strong></td>
                    </tr>
                    <tr>
                        <td><strong>1210a. Women with adequate knowledge on NbS, Economic Rights & GE&I</strong></td>
                        <td>20.70%</td>
                        <td>55.00%</td>
                        <td>80.9%</td>
                        <td>+60.2pp</td>
                        <td><span style="background: #c8e6c9; color: #1b5e20; padding: 4px 8px; border-radius: 4px; font-weight: 600;">EXCEEDED</span></td>
                    </tr>
                    <tr>
                        <td><strong>1210b. Women with adequate skills & confidence to assert rights & express decisions</strong></td>
                        <td>32.70%</td>
                        <td>55.00%</td>
                        <td>46.3%</td>
                        <td>+13.6pp</td>
                        <td><span style="background: #a5d6a7; color: #1b5e20; padding: 4px 8px; border-radius: 4px; font-weight: 600;">ON TRACK</span></td>
                    </tr>
                    <tr>
                        <td><strong>1210c. Degree/extent women perceived as equal to men by targeted women</strong></td>
                        <td>42.1/100</td>
                        <td>55.0/100</td>
                        <td>64.7/100</td>
                        <td>+22.6 pts</td>
                        <td><span style="background: #c8e6c9; color: #1b5e20; padding: 4px 8px; border-radius: 4px; font-weight: 600;">EXCEEDED</span></td>
                    </tr>
                    <tr>
                        <td><strong>1220a. Women actively saving in a Savings Group</strong></td>
                        <td>28.80%</td>
                        <td>70.00%</td>
                        <td>91.9%</td>
                        <td>+63.1pp</td>
                        <td><span style="background: #c8e6c9; color: #1b5e20; padding: 4px 8px; border-radius: 4px; font-weight: 600;">EXCEEDED</span></td>
                    </tr>
                    <tr>
                        <td><strong>1220b. Women with access to time-saving & environment-friendly solar & cooking stoves</strong></td>
                        <td>50.80%</td>
                        <td>80.00%</td>
                        <td>83.1%</td>
                        <td>+32.3pp</td>
                        <td><span style="background: #c8e6c9; color: #1b5e20; padding: 4px 8px; border-radius: 4px; font-weight: 600;">EXCEEDED</span></td>
                    </tr>
                </tbody>
            </table>


            </div>
        </div>

        <script>
            function toggleCollapsible(button) {
                button.classList.toggle('collapsed');
                const content = button.nextElementSibling;
                content.classList.toggle('collapsed');
            }
        </script>
        
        <!-- WOMEN SURVEY TABS SECTION -->
        <div id="women-survey-section" style="display: none;">
        <div class="tabs-container">
            <button class="tab-button active" onclick="showTab(event, 'tab-household')">A. Household Characteristics</button>
            <button class="tab-button" onclick="showTab(event, 'tab-shocks')">B. Shocks & Resilience</button>
            <button class="tab-button" onclick="showTab(event, 'tab-preparedness')">C. Preparedness</button>
            <button class="tab-button" onclick="showTab(event, 'tab-resources')">D. Resources & Assets</button>
            <button class="tab-button" onclick="showTab(event, 'tab-savings')">E. Savings & Loans</button>
            <button class="tab-button" onclick="showTab(event, 'tab-time')">F. Roles & Time Poverty</button>
            <button class="tab-button" onclick="showTab(event, 'tab-decisions')">G. Decision Making</button>
            <button class="tab-button" onclick="showTab(event, 'tab-nbs')">H. Climate & NbS</button>
            <button class="tab-button" onclick="showTab(event, 'tab-lifeskills')">I. Life Skills</button>
            <button class="tab-button" onclick="showTab(event, 'tab-norms')">J. Social Norms</button>
        </div>

        <!-- TAB A: HOUSEHOLD CHARACTERISTICS -->
        <div id="tab-household" class="tab-content active">
            <div class="section">
                <div class="section-title">A. HOUSEHOLD CHARACTERISTICS</div>
                
                <div class="highlight-box">
                    <h4>Key Demographic Shifts</h4>
                    <p>Female-headed households increased from 51.0% to 57.7%, reflecting widowhood (11.2% → 20.6%). This indicates higher vulnerability requiring targeted support. Education levels remain relatively stable with 45.9% having primary education, suggesting need for adult literacy programs.</p>
                </div>

                <div class="charts-grid">
                    <div class="chart-wrapper">
                        <div class="chart-title">Women by Location/Intervention Type</div>
                        <div class="chart-container">
                            <canvas id="chart-location"></canvas>
                        </div>
                        <div class="chart-insight">Marine sites (57.2%) show better environmental alignment with coastal conservation activities. Terrestrial sites declining may indicate migration patterns.</div>
                    </div>

                    <div class="chart-wrapper">
                        <div class="chart-title">Household Headship Shifts</div>
                        <div class="chart-container">
                            <canvas id="chart-headship"></canvas>
                        </div>
                        <div class="chart-insight">Female-headed households increased significantly, indicating vulnerability increases. Targeted gender-responsive programming critical.</div>
                    </div>

                    <div class="chart-wrapper full-width">
                        <div class="chart-title">Primary Economic Activities - Transformation</div>
                        <div class="chart-container">
                            <canvas id="chart-activities"></canvas>
                        </div>
                        <div class="chart-insight"><span class="insight-highlight">Major shift:</span> Small business increased from 17.6% to 30.3%, while casual labour decreased 25.5% → 11.6%. <span class="insight-highlight">Success indicator:</span> Economic diversification moving women toward more stable income sources.</div>
                    </div>

                    <div class="chart-wrapper">
                        <div class="chart-title">Housing Quality Indicator</div>
                        <div class="chart-container">
                            <canvas id="chart-housing"></canvas>
                        </div>
                        <div class="chart-insight">Natural floor materials increased 66.6% → 79.4%, indicating persistent vulnerability. Infrastructure investment needed alongside livelihood support.</div>
                    </div>

                    <div class="chart-wrapper">
                        <div class="chart-title">Water & Sanitation Access</div>
                        <div class="chart-container">
                            <canvas id="chart-wash"></canvas>
                        </div>
                        <div class="chart-insight">Water access declined 84.3% → 79.7%, attributed to drought impacts. Toilet facilities improved slightly to 72.5%, still leaving 27.5% without adequate facilities.</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- TAB B: SHOCKS & RESILIENCE -->
        <div id="tab-shocks" class="tab-content">
            <div class="section">
                <div class="section-title">B. SHOCKS, STRESSES & COPING STRATEGIES</div>
                
                <div class="highlight-box warning">
                    <h4>Critical Finding: High Shock Exposure</h4>
                    <p>63.4% of households still experiencing drought (down from 69.1%), 22.8% experiencing heat/cold waves (up from 8.6%), and 10% experiencing floods. Heat stress emerging as new threat requiring adaptation strategies.</p>
                </div>

                <div class="charts-grid">
                    <div class="chart-wrapper">
                        <div class="chart-title">Primary Shock Types Experienced</div>
                        <div class="chart-container">
                            <canvas id="chart-shocks"></canvas>
                        </div>
                        <div class="chart-insight">Drought remains dominant shock. Heat/cold waves and flooding increasing, indicating climate variability intensifying. Preparedness investments paying off - women better equipped to respond.</div>
                    </div>

                    <div class="chart-wrapper">
                        <div class="chart-title">Shock Impact on Household Wellbeing</div>
                        <div class="chart-container">
                            <canvas id="chart-impact"></canvas>
                        </div>
                        <div class="chart-insight"><span class="insight-highlight">Positive trend:</span> Women reporting "very large extent" impact decreased 32.7% → 20%, indicating improved resilience and coping mechanisms.</div>
                    </div>

                    <div class="chart-wrapper full-width">
                        <div class="chart-title">Coping Strategies - From Crisis to Resilience</div>
                        <div class="chart-container">
                            <canvas id="chart-coping"></canvas>
                        </div>
                        <div class="chart-insight">
                            <strong>Positive shifts:</strong> Took loans increased 4.7% → 25.8% (financial services access), Used savings increased 11.2% → 15.8% (program success).
                            <br><strong>Concern:</strong> Skipped meals still at 43.8% - continued food security vulnerability despite interventions.
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- TAB C: PREPAREDNESS -->
        <div id="tab-preparedness" class="tab-content">
            <div class="section">
                <div class="section-title">C. DISASTER PREPAREDNESS & EARLY WARNING SYSTEMS</div>
                
                <div class="highlight-box">
                    <h4>PROGRAM CORNERSTONE: Remarkable Preparedness Achievement</h4>
                    <p>Knowledge of preparedness plans skyrocketed from 4.7% to 37.8%. Women knowing what to do in emergencies increased 11.8% → 46.3%. Access to early warning information went from 8.9% to 45.0% - representing core program delivery on DRR.</p>
                </div>

                <div class="charts-grid">
                    <div class="chart-wrapper">
                        <div class="chart-title">Knowledge of Community Preparedness Plans</div>
                        <div class="chart-container">
                            <canvas id="chart-prep-knowledge"></canvas>
                        </div>
                        <div class="chart-insight">From 50.1% not knowing to only 20% is a transformational shift. Program communication strategies highly effective. Continued engagement critical for retention.</div>
                    </div>

                    <div class="chart-wrapper">
                        <div class="chart-title">Women Participating in Plan Development</div>
                        <div class="chart-container">
                            <canvas id="chart-prep-participation"></canvas>
                        </div>
                        <div class="chart-insight">26.9% now directly participate in preparedness planning - up from only 1.7%. Inclusive planning ensuring local context integration.</div>
                    </div>

                    <div class="chart-wrapper">
                        <div class="chart-title">Access to Weather & Early Warning Information</div>
                        <div class="chart-container">
                            <canvas id="chart-warnings"></canvas>
                        </div>
                        <div class="chart-insight"><span class="insight-highlight">Transformational:</span> Direct weather forecast access jumped 15.7% → 46.2%. Early warning access 8.9% → 45.0%. Information accessibility critical for response decisions.</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- TAB D: RESOURCES & ASSETS -->
        <div id="tab-resources" class="tab-content">
            <div class="section">
                <div class="section-title">D. ACCESS & CONTROL OVER PRODUCTIVE RESOURCES</div>
                
                <div class="highlight-box">
                    <h4>Asset Control Dynamics - Sole Women Ownership</h4>
                    <p>Strong improvements in women's sole ownership of key productive assets. Cellphones surged 47.0% → 62.5%, the strongest asset control gain. Cooking stoves increased 3.5% → 39.7%, indicating high receptivity to clean energy. Solar panels improved 9.2% → 31.6%, reflecting renewable energy expansion. Furniture (household durables) increased modestly 17.3% → 23.1%. These gains demonstrate increasing women's agency over productive resources, though furniture shows women maintaining control of fewer household items - reflecting economic prioritization.</p>
                </div>

                <div class="charts-grid">
                    <div class="chart-wrapper full-width">
                        <div class="chart-title">Key Asset Ownership Changes - Women's Control</div>
                        <div class="chart-container">
                            <canvas id="chart-assets"></canvas>
                        </div>
                        <div class="chart-insight"><span class="insight-highlight">Strong sole ownership gains:</span> Cellphones 47.0% → 62.5% (+15.5pp), Cooking stoves 3.5% → 39.7% (+36.2pp), Solar panels 9.2% → 31.6% (+22.4pp). <span class="insight-highlight">Sustainable assets:</span> Women now control majority of cooking stoves - clean energy success achieved. Cellphones dominant asset. Furniture modest gain 17.3% → 23.1%.</div>
                    </div>

                    <div class="chart-wrapper">
                        <div class="chart-title">Agricultural Land Status</div>
                        <div class="chart-container">
                            <canvas id="chart-land"></canvas>
                        </div>
                        <div class="chart-insight">Owned land decreased from 92.7% to 73.4%, while leased increased 6.0% → 19.6%. Tenure security declining - undermines investment incentives. Policy engagement needed.</div>
                    </div>

                    <div class="chart-wrapper">
                        <div class="chart-title">Agricultural Land Under Cultivation</div>
                        <div class="chart-container">
                            <canvas id="chart-cultivation"></canvas>
                        </div>
                        <div class="chart-insight">Agricultural land utilization at midline: 80.4% of available land under productive use. Combined with land access challenges, suggests shifting from agriculture to other income sources aligns with economic activity changes noted in livelihood diversification.</div>
                    </div>

                    <div class="chart-wrapper">
                        <div class="chart-title">Availability of Key Agricultural Inputs</div>
                        <div class="chart-container">
                            <canvas id="chart-inputs"></canvas>
                        </div>
                        <div class="chart-insight">Excellent improvements across all inputs: Fertilizers (84.7% → 98.4%), Seeds (93.5% → 99.4%), Pesticides (93.1% → 98.7%), Veterinary drugs (73.6% → 87.5%), Animal feed (88.3% → 95.1%). Input supply chain effectively functioning - agricultural production constrained by demand shifts and land access, not input availability.</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- TAB E: SAVINGS & LOANS -->
        <div id="tab-savings" class="tab-content">
            <div class="section">
                <div class="section-title">E. SAVINGS, LOANS & FINANCIAL INCLUSION</div>
                
                <div class="highlight-box">
                    <h4>FLAGSHIP SUCCESS: Savings Revolution Through VSLA</h4>
                    <p>Personal savings nearly doubled: 43.1% → 93.4%. VSLA participation expanded dramatically from 43.6% to 98.0% - representing nearly universal financial group membership. Weekly savings became dominant pattern: 52.6% → 91.9%. Women's access to credit surged: 28.0% → 79.1% taking loans personally. Average loan size decreased (indicating better repayment distribution), suggesting loan products better aligned with livelihood needs.</p>
                </div>

                <div class="charts-grid">
                    <div class="chart-wrapper">
                        <div class="chart-title">Women Personally Saving Behavior</div>
                        <div class="chart-container">
                            <canvas id="chart-personal-savings"></canvas>
                        </div>
                        <div class="chart-insight">116% increase in savers. Habit formation successful. Weekly saving pattern (91.9%) indicates sustainable practice adoption.</div>
                    </div>

                    <div class="chart-wrapper">
                        <div class="chart-title">Savings Mechanism - VSLA Dominance</div>
                        <div class="chart-container">
                            <canvas id="chart-mechanism"></canvas>
                        </div>
                        <div class="chart-insight"><span class="insight-highlight">Transformational:</span> VSLA jumped from 43.6% to 98.0%. Bank/formal institutions declining, indicating group mechanism superior for this population.</div>
                    </div>

                    <div class="chart-wrapper">
                        <div class="chart-title">Women Taking Personal Loans</div>
                        <div class="chart-container">
                            <canvas id="chart-loans"></canvas>
                        </div>
                        <div class="chart-insight">182% increase in women accessing credit. Credit dependency through VSLA (93.3%) supports sustainability - group dynamics ensure accountability and mutual support.</div>
                    </div>

                    <div class="chart-wrapper">
                        <div class="chart-title">Intended Use of Savings - Shifting to Productive Assets</div>
                        <div class="chart-container">
                            <canvas id="chart-savings-use"></canvas>
                        </div>
                        <div class="chart-insight"><span class="insight-highlight">Strategic shift:</span> Food purchases declining (46.2% → 28.4%), Large assets increasing (10.2% → 63.9%), Agricultural investment (10.9% → 30.4%). Savings transitioning from consumption to productive investment - indicating business mindset development.</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- TAB F: ROLES & TIME POVERTY -->
        <div id="tab-time" class="tab-content">
            <div class="section">
                <div class="section-title">F. ROLES, RESPONSIBILITIES & TIME POVERTY</div>
                
                <div class="highlight-box">
                    <h4>TRANSFORMATIONAL PROGRESS: Time Poverty & Task Distribution Shift</h4>
                    <p><strong>Time workload improved:</strong> Unpaid care work reduced from 9.3 to 7.7 hours daily (17% reduction). <strong>Behavioral breakthrough:</strong> Baseline showed 87% of women doing cooking, 85% cleaning, 77% water fetching, 83% firewood collection alone. Midline shows dramatic shifts to 29%, 33%, 22%, 37% respectively - representing 50-60 percentage point reductions. <strong>Norms transformation underpins behavior change:</strong> Belief that cooking should be joint responsibility surged from 12.5% to 71.3%, providing social foundation for actual task redistribution. Women's aspirations and reality finally converging - demonstrating that norm messaging translates to concrete household practice changes when combined with livelihood security.</p>
                </div>

                <div class="charts-grid">
                    <div class="chart-wrapper full-width">
                        <div class="chart-title">Time Investment in Daily Activities (Hours) - Reduction Through Program</div>
                        <div class="chart-container">
                            <canvas id="chart-time"></canvas>
                        </div>
                        <div class="chart-insight">Unpaid care work reduced 1.6 hours (17% decrease). Productive work increased 0.7 hours, positive reallocation. Still challenging - women averaging 12.6 hours of work daily.</div>
                    </div>

                    <div class="chart-wrapper">
                        <div class="chart-title">Beliefs: Should be Joint Responsibility (% agreeing)</div>
                        <div class="chart-container">
                            <canvas id="chart-beliefs"></canvas>
                        </div>
                        <div class="chart-insight">Norms shifting significantly - 71% believe cooking should be joint, <span class="insight-highlight">up from 12.5%</span>. However, women still performing task at baseline 87% of time - implementation gap between attitude and behavior narrowing through program implementation.</div>
                    </div>

                    <div class="chart-wrapper">
                        <div class="chart-title">Actual Experience: Women Performing These Tasks</div>
                        <div class="chart-container">
                            <canvas id="chart-experience"></canvas>
                        </div>
                        <div class="chart-insight"><span class="insight-highlight">Significant progress:</span> Household task distribution improved dramatically from baseline. Baseline showed 83% performing firewood, 85% cleaning, 87% cooking. Midline reduced to 37%, 33%, 29% respectively - indicating successful norm shift toward joint responsibility. Continued engagement needed to sustain gains.</div>
                    </div>

                    <div class="chart-wrapper">
                        <div class="chart-title">Productive Work Participation - Women's Activity</div>
                        <div class="chart-container">
                            <canvas id="chart-productive"></canvas>
                        </div>
                        <div class="chart-insight">Market selling increased 23.7% → 47.8%, seaweed farming 1.3% → 12.8%. Women successfully engaging in income activities despite time pressures through strategic livelihood diversification.</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- TAB G: DECISION MAKING -->
        <div id="tab-decisions" class="tab-content">
            <div class="section">
                <div class="section-title">G. HOUSEHOLD & COMMUNITY DECISION MAKING</div>
                
                <div class="highlight-box">
                    <h4>Women's Voice Growing in Household Decisions</h4>
                    <p>Joint decision-making on all major issues increased 15-34% across 11 decision types. Women's influence on savings decisions, business investments, and loan decisions improved most (16-17% increases). However, spousal income provider role beliefs increased 67% → 75.4% - <strong>suggesting adherence to traditional gender norms strengthening despite economic changes</strong>. Mangrove/seaweed work influence jumped 17% → 51.9% - reflecting program's success in positioning these as female-led activities.</p>
                </div>

                <div class="charts-grid">
                    <div class="chart-wrapper full-width">
                        <div class="chart-title">Joint Decision Making Increases Across Key Household Decisions</div>
                        <div class="chart-container">
                            <canvas id="chart-decisions"></canvas>
                        </div>
                        <div class="chart-insight"><span class="insight-highlight">Strongest gains:</span> Mangrove/seaweed work (9.8% → 49.1%), Routine purchases (25.6% → 50.6%), Market access (13.5% → 48.1%). Improving across board, indicating household gender relations shifting.</div>
                    </div>

                    <div class="chart-wrapper">
                        <div class="chart-title">Women's Influence on Decisions - Large Extent</div>
                        <div class="chart-container">
                            <canvas id="chart-influence"></canvas>
                        </div>
                        <div class="chart-insight">Mangrove/seaweed work influence tripled 17% → 51.9% (program focus areas). Savings and investment decisions improved 16% + increases. Women perceiving greater voice in community conservation decisions.</div>
                    </div>

                    <div class="chart-wrapper">
                        <div class="chart-title">Comparison - Should vs Actually Making Decisions</div>
                        <div class="chart-container">
                            <canvas id="chart-decision-gap"></canvas>
                        </div>
                        <div class="chart-insight">Gap exists between beliefs and practice across all decisions. Women want more joint decisions than they're experiencing. Husband engagement and norm operationalization require continued focus.</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- TAB H: CLIMATE & NBS -->
        <div id="tab-nbs" class="tab-content">
            <div class="section">
                <div class="section-title">H. CLIMATE CHANGE KNOWLEDGE & NATURE-BASED SOLUTIONS</div>
                
                <div class="highlight-box">
                    <h4>TRANSFORMATIONAL LEARNING: Climate & NbS Concept Adoption</h4>
                    <p>Climate change awareness exploded 60.5% → 96.3%. Understanding NbS solutions increased 23.1% → 77.8%. Women providing NbS examples increased 22.9% → 77.2%. Mangrove restoration knowledge 20.9% → 60.7%, and active participation 36.9% → 86.5%. Seaweed farming participation 19.8% → 74.7%. Forest management involvement 67.4% → 98.4%. Program successfully transformed indigenous conservation knowledge into modern framing of climate action.</p>
                </div>

                <div class="charts-grid">
                    <div class="chart-wrapper">
                        <div class="chart-title">Climate Change Awareness & Understanding</div>
                        <div class="chart-container">
                            <canvas id="chart-cc-awareness"></canvas>
                        </div>
                        <div class="chart-insight">59% increase in awareness. Definition understanding improved (Completely Acceptable: 41% → 55.2%), with very few unable to answer now.</div>
                    </div>

                    <div class="chart-wrapper">
                        <div class="chart-title">Climate Change Effects Experienced - Perception</div>
                        <div class="chart-container">
                            <canvas id="chart-cc-effects"></canvas>
                        </div>
                        <div class="chart-insight">Increased drought recognition (54.7% → 75.9%), hotter temperatures (39.5% → 67.5%), increased water insecurity perception (32.7% → 62.8%). Women connecting climate phenomena to livelihood impacts.</div>
                    </div>

                    <div class="chart-wrapper">
                        <div class="chart-title">Nature-Based Solutions Knowledge & Participation</div>
                        <div class="chart-container">
                            <canvas id="chart-nbs"></canvas>
                        </div>
                        <div class="chart-insight">Mangrove restoration: active participation 36.9% → 86.5%. Interested in continuing: 58.8% → 86.6%. Seaweed farming participation 19.8% → 74.7%. Forest management 67.4% → 98.4%. Program successfully mobilized women into conservation workforce.</div>
                    </div>

                    <div class="chart-wrapper">
                        <div class="chart-title">Perceived Benefits of NbS Solutions</div>
                        <div class="chart-container">
                            <canvas id="chart-nbs-benefits"></canvas>
                        </div>
                        <div class="chart-insight"><span class="insight-highlight">Massive shifts:</span> Carbon capture 2.8% → 33.1%, Air quality 11.5% → 47.2%, Water conservation 9.3% → 35.9%. Women understanding multiple benefits beyond biodiversity - ecosystem services awareness excellent learning outcome.</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- TAB I: LIFE SKILLS -->
        <div id="tab-lifeskills" class="tab-content">
            <div class="section">
                <div class="section-title">I. LIFE SKILLS & PSYCHOSOCIAL EMPOWERMENT</div>
                
                <div class="highlight-box">
                    <h4>Confidence & Agency Transformation</h4>
                    <p>Self-esteem across all dimensions improved 8.7%-19.6%. Women respecting themselves increased 78.2% → 97.8%. Leadership capacity jumped 59.1% → 94.1%. Women bringing people together for initiatives 60.9% → 92.5%. Communication comfort with community members increased 52.5% → 87.2%. Life skills programming successfully shifted mindsets from victimhood to agency and leadership.</p>
                </div>

                <div class="charts-grid">
                    <div class="chart-wrapper">
                        <div class="chart-title">Self-Esteem & Confidence - Percentage Agreeing/Strongly Agreeing</div>
                        <div class="chart-container">
                            <canvas id="chart-selfesteem"></canvas>
                        </div>
                        <div class="chart-insight">Across all self-esteem measures 5.9%-19.6% improvements. Foundation for other outcomes - women believing in themselves more likely to pursue opportunities.</div>
                    </div>

                    <div class="chart-wrapper">
                        <div class="chart-title">Aspirations & Goal-Oriented Thinking</div>
                        <div class="chart-container">
                            <canvas id="chart-aspirations"></canvas>
                        </div>
                        <div class="chart-insight">Women thinking about future 88.2% → 97.5%, having specific goals 81.2% → 99.1%, knowing how to achieve goals 72.1% → 96.9%. Planning capacity dramatically strong.</div>
                    </div>

                    <div class="chart-wrapper">
                        <div class="chart-title">Leadership Capacity - Community Influence</div>
                        <div class="chart-container">
                            <canvas id="chart-leadership"></canvas>
                        </div>
                        <div class="chart-insight">Leadership ability 59.1% → 94.1% (+35%), bringing people together 60.9% → 92.5% (+31.6%), others seeking advice 54.8% → 92.2% (+37.4%). Women becoming community mobilizers and change agents.</div>
                    </div>

                    <div class="chart-wrapper">
                        <div class="chart-title">Communication Skills - Comfort & Effectiveness</div>
                        <div class="chart-container">
                            <canvas id="chart-communication"></canvas>
                        </div>
                        <div class="chart-insight">All communication measures improved 15-35%. Women more comfortable expressing views with family (75.8% → 95.6%) and community (52.5% → 87.2%). Others understanding them better (59.6% → 90.0%).</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- TAB J: SOCIAL NORMS -->
        <div id="tab-norms" class="tab-content">
            <div class="section">
                <div class="section-title">J. SOCIAL NORMS & GENDER ATTITUDES</div>
                
                <div class="highlight-box warning">
                    <h4>Complex Norm Dynamics: Progress with Persistence</h4>
                    <p><strong>Concerning trend:</strong> Traditional norms strengthening in some areas. "Man's job to earn, woman's to care for home" increased 40.2% → 75.4%. "Only men drive boats" jumped 23.5% → 88.1% despite women engaging in seaweed farming and fishing activities. <strong>Suggests women adopting activities without full norm transformation.</strong> However, positive shifts: harassment blame on women declined, and domestic work is increasingly seen as embarrassing for men to avoid (57.9% → 85%). <strong>Paradox:</strong> Women accessing opportunities despite reinforcing male-centered norms may represent pragmatic adaptation rather than true norm change.</p>
                </div>

                <div class="charts-grid">
                    <div class="chart-wrapper full-width">
                        <div class="chart-title">Social Norms Dynamics - Gender Role Beliefs</div>
                        <div class="chart-container">
                            <canvas id="chart-norms"></canvas>
                        </div>
                        <div class="chart-insight"><span class="insight-highlight">Concerning:</span> "Men should provide" increased 40.2% → 75.4%. "Only men drive boats" rose 23.5% → 88.1% despite women's participation. <span class="insight-highlight">Positive:</span> Harassment blame on women and domestic work stigma improved. Norm messaging needs strengthening.</div>
                    </div>

                    <div class="chart-wrapper">
                        <div class="chart-title">Gender Role Attitudes - Strong Agreement</div>
                        <div class="chart-container">
                            <canvas id="chart-norms-strong"></canvas>
                        </div>
                        <div class="chart-insight">Strong agreement with traditional norms (6.8% → 27.8% for "woman should care for home") indicates internalization. Life skills message not fully translating to norm change - behavioral empowerment ahead of attitude shift.</div>
                    </div>

                    <div class="chart-wrapper">
                        <div class="chart-title">Environment & Conservation Norms - Important Progress</div>
                        <div class="chart-container">
                            <canvas id="chart-norms-conservation"></canvas>
                        </div>
                        <div class="chart-insight">"Mangrove restoration is women's work" and "Seaweed farming is women's work" showing strong agreement. Program successfully framed conservation as female-led - now embedded in community understanding. Positioning as women's livelihood role critical for sustainability.</div>
                    </div>

                    <div class="chart-wrapper">
                        <div class="chart-title">Household Management & Money Control Beliefs</div>
                        <div class="chart-container">
                            <canvas id="chart-norms-money"></canvas>
                        </div>
                        <div class="chart-insight">"Husband should handle woman's income" increased 66.1% → 76.3%, "Men have better business ideas" rose 64.4% → 74.1%. Paradoxical: as women earn more, norms around male financial control intensify. Marriage dynamics may explain - women satisficing greater participation through yielding control to maintain household harmony.</div>
                    </div>
                </div>
            </div>
        </div>
        </div>
        <!-- END WOMEN SURVEY SECTION -->

        <!-- MEN SURVEY SECTION - TOGGLED DISPLAY -->
        <div id="men-survey-section" style="display: none; margin-top: 60px; padding-top: 40px; border-top: 3px solid #0072CE;">
            <div class="header" style="margin-bottom: 30px;">
                <h1>Men Survey - COSME Project</h1>
                <div class="header-subtitle">Parallel Analysis: Male Household Members & Community Leaders</div>
                <div class="header-meta">
                    <div class="meta-item">
                        <div class="meta-label">Sample Size</div>
                        <div class="meta-value">267 Men</div>
                    </div>
                    <div class="meta-item">
                        <div class="meta-label">Survey Period</div>
                        <div class="meta-value">Baseline to Midline</div>
                    </div>
                    <div class="meta-item">
                        <div class="meta-label">Data Quality</div>
                        <div class="meta-value">High Confidence</div>
                    </div>
                </div>
            </div>
            <div class="tabs-container" id="men-tabs-container">
                <!-- Tab buttons will be generated by JavaScript -->
            </div>
            <div id="men-tabs-content">
                <!-- Tab content will be generated by JavaScript -->
            </div>
        </div>

        <!-- FORESTRY GROUPS SECTION -->
        <div id="forestry-section" style="display: none; margin-top: 60px; padding-top: 40px; border-top: 3px solid #2E7D32;">
            <div class="header" style="margin-bottom: 30px; background: linear-gradient(135deg, #1B5E20 0%, #2E7D32 50%, #388E3C 100%);">
                <h1>Community Forest Conservation Groups</h1>
                <div class="header-subtitle">Forest Functionality Assessment: Baseline to Midline Analysis</div>
                <div class="header-meta">
                    <div class="meta-item">
                        <div class="meta-label">Groups Assessed</div>
                        <div class="meta-value">28 Groups</div>
                    </div>
                    <div class="meta-item">
                        <div class="meta-label">Survey Period</div>
                        <div class="meta-value">Baseline to Midline</div>
                    </div>
                    <div class="meta-item">
                        <div class="meta-label">Data Quality</div>
                        <div class="meta-value">High Confidence</div>
                    </div>
                </div>
            </div>
            <div class="tabs-container" id="forestry-tabs-container">
                <button class="tab-button active" onclick="showForestryTab(event, 'ftab-overview')">A. Overview & Functionality</button>
                <button class="tab-button" onclick="showForestryTab(event, 'ftab-characteristics')">B. Group Characteristics</button>
                <button class="tab-button" onclick="showForestryTab(event, 'ftab-governance')">C. Rights & Governance</button>
                <button class="tab-button" onclick="showForestryTab(event, 'ftab-training')">D. Training & Assets</button>
                <button class="tab-button" onclick="showForestryTab(event, 'ftab-gender')">E. Gender Equality</button>
                <button class="tab-button" onclick="showForestryTab(event, 'ftab-effectiveness')">F. Effectiveness & Conservation</button>
            </div>

            <!-- TAB A: OVERVIEW & FUNCTIONALITY -->
            <div id="ftab-overview" class="forestry-tab-content active">
                <div class="section">
                    <div class="section-title">A. OVERVIEW & FUNCTIONALITY SCORES</div>
                    <div class="highlight-box">
                        <h4>Functionality Assessment Summary</h4>
                        <p>Overall group functionality improved significantly from baseline (n=43) to midline (n=28). Groups meeting the ≥60% threshold increased from 81.4% to 96.4% (+15.0pp). Groups meeting the ≥70% threshold surged from 53.5% to 85.7% (+32.2pp). Overall score improved from 70.6 to 84.2 (+13.6pp), with the strongest gains in Gender domain (+52.6pp).</p>
                    </div>
                    <div class="charts-grid">
                        <div class="chart-wrapper">
                            <div class="chart-title">Functionality Threshold — Groups Meeting ≥60% & ≥70% Benchmarks</div>
                            <div class="chart-container"><canvas id="f-chart-threshold"></canvas></div>
                            <div class="chart-insight">Groups meeting ≥60% threshold: 81.4%→96.4% (+15.0pp). Groups meeting ≥70% threshold: 53.5%→85.7% (+32.2pp). Strong upward trajectory across both benchmarks.</div>
                        </div>
                        <div class="chart-wrapper">
                            <div class="chart-title">Domain Scores — Management, Gender & Effectiveness</div>
                            <div class="chart-container"><canvas id="f-chart-domains"></canvas></div>
                            <div class="chart-insight">Management: 78.6%→78.0% (−0.6pp). Gender: 32.9%→85.5% (+52.6pp — strongest gain). Effectiveness: 72.0%→90.1% (+18.1pp). Overall: 70.6%→84.2% (+13.6pp).</div>
                        </div>
                        <div class="chart-wrapper full-width">
                            <div class="chart-title">Functionality Score Distribution — Average, Max & Min (Baseline n=43, Midline n=28)</div>
                            <div class="chart-container"><canvas id="f-chart-scores"></canvas></div>
                            <div class="chart-insight">Average score improved from 70.6 to 84.2 (+13.6). Maximum improved from 90.4 to 98.5. Minimum lifted from 37.0 to 46.7, indicating weakest groups are also improving.</div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- TAB B: GROUP CHARACTERISTICS -->
            <div id="ftab-characteristics" class="forestry-tab-content">
                <div class="section">
                    <div class="section-title">B. GROUP CHARACTERISTICS</div>
                    <div class="highlight-box">
                        <h4>Group Profile Summary</h4>
                        <p>Average group membership grew from 23 to 28 members, with female membership increasing from 10 to 13 (30% growth). Group registration improved from 72.5% to 85.0%. AMCOS membership rose 42.5%→52.5%. Most groups operate in the 6-10 year range, indicating mature community forest management.</p>
                    </div>
                    <div class="charts-grid">
                        <div class="chart-wrapper">
                            <div class="chart-title">Average Group Membership — Male vs Female</div>
                            <div class="chart-container"><canvas id="f-chart-membership"></canvas></div>
                            <div class="chart-insight">Male: 13→15 (+15.4%). Female: 10→13 (+30.0%). Total: 23→28 (+21.7%). Female membership growing faster than male.</div>
                        </div>
                        <div class="chart-wrapper">
                            <div class="chart-title">Group Affiliations — AMCOS, Beekeepers & Wellness</div>
                            <div class="chart-container"><canvas id="f-chart-affiliations"></canvas></div>
                            <div class="chart-insight">AMCOS: 42.5%→52.5% (+10.0pp). Beekeepers: 27.5%→35.0% (+7.5pp). Wellness: 15.0%→25.0% (+10.0pp). All affiliations growing.</div>
                        </div>
                        <div class="chart-wrapper">
                            <div class="chart-title">Years of Operation — Distribution</div>
                            <div class="chart-container"><canvas id="f-chart-years"></canvas></div>
                            <div class="chart-insight">Shift toward more mature groups: 11+ years increased 22.5%→30.0%. New groups (0-3 yrs) declined 22.5%→12.5%, suggesting group stability improving.</div>
                        </div>
                        <div class="chart-wrapper">
                            <div class="chart-title">Legal Registration Status</div>
                            <div class="chart-container"><canvas id="f-chart-legal"></canvas></div>
                            <div class="chart-insight">Registered groups increased from 72.5% to 85.0% (+12.5pp). Unregistered decreased 27.5%→15.0%. Formalization is progressing well.</div>
                        </div>
                        <div class="chart-wrapper">
                            <div class="chart-title">Forest Size Distribution (Hectares)</div>
                            <div class="chart-container"><canvas id="f-chart-forestsize"></canvas></div>
                            <div class="chart-insight">Larger forests gaining share: 11-100 ha increased 27.5%→32.5%, 101-999 ha grew 12.5%→17.5%. Small forests (1-5 ha) declined 25.0%→17.5%.</div>
                        </div>
                        <div class="chart-wrapper">
                            <div class="chart-title">Communities Near Forest — Distribution</div>
                            <div class="chart-container"><canvas id="f-chart-communities"></canvas></div>
                            <div class="chart-insight">More communities engaging: 7-10 communities increased 15.0%→20.0%. Groups with 1-3 communities declined 45.0%→35.0%, suggesting broader reach.</div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- TAB C: RIGHTS & GOVERNANCE -->
            <div id="ftab-governance" class="forestry-tab-content">
                <div class="section">
                    <div class="section-title">C. OBJECTIVES, RIGHTS & GOVERNANCE</div>
                    <div class="highlight-box">
                        <h4>Governance Improvements</h4>
                        <p>Groups with fully written objectives increased from 45.0% to 67.5% (+22.5pp). Board roles well-defined & understood improved from 35.0% to 57.5%. Regular meetings with full quorum grew from 32.5% to 55.0%. Women in significant leadership positions increased from 17.5% to 35.0%. Management practices show strong improvement across all 6 indicators.</p>
                    </div>
                    <div class="charts-grid">
                        <div class="chart-wrapper">
                            <div class="chart-title">Groups with Objectives in Written Format</div>
                            <div class="chart-container"><canvas id="f-chart-objectives"></canvas></div>
                            <div class="chart-insight">Written objectives: No 32.5%→12.5%, Partially 22.5%→20.0%, Yes 45.0%→67.5%. Strong documentation improvement.</div>
                        </div>
                        <div class="chart-wrapper">
                            <div class="chart-title">Board/Committee Roles Definition & Understanding</div>
                            <div class="chart-container"><canvas id="f-chart-boardroles"></canvas></div>
                            <div class="chart-insight">Well-defined & understood: 35.0%→57.5% (+22.5pp). Not defined at all: 15.0%→5.0% (-10.0pp). Governance clarity improving rapidly.</div>
                        </div>
                        <div class="chart-wrapper">
                            <div class="chart-title">Meeting Regularity & Attendance</div>
                            <div class="chart-container"><canvas id="f-chart-meetings"></canvas></div>
                            <div class="chart-insight">Regular/Full quorum: 32.5%→55.0% (+22.5pp). Occasional/Low: 30.0%→12.5% (-17.5pp). Participation dramatically improved.</div>
                        </div>
                        <div class="chart-wrapper">
                            <div class="chart-title">Women in Leadership Positions</div>
                            <div class="chart-container"><canvas id="f-chart-womenleadership"></canvas></div>
                            <div class="chart-insight">Significant leadership: 17.5%→35.0% (+17.5pp). No leadership/no voice: 25.0%→10.0% (-15.0pp). Gender inclusion in governance advancing.</div>
                        </div>
                        <div class="chart-wrapper full-width">
                            <div class="chart-title">Management Practices — Agree + Strongly Agree (%)</div>
                            <div class="chart-container"><canvas id="f-chart-mgmtpractices"></canvas></div>
                            <div class="chart-insight">Transparent elections: 55.0%→77.5%. Inclusive decisions: 50.0%→72.5%. Grievance mechanism: 35.0%→60.0% (+25.0pp — strongest gain). Benefit sharing rules: 40.0%→65.0%. Overall governance maturity rising.</div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- TAB D: TRAINING & ASSETS -->
            <div id="ftab-training" class="forestry-tab-content">
                <div class="section">
                    <div class="section-title">D. TRAINING & ASSETS</div>
                    <div class="highlight-box">
                        <h4>Training & Resource Mobilization</h4>
                        <p>Training coverage improved substantially: groups where "Most Members" received training grew from 15.0% to 42.5% (+27.5pp). Groups receiving no training dropped from 25.0% to 7.5%. Assets/inputs received increased from 35.0% to 62.5%. Key training topics include Climate Change & Forests, CFM Concepts, and Forest Livelihoods.</p>
                    </div>
                    <div class="charts-grid">
                        <div class="chart-wrapper">
                            <div class="chart-title">Training Coverage — Member Participation Levels</div>
                            <div class="chart-container"><canvas id="f-chart-training"></canvas></div>
                            <div class="chart-insight">Most members trained: 15.0%→42.5% (+27.5pp). No training: 25.0%→7.5% (-17.5pp). Training reach expanding significantly.</div>
                        </div>
                        <div class="chart-wrapper">
                            <div class="chart-title">Top Training Topics Received (%)</div>
                            <div class="chart-container"><canvas id="f-chart-topics"></canvas></div>
                            <div class="chart-insight">Climate Change & Forests: 32.5%→65.0%. CFM Concepts: 27.5%→57.5%. Forest Livelihoods: 22.5%→52.5%. Gender & Governance: 15.0%→40.0%.</div>
                        </div>
                        <div class="chart-wrapper">
                            <div class="chart-title">Assets & Inputs Received</div>
                            <div class="chart-container"><canvas id="f-chart-assets"></canvas></div>
                            <div class="chart-insight">Groups receiving assets: 35.0%→62.5% (+27.5pp). Seedlings/nursery most common, followed by tools & equipment and beekeeping inputs.</div>
                        </div>
                        <div class="chart-wrapper">
                            <div class="chart-title">Asset Types Received by Groups (%)</div>
                            <div class="chart-container"><canvas id="f-chart-assettypes"></canvas></div>
                            <div class="chart-insight">Seedlings/Nursery: 25.0%→50.0%. Tools & Equipment: 17.5%→40.0%. Beekeeping: 12.5%→32.5%. Energy (Solar/Stoves): 7.5%→22.5%.</div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- TAB E: GENDER EQUALITY -->
            <div id="ftab-gender" class="forestry-tab-content">
                <div class="section">
                    <div class="section-title">E. GENDER EQUALITY</div>
                    <div class="highlight-box">
                        <h4>Gender Equality Progress</h4>
                        <p>Groups discussing gender equality increased from 40.0% to 72.5% (+32.5pp). Groups taking gender equality actions improved from 25.0% to 55.0%. Key topics discussed include equitable roles/responsibilities, resource sharing, and women's leadership & voice. Gender action completion ("All actions") grew from 7.5% to 22.5%.</p>
                    </div>
                    <div class="charts-grid">
                        <div class="chart-wrapper">
                            <div class="chart-title">Groups Discussing Gender Equality</div>
                            <div class="chart-container"><canvas id="f-chart-gediscussion"></canvas></div>
                            <div class="chart-insight">Yes: 40.0%→72.5% (+32.5pp). No: 60.0%→27.5%. Gender conversations becoming mainstream in forest groups.</div>
                        </div>
                        <div class="chart-wrapper">
                            <div class="chart-title">Gender Equality Topics Discussed (%)</div>
                            <div class="chart-container"><canvas id="f-chart-getopics"></canvas></div>
                            <div class="chart-insight">Equitable roles: 30.0%→60.0%. Resource sharing: 25.0%→52.5%. Women leadership & voice: 22.5%→50.0%. All topics showing strong gains.</div>
                        </div>
                        <div class="chart-wrapper">
                            <div class="chart-title">Gender Equality Actions Taken</div>
                            <div class="chart-container"><canvas id="f-chart-geactions"></canvas></div>
                            <div class="chart-insight">Yes (fully): 25.0%→55.0% (+30.0pp). No: 42.5%→15.0% (-27.5pp). Partially: 32.5%→30.0%. Groups moving from discussion to action.</div>
                        </div>
                        <div class="chart-wrapper">
                            <div class="chart-title">Gender Action Completion Level</div>
                            <div class="chart-container"><canvas id="f-chart-gecompletion"></canvas></div>
                            <div class="chart-insight">All actions completed: 7.5%→22.5%. Many: 15.0%→32.5%. None: 35.0%→12.5%. Sustained implementation of gender equality measures.</div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- TAB F: EFFECTIVENESS & CONSERVATION -->
            <div id="ftab-effectiveness" class="forestry-tab-content">
                <div class="section">
                    <div class="section-title">F. EFFECTIVENESS & FOREST CONSERVATION</div>
                    <div class="highlight-box">
                        <h4>Conservation Outcomes</h4>
                        <p>Forest condition rated "Good" improved across all characteristics: Area 30.0%→52.5%, Biodiversity 25.0%→47.5%, Ecosystem Services 27.5%→50.0%. Threats decreased significantly: Fire (High) dropped 35.0%→15.0%, Charcoal (High) dropped 40.0%→17.5%. Income-generating groups increased from 37.5% to 62.5%. Agroforestry adoption grew from 32.5% to 57.5%.</p>
                    </div>
                    <div class="charts-grid">
                        <!-- FOREST CONDITION CHARTS -->
                        <div class="chart-wrapper">
                            <div class="chart-title">Forest Condition — "Good" Rating Baseline vs Midline (%)</div>
                            <div class="chart-container"><canvas id="f-chart-condition"></canvas></div>
                            <div class="chart-insight">Area: 30.0%→52.5%. Volume/Biomass: 27.5%→47.5%. Regeneration: 32.5%→55.0%. Biodiversity: 25.0%→47.5%. Ecosystem Services: 27.5%→50.0%.</div>
                        </div>
                        <div class="chart-wrapper">
                            <div class="chart-title">Forest Condition Breakdown — Baseline (Good / Medium / Poor)</div>
                            <div class="chart-container"><canvas id="f-chart-condition-bl"></canvas></div>
                            <div class="chart-insight">Baseline: Good ratings range 25.0–32.5%. Medium ratings 35.0–42.5%. Poor ratings 25.0–37.5%. Area and Regeneration show highest Good ratings.</div>
                        </div>
                        <div class="chart-wrapper">
                            <div class="chart-title">Forest Condition Breakdown — Midline (Good / Medium / Poor)</div>
                            <div class="chart-container"><canvas id="f-chart-condition-ml"></canvas></div>
                            <div class="chart-insight">Midline: Good ratings improved to 47.5–55.0%. Medium ratings 27.5–32.5%. Poor ratings dropped to 15.0–22.5%. Significant shift toward positive condition.</div>
                        </div>

                        <!-- FOREST STATUS / CHANGE CHARTS -->
                        <div class="chart-wrapper">
                            <div class="chart-title">Forest Status Changes — Baseline (Decrease / No Change / Increase)</div>
                            <div class="chart-container"><canvas id="f-chart-status-bl"></canvas></div>
                            <div class="chart-insight">Baseline: Decrease dominant across characteristics (30–42.5%). No Change ranges 27.5–35.0%. Increase observed in only 22.5–35.0% of groups.</div>
                        </div>
                        <div class="chart-wrapper">
                            <div class="chart-title">Forest Status Changes — Midline (Decrease / No Change / Increase)</div>
                            <div class="chart-container"><canvas id="f-chart-status-ml"></canvas></div>
                            <div class="chart-insight">Midline: Decrease reduced (15.0–22.5%). No Change stable (25.0–30.0%). Increase grew to 47.5–57.5%, showing positive conservation trajectory.</div>
                        </div>
                        <div class="chart-wrapper">
                            <div class="chart-title">Forest Status — Perceived Increase Baseline vs Midline (%)</div>
                            <div class="chart-container"><canvas id="f-chart-status-increase"></canvas></div>
                            <div class="chart-insight">Groups perceiving increase: Area 30.0%→52.5%, Volume 22.5%→47.5%, Regeneration 35.0%→57.5%, Biodiversity 27.5%→50.0%, Ecosystem 25.0%→50.0%.</div>
                        </div>

                        <!-- THREAT CHARTS -->
                        <div class="chart-wrapper">
                            <div class="chart-title">Forest Threats — "High" Level Baseline vs Midline (%)</div>
                            <div class="chart-container"><canvas id="f-chart-threats"></canvas></div>
                            <div class="chart-insight">Fire: 35.0%→15.0% (-20.0pp). Charcoal: 40.0%→17.5% (-22.5pp). Encroachment: 32.5%→15.0% (-17.5pp). All major threats declining.</div>
                        </div>
                        <div class="chart-wrapper">
                            <div class="chart-title">Threats Breakdown — Baseline (Low / Medium / High)</div>
                            <div class="chart-container"><canvas id="f-chart-threats-bl"></canvas></div>
                            <div class="chart-insight">Baseline: High threats concentrated in Charcoal (40%), Fire (35%), Encroachment (32.5%). Low threat levels below 30% for most categories.</div>
                        </div>
                        <div class="chart-wrapper">
                            <div class="chart-title">Threats Breakdown — Midline (Low / Medium / High)</div>
                            <div class="chart-container"><canvas id="f-chart-threats-ml"></canvas></div>
                            <div class="chart-insight">Midline: High threats sharply reduced. Low threats now dominant (45–62.5%). Medium threat levels stable. Effective threat mitigation evident.</div>
                        </div>
                        <div class="chart-wrapper">
                            <div class="chart-title">Threat Changes — Perceived Decrease Baseline vs Midline (%)</div>
                            <div class="chart-container"><canvas id="f-chart-threat-decrease"></canvas></div>
                            <div class="chart-insight">Groups perceiving threat decrease: Fire 20.0%→50.0%, Charcoal 15.0%→47.5%, Fuelwood 17.5%→42.5%. More groups reporting threat reduction at midline.</div>
                        </div>

                        <!-- INCOME & AGROFORESTRY CHARTS (existing) -->
                        <div class="chart-wrapper">
                            <div class="chart-title">Income Generation & Agroforestry Adoption</div>
                            <div class="chart-container"><canvas id="f-chart-income"></canvas></div>
                            <div class="chart-insight">Income-generating: 37.5%→62.5% (+25.0pp). Agroforestry adopted: 32.5%→57.5% (+25.0pp). Economic sustainability strengthening.</div>
                        </div>
                        <div class="chart-wrapper">
                            <div class="chart-title">Harvest Products — "Substantial" Amount (%)</div>
                            <div class="chart-container"><canvas id="f-chart-harvest"></canvas></div>
                            <div class="chart-insight">NWFPs: 10.0%→27.5%. Food: 12.5%→30.0%. Woodfuel: 22.5%→17.5% (declining — positive conservation signal). Timber: 15.0%→10.0% (reduced extraction).</div>
                        </div>
                        <div class="chart-wrapper full-width">
                            <div class="chart-title">Agroforestry Practices & Objectives (%)</div>
                            <div class="chart-container"><canvas id="f-chart-agroforestry"></canvas></div>
                            <div class="chart-insight">Top practices: Intercropping 25.0%→47.5%, Forest Farming 15.0%→37.5%, Beekeeping 20.0%→45.0%. Top objectives: Biodiversity, soil fertility, income diversification.</div>
                        </div>
                    </div>
                </div>
            </div>

        </div>
        <!-- END FORESTRY SECTION -->

        <!-- PRE & POST TEST SECTION -->
        <div id="prepost-section" style="display: none; margin-top: 60px; padding-top: 40px; border-top: 3px solid #0D47A1;">
            <div class="header" style="margin-bottom: 30px; background: linear-gradient(135deg, #0D47A1 0%, #1565C0 50%, #1976D2 100%);">
                <h1>Training Pre & Post Test Results</h1>
                <div class="header-subtitle">Knowledge Assessment: Pre-Training vs Post-Training Analysis</div>
                <div class="header-meta">
                    <div class="meta-item">
                        <div class="meta-label">Pre-Test Participants</div>
                        <div class="meta-value" id="pp-meta-pre">546</div>
                    </div>
                    <div class="meta-item">
                        <div class="meta-label">Post-Test Participants</div>
                        <div class="meta-value" id="pp-meta-post">909</div>
                    </div>
                    <div class="meta-item">
                        <div class="meta-label">Passing Threshold</div>
                        <div class="meta-value">≥70%</div>
                    </div>
                </div>
            </div>

            <!-- FOREST PRE & POST TEST CONTENT -->
            <div id="pp-forest-content">
                <div class="tabs-container" id="prepost-tabs-container">
                    <button class="tab-button active" onclick="showPrePostTab(event, 'pptab-overview')">A. Threshold & Scores</button>
                    <button class="tab-button" onclick="showPrePostTab(event, 'pptab-questions1')">B. Forest Ecology & Rights</button>
                    <button class="tab-button" onclick="showPrePostTab(event, 'pptab-questions2')">C. Management & Conservation</button>
                    <button class="tab-button" onclick="showPrePostTab(event, 'pptab-questions3')">D. Policy & Sustainability</button>
                </div>

                <!-- TAB A: THRESHOLD & SCORES -->
                <div id="pptab-overview" class="prepost-tab-content active">
                    <div class="section">
                        <div class="section-title">A. PASSING THRESHOLDS & OVERALL SCORES</div>
                        <div class="highlight-box">
                            <h4>Knowledge Assessment Summary — Forest Conservation Training</h4>
                            <p>Participants completing training demonstrated significant knowledge gains across all thresholds and domains. Those meeting the ≥70% passing threshold surged from 50.0% to 94.7% (+44.7pp). Average scores improved from 65.2% to 85.4% (+20.2pp). All 21 knowledge topics showed improvement, with the strongest gains in Forest Ecosystems (+34.9pp), Climate Adaptation (+21.9pp), and Sustainable Harvesting (+26.1pp).</p>
                        </div>
                        <div class="charts-grid">
                            <div class="chart-wrapper">
                                <div class="chart-title">Passing Threshold — Participants Meeting ≥50%, ≥60%, ≥70%, ≥80% Benchmarks</div>
                                <div class="chart-container"><canvas id="pp-chart-threshold"></canvas></div>
                                <div class="chart-insight">≥50%: 76.4%→97.7% (+21.3pp). ≥60%: 64.8%→96.6% (+31.8pp). ≥70%: 50.0%→94.7% (+44.7pp). ≥80%: 32.9%→85.7% (+52.8pp). Strongest gain at ≥80% threshold.</div>
                            </div>
                            <div class="chart-wrapper">
                                <div class="chart-title">Overall Scores — Average, Maximum & Minimum (%)</div>
                                <div class="chart-container"><canvas id="pp-chart-scores"></canvas></div>
                                <div class="chart-insight">Average: 65.2%→85.4% (+20.2pp). Maximum stable at 100%. Minimum improved from 2.5% to 27.5% (+25.0pp), lifting the lowest performers significantly.</div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- TAB B: FOREST ECOLOGY & RIGHTS -->
                <div id="pptab-questions1" class="prepost-tab-content" style="display: none;">
                    <div class="section">
                        <div class="section-title">B. FOREST ECOLOGY & RIGHTS</div>
                        <div class="highlight-box">
                            <h4>Forest Ecology & Rights: Foundational Knowledge</h4>
                            <p>Topics covering core forest ecosystems, biodiversity importance, community forestry principles, forest rights, conservation fundamentals, and tree species identification. All 6 topics showed significant post-training improvement, with Forest Ecosystems showing the strongest gain (+34.9pp) and Community Forestry the highest post-test score (97.7%).</p>
                        </div>
                        <div class="charts-grid">
                            <div class="chart-wrapper" style="grid-column: 1 / -1;">
                                <div class="chart-title">Forest Ecology & Rights — Pre-Test vs Post-Test Performance (%)</div>
                                <div class="chart-container" style="height: 450px;"><canvas id="pp-chart-q1"></canvas></div>
                                <div class="chart-insight">Forest Ecosystems: 56.6%→91.5% (+34.9pp). Biodiversity: 85.7%→97.6% (+11.9pp). Community Forestry: 86.6%→97.7% (+11.1pp). Forest Rights: 67.4%→95.0% (+27.6pp). Conservation Principles: 67.2%→97.8% (+30.6pp). Tree Species: 82.6%→97.5% (+14.9pp).</div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- TAB C: MANAGEMENT & CONSERVATION -->
                <div id="pptab-questions2" class="prepost-tab-content" style="display: none;">
                    <div class="section">
                        <div class="section-title">C. MANAGEMENT & CONSERVATION</div>
                        <div class="highlight-box">
                            <h4>Management & Conservation: Intermediate Knowledge</h4>
                            <p>Topics covering forest management planning, sustainable harvesting, fire prevention, reforestation methods, watershed protection, carbon sequestration, and wildlife corridors. Strong improvements observed across all topics, with Carbon Sequestration and Wildlife Corridors reaching 99.2% post-test scores.</p>
                        </div>
                        <div class="charts-grid">
                            <div class="chart-wrapper" style="grid-column: 1 / -1;">
                                <div class="chart-title">Management & Conservation — Pre-Test vs Post-Test Performance (%)</div>
                                <div class="chart-container" style="height: 450px;"><canvas id="pp-chart-q2"></canvas></div>
                                <div class="chart-insight">Management Plans: 68.9%→83.4% (+14.5pp). Sustainable Harvesting: 69.6%→95.7% (+26.1pp). Fire Prevention: 85.2%→97.0% (+11.8pp). Reforestation: 67.0%→92.0% (+25.0pp). Watershed Protection: 76.4%→98.2% (+21.8pp). Carbon Sequestration: 90.8%→99.2% (+8.4pp). Wildlife Corridors: 88.6%→99.2% (+10.6pp).</div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- TAB D: POLICY & SUSTAINABILITY -->
                <div id="pptab-questions3" class="prepost-tab-content" style="display: none;">
                    <div class="section">
                        <div class="section-title">D. POLICY & SUSTAINABILITY</div>
                        <div class="highlight-box">
                            <h4>Policy & Sustainability: Advanced Knowledge</h4>
                            <p>Topics covering forest policy frameworks, climate adaptation, community governance, benefit sharing, ecosystem services valuation, agroforestry integration, and monitoring & evaluation. Strongest results with 6 of 7 topics exceeding 96% post-test, and Ecosystem Services achieving the highest score at 99.7%.</p>
                        </div>
                        <div class="charts-grid">
                            <div class="chart-wrapper" style="grid-column: 1 / -1;">
                                <div class="chart-title">Policy & Sustainability — Pre-Test vs Post-Test Performance (%)</div>
                                <div class="chart-container" style="height: 450px;"><canvas id="pp-chart-q3"></canvas></div>
                                <div class="chart-insight">Forest Policy: 65.6%→95.3% (+29.7pp). Climate Adaptation: 74.7%→96.6% (+21.9pp). Community Governance: 96.9%→99.6% (+2.7pp). Benefit Sharing: 89.6%→98.6% (+9.0pp). Ecosystem Services: 88.5%→99.7% (+11.2pp). Agroforestry: 77.7%→97.9% (+20.2pp). Monitoring & Evaluation: 76.7%→97.4% (+20.7pp).</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- MANGROVE PRE & POST TEST CONTENT -->
            <div id="pp-mangrove-content" style="display: none;">
                <div class="section">
                    <div class="section-title">ADEQUATE KNOWLEDGE — BY LOCATION & GENDER</div>
                    <div class="highlight-box">
                        <h4>Knowledge Assessment Summary — Mangrove Restoration Training</h4>
                        <p>Overall adequate knowledge improved dramatically from 36.9% to 81.5% (+44.6pp). By location, Kilifi showed the strongest gain (+59.0pp, from 21.1% to 80.1%), while Kwale improved from 53.7% to 83.1% (+29.4pp). By gender, females outperformed males at post-test (87.4% vs 80.2%), with females gaining +52.7pp compared to males' +42.0pp — demonstrating particularly strong knowledge uptake among women participants.</p>
                    </div>
                    <div class="charts-grid">
                        <div class="chart-wrapper">
                            <div class="chart-title">Adequate Knowledge by Location — Pre-Test vs Post-Test (%)</div>
                            <div class="chart-container"><canvas id="pp-mgv-chart-location"></canvas></div>
                            <div class="chart-insight">Kilifi: 21.1%→80.1% (+59.0pp — strongest location gain). Kwale: 53.7%→83.1% (+29.4pp). Overall: 36.9%→81.5% (+44.6pp). Kilifi closed the gap with Kwale significantly.</div>
                        </div>
                        <div class="chart-wrapper">
                            <div class="chart-title">Adequate Knowledge by Gender — Pre-Test vs Post-Test (%)</div>
                            <div class="chart-container"><canvas id="pp-mgv-chart-gender"></canvas></div>
                            <div class="chart-insight">Male: 38.2%→80.2% (+42.0pp). Female: 34.7%→87.4% (+52.7pp — strongest gender gain). Overall: 36.9%→81.9% (+45.0pp). Women outperformed men at post-test by 7.2pp.</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <!-- END PRE & POST TEST SECTION -->

        <!-- SCHOOLS DASHBOARD SECTION -->
        <div id="schools-dashboard-section" style="display: none; margin-top: 60px; padding-top: 40px; border-top: 3px solid #1565C0;">

            <!-- SCHOOLS INDICATOR LOGFRAME -->
            <div class="section" id="schools-logframe-section" style="margin-bottom: 30px;">
                <button class="collapsible-header" onclick="toggleCollapsible(this)">Schools Dashboard — Program Target vs Result</button>
                <div class="collapsible-content">
                    <div class="highlight-box">
                        <h4>Indicator 1310c Performance</h4>
                        <p>The percentage of targeted schools with access to sustainable clean water solutions <strong>exceeded the 60% target</strong>, rising from <strong>23.4%</strong> at baseline to <strong>62.5%</strong> at midline — a gain of <strong>+39.1pp</strong>. This represents a significant achievement, demonstrating that COSME interventions in water infrastructure, rainwater harvesting, and school-based water management are delivering measurable impact.</p>
                    </div>
                    <table class="comparison-table">
                        <thead>
                            <tr>
                                <th style="width: 35%;">Indicator</th>
                                <th style="width: 15%;">Baseline</th>
                                <th style="width: 15%;">Midline</th>
                                <th style="width: 15%;">Target</th>
                                <th style="width: 10%;">Change</th>
                                <th style="width: 10%;">Status</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr style="background: #1565C0; font-weight: 600;">
                                <td colspan="6"><strong style="color: white;">OUTPUT LEVEL — Schools Programme (1310-series)</strong></td>
                            </tr>
                            <tr>
                                <td><strong>1310c. Percentage of targeted schools with access to sustainable clean water solutions</strong></td>
                                <td>23.4%</td>
                                <td>62.5%</td>
                                <td>60%</td>
                                <td>+39.1pp</td>
                                <td><span style="background: #c8e6c9; color: #1b5e20; padding: 4px 8px; border-radius: 4px; font-weight: 600;">EXCEEDED</span></td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- ========== A. ACCESS TO CLEAN WATER ========== -->
            <div id="schools-dash-clean-water">
                <div class="output-header" style="background: linear-gradient(135deg, #0277BD 0%, #01579B 100%); color: #fff; padding: 25px 30px; border-radius: 12px; margin-bottom: 25px;">
                    <h2 style="margin: 0; font-size: 1.5em;">A. Access to Clean Water: Baseline vs. Midline Comparison</h2>
                    <p style="margin: 8px 0 0; opacity: 0.9; font-size: 0.95em;">Between the Baseline (September 2023) and Midline (July 2025) assessments</p>
                </div>

                <!-- KPI Cards -->
                <div class="kpi-grid" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px; margin-bottom: 30px;">
                    <div class="kpi-card up" >
                        <div class="kpi-label" style="font-size: 0.85em; color: #666;">Borehole Access</div>
                        <div class="kpi-value" style="font-size: 1.8em; font-weight: 700; color: #283593;">52.3%</div>
                        <div class="kpi-change up" style="color: #2e7d32; font-size: 0.85em;">↑ from 44.2%</div>
                    </div>
                    <div class="kpi-card up" >
                        <div class="kpi-label" style="font-size: 0.85em; color: #666;">Rainwater Harvesting</div>
                        <div class="kpi-value" style="font-size: 1.8em; font-weight: 700; color: #283593;">27.7%</div>
                        <div class="kpi-change up" style="color: #2e7d32; font-size: 0.85em;">↑ from 13.0%</div>
                    </div>
                    <div class="kpi-card up" >
                        <div class="kpi-label" style="font-size: 0.85em; color: #666;">Water Tanks</div>
                        <div class="kpi-value" style="font-size: 1.8em; font-weight: 700; color: #283593;">9.2%</div>
                        <div class="kpi-change up" style="color: #2e7d32; font-size: 0.85em;">↑ from 2.6%</div>
                    </div>
                    <div class="kpi-card up" >
                        <div class="kpi-label" style="font-size: 0.85em; color: #666;">Piped Water Access</div>
                        <div class="kpi-value" style="font-size: 1.8em; font-weight: 700; color: #283593;">35.4%</div>
                        <div class="kpi-change up" style="color: #2e7d32; font-size: 0.85em;">↑ from 31.2%</div>
                    </div>
                    <div class="kpi-card up" >
                        <div class="kpi-label" style="font-size: 0.85em; color: #666;">Year-round Availability</div>
                        <div class="kpi-value" style="font-size: 1.8em; font-weight: 700; color: #283593;">55.4%</div>
                        <div class="kpi-change up" style="color: #2e7d32; font-size: 0.85em;">↑ from 49.4%</div>
                    </div>
                    <div class="kpi-card up" >
                        <div class="kpi-label" style="font-size: 0.85em; color: #666;">Indicator 1310c (Composite)</div>
                        <div class="kpi-value" style="font-size: 1.8em; font-weight: 700; color: #1b5e20;">62.5%</div>
                        <div class="kpi-change up" style="color: #2e7d32; font-size: 0.85em;">↑ from 23.4%</div>
                    </div>
                </div>

                <!-- Narrative Summary -->
                <div style="background: #fff; padding: 25px 30px; border-radius: 12px; box-shadow: 0 2px 10px rgba(0,0,0,0.06); margin-bottom: 25px;">
                    <h3 style="color: #0D47A1; margin-bottom: 15px; font-size: 1.15em;">Narrative Summary</h3>
                    <div style="line-height: 1.8; color: #444;">
                        <p style="margin-bottom: 12px;">Between the <strong>Baseline (September 2023)</strong> and <strong>Midline (July 2025)</strong> assessments, several indicators related to access to clean water in schools showed notable changes:</p>
                        <h4 style="color: #01579B; margin: 12px 0 6px;">Water Source Improvements:</h4>
                        <ul style="padding-left: 25px; margin-bottom: 10px;">
                            <li>Borehole access increased from <strong>44.2%</strong> to <strong>52.3%</strong></li>
                            <li>Rainwater harvesting rose from <strong>13.0%</strong> to <strong>27.7%</strong></li>
                            <li>Water tanks usage increased significantly from <strong>2.6%</strong> to <strong>9.2%</strong></li>
                            <li>Piped water access improved slightly from <strong>31.2%</strong> to <strong>35.4%</strong></li>
                            <li>River and pond usage decreased, indicating a shift away from unsafe sources</li>
                        </ul>
                        <h4 style="color: #01579B; margin: 12px 0 6px;">Ownership of Water Infrastructure:</h4>
                        <ul style="padding-left: 25px; margin-bottom: 10px;">
                            <li>Schools with <strong>private ownership</strong> of water infrastructure increased from <strong>63.6%</strong> to <strong>81.5%</strong></li>
                            <li><strong>Public/communal ownership</strong> dropped from <strong>36.4%</strong> to <strong>15.4%</strong></li>
                        </ul>
                        <h4 style="color: #01579B; margin: 12px 0 6px;">Additional Indicators:</h4>
                        <ul style="padding-left: 25px; margin-bottom: 10px;">
                            <li>Schools reporting <strong>year-round availability</strong> rose from <strong>49.4%</strong> to <strong>55.4%</strong></li>
                            <li>Schools reporting <strong>clean/safe drinking water</strong> slightly decreased from <strong>81.2%</strong> to <strong>78.5%</strong></li>
                            <li>Functional rainwater harvesting systems increased from <strong>37.7%</strong> to <strong>53.8%</strong></li>
                            <li>The percentage of schools with <strong>sustainable clean water solutions</strong> rose from <strong>23.4%</strong> to <strong>62.5%</strong> (Indicator 1310c)</li>
                        </ul>
                    </div>
                </div>

                <!-- Charts -->
                <div class="charts-grid" style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 25px; margin-bottom: 25px;">
                    <div class="chart-wrapper" style="background: #fff; padding: 20px; border-radius: 12px; box-shadow: 0 2px 10px rgba(0,0,0,0.06);">
                        <div class="chart-title" style="font-weight: 600; margin-bottom: 10px; color: #333;">Water Source: Baseline vs Midline (%)</div>
                        <div style="height: 320px;"><canvas id="sd-water-source-chart"></canvas></div>
                    </div>
                    <div class="chart-wrapper" style="background: #fff; padding: 20px; border-radius: 12px; box-shadow: 0 2px 10px rgba(0,0,0,0.06);">
                        <div class="chart-title" style="font-weight: 600; margin-bottom: 10px; color: #333;">Infrastructure Ownership: Baseline vs Midline (%)</div>
                        <div style="height: 320px;"><canvas id="sd-ownership-chart"></canvas></div>
                    </div>
                    <div class="chart-wrapper" style="background: #fff; padding: 20px; border-radius: 12px; box-shadow: 0 2px 10px rgba(0,0,0,0.06);">
                        <div class="chart-title" style="font-weight: 600; margin-bottom: 10px; color: #333;">Key Indicators: Baseline vs Midline (%)</div>
                        <div style="height: 320px;"><canvas id="sd-indicators-chart"></canvas></div>
                    </div>
                    <div class="chart-wrapper" style="background: #fff; padding: 20px; border-radius: 12px; box-shadow: 0 2px 10px rgba(0,0,0,0.06);">
                        <div class="chart-title" style="font-weight: 600; margin-bottom: 10px; color: #333;">Indicator 1310c — Sustainable Clean Water Solutions (%)</div>
                        <div style="height: 320px;"><canvas id="sd-composite-chart"></canvas></div>
                    </div>
                </div>

                <!-- Insights & Recommendations -->
                <div class="insights-grid">
                    <div class="insight-panel green">
                        <h4 style="color: #1b5e20;">General Insights & Trends</h4>
                        <ul>
                            <li>Clear trend toward <strong>improved infrastructure and safer water sources</strong>, particularly through increased borehole and rainwater harvesting systems</li>
                            <li>Shift from public to private ownership suggests greater <strong>school-level control</strong> and possibly better maintenance</li>
                            <li>Despite infrastructure gains, the <strong>perception of water safety declined slightly</strong>, which may reflect increased awareness or persistent quality issues</li>
                        </ul>
                    </div>
                    <div class="insight-panel blue">
                        <h4 style="color: #0D47A1;">Recommendations</h4>
                        <ul>
                            <li><strong>Strengthen water quality monitoring</strong> to address concerns about safety</li>
                            <li>Continue investing in <strong>rainwater harvesting and borehole development</strong>, especially in areas with limited piped water</li>
                            <li>Provide <strong>technical support and training</strong> for maintenance of water systems to ensure long-term sustainability</li>
                            <li>Investigate reasons behind the <strong>decline in perceived water safety</strong> despite infrastructure improvements</li>
                        </ul>
                    </div>
                </div>
            </div>

            <!-- ========== B. WATER IN SCHOOLS: MIDLINE RESULTS ========== -->
            <div id="schools-dash-water-midline" style="display: none;">
                <div class="output-header" style="background: linear-gradient(135deg, #00695C 0%, #004D40 100%); color: #fff; padding: 25px 30px; border-radius: 12px; margin-bottom: 25px;">
                    <h2 style="margin: 0; font-size: 1.5em;">B. Water in Schools: Midline Results</h2>
                    <p style="margin: 8px 0 0; opacity: 0.9; font-size: 0.95em;">Midline data from sections A, B, and C</p>
                </div>

                <!-- KPI Cards -->
                <div class="kpi-grid" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px; margin-bottom: 30px;">
                    <div class="kpi-card" >
                        <div class="kpi-label" style="font-size: 0.85em; color: #666;">Schools Received Tanks & Gutters</div>
                        <div class="kpi-value" style="font-size: 1.8em; font-weight: 700; color: #00695C;">83%</div>
                    </div>
                    <div class="kpi-card" >
                        <div class="kpi-label" style="font-size: 0.85em; color: #666;">Tanks Installed</div>
                        <div class="kpi-value" style="font-size: 1.8em; font-weight: 700; color: #e65100;">34%</div>
                        <div class="kpi-change" style="color: #e65100; font-size: 0.8em;">Low uptake</div>
                    </div>
                    <div class="kpi-card" >
                        <div class="kpi-label" style="font-size: 0.85em; color: #666;">Gutters Installed</div>
                        <div class="kpi-value" style="font-size: 1.8em; font-weight: 700; color: #e65100;">32%</div>
                        <div class="kpi-change" style="color: #e65100; font-size: 0.8em;">Low uptake</div>
                    </div>
                    <div class="kpi-card" >
                        <div class="kpi-label" style="font-size: 0.85em; color: #666;">Solvatten Kits Used</div>
                        <div class="kpi-value" style="font-size: 1.8em; font-weight: 700; color: #00695C;">49%</div>
                        <div class="kpi-change" style="color: #666; font-size: 0.8em;">14% partially used</div>
                    </div>
                    <div class="kpi-card" >
                        <div class="kpi-label" style="font-size: 0.85em; color: #666;">Maintenance Budget</div>
                        <div class="kpi-value" style="font-size: 1.8em; font-weight: 700; color: #e65100;">20%</div>
                        <div class="kpi-change" style="color: #666; font-size: 0.8em;">46% partially</div>
                    </div>
                    <div class="kpi-card" >
                        <div class="kpi-label" style="font-size: 0.85em; color: #666;">Hygiene Training Programs</div>
                        <div class="kpi-value" style="font-size: 1.8em; font-weight: 700; color: #00695C;">74%</div>
                    </div>
                </div>

                <!-- Narrative -->
                <div style="background: #fff; padding: 25px 30px; border-radius: 12px; box-shadow: 0 2px 10px rgba(0,0,0,0.06); margin-bottom: 25px;">
                    <h3 style="color: #00695C; margin-bottom: 15px; font-size: 1.15em;">Narrative Summary</h3>
                    <div style="line-height: 1.8; color: #444;">
                        <h4 style="color: #004D40; margin: 12px 0 6px;">COSME Project Interventions:</h4>
                        <ul style="padding-left: 25px; margin-bottom: 10px;">
                            <li><strong>83%</strong> of schools received water tanks and gutters</li>
                            <li>However, only <strong>34%</strong> of schools installed tanks, and <strong>32%</strong> installed gutters</li>
                            <li>Usage rates were lower: <strong>35%</strong> used tanks, <strong>27%</strong> used gutters</li>
                            <li>Only <strong>30%</strong> of schools had tanks and gutters connected for rainwater harvesting</li>
                        </ul>
                        <h4 style="color: #004D40; margin: 12px 0 6px;">Solvatten Kits:</h4>
                        <ul style="padding-left: 25px; margin-bottom: 10px;">
                            <li>All <strong>65 schools</strong> received kits</li>
                            <li><strong>49%</strong> used them, <strong>14%</strong> partially used, and <strong>37%</strong> did not use them</li>
                        </ul>
                        <h4 style="color: #004D40; margin: 12px 0 6px;">Sustainability Measures:</h4>
                        <ul style="padding-left: 25px; margin-bottom: 10px;">
                            <li><strong>20%</strong> of schools had budgets for maintenance; <strong>46%</strong> partially</li>
                            <li><strong>57%</strong> had trained staff/students managing systems</li>
                            <li><strong>65%</strong> conducted repairs/maintenance in the past year</li>
                            <li><strong>74%</strong> had hygiene training programs for students</li>
                            <li><strong>74%</strong> involved community members in oversight</li>
                            <li><strong>63%</strong> had income-generating activities linked to water use</li>
                        </ul>
                    </div>
                </div>

                <!-- Charts -->
                <div class="charts-grid" style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 25px; margin-bottom: 25px;">
                    <div class="chart-wrapper" style="background: #fff; padding: 20px; border-radius: 12px; box-shadow: 0 2px 10px rgba(0,0,0,0.06);">
                        <div class="chart-title" style="font-weight: 600; margin-bottom: 10px; color: #333;">Infrastructure: Received vs Installed vs Used (%)</div>
                        <div style="height: 320px;"><canvas id="sd-infra-usage-chart"></canvas></div>
                    </div>
                    <div class="chart-wrapper" style="background: #fff; padding: 20px; border-radius: 12px; box-shadow: 0 2px 10px rgba(0,0,0,0.06);">
                        <div class="chart-title" style="font-weight: 600; margin-bottom: 10px; color: #333;">Solvatten Kit Usage (%)</div>
                        <div style="height: 320px;"><canvas id="sd-solvatten-chart"></canvas></div>
                    </div>
                    <div class="chart-wrapper" style="background: #fff; padding: 20px; border-radius: 12px; box-shadow: 0 2px 10px rgba(0,0,0,0.06);">
                        <div class="chart-title" style="font-weight: 600; margin-bottom: 10px; color: #333;">Sustainability Measures (%)</div>
                        <div style="height: 320px;"><canvas id="sd-sustainability-chart"></canvas></div>
                    </div>
                    <div class="chart-wrapper" style="background: #fff; padding: 20px; border-radius: 12px; box-shadow: 0 2px 10px rgba(0,0,0,0.06);">
                        <div class="chart-title" style="font-weight: 600; margin-bottom: 10px; color: #333;">Tank & Gutter Pipeline: Received → Installed → Used (%)</div>
                        <div style="height: 320px;"><canvas id="sd-pipeline-chart"></canvas></div>
                    </div>
                </div>

                <!-- Insights -->
                <div class="insights-grid">
                    <div class="insight-panel teal">
                        <h4 style="color: #004D40;">General Insights & Patterns</h4>
                        <ul>
                            <li>While distribution of infrastructure was high, <strong>installation and usage lagged</strong>, suggesting barriers beyond access — likely financial or technical</li>
                            <li><strong>Solvatten kits</strong> had better uptake than tanks/gutters, possibly due to ease of use</li>
                            <li>Schools are increasingly engaging in <strong>sustainability practices</strong>, but <strong>funding remains a major constraint</strong></li>
                            <li><strong>Community involvement</strong> and student training are strong, which bodes well for long-term impact</li>
                        </ul>
                    </div>
                    <div class="insight-panel blue">
                        <h4 style="color: #0D47A1;">Recommendations</h4>
                        <ul>
                            <li>Provide <strong>installation support</strong> and <strong>technical assistance</strong> post-distribution</li>
                            <li>Develop <strong>maintenance funding models</strong>, possibly through community partnerships or government support</li>
                            <li>Expand <strong>training programs</strong> for staff and students to improve system management</li>
                            <li>Monitor and evaluate <strong>usage of distributed resources</strong> to ensure effectiveness</li>
                        </ul>
                    </div>
                </div>
            </div>

            <!-- ========== C. 4K CLUBS: MIDLINE RESULTS ========== -->
            <div id="schools-dash-four-k-clubs" style="display: none;">
                <div class="output-header" style="background: linear-gradient(135deg, #2E7D32 0%, #1B5E20 100%); color: #fff; padding: 25px 30px; border-radius: 12px; margin-bottom: 25px;">
                    <h2 style="margin: 0; font-size: 1.5em;">C. 4K Clubs: Midline Results</h2>
                    <p style="margin: 8px 0 0; opacity: 0.9; font-size: 0.95em;">4K Club Establishment, Training & Support, and Environmental Initiatives</p>
                </div>

                <!-- KPI Cards -->
                <div class="kpi-grid" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px; margin-bottom: 30px;">
                    <div class="kpi-card" >
                        <div class="kpi-label" style="font-size: 0.85em; color: #666;">Schools with 4K Clubs</div>
                        <div class="kpi-value" style="font-size: 1.8em; font-weight: 700; color: #2E7D32;">97%</div>
                        <div class="kpi-change" style="color: #666; font-size: 0.8em;">3% had two clubs</div>
                    </div>
                    <div class="kpi-card" >
                        <div class="kpi-label" style="font-size: 0.85em; color: #666;">Total Members</div>
                        <div class="kpi-value" style="font-size: 1.8em; font-weight: 700; color: #283593;">5,065</div>
                        <div class="kpi-change" style="color: #666; font-size: 0.8em;">2,917 girls · 2,148 boys</div>
                    </div>
                    <div class="kpi-card" >
                        <div class="kpi-label" style="font-size: 0.85em; color: #666;">Materials Received</div>
                        <div class="kpi-value" style="font-size: 1.8em; font-weight: 700; color: #2E7D32;">92%</div>
                        <div class="kpi-change" style="color: #666; font-size: 0.8em;">6% partially</div>
                    </div>
                    <div class="kpi-card" >
                        <div class="kpi-label" style="font-size: 0.85em; color: #666;">Curriculum Completed ~50%</div>
                        <div class="kpi-value" style="font-size: 1.8em; font-weight: 700; color: #e65100;">66%</div>
                        <div class="kpi-change" style="color: #666; font-size: 0.8em;">14% almost, 17% less</div>
                    </div>
                    <div class="kpi-card" >
                        <div class="kpi-label" style="font-size: 0.85em; color: #666;">Environmental Initiatives</div>
                        <div class="kpi-value" style="font-size: 1.8em; font-weight: 700; color: #2E7D32;">81.5%</div>
                        <div class="kpi-change" style="color: #666; font-size: 0.8em;">of clubs initiated activities</div>
                    </div>
                    <div class="kpi-card" >
                        <div class="kpi-label" style="font-size: 0.85em; color: #666;">Patrons Agree: Adequate Training</div>
                        <div class="kpi-value" style="font-size: 1.8em; font-weight: 700; color: #2E7D32;">85%</div>
                    </div>
                </div>

                <!-- Narrative -->
                <div style="background: #fff; padding: 25px 30px; border-radius: 12px; box-shadow: 0 2px 10px rgba(0,0,0,0.06); margin-bottom: 25px;">
                    <h3 style="color: #2E7D32; margin-bottom: 15px; font-size: 1.15em;">Narrative Summary</h3>
                    <div style="line-height: 1.8; color: #444;">
                        <h4 style="color: #1B5E20; margin: 12px 0 6px;">4K Club Establishment:</h4>
                        <ul style="padding-left: 25px; margin-bottom: 10px;">
                            <li><strong>97%</strong> of schools had at least one club; <strong>3%</strong> had two</li>
                            <li>Total members: <strong>2,917 girls</strong> and <strong>2,148 boys</strong></li>
                        </ul>
                        <h4 style="color: #1B5E20; margin: 12px 0 6px;">Training & Support:</h4>
                        <ul style="padding-left: 25px; margin-bottom: 10px;">
                            <li><strong>85%</strong> agreed patrons received adequate training</li>
                            <li><strong>88%</strong> agreed patrons actively support clubs</li>
                            <li><strong>85%</strong> agreed training materials are adequate</li>
                            <li><strong>89%</strong> agreed club members are committed</li>
                            <li><strong>89%</strong> agreed clubs are functional and active</li>
                        </ul>
                        <h4 style="color: #1B5E20; margin: 12px 0 6px;">Material Distribution:</h4>
                        <ul style="padding-left: 25px; margin-bottom: 10px;">
                            <li><strong>92%</strong> of schools received materials; <strong>6%</strong> partially</li>
                            <li>Beneficiaries: <strong>2,153 girls</strong>, <strong>1,632 boys</strong></li>
                        </ul>
                        <h4 style="color: #1B5E20; margin: 12px 0 6px;">Curriculum Delivery:</h4>
                        <ul style="padding-left: 25px; margin-bottom: 10px;">
                            <li><strong>66%</strong> of schools completed around half</li>
                            <li><strong>14%</strong> almost completed, <strong>17%</strong> less than half</li>
                        </ul>
                        <h4 style="color: #1B5E20; margin: 12px 0 6px;">Environmental Initiatives:</h4>
                        <ul style="padding-left: 25px; margin-bottom: 10px;">
                            <li><strong>81.5%</strong> of clubs initiated activities</li>
                            <li>Most common: <strong>Tree planting (38)</strong>, <strong>Farming (32)</strong>, <strong>Environmental conservation (9)</strong></li>
                        </ul>
                    </div>
                </div>

                <!-- Charts -->
                <div class="charts-grid" style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 25px; margin-bottom: 25px;">
                    <div class="chart-wrapper" style="background: #fff; padding: 20px; border-radius: 12px; box-shadow: 0 2px 10px rgba(0,0,0,0.06);">
                        <div class="chart-title" style="font-weight: 600; margin-bottom: 10px; color: #333;">Training & Support Agreement (%)</div>
                        <div style="height: 320px;"><canvas id="sd-4k-training-chart"></canvas></div>
                    </div>
                    <div class="chart-wrapper" style="background: #fff; padding: 20px; border-radius: 12px; box-shadow: 0 2px 10px rgba(0,0,0,0.06);">
                        <div class="chart-title" style="font-weight: 600; margin-bottom: 10px; color: #333;">4K Club Members: Gender Split</div>
                        <div style="height: 320px;"><canvas id="sd-4k-gender-chart"></canvas></div>
                    </div>
                    <div class="chart-wrapper" style="background: #fff; padding: 20px; border-radius: 12px; box-shadow: 0 2px 10px rgba(0,0,0,0.06);">
                        <div class="chart-title" style="font-weight: 600; margin-bottom: 10px; color: #333;">Environmental Initiatives by Type</div>
                        <div style="height: 320px;"><canvas id="sd-4k-enviro-chart"></canvas></div>
                    </div>
                    <div class="chart-wrapper" style="background: #fff; padding: 20px; border-radius: 12px; box-shadow: 0 2px 10px rgba(0,0,0,0.06);">
                        <div class="chart-title" style="font-weight: 600; margin-bottom: 10px; color: #333;">Curriculum Delivery Progress</div>
                        <div style="height: 320px;"><canvas id="sd-4k-curriculum-chart"></canvas></div>
                    </div>
                </div>

                <!-- Insights -->
                <div class="insights-grid">
                    <div class="insight-panel green">
                        <h4 style="color: #1B5E20;">General Insights & Patterns</h4>
                        <ul>
                            <li>4K Clubs are <strong>widely adopted and well-supported</strong>, with high levels of engagement</li>
                            <li>Girls outnumber boys in club participation and material benefit</li>
                            <li>Environmental initiatives are <strong>diverse and impactful</strong>, with strong emphasis on sustainability</li>
                            <li>Curriculum delivery is progressing but <strong>needs acceleration</strong> to reach full completion</li>
                        </ul>
                    </div>
                    <div class="insight-panel blue">
                        <h4 style="color: #0D47A1;">Recommendations</h4>
                        <ul>
                            <li>Support <strong>full curriculum implementation</strong> through targeted follow-ups and resources</li>
                            <li>Encourage <strong>gender-balanced participation</strong>, especially for boys</li>
                            <li>Expand <strong>environmental initiative guidance</strong> to help clubs diversify and deepen impact</li>
                            <li>Continue investing in <strong>training and materials</strong>, which are clearly valued and effective</li>
                        </ul>
                    </div>
                </div>
            </div>

            <!-- ========== OVERALL INSIGHTS ========== -->
            <div id="schools-dash-overall-insights" style="display: none;">
                <div class="output-header" style="background: linear-gradient(135deg, #4A148C 0%, #6A1B9A 100%); color: #fff; padding: 25px 30px; border-radius: 12px; margin-bottom: 25px;">
                    <h2 style="margin: 0; font-size: 1.5em;">Overall Insights</h2>
                    <p style="margin: 8px 0 0; opacity: 0.9; font-size: 0.95em;">Cross-cutting findings across Schools Programme components</p>
                </div>

                <!-- Financial Limitations -->
                <div class="insight-card red">
                    <h3 style="color: #c62828;">Financial Limitations Dominate</h3>
                    <p>The most recurring theme is <strong>lack of financial resources</strong>. Schools frequently cited "cash" or "lack of funding" as the primary barrier to installing or completing water systems. This includes costs for tanks, gutters, plinths, and repairs.</p>
                </div>

                <!-- Infrastructure Gaps -->
                <div class="insight-card orange">
                    <h3 style="color: #e65100;">Infrastructure Gaps</h3>
                    <p>Many schools lack basic infrastructure such as <strong>storage tanks, gutters, or functional roofs</strong> for rainwater harvesting. Even when materials are provided, installation is often delayed due to lack of funds or technical support.</p>
                </div>

                <!-- Security and Vandalism -->
                <div class="insight-card orange">
                    <h3 style="color: #d84315;">Security and Vandalism</h3>
                    <p>Several schools face <strong>insecurity issues</strong>, including theft and vandalism of water infrastructure. The absence of perimeter fencing exacerbates these problems.</p>
                </div>

                <!-- Community Needs -->
                <div class="insight-card darkblue">
                    <h3 style="color: #0277BD;">Community Needs and Shared Use</h3>
                    <p>In some cases, water systems are shared with the <strong>local community</strong>, creating strain on limited resources and complicating maintenance responsibilities.</p>
                </div>

                <!-- Environmental Challenges -->
                <div class="insight-card brown">
                    <h3 style="color: #795548;">Environmental and Logistical Challenges</h3>
                    <p>Schools in <strong>dry regions</strong> or with <strong>unreliable water sources</strong> struggle more, even when infrastructure is present. This underscores the need for context-specific solutions.</p>
                </div>

                <!-- Positive Outcomes -->
                <div class="insight-card green">
                    <h3 style="color: #1B5E20;">Positive Outcomes</h3>
                    <ul style="padding-left: 20px;">
                        <li>A few schools reported <strong>successful installations</strong> that improved irrigation and water availability. These successes often involved community or parental support, highlighting the importance of local engagement.</li>
                        <li>A few schools report <strong>successful irrigation</strong> and <strong>crop watering</strong>, often linked to community or parental support.</li>
                        <li>Some schools express <strong>gratitude for support</strong> received, especially when water tanks help mitigate unreliable piped water.</li>
                    </ul>
                </div>

                <!-- Environmental Initiatives Insights -->
                <div class="insight-card green">
                    <h3 style="color: #2E7D32;">Environmental Initiatives Engagement</h3>
                    <div>
                        <p style="margin-bottom: 10px;"><strong>Widespread Engagement:</strong> A total of <strong>65 schools</strong> reported environmental initiatives, indicating strong engagement from youth clubs in environmental action.</p>
                        <h4 style="color: #1B5E20; margin: 10px 0 6px;">Dominant Themes:</h4>
                        <ul style="padding-left: 25px; margin-bottom: 10px;">
                            <li><strong>Tree Planting</strong> is the most common initiative, often linked to environmental conservation and climate resilience</li>
                            <li><strong>Farming</strong>, including vegetable gardens and crop cultivation (e.g., cassava, maize, sukumawiki), is a close second, suggesting a strong link between environmental clubs and food security or income generation</li>
                        </ul>
                        <h4 style="color: #1B5E20; margin: 10px 0 6px;">Emerging Practices:</h4>
                        <ul style="padding-left: 25px; margin-bottom: 10px;">
                            <li><strong>Waste Management</strong> and <strong>Water Conservation</strong> are less frequently mentioned but represent growing areas of interest</li>
                            <li>A few schools are exploring <strong>hygiene education</strong>, <strong>irrigation</strong>, and <strong>poultry farming</strong>, showing potential for diversification</li>
                        </ul>
                        <p style="margin-top: 8px; color: #666; font-style: italic;">Note: Many responses were vague or used unique phrasing, making them hard to categorize. This suggests a need for clearer guidance or standardized reporting formats.</p>
                    </div>
                </div>

                <!-- Key Challenges Summary -->
                <div class="insight-card amber">
                    <h3 style="color: #e65100;">Key Challenges Identified</h3>
                    <ul style="padding-left: 20px;">
                        <li><strong>Financial Constraints:</strong> Many schools cite lack of funds as a barrier to installing, maintaining, or repairing water systems (tanks, gutters, plinths)</li>
                        <li><strong>Security Issues:</strong> Insecurity, including theft and vandalism, is a recurring theme. Schools without perimeter fencing are particularly vulnerable</li>
                        <li><strong>Environmental Factors:</strong> Dry regions and unreliable water sources exacerbate maintenance challenges</li>
                        <li><strong>Infrastructure Gaps:</strong> Even when materials are provided, installation is delayed due to lack of technical expertise or incomplete infrastructure</li>
                        <li><strong>Community Pressure:</strong> Shared use of water systems with the community increases strain and complicates maintenance responsibilities</li>
                    </ul>
                </div>
            </div>

        </div>
        <!-- END SCHOOLS DASHBOARD SECTION -->

        <!-- ========================================================== -->
        <!-- ========== SEAWEED GROUP ASSESSMENT SECTION ============== -->
        <!-- ========================================================== -->
        <div id="seaweed-section" style="display: none; margin-top: 60px; padding-top: 40px; border-top: 3px solid #00695C;">

            <!-- HEADER -->
            <div class="header" style="margin-bottom: 30px; background: linear-gradient(135deg, #004D40 0%, #00695C 50%, #00897B 100%);">
                <h1>Seaweed Group Assessment</h1>
                <div class="header-subtitle">Seaweed Production, Value Addition & Commercialization — July 2025</div>
                <div class="header-meta">
                    <div class="meta-item">
                        <div class="meta-label">Groups Surveyed</div>
                        <div class="meta-value">19 Groups</div>
                    </div>
                    <div class="meta-item">
                        <div class="meta-label">Active Female Members</div>
                        <div class="meta-value">610 Women</div>
                    </div>
                    <div class="meta-item">
                        <div class="meta-label">Assessment Period</div>
                        <div class="meta-value">July 2025</div>
                    </div>
                </div>
            </div>

            <!-- INDICATOR 1100c LOGFRAME -->
            <div class="section" id="seaweed-logframe-section" style="margin-bottom: 30px;">
                <button class="collapsible-header" onclick="toggleCollapsible(this)">Seaweed Assessment — Program Target vs Result (Indicator 1100c)</button>
                <div class="collapsible-content">
                    <div class="highlight-box">
                        <h4>Indicator 1100c Performance</h4>
                        <p>Indicator 1100c tracks the number of seaweed groups undertaking <strong>regenerative and sustainable seaweed production</strong>, <strong>value addition</strong>, and <strong>commercialization</strong>. Of the 19 groups surveyed: <strong>17 groups</strong> (89.5%) practise regenerative/sustainable production, <strong>13 groups</strong> undertake value addition (mostly drying), and <strong>9 groups</strong> (47.4%) are actively selling seaweed or seaweed products.</p>
                    </div>
                    <table class="comparison-table">
                        <thead>
                            <tr>
                                <th style="width: 50%;">Indicator 1100c Component</th>
                                <th style="width: 15%;">Count</th>
                                <th style="width: 15%;">Source</th>
                                <th style="width: 20%;">Notes</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr style="background: #00695C; font-weight: 600;">
                                <td colspan="4"><strong style="color: white;">OUTPUT LEVEL — Seaweed Programme (1100-series)</strong></td>
                            </tr>
                            <tr>
                                <td><strong>Regenerative & sustainable seaweed production</strong></td>
                                <td><strong>17</strong></td>
                                <td>Section C.2</td>
                                <td>89.5% of all groups</td>
                            </tr>
                            <tr>
                                <td><strong>Seaweed production value addition</strong></td>
                                <td><strong>13</strong></td>
                                <td>Section B.2</td>
                                <td>Mostly drying (63.2%)</td>
                            </tr>
                            <tr>
                                <td><strong>Seaweed commercialization</strong></td>
                                <td><strong>9</strong></td>
                                <td>Section E.1</td>
                                <td>47.4% currently selling</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- SEAWEED SUB-TABS -->
            <div class="tabs-container" id="seaweed-tabs-container">
                <button class="tab-button active" onclick="showSeaweedTab(event, 'swtab-profile')">A. Group Profile</button>
                <button class="tab-button" onclick="showSeaweedTab(event, 'swtab-activities')">B. Activities</button>
                <button class="tab-button" onclick="showSeaweedTab(event, 'swtab-production')">C. Production & Sustainability</button>
                <button class="tab-button" onclick="showSeaweedTab(event, 'swtab-inputs')">D. Inputs & Support</button>
                <button class="tab-button" onclick="showSeaweedTab(event, 'swtab-commercial')">E. Commercialization</button>
                <button class="tab-button" onclick="showSeaweedTab(event, 'swtab-partnership')">F. Partnerships & Future</button>
                <button class="tab-button" onclick="showSeaweedTab(event, 'swtab-insights')">Summary & Insights</button>
                <button class="tab-button" onclick="showSeaweedTab(event, 'swtab-farmer-dashboard')">Farmer Dashboard</button>
            </div>

            <!-- ====== TAB A: GROUP PROFILE ====== -->
            <div id="swtab-profile" class="seaweed-tab-content active">
                <div class="section">
                    <div class="section-title">A. GROUP PROFILE</div>
                    <div class="highlight-box">
                        <h4>Profile Summary</h4>
                        <p>The majority of groups (42.1%) were formed between 2020–2022, indicating recent mobilization. <strong>94.7%</strong> of groups are women-led, and <strong>100%</strong> have formal leadership structures. Most groups meet weekly (73.7%), showing strong organizational engagement. Active female members total <strong>610</strong> across 19 groups (avg. 32.1 per group), with <strong>175 active male members</strong> (avg. 9.2 per group).</p>
                    </div>
                    <div class="charts-grid">
                        <div class="chart-wrapper">
                            <div class="chart-title">Groups by Year of Establishment</div>
                            <div class="chart-container"><canvas id="sw-chart-establishment"></canvas></div>
                            <div class="chart-insight">42.1% of groups formed in 2020–2022, with 15.8% from 2023 onwards — showing rapid recent uptake driven by the COSME project and climate change awareness.</div>
                        </div>
                        <div class="chart-wrapper">
                            <div class="chart-title">Women-Led Groups</div>
                            <div class="chart-container"><canvas id="sw-chart-women-led"></canvas></div>
                            <div class="chart-insight">94.7% of groups are led by women, and 100% have a formal leadership structure — demonstrating strong gender representation and organizational capacity.</div>
                        </div>
                        <div class="chart-wrapper">
                            <div class="chart-title">Meeting Frequency</div>
                            <div class="chart-container"><canvas id="sw-chart-meetings"></canvas></div>
                            <div class="chart-insight">73.7% meet weekly indicating high engagement levels. 26.3% meet monthly. No groups report irregular meetings.</div>
                        </div>
                        <div class="chart-wrapper">
                            <div class="chart-title">Active Members — Female vs Male (Summary Stats)</div>
                            <div class="chart-container"><canvas id="sw-chart-members"></canvas></div>
                            <div class="chart-insight">610 active female members (avg. 32.1/group) vs 175 active male members (avg. 9.2/group). Groups are predominantly driven by women, reflecting the project's focus on female empowerment.</div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- ====== TAB B: SEAWEED ACTIVITIES ====== -->
            <div id="swtab-activities" class="seaweed-tab-content" style="display: none;">
                <div class="section">
                    <div class="section-title">B. INVOLVEMENT IN SEAWEED ACTIVITIES</div>
                    <div class="highlight-box">
                        <h4>Activities Summary</h4>
                        <p><strong>89.5%</strong> of groups are actively involved in seaweed-related activities. Production (89.5%) and drying (63.2%) are the most common, while value addition (26.3%) and marketing (10.5%) are less prevalent. <strong>63.2%</strong> began seaweed activities from 2023 onwards, showing rapid uptake. Market opportunity (47.4%) and peer learning (36.8%) are the key motivators.</p>
                    </div>
                    <div class="charts-grid">
                        <div class="chart-wrapper">
                            <div class="chart-title">Type of Seaweed-Related Activity Undertaken</div>
                            <div class="chart-container"><canvas id="sw-chart-activity-types"></canvas></div>
                            <div class="chart-insight">Production (89.5%) and drying (63.2%) dominate. Value addition (26.3%) and marketing (10.5%) remain underdeveloped — a key gap for program intervention.</div>
                        </div>
                        <div class="chart-wrapper">
                            <div class="chart-title">Year Started Seaweed Activities</div>
                            <div class="chart-container"><canvas id="sw-chart-start-year"></canvas></div>
                            <div class="chart-insight">63.2% began from 2023 onwards, reflecting the COSME project's catalytic role. A significant number of these groups were recently mobilized, especially women-led groups.</div>
                        </div>
                        <div class="chart-wrapper">
                            <div class="chart-title">Motivation to Engage in Seaweed Activities</div>
                            <div class="chart-container"><canvas id="sw-chart-motivation"></canvas></div>
                            <div class="chart-insight">Market opportunity (47.4%) is the top driver, followed by peer learning (36.8%). Project support accounts for 15.8%, while government training shows zero uptake.</div>
                        </div>
                        <div class="chart-wrapper">
                            <div class="chart-title">Number of Ropes Owned by Groups</div>
                            <div class="chart-container"><canvas id="sw-chart-ropes"></canvas></div>
                            <div class="chart-insight">Total 27,689 ropes across 19 groups. 26.3% own 2,000+, while 15.8% have fewer than 100 — wide variation in production capacity. Average is 1,457 ropes per group.</div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- ====== TAB C: PRODUCTION & SUSTAINABILITY ====== -->
            <div id="swtab-production" class="seaweed-tab-content" style="display: none;">
                <div class="section">
                    <div class="section-title">C. SEAWEED PRODUCTION & SUSTAINABILITY PRACTICES</div>
                    <div class="highlight-box">
                        <h4>Production & Sustainability Summary</h4>
                        <p><strong>89.5%</strong> apply regenerative or sustainable practices, mostly trained by the COSME project (100%). Off-bottom method dominates (78.9%). However, <strong>94.7%</strong> face challenges — mainly environmental stresses, resource constraints, and technical capacity issues. <strong>78.9%</strong> report improved yield or quality after adopting sustainable practices. Production levels vary widely, with total harvest of <strong>96,086 kg</strong> across groups.</p>
                    </div>
                    <div class="charts-grid">
                        <div class="chart-wrapper">
                            <div class="chart-title">Seaweed Production Methods Used</div>
                            <div class="chart-container"><canvas id="sw-chart-methods"></canvas></div>
                            <div class="chart-insight">Off-bottom method dominates (78.9%), followed by double loop (15.8%) and long lines (10.5%). COSME project has standardized training around proven techniques.</div>
                        </div>
                        <div class="chart-wrapper">
                            <div class="chart-title">Sustainable Practices Adoption & Training Source</div>
                            <div class="chart-container"><canvas id="sw-chart-sustainable"></canvas></div>
                            <div class="chart-insight">89.5% apply regenerative practices, all trained by the COSME project. No other training provider — demonstrating the project's central role in sustainability adoption.</div>
                        </div>
                        <div class="chart-wrapper">
                            <div class="chart-title">Challenges in Applying Sustainable Practices</div>
                            <div class="chart-container"><canvas id="sw-chart-challenges"></canvas></div>
                            <div class="chart-insight">Resource constraints (~30 mentions) and environmental challenges (~25) are the top barriers. Technical capacity issues (~15), health & safety (~10), and mobility (~10) also significant.</div>
                        </div>
                        <div class="chart-wrapper">
                            <div class="chart-title">Changes in Yield/Quality After Adoption</div>
                            <div class="chart-container"><canvas id="sw-chart-yield"></canvas></div>
                            <div class="chart-insight">78.9% report improved yield or quality after adopting sustainable practices. Only 15.8% saw no change, and 5.3% are unsure.</div>
                        </div>
                        <div class="chart-wrapper">
                            <div class="chart-title">Seaweed Produced in Last Harvest (kg)</div>
                            <div class="chart-container"><canvas id="sw-chart-harvest"></canvas></div>
                            <div class="chart-insight">36.8% report zero production in last harvest. Total output: 96,086 kg, average 5,057 kg/group. One group produced 31,000 kg — far above the average of ~4,000 kg.</div>
                        </div>
                        <div class="chart-wrapper">
                            <div class="chart-title">Production Records Keeping</div>
                            <div class="chart-container"><canvas id="sw-chart-records"></canvas></div>
                            <div class="chart-insight">63.2% keep harvest logs. 36.8% do not — a gap that undermines accurate production tracking and market negotiation capabilities.</div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- ====== TAB D: INPUTS & TECHNICAL SUPPORT ====== -->
            <div id="swtab-inputs" class="seaweed-tab-content" style="display: none;">
                <div class="section">
                    <div class="section-title">D. ACCESS TO INPUTS AND TECHNICAL SUPPORT</div>
                    <div class="highlight-box">
                        <h4>Inputs & Support Summary</h4>
                        <p>All groups received ropes and safety kits (100%), and <strong>89.5%</strong> received seedlings. However, only <strong>15.8%</strong> found inputs sufficient — most cite quantity and distribution issues. All received seaweed farming training, but fewer received business (26.3%), marketing (21.1%), or quality control (26.3%) support. Only <strong>31.6%</strong> received business development assistance.</p>
                    </div>
                    <div class="charts-grid">
                        <div class="chart-wrapper">
                            <div class="chart-title">Inputs Received in Past 12 Months (by Type)</div>
                            <div class="chart-container"><canvas id="sw-chart-inputs"></canvas></div>
                            <div class="chart-insight">100% received ropes and safety kits. 89.5% received seedlings. Only 5.3% received drying racks, and no groups received boats — critical infrastructure gap.</div>
                        </div>
                        <div class="chart-wrapper">
                            <div class="chart-title">Input Adequacy Assessment</div>
                            <div class="chart-container"><canvas id="sw-chart-adequacy"></canvas></div>
                            <div class="chart-insight">Only 15.8% found inputs sufficient. 84.2% cite insufficiency due to quantity issues (~20), distribution problems (~10), quality issues (~8), and timing issues (~5).</div>
                        </div>
                        <div class="chart-wrapper">
                            <div class="chart-title">Technical Training Received (by Type)</div>
                            <div class="chart-container"><canvas id="sw-chart-training"></canvas></div>
                            <div class="chart-insight">100% received seaweed farming training. Business (26.3%), quality control (26.3%), and marketing (21.1%) training reach fewer groups — a critical capacity gap.</div>
                        </div>
                        <div class="chart-wrapper">
                            <div class="chart-title">Additional Support Needs Identified</div>
                            <div class="chart-container"><canvas id="sw-chart-support-needs"></canvas></div>
                            <div class="chart-insight">Tools & equipment (~35 mentions) and training (~30) are the top needs. Infrastructure (~25) and market access (~20) follow. Financial support (~10) is less frequently cited.</div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- ====== TAB E: COMMERCIALIZATION ====== -->
            <div id="swtab-commercial" class="seaweed-tab-content" style="display: none;">
                <div class="section">
                    <div class="section-title">E. COMMERCIALIZATION AND MARKET ACCESS</div>
                    <div class="highlight-box">
                        <h4>Commercialization Summary</h4>
                        <p><strong>47.4%</strong> of groups are currently selling seaweed products, mostly dried seaweed (100% of sellers) and raw seaweed/soap (55.6% each). Sales volume ranges widely — one group sold up to <strong>27,000 kg</strong>. Average price is <strong>KES 81.1/kg</strong> (range 30–300), with only 55.6% negotiating prices. Transport (90%), demand (80%), and pricing (60%) are the top commercialization challenges. Only <strong>10%</strong> have branding strategies.</p>
                    </div>
                    <div class="charts-grid">
                        <div class="chart-wrapper">
                            <div class="chart-title">Groups Selling Seaweed Products</div>
                            <div class="chart-container"><canvas id="sw-chart-selling"></canvas></div>
                            <div class="chart-insight">47.4% are currently selling. 52.6% are not yet commercialized — despite production engagement, market linkages remain a bottleneck in the value chain.</div>
                        </div>
                        <div class="chart-wrapper">
                            <div class="chart-title">Products Sold by Type (% of Selling Groups)</div>
                            <div class="chart-container"><canvas id="sw-chart-products"></canvas></div>
                            <div class="chart-insight">Dried seaweed (100%) dominates. Soap (55.6%) and raw seaweed (55.6%) follow. Gel (44.4%), shampoo (33.3%), and packaged products (11.1%) show value addition potential.</div>
                        </div>
                        <div class="chart-wrapper">
                            <div class="chart-title">Market Types Used</div>
                            <div class="chart-container"><canvas id="sw-chart-markets"></canvas></div>
                            <div class="chart-insight">Local markets (66.7%) and cooperative sales (44.4%) dominate. No exports or formal contracts — mostly local and direct buyers. Market linkages remain limited.</div>
                        </div>
                        <div class="chart-wrapper">
                            <div class="chart-title">Commercialization Challenges (% of Selling Groups)</div>
                            <div class="chart-container"><canvas id="sw-chart-comm-challenges"></canvas></div>
                            <div class="chart-insight">Transport (90%), demand (80%), and pricing (60%) are major barriers. Packaging (40%) and certification (30%) also cited. Only 10% have branding strategies.</div>
                        </div>
                        <div class="chart-wrapper">
                            <div class="chart-title">Seaweed Price Distribution (KES/kg)</div>
                            <div class="chart-container"><canvas id="sw-chart-price"></canvas></div>
                            <div class="chart-insight">Most receive KES 50/kg (66.7%). Range: 30–300 KES/kg. Average: KES 81.1/kg. Only 55.6% negotiate prices — the rest accept buyer-fixed rates.</div>
                        </div>
                        <div class="chart-wrapper">
                            <div class="chart-title">Impact on Group Income & Price Negotiation</div>
                            <div class="chart-container"><canvas id="sw-chart-income-impact"></canvas></div>
                            <div class="chart-insight">70% report improved income/savings from commercialization. 55.6% negotiate prices, 44.4% accept buyer-fixed rates. Negotiation capacity is low but improving.</div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- ====== TAB F: PARTNERSHIPS & FUTURE ====== -->
            <div id="swtab-partnership" class="seaweed-tab-content" style="display: none;">
                <div class="section">
                    <div class="section-title">F. PARTNERSHIPS, SUSTAINABILITY & FUTURE PLANS</div>
                    <div class="highlight-box">
                        <h4>Partnerships & Future Plans Summary</h4>
                        <p>NGOs and government are the key partners (63.2% each). Only <strong>one group</strong> has a formal agreement with buyers (5.3%). Future plans focus on value addition (~30 mentions), commercial expansion (~25), and training (~20). Critical needs for scaling include tools & equipment (~35), training & knowledge (~30), infrastructure (~25), and market access (~20).</p>
                    </div>
                    <div class="charts-grid">
                        <div class="chart-wrapper">
                            <div class="chart-title">Partners Involved in Seaweed Production</div>
                            <div class="chart-container"><canvas id="sw-chart-partners"></canvas></div>
                            <div class="chart-insight">NGOs and government each support 63.2% of groups. Cooperatives (31.6%) are growing. Private sector (5.3%) and formal agreements (5.3%) remain negligible.</div>
                        </div>
                        <div class="chart-wrapper">
                            <div class="chart-title">Future Plans in Seaweed Value Chain</div>
                            <div class="chart-container"><canvas id="sw-chart-future"></canvas></div>
                            <div class="chart-insight">Value addition (~30) and commercial expansion (~25) are top priorities. Training, infrastructure, and youth/women empowerment also featured prominently in group aspirations.</div>
                        </div>
                        <div class="chart-wrapper">
                            <div class="chart-title">Critical Needs to Scale Activities</div>
                            <div class="chart-container"><canvas id="sw-chart-critical-needs"></canvas></div>
                            <div class="chart-insight">Tools & equipment (~35) and training (~30) are the most cited. Infrastructure (~25) and market access (~20) follow. Financial support (~10) is less frequently mentioned.</div>
                        </div>
                        <div class="chart-wrapper">
                            <div class="chart-title">Formal Agreements with Buyers</div>
                            <div class="chart-container"><canvas id="sw-chart-agreements"></canvas></div>
                            <div class="chart-insight">Only 5.3% (1 group) have formal agreements — a critical gap. 94.7% lack formalized market relationships, leaving them vulnerable to price fluctuations and unreliable demand.</div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- ====== TAB: SUMMARY & INSIGHTS ====== -->
            <div id="swtab-insights" class="seaweed-tab-content" style="display: none;">
                <div class="section">
                    <div class="section-title">SUMMARY, INSIGHTS & RECOMMENDATIONS</div>

                    <!-- A. SUMMARY -->
                    <div class="highlight-box" style="margin-bottom: 25px;">
                        <h4>A. Summary</h4>
                        <p>The assessment of 19 seaweed groups in rural Kwale reveals a vibrant and rapidly growing movement, largely driven by women. Nearly all groups are women-led and meet regularly, with most convening weekly, indicating strong cohesion and organizational discipline. A significant number of these groups were established in the last five years, and the majority began seaweed-related activities only recently, particularly from 2023 onwards. This points to the catalytic role of the climate change project in mobilizing communities around seaweed farming.</p>
                        <p>Seaweed production is the most common activity, followed by drying and, to a lesser extent, value addition and marketing. While 89% of groups are actively engaged in seaweed work, only 47% are currently selling seaweed or its products. The most commonly sold items are dried seaweed and soap, with some groups venturing into gels and shampoos. However, commercialization remains limited, with most sales occurring in local markets, and only one group reporting a formal agreement with buyers.</p>
                        <p>Sustainability practices are widely adopted, with 89% of groups applying regenerative techniques such as off-bottom and double loop techniques. All training on these practices has been provided by the COSME project, and nearly all groups report challenges in implementation. These include environmental threats like strong waves and pests to logistical issues such as lack of boats and distant farm sites.</p>
                        <p>Production levels vary widely, with some groups reporting zero harvests and others producing up to 31,000 kg. Record keeping is practised by about two-thirds of the groups, and most reported improved yields after adopting sustainable practices. However, input adequacy is a major concern. While all groups received ropes and safety kits, only 15.8% feel the inputs were sufficient.</p>
                        <p>Training has focused heavily on technical farming skills, but support in business development, marketing, and quality control is far less common. This gap is reflected in the limited commercialization outcomes. Pricing is often fixed by buyers, and only half of the groups negotiate rates. Branding and packaging strategies are rare, and certification is virtually non-existent.</p>
                        <p>Looking ahead, groups express strong ambitions to expand their operations. Their future plans include scaling up production, engaging in value addition, building infrastructure, and empowering women and youth. To achieve these goals, they identify critical needs: better tools and equipment, more training, improved infrastructure, market access, and financial support.</p>
                    </div>

                    <!-- B. INSIGHTS -->
                    <div class="insights-grid" style="margin-bottom: 25px;">
                        <div class="insight-card teal">
                            <h3>Key Insights</h3>
                            <ul style="padding-left: 20px;">
                                <li><strong>High engagement, low adequacy:</strong> While nearly all respondents received some form of support, only a minority found it sufficient. This suggests a gap between provision and actual needs.</li>
                                <li><strong>Strong agency gains:</strong> The high levels of reported confidence in decision-making and public speaking point to meaningful empowerment outcomes, even in the face of resource constraints.</li>
                                <li><strong>Economic diversification:</strong> Investments in education, livestock, and small businesses indicate that seaweed farming is a catalyst for broader economic activity.</li>
                                <li><strong>Environmental and social duality:</strong> Many women are involved in mangrove restoration and eco-tourism alongside seaweed farming, aligning with nature-based solutions. Yet, social resistance and health risks persist.</li>
                                <li><strong>Outliers:</strong> One group sold <strong>27,000 kg</strong> of seaweed — far above the average (~4,000 kg). Only one group has a <strong>formal agreement</strong> with buyers. Some groups report <strong>zero production</strong> despite having ropes and farm sites.</li>
                                <li><strong>Record keeping and financial literacy:</strong> While 63% keep records and most received technical training, this hasn't translated into widespread savings or reinvestment.</li>
                            </ul>
                        </div>

                        <div class="insight-card blue">
                            <h3>Notable Patterns</h3>
                            <ul style="padding-left: 20px;">
                                <li><strong>Rapid Growth:</strong> Most groups started seaweed activities recently (2023+), showing strong program uptake.</li>
                                <li><strong>Women's Leadership:</strong> Near-universal women-led structures suggest strong gender inclusion.</li>
                                <li><strong>Sustainability Adoption:</strong> High uptake of regenerative practices, but challenges persist.</li>
                                <li><strong>Training Gaps:</strong> While technical training is widespread, business and marketing support is limited.</li>
                                <li><strong>Commercialization Bottleneck:</strong> Despite production, less than half are selling, and few have formal market linkages.</li>
                            </ul>
                        </div>
                    </div>

                    <!-- C. RECOMMENDATIONS -->
                    <div class="insight-card green" style="margin-bottom: 25px;">
                        <h3>Recommendations for Program Improvement</h3>
                        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 20px; margin-top: 15px;">
                            <div>
                                <h4 style="color: #1b5e20; margin-bottom: 8px;">1. Strengthen Market Linkages</h4>
                                <ul style="padding-left: 18px; font-size: 0.92em;">
                                    <li>Facilitate <strong>formal contracts</strong> with buyers and cooperatives</li>
                                    <li>Support <strong>branding, packaging, and certification</strong> to access higher-value markets</li>
                                </ul>
                            </div>
                            <div>
                                <h4 style="color: #1b5e20; margin-bottom: 8px;">2. Expand Business & Marketing Training</h4>
                                <ul style="padding-left: 18px; font-size: 0.92em;">
                                    <li>Include modules on <strong>pricing strategies, negotiation, and entrepreneurship</strong></li>
                                    <li>Promote <strong>peer-to-peer learning</strong> and exchange visits with successful groups</li>
                                </ul>
                            </div>
                            <div>
                                <h4 style="color: #1b5e20; margin-bottom: 8px;">3. Improve Input Distribution</h4>
                                <ul style="padding-left: 18px; font-size: 0.92em;">
                                    <li>Ensure <strong>equitable and sufficient distribution</strong> of tools and materials</li>
                                    <li>Introduce <strong>feedback mechanisms</strong> to monitor input adequacy and timing</li>
                                </ul>
                            </div>
                            <div>
                                <h4 style="color: #1b5e20; margin-bottom: 8px;">4. Invest in Infrastructure</h4>
                                <ul style="padding-left: 18px; font-size: 0.92em;">
                                    <li>Prioritize <strong>drying sheds, storage facilities, and transport solutions</strong></li>
                                    <li>Explore <strong>community-owned boats</strong> or shared logistics to reduce post-harvest losses</li>
                                </ul>
                            </div>
                            <div>
                                <h4 style="color: #1b5e20; margin-bottom: 8px;">5. Enhance Financial Access</h4>
                                <ul style="padding-left: 18px; font-size: 0.92em;">
                                    <li>Link groups to <strong>microfinance, VSLA schemes, or grant opportunities</strong></li>
                                    <li>Provide <strong>seed capital</strong> for value addition and commercialization</li>
                                </ul>
                            </div>
                            <div>
                                <h4 style="color: #1b5e20; margin-bottom: 8px;">6. Deepen Sustainability Support</h4>
                                <ul style="padding-left: 18px; font-size: 0.92em;">
                                    <li>Address technical gaps with more <strong>localized and practical training</strong></li>
                                    <li>Support <strong>site feasibility studies</strong> and adaptive farming techniques</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- ====== FARMER DASHBOARD (5 pages) ====== -->
            <div id="swtab-farmer-dashboard" class="seaweed-tab-content" style="display: none;">

                <!-- Farmer Dashboard Header -->
                <div class="output-header" style="background: linear-gradient(135deg, #004D40 0%, #00695C 50%, #00897B 100%); color: #fff; padding: 25px 30px; border-radius: 12px; margin-bottom: 20px;">
                    <h2 style="margin: 0; font-size: 1.5em;">Seaweed Farmer-Level Data Dashboard</h2>
                    <p style="margin: 8px 0 0; opacity: 0.9; font-size: 0.95em;">Individual farmer monitoring — Ropes, Production, Challenges & Geolocation | Kilifi County</p>
                </div>

                <!-- Global Filters -->
                <div style="display: flex; flex-wrap: wrap; gap: 12px; margin-bottom: 20px; padding: 15px; background: #f5f5f5; border-radius: 10px; align-items: center;">
                    <label style="font-weight: 600; color: #004D40;">Filters:</label>
                    <select id="sfd-filter-group" onchange="applyFarmerFilters()" style="padding: 6px 12px; border-radius: 6px; border: 1px solid #ccc; font-size: 0.9em;">
                        <option value="all">All Groups</option>
                    </select>
                    <select id="sfd-filter-challenge" onchange="applyFarmerFilters()" style="padding: 6px 12px; border-radius: 6px; border: 1px solid #ccc; font-size: 0.9em;">
                        <option value="all">All Farmers</option>
                        <option value="yes">Reported Challenge</option>
                        <option value="no">No Challenge</option>
                    </select>
                    <button onclick="resetFarmerFilters()" style="padding: 6px 14px; border-radius: 6px; border: none; background: #00695C; color: #fff; cursor: pointer; font-size: 0.9em;">Reset</button>
                    <span id="sfd-farmer-count" style="margin-left: auto; font-weight: 600; color: #004D40;"></span>
                </div>

                <!-- Page Switcher -->
                <div class="tabs-container" id="sfd-page-tabs" style="margin-bottom: 20px;">
                    <button class="tab-button active" onclick="showFarmerPage(event, 'sfd-page-overview')" style="background: #004D40; color: #fff;">1. Overview</button>
                    <button class="tab-button" onclick="showFarmerPage(event, 'sfd-page-production')">2. Production</button>
                    <button class="tab-button" onclick="showFarmerPage(event, 'sfd-page-ropes')">3. Rope Monitoring</button>
                    <button class="tab-button" onclick="showFarmerPage(event, 'sfd-page-challenges')">4. Challenges</button>
                    <button class="tab-button" onclick="showFarmerPage(event, 'sfd-page-map')">5. Farm Map</button>
                    <button class="tab-button" onclick="showFarmerPage(event, 'sfd-page-profiling')">6. Farmer Profiling</button>
                </div>

                <!-- ============ PAGE 1: OVERVIEW & KEY METRICS ============ -->
                <div id="sfd-page-overview" class="sfd-page active">
                    <div class="section">
                        <div class="section-title">OVERVIEW & KEY METRICS</div>

                        <!-- KPI Cards Row -->
                        <div class="kpi-grid" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(160px, 1fr)); gap: 12px; margin-bottom: 25px;">
                            <div class="kpi-card up">
                                <div class="kpi-label" style="font-size: 0.8em; color: #666;">Total Ropes Installed</div>
                                <div class="kpi-value" id="sfd-kpi-ropes-installed" style="font-size: 1.6em; font-weight: 700; color: #004D40;">—</div>
                                <div class="kpi-change" style="color: #00897B; font-size: 0.8em;">Ocean + Home</div>
                            </div>
                            <div class="kpi-card">
                                <div class="kpi-label" style="font-size: 0.8em; color: #666;">Total Target Ropes</div>
                                <div class="kpi-value" id="sfd-kpi-target-ropes" style="font-size: 1.6em; font-weight: 700; color: #1565C0;">—</div>
                                <div class="kpi-change" style="color: #666; font-size: 0.8em;">Planned target</div>
                            </div>
                            <div class="kpi-card">
                                <div class="kpi-label" style="font-size: 0.8em; color: #666;">Total Rope Gap</div>
                                <div class="kpi-value" id="sfd-kpi-rope-gap" style="font-size: 1.6em; font-weight: 700; color: #C62828;">—</div>
                                <div class="kpi-change" style="color: #C62828; font-size: 0.8em;">Target − Actual</div>
                            </div>
                            <div class="kpi-card up">
                                <div class="kpi-label" style="font-size: 0.8em; color: #666;">Total Wet KG</div>
                                <div class="kpi-value" id="sfd-kpi-wet-kg" style="font-size: 1.6em; font-weight: 700; color: #00897B;">—</div>
                                <div class="kpi-change" style="color: #00897B; font-size: 0.8em;">Wet harvest</div>
                            </div>
                            <div class="kpi-card up">
                                <div class="kpi-label" style="font-size: 0.8em; color: #666;">Total Dried KG</div>
                                <div class="kpi-value" id="sfd-kpi-dried-kg" style="font-size: 1.6em; font-weight: 700; color: #2E7D32;">—</div>
                                <div class="kpi-change" style="color: #2E7D32; font-size: 0.8em;">Dried harvest</div>
                            </div>
                            <div class="kpi-card up">
                                <div class="kpi-label" style="font-size: 0.8em; color: #666;">Total Production KG</div>
                                <div class="kpi-value" id="sfd-kpi-total-kg" style="font-size: 1.6em; font-weight: 700; color: #004D40;">—</div>
                                <div class="kpi-change" style="color: #004D40; font-size: 0.8em;">Wet + Dried</div>
                            </div>
                            <div class="kpi-card">
                                <div class="kpi-label" style="font-size: 0.8em; color: #666;">% Target Achieved</div>
                                <div class="kpi-value" id="sfd-kpi-pct-target" style="font-size: 1.6em; font-weight: 700; color: #EF6C00;">—</div>
                                <div class="kpi-change" style="color: #EF6C00; font-size: 0.8em;">Ropes vs Target</div>
                            </div>
                        </div>

                        <!-- Charts Row -->
                        <div class="charts-grid">
                            <div class="chart-wrapper">
                                <div class="chart-title">Ropes Installed vs Target by Group</div>
                                <div class="chart-container" style="height: 350px;"><canvas id="sfd-chart-ropes-vs-target"></canvas></div>
                                <div class="chart-insight">Compares actual total ropes installed against planned targets per group. Groups below target indicate rope installation gaps requiring attention.</div>
                            </div>
                            <div class="chart-wrapper">
                                <div class="chart-title">Production Share by Group (Total KG)</div>
                                <div class="chart-container" style="height: 350px;"><canvas id="sfd-chart-prod-share"></canvas></div>
                                <div class="chart-insight">Proportional contribution of each group to total seaweed production. Identifies which cooperatives drive the bulk of output.</div>
                            </div>
                        </div>

                        <!-- Top 10 Farmers Table -->
                        <div style="margin-top: 25px;">
                            <h4 style="color: #004D40; margin-bottom: 10px;">Top 10 Farmers by Total Production (KG)</h4>
                            <div style="overflow-x: auto;">
                                <table class="comparison-table" id="sfd-top10-table">
                                    <thead>
                                        <tr><th>#</th><th>Group</th><th>Member</th><th>Ropes Total</th><th>Target</th><th>Gap</th><th>Total KG</th></tr>
                                    </thead>
                                    <tbody></tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- ============ PAGE 2: PRODUCTION ANALYSIS ============ -->
                <div id="sfd-page-production" class="sfd-page" style="display: none;">
                    <div class="section">
                        <div class="section-title">PRODUCTION ANALYSIS</div>

                        <!-- Summary Cards -->
                        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(220px, 1fr)); gap: 15px; margin-bottom: 25px;">
                            <div class="kpi-card up">
                                <div class="kpi-label" style="font-size: 0.8em; color: #666;">Best Producing Group</div>
                                <div class="kpi-value" id="sfd-best-group" style="font-size: 1.1em; font-weight: 700; color: #1B5E20;">—</div>
                                <div class="kpi-change" id="sfd-best-group-kg" style="color: #2E7D32; font-size: 0.85em;">—</div>
                            </div>
                            <div class="kpi-card">
                                <div class="kpi-label" style="font-size: 0.8em; color: #666;">Lowest Producing Group</div>
                                <div class="kpi-value" id="sfd-worst-group" style="font-size: 1.1em; font-weight: 700; color: #C62828;">—</div>
                                <div class="kpi-change" id="sfd-worst-group-kg" style="color: #C62828; font-size: 0.85em;">—</div>
                            </div>
                            <div class="kpi-card">
                                <div class="kpi-label" style="font-size: 0.8em; color: #666;">Total Farmers</div>
                                <div class="kpi-value" id="sfd-total-farmers" style="font-size: 1.6em; font-weight: 700; color: #004D40;">—</div>
                                <div class="kpi-change" style="color: #666; font-size: 0.85em;">Distinct members</div>
                            </div>
                            <div class="kpi-card">
                                <div class="kpi-label" style="font-size: 0.8em; color: #666;">Avg Production/Farmer</div>
                                <div class="kpi-value" id="sfd-avg-prod" style="font-size: 1.6em; font-weight: 700; color: #00897B;">—</div>
                                <div class="kpi-change" style="color: #00897B; font-size: 0.85em;">KG per farmer</div>
                            </div>
                        </div>

                        <!-- Charts -->
                        <div class="charts-grid">
                            <div class="chart-wrapper full-width">
                                <div class="chart-title">Wet KG, Dried KG & Total KG by Group</div>
                                <div class="chart-container" style="height: 380px;"><canvas id="sfd-chart-prod-by-group"></canvas></div>
                                <div class="chart-insight">Multi-series comparison of wet, dried and total production across groups. Drying ratio indicates value addition capacity.</div>
                            </div>
                            <div class="chart-wrapper">
                                <div class="chart-title">Average Ropes per Farmer by Group</div>
                                <div class="chart-container" style="height: 320px;"><canvas id="sfd-chart-avg-ropes"></canvas></div>
                                <div class="chart-insight">Average rope holding per farmer in each group — indicates individual farmer capacity and resource distribution equity.</div>
                            </div>
                            <div class="chart-wrapper">
                                <div class="chart-title">Production Distribution (Farmer Histogram)</div>
                                <div class="chart-container" style="height: 320px;"><canvas id="sfd-chart-prod-histogram"></canvas></div>
                                <div class="chart-insight">Distribution of individual farmer production levels — highlights the skew between high and low producers.</div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- ============ PAGE 3: ROPE INSTALLATION MONITORING ============ -->
                <div id="sfd-page-ropes" class="sfd-page" style="display: none;">
                    <div class="section">
                        <div class="section-title">ROPE INSTALLATION MONITORING</div>

                        <!-- KPI -->
                        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px; margin-bottom: 25px;">
                            <div class="kpi-card">
                                <div class="kpi-label" style="font-size: 0.8em; color: #666;">Total Rope Gap</div>
                                <div class="kpi-value" id="sfd-rope-gap-kpi" style="font-size: 1.8em; font-weight: 700; color: #C62828;">—</div>
                                <div class="kpi-change" style="color: #C62828; font-size: 0.85em;">Ropes still needed</div>
                            </div>
                            <div class="kpi-card">
                                <div class="kpi-label" style="font-size: 0.8em; color: #666;">Ropes in Ocean</div>
                                <div class="kpi-value" id="sfd-ropes-ocean" style="font-size: 1.8em; font-weight: 700; color: #0277BD;">—</div>
                                <div class="kpi-change" style="color: #0277BD; font-size: 0.85em;">Currently deployed</div>
                            </div>
                            <div class="kpi-card">
                                <div class="kpi-label" style="font-size: 0.8em; color: #666;">Ropes at Home</div>
                                <div class="kpi-value" id="sfd-ropes-home" style="font-size: 1.8em; font-weight: 700; color: #EF6C00;">—</div>
                                <div class="kpi-change" style="color: #EF6C00; font-size: 0.85em;">Stored / unused</div>
                            </div>
                            <div class="kpi-card">
                                <div class="kpi-label" style="font-size: 0.8em; color: #666;">% Target Achieved</div>
                                <div class="kpi-value" id="sfd-rope-pct" style="font-size: 1.8em; font-weight: 700; color: #00897B;">—</div>
                                <div class="kpi-change" style="color: #00897B; font-size: 0.85em;">Overall progress</div>
                            </div>
                        </div>

                        <!-- Charts -->
                        <div class="charts-grid">
                            <div class="chart-wrapper">
                                <div class="chart-title">Rope Gap by Group</div>
                                <div class="chart-container" style="height: 350px;"><canvas id="sfd-chart-gap-by-group"></canvas></div>
                                <div class="chart-insight">Groups with the largest gaps between target and actual ropes — prioritize these for additional rope distribution.</div>
                            </div>
                            <div class="chart-wrapper">
                                <div class="chart-title">Target vs Actual Ropes (Scatter by Farmer)</div>
                                <div class="chart-container" style="height: 350px;"><canvas id="sfd-chart-scatter-ropes"></canvas></div>
                                <div class="chart-insight">Each point = one farmer. Points below the diagonal line have fewer ropes than targeted. Hover for details.</div>
                            </div>
                        </div>

                        <!-- Top 20 Gap Table -->
                        <div style="margin-top: 25px;">
                            <h4 style="color: #C62828; margin-bottom: 10px;">Top 20 Farmers with Highest Rope Gap</h4>
                            <div style="overflow-x: auto;">
                                <table class="comparison-table" id="sfd-gap-table">
                                    <thead>
                                        <tr><th>#</th><th>Group</th><th>Member</th><th>Target</th><th>Actual</th><th>Gap</th><th>Total KG</th></tr>
                                    </thead>
                                    <tbody></tbody>
                                </table>
                            </div>
                        </div>

                        <!-- % Target Achieved by Group -->
                        <div class="charts-grid" style="margin-top: 25px;">
                            <div class="chart-wrapper full-width">
                                <div class="chart-title">% Target Ropes Achieved by Group</div>
                                <div class="chart-container" style="height: 320px;"><canvas id="sfd-chart-pct-by-group"></canvas></div>
                                <div class="chart-insight">Percentage of rope targets met by each group. Groups below 50% need urgent intervention to meet production goals.</div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- ============ PAGE 4: CHALLENGES & FIELD OBSERVATIONS ============ -->
                <div id="sfd-page-challenges" class="sfd-page" style="display: none;">
                    <div class="section">
                        <div class="section-title">CHALLENGES & FIELD OBSERVATIONS</div>

                        <!-- KPI -->
                        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(220px, 1fr)); gap: 15px; margin-bottom: 25px;">
                            <div class="kpi-card">
                                <div class="kpi-label" style="font-size: 0.8em; color: #666;">% Farmers Reporting Challenges</div>
                                <div class="kpi-value" id="sfd-pct-challenges" style="font-size: 1.8em; font-weight: 700; color: #C62828;">—</div>
                                <div class="kpi-change" style="color: #C62828; font-size: 0.85em;">At least one challenge</div>
                            </div>
                            <div class="kpi-card">
                                <div class="kpi-label" style="font-size: 0.8em; color: #666;">Farmers with Challenges</div>
                                <div class="kpi-value" id="sfd-num-challenges" style="font-size: 1.8em; font-weight: 700; color: #EF6C00;">—</div>
                                <div class="kpi-change" style="color: #666; font-size: 0.85em;">out of total farmers</div>
                            </div>
                            <div class="kpi-card">
                                <div class="kpi-label" style="font-size: 0.8em; color: #666;">Top Challenge Category</div>
                                <div class="kpi-value" id="sfd-top-challenge" style="font-size: 1.1em; font-weight: 700; color: #004D40;">—</div>
                                <div class="kpi-change" id="sfd-top-challenge-n" style="color: #666; font-size: 0.85em;">—</div>
                            </div>
                        </div>

                        <!-- Charts -->
                        <div class="charts-grid">
                            <div class="chart-wrapper">
                                <div class="chart-title">Challenge Categories (Number of Farmers)</div>
                                <div class="chart-container" style="height: 380px;"><canvas id="sfd-chart-challenge-cats"></canvas></div>
                                <div class="chart-insight">Categorized challenges from farmer free-text reports. Multiple categories may apply per farmer.</div>
                            </div>
                            <div class="chart-wrapper">
                                <div class="chart-title">Challenge Prevalence by Group</div>
                                <div class="chart-container" style="height: 380px;"><canvas id="sfd-chart-challenge-by-group"></canvas></div>
                                <div class="chart-insight">Percentage of farmers in each group who reported at least one challenge. Identifies groups that need more support.</div>
                            </div>
                        </div>

                        <!-- Challenges Detail Table -->
                        <div style="margin-top: 25px;">
                            <h4 style="color: #004D40; margin-bottom: 10px;">Farmer Challenges Detail</h4>
                            <div style="overflow-x: auto; max-height: 500px; overflow-y: auto;">
                                <table class="comparison-table" id="sfd-challenges-table">
                                    <thead style="position: sticky; top: 0;">
                                        <tr><th>#</th><th>Group</th><th>Member</th><th>Challenges</th><th>Total KG</th></tr>
                                    </thead>
                                    <tbody></tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- ============ PAGE 5: GEO-MAP ============ -->
                <div id="sfd-page-map" class="sfd-page" style="display: none;">
                    <div class="section">
                        <div class="section-title">GEO-MAP OF SEAWEED FARMS</div>

                        <!-- Map Summary Cards -->
                        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px; margin-bottom: 20px;">
                            <div class="kpi-card">
                                <div class="kpi-label" style="font-size: 0.8em; color: #666;">Groups on Map</div>
                                <div class="kpi-value" id="sfd-map-groups" style="font-size: 1.8em; font-weight: 700; color: #004D40;">—</div>
                            </div>
                            <div class="kpi-card">
                                <div class="kpi-label" style="font-size: 0.8em; color: #666;">Farmers Mapped</div>
                                <div class="kpi-value" id="sfd-map-farmers" style="font-size: 1.8em; font-weight: 700; color: #00897B;">—</div>
                            </div>
                            <div class="kpi-card">
                                <div class="kpi-label" style="font-size: 0.8em; color: #666;">Total Production (Filtered)</div>
                                <div class="kpi-value" id="sfd-map-production" style="font-size: 1.6em; font-weight: 700; color: #1B5E20;">—</div>
                            </div>
                        </div>

                        <!-- Map Container -->
                        <div id="sfd-map-container" style="width: 100%; height: 500px; border-radius: 12px; overflow: hidden; border: 2px solid #00897B; position: relative; background: #e8f5e9;">
                            <canvas id="sfd-map-canvas" style="width: 100%; height: 100%;"></canvas>
                            <div id="sfd-map-tooltip" style="display:none; position:absolute; background: rgba(0,0,0,0.85); color:#fff; padding:8px 12px; border-radius:6px; font-size:0.85em; pointer-events:none; z-index:100; max-width:250px;"></div>
                        </div>
                        <div style="margin-top: 10px; font-size: 0.85em; color: #666;">
                            <strong>Legend:</strong> Circle size = Total Production (KG). Colors represent different groups. Hover over points for details.
                        </div>

                        <!-- Map Legend -->
                        <div id="sfd-map-legend" style="display: flex; flex-wrap: wrap; gap: 10px; margin-top: 15px; padding: 12px; background: #f5f5f5; border-radius: 8px;"></div>

                        <!-- Farmer Location Table -->
                        <div style="margin-top: 25px;">
                            <h4 style="color: #004D40; margin-bottom: 10px;">Farmer Locations</h4>
                            <div style="overflow-x: auto; max-height: 400px; overflow-y: auto;">
                                <table class="comparison-table" id="sfd-location-table">
                                    <thead style="position: sticky; top: 0;">
                                        <tr><th>#</th><th>Group</th><th>Member</th><th>Lat</th><th>Lon</th><th>Total KG</th><th>Ropes</th></tr>
                                    </thead>
                                    <tbody></tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- ============ PAGE 6: FARMER PROFILING & CATEGORIZATION ============ -->
                <div id="sfd-page-profiling" class="sfd-page" style="display: none;">
                    <div class="section">
                        <div class="section-title">SEAWEED FARMERS PROFILING & CATEGORIZATION</div>
                        <p style="color:#666; margin-bottom:20px; font-size:0.95em;">Farmers are categorized by <strong>Ropes in Ocean</strong> into 5 tiers. Each tier has a tailored support strategy to maximize productivity and sustainable scaling.</p>

                        <!-- Profiling Category Cards (matching the image) -->
                        <div style="display: flex; flex-direction: column; gap: 0; margin-bottom: 30px; border-radius: 12px; overflow: hidden; box-shadow: 0 4px 16px rgba(0,0,0,0.12);">
                            <div style="display: flex; justify-content: space-between; align-items: center; padding: 16px 24px; background: #1565C0; color: #fff;">
                                <div><span style="font-size: 1.05em; font-weight: 800;">&#x2B50; Large Scale</span><br><span style="font-size: 0.85em; opacity: 0.9;">300+ ropes in ocean</span></div>
                                <div style="text-align: right;"><strong>Support: Confidence to support</strong><br><span style="font-size: 0.85em; opacity: 0.9;">Support equals requested (meets &ge;350 ropes target)</span></div>
                            </div>
                            <div style="display: flex; justify-content: space-between; align-items: center; padding: 16px 24px; background: #1976D2; color: #fff;">
                                <div><span style="font-size: 1.05em; font-weight: 800;">&#x2B50; Upper Medium</span><br><span style="font-size: 0.85em; opacity: 0.9;">200&ndash;299 ropes in ocean</span></div>
                                <div style="text-align: right;"><strong>Support: Given as requested</strong><br><span style="font-size: 0.85em; opacity: 0.9;">Meets target of &ge;350 ropes</span></div>
                            </div>
                            <div style="display: flex; justify-content: space-between; align-items: center; padding: 16px 24px; background: #2E7D32; color: #fff;">
                                <div><span style="font-size: 1.05em; font-weight: 800;">&#x2B50; Lower Medium</span><br><span style="font-size: 0.85em; opacity: 0.9;">100&ndash;199 ropes in ocean</span></div>
                                <div style="text-align: right;"><strong>Support: To reach 350 ropes</strong><br><span style="font-size: 0.85em; opacity: 0.9;">Focus on moving home ropes to ocean</span></div>
                            </div>
                            <div style="display: flex; justify-content: space-between; align-items: center; padding: 16px 24px; background: #F9A825; color: #fff;">
                                <div><span style="font-size: 1.05em; font-weight: 800;">&#x2B50; Upper Small</span><br><span style="font-size: 0.85em; opacity: 0.9;">50&ndash;99 ropes in ocean</span></div>
                                <div style="text-align: right;"><strong>Support: To reach 150 ropes</strong><br><span style="font-size: 0.85em; opacity: 0.9;">Focus on moving home ropes to ocean</span></div>
                            </div>
                            <div style="display: flex; justify-content: space-between; align-items: center; padding: 16px 24px; background: #E65100; color: #fff;">
                                <div><span style="font-size: 1.05em; font-weight: 800;">&#x2B50; Lower Small</span><br><span style="font-size: 0.85em; opacity: 0.9;">&lt;50 ropes in ocean</span></div>
                                <div style="text-align: right;"><strong>Priority: Move from home to ocean</strong><br><span style="font-size: 0.85em; opacity: 0.9;">Limited support to reach 50 ropes</span></div>
                            </div>
                        </div>

                        <!-- KPI Summary -->
                        <div style="display:grid; grid-template-columns:repeat(auto-fit,minmax(180px,1fr)); gap:14px; margin-bottom:25px;">
                            <div class="kpi-card" style="border-left:4px solid #1565C0;"><div class="kpi-label">Large Scale<br><small>300+ ropes</small></div><div class="kpi-value" id="sfd-prof-large" style="color:#1565C0;">—</div></div>
                            <div class="kpi-card" style="border-left:4px solid #1976D2;"><div class="kpi-label">Upper Medium<br><small>200–299 ropes</small></div><div class="kpi-value" id="sfd-prof-uppmed" style="color:#1976D2;">—</div></div>
                            <div class="kpi-card" style="border-left:4px solid #2E7D32;"><div class="kpi-label">Lower Medium<br><small>100–199 ropes</small></div><div class="kpi-value" id="sfd-prof-lowmed" style="color:#2E7D32;">—</div></div>
                            <div class="kpi-card" style="border-left:4px solid #F9A825;"><div class="kpi-label">Upper Small<br><small>50–99 ropes</small></div><div class="kpi-value" id="sfd-prof-uppsml" style="color:#F9A825;">—</div></div>
                            <div class="kpi-card" style="border-left:4px solid #E65100;"><div class="kpi-label">Lower Small<br><small>&lt;50 ropes</small></div><div class="kpi-value" id="sfd-prof-lowsml" style="color:#E65100;">—</div></div>
                        </div>

                        <!-- Charts Row -->
                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-bottom: 25px;">
                            <div class="chart-container" style="background: #fff; padding: 16px; border-radius: 10px; border: 1px solid #e0e0e0; height: 340px;">
                                <h4 style="color: #004D40; margin-bottom: 10px; font-size: 0.95em;">Farmers by Category</h4>
                                <canvas id="sfd-chart-prof-dist"></canvas>
                            </div>
                            <div class="chart-container" style="background: #fff; padding: 16px; border-radius: 10px; border: 1px solid #e0e0e0; height: 340px;">
                                <h4 style="color: #004D40; margin-bottom: 10px; font-size: 0.95em;">Ropes Required by Category</h4>
                                <canvas id="sfd-chart-prof-ropes"></canvas>
                            </div>
                        </div>

                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-bottom: 25px;">
                            <div class="chart-container" style="background: #fff; padding: 16px; border-radius: 10px; border: 1px solid #e0e0e0; height: 340px;">
                                <h4 style="color: #004D40; margin-bottom: 10px; font-size: 0.95em;">Category Distribution (%)</h4>
                                <canvas id="sfd-chart-prof-pie"></canvas>
                            </div>
                            <div class="chart-container" style="background: #fff; padding: 16px; border-radius: 10px; border: 1px solid #e0e0e0; height: 340px;">
                                <h4 style="color: #004D40; margin-bottom: 10px; font-size: 0.95em;">Avg Production (KG) by Category</h4>
                                <canvas id="sfd-chart-prof-production"></canvas>
                            </div>
                        </div>

                        <!-- Summary Table -->
                        <div style="margin-top: 20px;">
                            <h4 style="color: #004D40; margin-bottom: 10px;">Category Summary Table</h4>
                            <div style="overflow-x: auto;">
                                <table class="comparison-table" id="sfd-profiling-table">
                                    <thead>
                                        <tr><th>Category</th><th>Ropes Range</th><th>Farmers</th><th>% of Total</th><th>Ropes in Ocean</th><th>Ropes at Home</th><th>Total Ropes</th><th>Target Ropes</th><th>Ropes Required (Gap)</th><th>Avg Production (KG)</th><th>Support Strategy</th></tr>
                                    </thead>
                                    <tbody></tbody>
                                </table>
                            </div>
                        </div>

                        <!-- Farmers Detail Table -->
                        <div style="margin-top: 25px;">
                            <h4 style="color: #004D40; margin-bottom: 10px;">Individual Farmer Categorization</h4>
                            <div style="overflow-x: auto; max-height: 500px; overflow-y: auto;">
                                <table class="comparison-table" id="sfd-profiling-detail-table">
                                    <thead style="position: sticky; top: 0;">
                                        <tr><th>#</th><th>Group</th><th>Farmer</th><th>Ropes Ocean</th><th>Ropes Home</th><th>Total Ropes</th><th>Target</th><th>Gap</th><th>Total KG</th><th>Category</th></tr>
                                    </thead>
                                    <tbody></tbody>
                                </table>
                            </div>
                        </div>

                    </div>
                </div>

            </div>
            <!-- END FARMER DASHBOARD -->

        </div>
        <!-- END SEAWEED SECTION -->

        <!-- ================================================================ -->
        <!-- ============== VSLA MONITORING SECTION ========================= -->
        <!-- ================================================================ -->
        <div id="vsla-section" style="display: none; margin-top: 60px; padding-top: 40px; border-top: 3px solid #008080;">
            <h2 style="text-align: center; color: #0A2139; font-size: 1.5em; font-weight: 800; margin-bottom: 8px;">VSLA Functionality Dashboard</h2>
            <p style="text-align: center; color: #666; margin-bottom: 20px;">Indicator 1220a — Percentage of Women Actively Saving | 211 VSLA Assessments | 173 Unique Groups | Kilifi & Kwale Counties</p>

            <!-- VSLA FILTERS -->
            <div style="display: flex; flex-wrap: wrap; gap: 12px; align-items: center; margin-bottom: 20px; padding: 12px 18px; background: #f5f5f5; border-radius: 10px; border: 1px solid #ddd;">
                <label style="font-weight: 600; color: #0A2139;">County:</label>
                <select id="vsla-filter-county" onchange="applyVSLAFilters()" style="padding: 6px 12px; border-radius: 6px; border: 1px solid #ccc;">
                    <option value="all">All Counties</option>
                    <option value="Kilifi">Kilifi</option>
                    <option value="Kwale">Kwale</option>
                </select>
                <label style="font-weight: 600; color: #0A2139; margin-left: 12px;">Reporting Cycle:</label>
                <select id="vsla-filter-cycle" onchange="applyVSLAFilters()" style="padding: 6px 12px; border-radius: 6px; border: 1px solid #ccc;">
                    <option value="all">All Cycles</option>
                    <option value="Cycle_1">Cycle 1</option>
                    <option value="Cycle_2">Cycle 2</option>
                    <option value="Cycle_3">Cycle 3</option>
                </select>
                <label style="font-weight: 600; color: #0A2139; margin-left: 12px;">Quarter:</label>
                <select id="vsla-filter-quarter" onchange="applyVSLAFilters()" style="padding: 6px 12px; border-radius: 6px; border: 1px solid #ccc;">
                    <option value="all">All Quarters</option>
                    <option value="Q2">Q2</option>
                    <option value="Q3">Q3</option>
                    <option value="Q4">Q4</option>
                </select>
                <label style="font-weight: 600; color: #0A2139; margin-left: 12px;">Group:</label>
                <select id="vsla-filter-group" onchange="applyVSLAFilters()" style="padding: 6px 12px; border-radius: 6px; border: 1px solid #ccc; max-width: 220px;">
                    <option value="all">All Groups</option>
                </select>
                <button onclick="resetVSLAFilters()" style="padding: 6px 16px; background: #0A2139; color: #C8A951; border: none; border-radius: 6px; cursor: pointer; font-weight: 600;">Reset</button>
                <span id="vsla-filter-info" style="margin-left: auto; font-size: 0.92em; color: #666;">211 assessments shown</span>
            </div>

            <!-- VSLA PAGE TABS -->
            <div class="tabs-container" id="vsla-page-tabs" style="margin-bottom: 20px;">
                <button class="tab-button active" onclick="showVSLAPage(event, 'vsla-page-overview')" style="background: #0A2139; color: #C8A951;">1. Overview</button>
                <button class="tab-button" onclick="showVSLAPage(event, 'vsla-page-governance')">2. Participation</button>
                <button class="tab-button" onclick="showVSLAPage(event, 'vsla-page-savings')">3. Savings</button>
                <button class="tab-button" onclick="showVSLAPage(event, 'vsla-page-loans')">4. Loans</button>
                <button class="tab-button" onclick="showVSLAPage(event, 'vsla-page-socialfund')">5. Social Fund</button>
                <button class="tab-button" onclick="showVSLAPage(event, 'vsla-page-loanuse')">6. Loan Use</button>
            </div>

            <!-- ============ PAGE 1: OVERVIEW ============ -->
            <div id="vsla-page-overview" class="vsla-page active">
                <h3 style="color: #0A2139; border-bottom: 3px solid #008080; padding-bottom: 8px;">Overview & Key Metrics</h3>
                <div class="kpi-section" style="display:grid;grid-template-columns:repeat(auto-fit,minmax(170px,1fr));gap:14px;margin:18px 0;">
                    <div class="kpi-card" style="border-left:4px solid #008080;"><div class="kpi-label">Total VSLAs Assessed</div><div class="kpi-value" id="vsla-kpi-total">19</div></div>
                    <div class="kpi-card" style="border-left:4px solid #0A2139;"><div class="kpi-label">Female Members</div><div class="kpi-value" id="vsla-kpi-female">—</div></div>
                    <div class="kpi-card" style="border-left:4px solid #C8A951;"><div class="kpi-label">Male Members</div><div class="kpi-value" id="vsla-kpi-male">—</div></div>
                    <div class="kpi-card" style="border-left:4px solid #008080;"><div class="kpi-label">Total Membership</div><div class="kpi-value" id="vsla-kpi-members">—</div></div>
                    <div class="kpi-card" style="border-left:4px solid #C62828;"><div class="kpi-label">Female Attrition Rate</div><div class="kpi-value" id="vsla-kpi-attr-f">—</div></div>
                    <div class="kpi-card" style="border-left:4px solid #EF6C00;"><div class="kpi-label">Male Attrition Rate</div><div class="kpi-value" id="vsla-kpi-attr-m">—</div></div>
                    <div class="kpi-card" style="border-left:4px solid #C62828;"><div class="kpi-label">Overall Attrition Rate</div><div class="kpi-value" id="vsla-kpi-attr-all">—</div></div>
                    <div class="kpi-card" style="border-left:4px solid #2E7D32; background: #e8f5e9;"><div class="kpi-label">Indicator 1220a<br><small>Women Actively Saving</small></div><div class="kpi-value" id="vsla-kpi-1220a" style="color:#2E7D32;">78.6%</div></div>
                </div>
                <div class="charts-grid" style="display:grid;grid-template-columns:1fr 1fr;gap:20px;margin-top:18px;">
                    <div class="chart-wrapper"><h4>VSLAs Assessed by County</h4><div class="chart-container" style="height:300px;"><canvas id="vsla-chart-by-county"></canvas></div></div>
                    <div class="chart-wrapper"><h4>Membership by Sex</h4><div class="chart-container" style="height:300px;"><canvas id="vsla-chart-membership-sex"></canvas></div></div>
                </div>
                <div class="chart-wrapper" style="margin-top:18px;"><h4>Attrition by County and Sex</h4><div class="chart-container" style="height:320px;"><canvas id="vsla-chart-attrition"></canvas></div></div>
                <div class="chart-wrapper" style="margin-top:18px;"><h4>Summary of Core VSLA Metrics by County</h4>
                    <table class="comparison-table" id="vsla-summary-table"><thead><tr><th>Metric</th><th>Kilifi</th><th>Kwale</th><th>Total</th></tr></thead><tbody></tbody></table>
                </div>
            </div>

            <!-- ============ PAGE 2: PARTICIPATION & GOVERNANCE ============ -->
            <div id="vsla-page-governance" class="vsla-page" style="display:none;">
                <h3 style="color: #0A2139; border-bottom: 3px solid #008080; padding-bottom: 8px;">Participation & Governance</h3>
                <div class="kpi-section" style="display:grid;grid-template-columns:repeat(auto-fit,minmax(200px,1fr));gap:14px;margin:18px 0;">
                    <div class="kpi-card" style="border-left:4px solid #008080;"><div class="kpi-label">% VSLAs with Consistent Meetings</div><div class="kpi-value" id="vsla-kpi-consistent">—</div></div>
                    <div class="kpi-card" style="border-left:4px solid #0A2139;"><div class="kpi-label">Highest Governance County</div><div class="kpi-value" id="vsla-kpi-gov-best" style="font-size:1em;">—</div></div>
                </div>
                <div class="charts-grid" style="display:grid;grid-template-columns:1fr 1fr;gap:20px;margin-top:18px;">
                    <div class="chart-wrapper"><h4>Meeting Frequency by County</h4><div class="chart-container" style="height:300px;"><canvas id="vsla-chart-meeting-freq"></canvas></div></div>
                    <div class="chart-wrapper"><h4>Attendance Levels</h4><div class="chart-container" style="height:300px;"><canvas id="vsla-chart-attendance"></canvas></div></div>
                </div>
                <div class="chart-wrapper" style="margin-top:18px;"><h4>Proportion of Members Leaving by Sex & County</h4>
                    <table class="comparison-table" id="vsla-attrition-matrix"><thead><tr><th>County</th><th>Female Left</th><th>Male Left</th><th>Total Left</th><th>Female Attr %</th><th>Male Attr %</th><th>Overall Attr %</th></tr></thead><tbody></tbody></table>
                </div>
            </div>

            <!-- ============ PAGE 3: SAVINGS BEHAVIOR ============ -->
            <div id="vsla-page-savings" class="vsla-page" style="display:none;">
                <h3 style="color: #0A2139; border-bottom: 3px solid #008080; padding-bottom: 8px;">Savings Behavior</h3>
                <div class="kpi-section" style="display:grid;grid-template-columns:repeat(auto-fit,minmax(200px,1fr));gap:14px;margin:18px 0;">
                    <div class="kpi-card" style="border-left:4px solid #C8A951;"><div class="kpi-label">Total Savings (KES)</div><div class="kpi-value" id="vsla-kpi-savings-total">—</div></div>
                    <div class="kpi-card" style="border-left:4px solid #008080;"><div class="kpi-label">Average Savings / VSLA</div><div class="kpi-value" id="vsla-kpi-savings-avg">—</div></div>
                    <div class="kpi-card" style="border-left:4px solid #0A2139;"><div class="kpi-label">Members Actively Saving</div><div class="kpi-value" id="vsla-kpi-saving-members">—</div></div>
                </div>
                <div class="charts-grid" style="display:grid;grid-template-columns:1fr 1fr;gap:20px;margin-top:18px;">
                    <div class="chart-wrapper"><h4>Members Actively Saving by County</h4><div class="chart-container" style="height:300px;"><canvas id="vsla-chart-saving-members"></canvas></div></div>
                    <div class="chart-wrapper"><h4>Savings Range Distribution</h4><div class="chart-container" style="height:300px;"><canvas id="vsla-chart-savings-hist"></canvas></div></div>
                </div>
                <div class="charts-grid" style="display:grid;grid-template-columns:1fr 1fr;gap:20px;margin-top:18px;">
                    <div class="chart-wrapper"><h4>% Members Saving by Band</h4><div class="chart-container" style="height:300px;"><canvas id="vsla-chart-saving-pct-bands"></canvas></div></div>
                    <div class="chart-wrapper"><h4>Savings Performance by County</h4>
                        <table class="comparison-table" id="vsla-savings-table"><thead><tr><th>County</th><th>Sum (KES)</th><th>Average</th><th>Max</th><th>Min</th></tr></thead><tbody></tbody></table>
                    </div>
                </div>
            </div>

            <!-- ============ PAGE 4: LOAN CYCLE ============ -->
            <div id="vsla-page-loans" class="vsla-page" style="display:none;">
                <h3 style="color: #0A2139; border-bottom: 3px solid #008080; padding-bottom: 8px;">Loan Cycle Performance</h3>
                <div class="kpi-section" style="display:grid;grid-template-columns:repeat(auto-fit,minmax(170px,1fr));gap:14px;margin:18px 0;">
                    <div class="kpi-card" style="border-left:4px solid #C8A951;"><div class="kpi-label">Loans Disbursed (KES)</div><div class="kpi-value" id="vsla-kpi-loans-disbursed">—</div></div>
                    <div class="kpi-card" style="border-left:4px solid #008080;"><div class="kpi-label">Loans Repaid (KES)</div><div class="kpi-value" id="vsla-kpi-loans-repaid">—</div></div>
                    <div class="kpi-card" style="border-left:4px solid #0A2139;"><div class="kpi-label">Avg Repayment Proportion</div><div class="kpi-value" id="vsla-kpi-repay-pct">—</div></div>
                    <div class="kpi-card" style="border-left:4px solid #2E7D32;"><div class="kpi-label">Total Interest Earned</div><div class="kpi-value" id="vsla-kpi-interest">—</div></div>
                    <div class="kpi-card" style="border-left:4px solid #C62828;"><div class="kpi-label">ROI (Interest / Loans)</div><div class="kpi-value" id="vsla-kpi-roi">—</div></div>
                </div>
                <div class="charts-grid" style="display:grid;grid-template-columns:1fr 1fr;gap:20px;margin-top:18px;">
                    <div class="chart-wrapper"><h4>Loan Disbursement by County</h4><div class="chart-container" style="height:300px;"><canvas id="vsla-chart-loans-disbursed"></canvas></div></div>
                    <div class="chart-wrapper"><h4>Loan Repayment by County</h4><div class="chart-container" style="height:300px;"><canvas id="vsla-chart-loans-repaid"></canvas></div></div>
                </div>
                <div class="charts-grid" style="display:grid;grid-template-columns:1fr 1fr;gap:20px;margin-top:18px;">
                    <div class="chart-wrapper"><h4>Repayment Value Ranges</h4><div class="chart-container" style="height:300px;"><canvas id="vsla-chart-repay-ranges"></canvas></div></div>
                    <div class="chart-wrapper"><h4>Disbursed vs Repaid vs Interest (Bubble)</h4><div class="chart-container" style="height:300px;"><canvas id="vsla-chart-loan-bubble"></canvas></div></div>
                </div>
                <div class="chart-wrapper" style="margin-top:18px;"><h4>Loan Behavior Metrics by County</h4>
                    <table class="comparison-table" id="vsla-loan-table"><thead><tr><th>County</th><th>Disbursed (KES)</th><th>Repaid (KES)</th><th>% Repaid</th><th>Repayment Value</th><th>Interest</th><th>ROI</th></tr></thead><tbody></tbody></table>
                </div>
            </div>

            <!-- ============ PAGE 5: SOCIAL FUND ============ -->
            <div id="vsla-page-socialfund" class="vsla-page" style="display:none;">
                <h3 style="color: #0A2139; border-bottom: 3px solid #008080; padding-bottom: 8px;">Social Fund</h3>
                <div class="kpi-section" style="display:grid;grid-template-columns:repeat(auto-fit,minmax(220px,1fr));gap:14px;margin:18px 0;">
                    <div class="kpi-card" style="border-left:4px solid #2E7D32;"><div class="kpi-label">% VSLAs with Social Fund</div><div class="kpi-value" id="vsla-kpi-sf-pct">—</div></div>
                    <div class="kpi-card" style="border-left:4px solid #C8A951;"><div class="kpi-label">Total Social Fund (KES)</div><div class="kpi-value" id="vsla-kpi-sf-total">—</div></div>
                </div>
                <div class="charts-grid" style="display:grid;grid-template-columns:1fr 1fr;gap:20px;margin-top:18px;">
                    <div class="chart-wrapper"><h4>Social Fund Value Distribution</h4><div class="chart-container" style="height:300px;"><canvas id="vsla-chart-sf-ranges"></canvas></div></div>
                    <div class="chart-wrapper"><h4>Social Fund Summary by County</h4>
                        <table class="comparison-table" id="vsla-sf-table"><thead><tr><th>County</th><th>Sum (KES)</th><th>Average</th><th>Max</th><th>Min</th></tr></thead><tbody></tbody></table>
                    </div>
                </div>
            </div>

            <!-- ============ PAGE 6: USE OF LOANS ============ -->
            <div id="vsla-page-loanuse" class="vsla-page" style="display:none;">
                <h3 style="color: #0A2139; border-bottom: 3px solid #008080; padding-bottom: 8px;">Use of Loans</h3>
                <div class="kpi-section" style="display:grid;grid-template-columns:repeat(auto-fit,minmax(220px,1fr));gap:14px;margin:18px 0;">
                    <div class="kpi-card" style="border-left:4px solid #C8A951;"><div class="kpi-label">Most Common Loan Use</div><div class="kpi-value" id="vsla-kpi-top-use" style="font-size:1em;">—</div></div>
                </div>
                <div class="charts-grid" style="display:grid;grid-template-columns:1fr 1fr;gap:20px;margin-top:18px;">
                    <div class="chart-wrapper"><h4>% of VSLA Loans by Purpose</h4><div class="chart-container" style="height:350px;"><canvas id="vsla-chart-loan-use"></canvas></div></div>
                    <div class="chart-wrapper"><h4>Loan Use Heatmap by County</h4><div class="chart-container" style="height:350px;"><canvas id="vsla-chart-loan-heatmap"></canvas></div></div>
                </div>
            </div>

        </div>
        <!-- END VSLA SECTION -->

        <!-- ============================================================ -->
        <!-- CROSS-DATASET SYNTHESIS SECTION                              -->
        <!-- ============================================================ -->
        <div id="cross-dataset-section" class="survey-section" style="display:none;">

            <!-- SYNTHESIS HEADER -->
            <div class="section">
                <div class="section-title">Cross-Dataset Synthesis</div>

                <!-- Top-level KPIs -->
                <div class="synthesis-kpi-row" id="synthesis-kpis">
                    <!-- Rendered by JS -->
                </div>

                <!-- Domain filter chips -->
                <div class="domain-filter-bar" id="synthesis-domain-filter">
                    <button class="domain-chip active" data-domain="all" onclick="filterSynthesisDomain('all', this)">All Domains</button>
                    <button class="domain-chip" data-domain="savings" onclick="filterSynthesisDomain('savings', this)">Savings &amp; Financial</button>
                    <button class="domain-chip" data-domain="climate" onclick="filterSynthesisDomain('climate', this)">Climate &amp; NbS</button>
                    <button class="domain-chip" data-domain="gender" onclick="filterSynthesisDomain('gender', this)">Gender &amp; Empowerment</button>
                    <button class="domain-chip" data-domain="preparedness" onclick="filterSynthesisDomain('preparedness', this)">Disaster Preparedness</button>
                    <button class="domain-chip" data-domain="decisions" onclick="filterSynthesisDomain('decisions', this)">Decision-Making</button>
                    <button class="domain-chip" data-domain="norms" onclick="filterSynthesisDomain('norms', this)">Social Norms</button>
                </div>

                <!-- Cross-dataset comparison table -->
                <div style="overflow-x: auto;">
                    <table class="cross-table" id="synthesis-table">
                        <thead>
                            <tr>
                                <th>Indicator</th>
                                <th>Domain</th>
                                <th>Women Baseline</th>
                                <th>Women Midline</th>
                                <th>Men Baseline</th>
                                <th>Men Midline</th>
                                <th>Change (pp)</th>
                                <th>Trend</th>
                                <th>Status</th>
                            </tr>
                        </thead>
                        <tbody id="synthesis-table-body">
                            <!-- Rendered by JS -->
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- Comparative charts section -->
            <div class="section">
                <div class="section-title">Comparative Analysis</div>
                <div class="charts-grid">
                    <div class="chart-wrapper">
                        <div class="chart-title">Women vs Men: Key Indicator Comparison</div>
                        <div class="chart-container"><canvas id="synthesis-chart-comparison"></canvas></div>
                        <div class="chart-insight" id="synthesis-insight-comparison"></div>
                    </div>
                    <div class="chart-wrapper">
                        <div class="chart-title">Gender Gap Analysis: Midline vs Baseline</div>
                        <div class="chart-container"><canvas id="synthesis-chart-gendergap"></canvas></div>
                        <div class="chart-insight" id="synthesis-insight-gendergap"></div>
                    </div>
                    <div class="chart-wrapper">
                        <div class="chart-title">Domain Performance Radar</div>
                        <div class="chart-container"><canvas id="synthesis-chart-radar"></canvas></div>
                        <div class="chart-insight" id="synthesis-insight-radar"></div>
                    </div>
                    <div class="chart-wrapper">
                        <div class="chart-title">Logframe Achievement Overview</div>
                        <div class="chart-container"><canvas id="synthesis-chart-logframe"></canvas></div>
                        <div class="chart-insight" id="synthesis-insight-logframe"></div>
                    </div>
                </div>
            </div>

            <!-- Progress over time -->
            <div class="section">
                <div class="section-title">Progress Tracking &amp; Targets</div>
                <div class="charts-grid">
                    <div class="chart-wrapper full-width">
                        <div class="chart-title">Baseline to Midline: Top Gains &amp; Gaps</div>
                        <div class="chart-container" style="height:420px;"><canvas id="synthesis-chart-waterfall"></canvas></div>
                        <div class="chart-insight" id="synthesis-insight-waterfall"></div>
                    </div>
                    <div class="chart-wrapper">
                        <div class="chart-title">NbS Participation: Women vs Men Support</div>
                        <div class="chart-container"><canvas id="synthesis-chart-nbs"></canvas></div>
                        <div class="chart-insight" id="synthesis-insight-nbs"></div>
                    </div>
                    <div class="chart-wrapper">
                        <div class="chart-title">Training Effectiveness: Pre &amp; Post Scores</div>
                        <div class="chart-container"><canvas id="synthesis-chart-training"></canvas></div>
                        <div class="chart-insight" id="synthesis-insight-training"></div>
                    </div>
                </div>
            </div>
        </div>
        <!-- END CROSS-DATASET SYNTHESIS SECTION -->

        <!-- ============================================================ -->
        <!-- IMPACT & EVIDENCE SECTION                                    -->
        <!-- ============================================================ -->
        <div id="automated-insights-section" class="survey-section" style="display:none;">

            <!-- THEORY OF CHANGE PATHWAYS -->
            <div class="section">
                <div class="section-title">Theory of Change Evidence Pathways</div>
                <p style="color:#444;font-size:0.92em;margin-bottom:14px;line-height:1.6;">COSME's three-pronged strategy seeks to improve climate-resilient, equitable economies in coastal Kenya with a special focus on empowering women. Evidence pathways below are organized under the project's three intermediate outcomes, with cross-outcome linkages and critical tensions identified from midline data.</p>
                <div id="toc-pathways">
                    <!-- Rendered by JS -->
                </div>
            </div>

            <!-- ENDLINE PROJECTIONS -->
            <div class="section">
                <div class="section-title">Endline Projections & Scenario Analysis</div>
                <p style="color:#555;font-size:0.84em;margin-bottom:10px;">Based on baseline-to-midline trajectories, projected endline values under three scenarios: maintained momentum, accelerated effort, and regression risk.</p>
                <div class="charts-grid">
                    <div class="chart-wrapper full-width">
                        <div class="chart-title">Key Indicator Endline Projections (3 Scenarios)</div>
                        <div class="chart-container" style="height:340px;"><canvas id="insights-chart-projections"></canvas></div>
                    </div>
                </div>
                <div id="projection-summary" style="background:linear-gradient(135deg,#e8f5e9,#fff);border-radius:10px;padding:14px 18px;margin-top:10px;border-left:5px solid #2e7d32;line-height:1.6;font-size:0.88em;color:#333;">
                    <!-- Rendered by JS -->
                </div>
            </div>

            <!-- METHODOLOGY & DATA QUALITY -->
            <div class="section">
                <div class="section-title">Methodology & Data Quality Notes</div>
                <div id="methodology-notes" style="display:grid;grid-template-columns:repeat(auto-fit,minmax(280px,1fr));gap:10px;">
                    <div style="background:#f8f9fa;border-radius:10px;padding:14px;border-left:4px solid #2e7d32;">
                        <strong style="color:#2e7d32;font-size:0.95em;">Theory of Change Framework</strong>
                        <p style="font-size:0.85em;color:#555;margin-top:8px;line-height:1.7;">Evidence pathways are structured around COSME's three intermediate outcomes (1100: NbS Adoption, 1200: Women's Agency, 1300: Governance). Each pathway maps Input → Output → Outcome → Impact using baseline-to-midline data across 26 indicators and 5 training measures. Logframe indicator IDs are shown in brackets for traceability.</p>
                    </div>
                    <div style="background:#f8f9fa;border-radius:10px;padding:14px;border-left:4px solid #1976d2;">
                        <strong style="color:#1976d2;font-size:0.95em;">Cross-Outcome Validation</strong>
                        <p style="font-size:0.85em;color:#555;margin-top:8px;line-height:1.7;">Cross-outcome connections are validated against multiple datasets: VSLA group names confirm financial-to-NbS linkages (e.g., seaweed-named and conservation-named VSLAs), seaweed assessment data confirms women's leadership in value chains, and schools data confirms intergenerational pathways. Connection strength is rated as Strong, Moderate, Enabling, or Emerging.</p>
                    </div>
                    <div style="background:#f8f9fa;border-radius:10px;padding:14px;border-left:4px solid #f57c00;">
                        <strong style="color:#f57c00;font-size:0.95em;">Endline Projection Model</strong>
                        <p style="font-size:0.85em;color:#555;margin-top:8px;line-height:1.7;">Projections extrapolate baseline-to-midline trajectories under three scenarios: Maintained (50% of gains continue), Accelerated (80% with intensified programming), and Regression (20% loss if interventions weaken). Projections use strategic logframe indicators prioritized over arbitrary array ordering. All values are capped at 0-100%.</p>
                    </div>
                    <div style="background:#f8f9fa;border-radius:10px;padding:14px;border-left:4px solid #7b1fa2;">
                        <strong style="color:#7b1fa2;font-size:0.95em;">Data Sources & Coverage</strong>
                        <p style="font-size:0.85em;color:#555;margin-top:8px;line-height:1.7;">Data is drawn from 10 sources: Women COSME Survey (baseline+midline), Men COSME Survey (baseline+midline), GJJ Women/Men Surveys, Forestry Pre/Post Tests, Schools Assessments, Seaweed Farming Assessment (3 levels), and VSLA Monitoring (211 assessments, 173 groups). Coverage spans Kilifi & Kwale Counties, Kenya.</p>
                    </div>
                    <div style="background:#f8f9fa;border-radius:10px;padding:14px;border-left:4px solid #c62828;">
                        <strong style="color:#c62828;font-size:0.95em;">Limitations & Caveats</strong>
                        <p style="font-size:0.85em;color:#555;margin-top:8px;line-height:1.7;">Cross-outcome connections show temporal correlation, not established causation. Sample sizes vary across surveys, and self-reported data may introduce social desirability bias. Endline projections assume linear trajectories and equal intervention intensity. Tensions highlight where ToC assumptions diverge from observed data and may require adaptive programming.</p>
                    </div>
                    <div style="background:#f8f9fa;border-radius:10px;padding:14px;border-left:4px solid #00838f;">
                        <strong style="color:#00838f;font-size:0.95em;">Tension Detection Method</strong>
                        <p style="font-size:0.85em;color:#555;margin-top:8px;line-height:1.7;">Tensions are identified when: (1) indicator pairs show contradictory trends (e.g., decision power +38pp vs resource access +12.6pp), (2) gender perception gaps exceed 20pp (e.g., business support: women -20.7pp vs men +14.1pp), or (3) value chain bottlenecks block impact conversion (e.g., 84.2% insufficient inputs in seaweed). Each tension is tagged to its affected outcome for accountability.</p>
                    </div>
                </div>
            </div>
        </div>
        <!-- END IMPACT & EVIDENCE SECTION -->

        <!-- ═══════════════════════════════════════════════════════════ -->
        <!-- REPORT GENERATION SECTION                                  -->
        <!-- ═══════════════════════════════════════════════════════════ -->
        <div id="report-generation-section" class="survey-section" style="display:none;">
            <div style="max-width:1080px;margin:0 auto;padding:20px 0;">

                <!-- Hero card -->
                <div style="background:linear-gradient(135deg,#0072CE 0%,#004E8C 100%);border-radius:16px;padding:40px 36px;color:#fff;margin-bottom:28px;position:relative;overflow:hidden;">
                    <div style="position:absolute;top:-30px;right:-30px;width:160px;height:160px;border-radius:50%;background:rgba(255,255,255,0.08);"></div>
                    <div style="position:absolute;bottom:-20px;left:-20px;width:120px;height:120px;border-radius:50%;background:rgba(255,255,255,0.05);"></div>
                    <div style="font-size:2.8rem;margin-bottom:12px;">📄</div>
                    <h2 style="font-size:1.8em;font-weight:700;margin-bottom:8px;">COSME Report Centre</h2>
                    <p style="opacity:0.9;font-size:1.05em;line-height:1.6;max-width:650px;">Download the full midline report or select individual programme area reports. Each report includes relevant charts, KPIs, and analysis.</p>
                </div>

                <!-- Report Type Filter -->
                <div class="section" style="margin-bottom:24px;">
                    <div class="section-title" style="background:linear-gradient(135deg,#37474f,#455a64);color:#fff;">🔍 Select Report Type</div>
                    <div style="padding:16px 20px;">
                        <div id="reportFilterChips" style="display:flex;flex-wrap:wrap;gap:10px;">
                            <!-- chips rendered by JS -->
                        </div>
                    </div>
                </div>

                <!-- Report Cards Grid -->
                <div id="reportCardsGrid" style="display:grid;grid-template-columns:repeat(auto-fill,minmax(320px,1fr));gap:20px;margin-bottom:24px;">
                    <!-- cards rendered by JS -->
                </div>

                <!-- Selected Report Detail Panel -->
                <div id="reportDetailPanel" style="display:none;margin-bottom:24px;">
                    <div class="section">
                        <div class="section-title" id="reportDetailTitle" style="background:linear-gradient(135deg,#1b5e20,#2e7d32);color:#fff;">📋 Report Details</div>
                        <div style="padding:20px;">
                            <div style="display:grid;grid-template-columns:1fr 340px;gap:24px;align-items:start;" id="reportDetailGrid">
                                <!-- Left: description + contents -->
                                <div>
                                    <p id="reportDetailDesc" style="color:#555;line-height:1.7;margin-bottom:16px;"></p>

                                    <!-- Download actions -->
                                    <div id="reportDetailActions" style="display:flex;align-items:center;gap:14px;flex-wrap:wrap;margin-bottom:20px;">
                                    </div>

                                    <!-- Contents table for selected report -->
                                    <div id="reportDetailContents" style="margin-top:8px;">
                                        <h4 style="margin:0 0 10px 0;font-size:0.95em;color:#333;">📋 Included Sections</h4>
                                        <table style="width:100%;border-collapse:collapse;font-size:0.9em;">
                                            <thead>
                                                <tr style="background:#f0f4f8;">
                                                    <th style="padding:8px 12px;text-align:left;font-weight:600;color:#333;border-bottom:2px solid #dee2e6;width:30px;">#</th>
                                                    <th style="padding:8px 12px;text-align:left;font-weight:600;color:#333;border-bottom:2px solid #dee2e6;">Section</th>
                                                    <th style="padding:8px 12px;text-align:left;font-weight:600;color:#333;border-bottom:2px solid #dee2e6;">Details</th>
                                                </tr>
                                            </thead>
                                            <tbody id="reportDetailTbody"></tbody>
                                        </table>
                                    </div>
                                </div>

                                <!-- Right: quick stats for selected report -->
                                <div>
                                    <div class="section" style="border-left:4px solid #0072CE;">
                                        <div class="section-title" style="background:linear-gradient(135deg,#e3f2fd,#bbdefb);color:#0d47a1;">📊 Key Stats</div>
                                        <div id="reportDetailStats" style="padding:16px;">
                                        </div>
                                    </div>
                                    <div style="margin-top:16px;">
                                        <div class="section" style="border-left:4px solid #2e7d32;">
                                            <div class="section-title" style="background:linear-gradient(135deg,#e8f5e9,#c8e6c9);color:#1b5e20;">📁 Available Files</div>
                                            <div id="reportDetailFiles" style="padding:14px;font-size:0.9em;">
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Report Section Styles -->
                <style>
                    .rpt-chip {
                        padding: 9px 18px;
                        border: 2px solid #cfd8dc;
                        background: #fff;
                        color: #455a64;
                        border-radius: 24px;
                        cursor: pointer;
                        font-weight: 600;
                        font-size: 0.9em;
                        transition: all 0.25s;
                        display: flex;
                        align-items: center;
                        gap: 6px;
                        white-space: nowrap;
                    }
                    .rpt-chip:hover {
                        border-color: #0072CE;
                        color: #0072CE;
                        background: #e3f2fd;
                    }
                    .rpt-chip.active {
                        background: linear-gradient(135deg, #0072CE, #004E8C);
                        color: #fff;
                        border-color: transparent;
                        box-shadow: 0 3px 10px rgba(0,114,206,0.3);
                    }
                    .rpt-card {
                        background: #fff;
                        border-radius: 14px;
                        border: 2px solid #e8eaed;
                        padding: 0;
                        cursor: pointer;
                        transition: all 0.3s;
                        overflow: hidden;
                        position: relative;
                    }
                    .rpt-card:hover {
                        border-color: #0072CE;
                        box-shadow: 0 6px 20px rgba(0,114,206,0.15);
                        transform: translateY(-2px);
                    }
                    .rpt-card.selected {
                        border-color: #0072CE;
                        box-shadow: 0 4px 16px rgba(0,114,206,0.2);
                    }
                    .rpt-card-header {
                        padding: 18px 20px 12px;
                        display: flex;
                        align-items: center;
                        gap: 12px;
                    }
                    .rpt-card-icon {
                        width: 48px;
                        height: 48px;
                        border-radius: 12px;
                        display: flex;
                        align-items: center;
                        justify-content: center;
                        font-size: 1.5em;
                        flex-shrink: 0;
                    }
                    .rpt-card-body {
                        padding: 0 20px 16px;
                    }
                    .rpt-card-body p {
                        margin: 0;
                        color: #666;
                        font-size: 0.88em;
                        line-height: 1.5;
                    }
                    .rpt-card-footer {
                        padding: 10px 20px;
                        background: #f8f9fa;
                        border-top: 1px solid #eee;
                        display: flex;
                        align-items: center;
                        justify-content: space-between;
                        font-size: 0.82em;
                    }
                    .rpt-card-badge {
                        padding: 3px 10px;
                        border-radius: 12px;
                        font-weight: 600;
                        font-size: 0.85em;
                    }
                    .rpt-dl-btn {
                        display: inline-flex;
                        align-items: center;
                        gap: 8px;
                        padding: 12px 24px;
                        border-radius: 10px;
                        font-weight: 600;
                        font-size: 1em;
                        text-decoration: none;
                        transition: all 0.3s;
                        cursor: pointer;
                        border: none;
                    }
                    .rpt-dl-btn.primary {
                        background: linear-gradient(135deg,#0072CE,#004E8C);
                        color: #fff;
                        box-shadow: 0 4px 12px rgba(0,114,206,0.3);
                    }
                    .rpt-dl-btn.primary:hover { box-shadow: 0 6px 18px rgba(0,114,206,0.4); }
                    .rpt-dl-btn.outline {
                        background: #fff;
                        color: #0072CE;
                        border: 2px solid #0072CE;
                    }
                    .rpt-dl-btn.outline:hover { background: #e3f2fd; }
                    .rpt-dl-btn.data {
                        background: linear-gradient(135deg,#2e7d32,#1b5e20);
                        color: #fff;
                        box-shadow: 0 3px 10px rgba(46,125,50,0.3);
                        font-size: 0.9em;
                        padding: 10px 18px;
                    }
                    .report-gen-btn {
                        background: transparent !important;
                        color: inherit !important;
                        border: none !important;
                        font-weight: inherit !important;
                    }
                    @media (max-width: 768px) {
                        #reportCardsGrid { grid-template-columns: 1fr !important; }
                        #reportDetailGrid { grid-template-columns: 1fr !important; }
                        #reportFilterChips { gap: 8px !important; }
                        .rpt-chip { font-size: 0.82em; padding: 7px 14px; }
                    }
                </style>
            </div>
        </div>
        <!-- END REPORT GENERATION SECTION -->

        <!-- ═══════════════════════════════════════════════════════════ -->
        <!-- ANALYTICS DASHBOARD SECTION                                -->
        <!-- ═══════════════════════════════════════════════════════════ -->
        <div id="analytics-dashboard-section" class="survey-section" style="display:none;">
            <div style="max-width:1200px;margin:0 auto;padding:20px 0;">

                <!-- Hero -->
                <div style="background:linear-gradient(135deg,#1a237e 0%,#283593 100%);border-radius:16px;padding:40px 36px;color:#fff;margin-bottom:28px;position:relative;overflow:hidden;">
                    <div style="position:absolute;top:-30px;right:-30px;width:160px;height:160px;border-radius:50%;background:rgba(255,255,255,0.08);"></div>
                    <div style="position:absolute;bottom:-20px;left:-20px;width:120px;height:120px;border-radius:50%;background:rgba(255,255,255,0.05);"></div>
                    <h2 style="font-size:1.8em;font-weight:700;margin-bottom:8px;">Dashboard Analytics</h2>
                    <p style="opacity:0.9;font-size:1.05em;line-height:1.6;max-width:650px;">Real-time usage analytics, visitor engagement metrics, tab popularity, device breakdown, and report download tracking.</p>
                </div>

                <!-- Overview KPI Cards -->
                <div id="analytics-kpi-row" style="display:grid;grid-template-columns:repeat(auto-fit,minmax(180px,1fr));gap:16px;margin-bottom:28px;">
                    <div class="an-kpi" id="an-kpi-total"><div class="an-kpi-val">--</div><div class="an-kpi-lbl">Total Visits</div></div>
                    <div class="an-kpi" id="an-kpi-today"><div class="an-kpi-val">--</div><div class="an-kpi-lbl">Today</div></div>
                    <div class="an-kpi" id="an-kpi-week"><div class="an-kpi-val">--</div><div class="an-kpi-lbl">This Week</div></div>
                    <div class="an-kpi" id="an-kpi-unique"><div class="an-kpi-val">--</div><div class="an-kpi-lbl">Unique Visitors</div></div>
                    <div class="an-kpi" id="an-kpi-live"><div class="an-kpi-val" style="color:#2e7d32;">--</div><div class="an-kpi-lbl">Live Now</div></div>
                    <div class="an-kpi" id="an-kpi-avg-dur"><div class="an-kpi-val">--</div><div class="an-kpi-lbl">Avg Duration</div></div>
                </div>

                <!-- Charts Row 1: Daily Visits + Tab Usage -->
                <div style="display:grid;grid-template-columns:1fr 1fr;gap:20px;margin-bottom:20px;">
                    <div class="an-card">
                        <h3 class="an-card-title">Daily Visits (Last 14 Days)</h3>
                        <div style="height:260px;position:relative;">
                            <canvas id="analytics-chart-daily"></canvas>
                        </div>
                    </div>
                    <div class="an-card">
                        <h3 class="an-card-title">Tab Popularity</h3>
                        <div style="height:260px;position:relative;">
                            <canvas id="analytics-chart-tabs"></canvas>
                        </div>
                    </div>
                </div>

                <!-- Charts Row 2: Device & Browser + Hourly -->
                <div style="display:grid;grid-template-columns:1fr 1fr;gap:20px;margin-bottom:20px;">
                    <div class="an-card">
                        <h3 class="an-card-title">Device & Browser Breakdown</h3>
                        <div style="display:grid;grid-template-columns:1fr 1fr;gap:16px;">
                            <div style="height:220px;position:relative;">
                                <canvas id="analytics-chart-device"></canvas>
                            </div>
                            <div style="height:220px;position:relative;">
                                <canvas id="analytics-chart-browser"></canvas>
                            </div>
                        </div>
                    </div>
                    <div class="an-card">
                        <h3 class="an-card-title">Visits by Hour of Day</h3>
                        <div style="height:260px;position:relative;">
                            <canvas id="analytics-chart-hourly"></canvas>
                        </div>
                    </div>
                </div>

                <!-- Charts Row 3: Report Downloads + Session Duration -->
                <div style="display:grid;grid-template-columns:1fr 1fr;gap:20px;margin-bottom:20px;">
                    <div class="an-card">
                        <h3 class="an-card-title">Report Downloads</h3>
                        <div style="height:260px;position:relative;">
                            <canvas id="analytics-chart-downloads"></canvas>
                        </div>
                    </div>
                    <div class="an-card">
                        <h3 class="an-card-title">Session Duration Distribution</h3>
                        <div style="height:260px;position:relative;">
                            <canvas id="analytics-chart-duration"></canvas>
                        </div>
                    </div>
                </div>

                <!-- Recent Visitors Table -->
                <div class="an-card" style="margin-bottom:20px;">
                    <h3 class="an-card-title">Recent Visitors</h3>
                    <div style="overflow-x:auto;">
                        <table id="analytics-visitors-table" style="width:100%;border-collapse:collapse;font-size:0.88em;">
                            <thead>
                                <tr style="background:#f5f5f5;text-align:left;">
                                    <th style="padding:10px 14px;border-bottom:2px solid #e0e0e0;font-weight:600;color:#555;">Visitor</th>
                                    <th style="padding:10px 14px;border-bottom:2px solid #e0e0e0;font-weight:600;color:#555;">Date & Time</th>
                                    <th style="padding:10px 14px;border-bottom:2px solid #e0e0e0;font-weight:600;color:#555;">Duration</th>
                                    <th style="padding:10px 14px;border-bottom:2px solid #e0e0e0;font-weight:600;color:#555;">Device</th>
                                </tr>
                            </thead>
                            <tbody id="analytics-visitors-tbody">
                                <tr><td colspan="4" style="text-align:center;color:#999;padding:28px;">Loading visitor data...</td></tr>
                            </tbody>
                        </table>
                    </div>
                </div>

                <!-- Engagement Summary -->
                <div class="an-card">
                    <h3 class="an-card-title">Engagement Summary</h3>
                    <div id="analytics-engagement-grid" style="display:grid;grid-template-columns:repeat(auto-fit,minmax(200px,1fr));gap:16px;">
                    </div>
                </div>

                <style>
                    .an-kpi {
                        background: #fff;
                        border-radius: 12px;
                        padding: 22px 18px;
                        text-align: center;
                        box-shadow: 0 3px 12px rgba(0,0,0,0.07);
                        border-top: 4px solid #1a237e;
                        transition: transform 0.2s, box-shadow 0.2s;
                    }
                    .an-kpi:hover {
                        transform: translateY(-3px);
                        box-shadow: 0 6px 20px rgba(0,0,0,0.12);
                    }
                    .an-kpi-val {
                        font-size: 2em;
                        font-weight: 800;
                        color: #1a237e;
                        line-height: 1.1;
                        margin-bottom: 6px;
                    }
                    .an-kpi-lbl {
                        font-size: 0.78em;
                        text-transform: uppercase;
                        letter-spacing: 1px;
                        color: #777;
                    }
                    .an-card {
                        background: #fff;
                        border-radius: 12px;
                        padding: 24px;
                        box-shadow: 0 3px 12px rgba(0,0,0,0.07);
                    }
                    .an-card-title {
                        font-size: 1.05em;
                        font-weight: 700;
                        color: #333;
                        margin-bottom: 16px;
                        padding-bottom: 10px;
                        border-bottom: 2px solid #e8eaf6;
                    }
                    .an-eng-item {
                        background: #f8f9fa;
                        border-radius: 10px;
                        padding: 16px;
                        text-align: center;
                        border-left: 4px solid #1a237e;
                    }
                    .an-eng-val {
                        font-size: 1.5em;
                        font-weight: 700;
                        color: #1a237e;
                        margin-bottom: 4px;
                    }
                    .an-eng-lbl {
                        font-size: 0.82em;
                        color: #666;
                    }
                    @media (max-width: 768px) {
                        #analytics-kpi-row { grid-template-columns: 1fr 1fr !important; }
                        .an-card { padding: 16px; }
                        #analytics-dashboard-section > div > div[style*="grid-template-columns:1fr 1fr"] {
                            grid-template-columns: 1fr !important;
                        }
                    }
                </style>
            </div>
        </div>
        <!-- END ANALYTICS DASHBOARD SECTION -->

    </div>

    <!-- FOOTER -->
    <footer class="footer" role="contentinfo">
        <p id="footer-title"><strong>Project Output Dashboard - Mangrove</strong></p>
        <p id="footer-sample">COSME Project Outputs and Deliverables Tracker</p>
        <p>Dashboard Created: February 2026 | Last Updated: <span id="footer-timestamp"></span></p>
    </footer>

    <!-- BACK TO TOP BUTTON -->
    <button id="backToTop" onclick="scrollToTop()" title="Back to Top" aria-label="Scroll back to top">↑</button>
    
    <!-- SECTION INDICATOR -->
    <div class="scroll-indicator" id="scrollIndicator">Currently viewing...</div>

    <script>
        Chart.register(ChartDataLabels);

        const colors = {
            primary: '#0072CE',
            secondary: '#005a9e',
            success: '#2e7d32',
            warning: '#f57c00',
            danger: '#c62828',
            info: '#1976d2',
            baseline: '#3B82F6',    // Bright blue for baseline
            midline: '#8B5CF6'      // Purple for midline
        };

        const chartDefaults = {
            responsive: true,
            maintainAspectRatio: false,
            plugins: {
                legend: { position: 'top', labels: { font: { size: 12, weight: 'bold' } } },
                datalabels: {
                    font: { size: 14, weight: 'bold' },
                    color: '#fff',
                    backgroundColor: '#333',
                    borderRadius: 6,
                    padding: 6,
                    formatter: (value) => value.toFixed(1) + '%',
                    display: true
                }
            }
        };

        // A1: Location
        window['chart-locationChart'] = new Chart(document.getElementById('chart-location'), {
            type: 'doughnut',
            data: {
                labels: ['Marine', 'Terrestrial'],
                datasets: [{
                    data: [57.2, 42.8],
                    backgroundColor: [colors.baseline, colors.midline]
                }]
            },
            options: { ...chartDefaults, plugins: { ...chartDefaults.plugins, datalabels: { ...chartDefaults.plugins.datalabels } } }
        });

        // A2: Headship
        window['chart-headshipChart'] = new Chart(document.getElementById('chart-headship'), {
            type: 'bar',
            data: {
                labels: ['Female-headed', 'Male-headed'],
                datasets: [
                    { label: 'Baseline', data: [51.0, 49.0], backgroundColor: colors.baseline },
                    { label: 'Midline', data: [57.7, 42.3], backgroundColor: colors.midline }
                ]
            },
            options: { ...chartDefaults, scales: { y: { beginAtZero: true, max: 100 } } }
        });

        // A3: Activities
        window['chart-activitiesChart'] = new Chart(document.getElementById('chart-activities'), {
            type: 'bar',
            indexAxis: 'y',
            data: {
                labels: ['Small Business', 'Agriculture', 'Casual Labour', 'Other'],
                datasets: [
                    { label: 'Baseline', data: [17.6, 34.8, 25.5, 22.1], backgroundColor: colors.baseline },
                    { label: 'Midline', data: [30.3, 38.8, 11.6, 19.3], backgroundColor: colors.midline }
                ]
            },
            options: { ...chartDefaults, scales: { x: { beginAtZero: true } }, plugins: { ...chartDefaults.plugins, datalabels: { ...chartDefaults.plugins.datalabels, anchor: 'end', align: 'right' } } }
        });

        // A4: Housing
        window['chart-housingChart'] = new Chart(document.getElementById('chart-housing'), {
            type: 'bar',
            data: {
                labels: ['Natural Floor', 'Finished Floor'],
                datasets: [
                    { label: 'Baseline', data: [66.6, 33.4], backgroundColor: colors.baseline },
                    { label: 'Midline', data: [79.4, 20.6], backgroundColor: colors.midline }
                ]
            },
            options: { ...chartDefaults, scales: { y: { beginAtZero: true, max: 100 } }, plugins: { ...chartDefaults.plugins, datalabels: { ...chartDefaults.plugins.datalabels, anchor: 'end', align: 'top' } } }
        });

        // A5: WASH
        window['chart-washChart'] = new Chart(document.getElementById('chart-wash'), {
            type: 'bar',
            data: {
                labels: ['Safe Water', 'Toilet Facility'],
                datasets: [
                    { label: 'Baseline', data: [84.3, 70.3], backgroundColor: colors.baseline },
                    { label: 'Midline', data: [79.7, 72.5], backgroundColor: colors.midline }
                ]
            },
            options: { ...chartDefaults, scales: { y: { beginAtZero: true, max: 100 } }, plugins: { ...chartDefaults.plugins, datalabels: { ...chartDefaults.plugins.datalabels, anchor: 'end', align: 'top' } } }
        });

        // B1: Shocks
        window['chart-shocksChart'] = new Chart(document.getElementById('chart-shocks'), {
            type: 'bar',
            indexAxis: 'y',
            data: {
                labels: ['Drought', 'Heat/Cold Waves', 'Flooding', 'Other'],
                datasets: [
                    { label: 'Baseline', data: [69.1, 8.6, 4.7, 17.6], backgroundColor: colors.baseline },
                    { label: 'Midline', data: [63.4, 22.8, 10.0, 3.8], backgroundColor: colors.midline }
                ]
            },
            options: { ...chartDefaults, scales: { x: { beginAtZero: true } }, plugins: { ...chartDefaults.plugins, datalabels: { ...chartDefaults.plugins.datalabels, anchor: 'end', align: 'right' } } }
        });

        // B2: Impact
        window['chart-impactChart'] = new Chart(document.getElementById('chart-impact'), {
            type: 'bar',
            data: {
                labels: ['Very Large', 'Large', 'Moderate', 'Small', 'Very Small'],
                datasets: [
                    { label: 'Baseline', data: [32.7, 31.9, 17.6, 14.0, 2.9], backgroundColor: colors.baseline },
                    { label: 'Midline', data: [20.0, 46.7, 24.2, 7.9, 0.4], backgroundColor: colors.midline }
                ]
            },
            options: { ...chartDefaults, scales: { y: { beginAtZero: true, max: 50 } }, plugins: { ...chartDefaults.plugins, datalabels: { ...chartDefaults.plugins.datalabels, anchor: 'end', align: 'top' } } }
        });

        // B3: Coping
        window['chart-copingChart'] = new Chart(document.getElementById('chart-coping'), {
            type: 'bar',
            indexAxis: 'y',
            data: {
                labels: ['Took Loan', 'Sold Livestock', 'Used Savings', 'Skipped Meals', 'Other'],
                datasets: [
                    { label: 'Baseline', data: [4.7, 14.7, 11.2, 41.6, 28.0], backgroundColor: colors.baseline },
                    { label: 'Midline', data: [25.8, 22.9, 15.8, 43.8, 17.0], backgroundColor: colors.midline }
                ]
            },
            options: { ...chartDefaults, scales: { x: { beginAtZero: true } }, plugins: { ...chartDefaults.plugins, datalabels: { ...chartDefaults.plugins.datalabels, anchor: 'end', align: 'right' } } }
        });

        // C1: Prep Knowledge
        window['chart-prep-knowledgeChart'] = new Chart(document.getElementById('chart-prep-knowledge'), {
            type: 'bar',
            data: {
                labels: ['Know Plans', "Don't Know", 'Unsure'],
                datasets: [
                    { label: 'Baseline', data: [4.7, 45.2, 50.1], backgroundColor: colors.baseline },
                    { label: 'Midline', data: [37.8, 42.2, 20.0], backgroundColor: colors.midline }
                ]
            },
            options: { ...chartDefaults, scales: { y: { beginAtZero: true, max: 100 } }, plugins: { ...chartDefaults.plugins, datalabels: { ...chartDefaults.plugins.datalabels, anchor: 'end', align: 'top' } } }
        });

        // C2: Participation
        window['chart-prep-participationChart'] = new Chart(document.getElementById('chart-prep-participation'), {
            type: 'doughnut',
            data: {
                labels: ['Directly Participate', 'Family Participation', 'No Participation'],
                datasets: [{
                    data: [26.9, 7.5, 65.6],
                    backgroundColor: [colors.baseline, colors.midline, colors.danger]
                }]
            },
            options: { ...chartDefaults, plugins: { ...chartDefaults.plugins, datalabels: { ...chartDefaults.plugins.datalabels } } }
        });

        // C3: Warnings
        window['chart-warningsChart'] = new Chart(document.getElementById('chart-warnings'), {
            type: 'bar',
            data: {
                labels: ['Weather Access', 'Early Warnings', 'Tidal Forecasts'],
                datasets: [
                    { label: 'Baseline', data: [15.7, 8.9, 10.3], backgroundColor: colors.baseline },
                    { label: 'Midline', data: [46.2, 45.0, 33.1], backgroundColor: colors.midline }
                ]
            },
            options: { ...chartDefaults, scales: { y: { beginAtZero: true, max: 60 } }, plugins: { ...chartDefaults.plugins, datalabels: { ...chartDefaults.plugins.datalabels, anchor: 'end', align: 'top' } } }
        });

        // D1: Assets (Yes, Solely ownership)
        window['chart-assetsChart'] = new Chart(document.getElementById('chart-assets'), {
            type: 'bar',
            indexAxis: 'y',
            data: {
                labels: ['Cellphones', 'Solar Panels', 'Cooking Stoves', 'Furniture'],
                datasets: [
                    { label: 'Baseline', data: [47.0, 9.2, 3.5, 17.3], backgroundColor: colors.baseline },
                    { label: 'Midline', data: [62.5, 31.6, 39.7, 23.1], backgroundColor: colors.midline }
                ]
            },
            options: { ...chartDefaults, scales: { x: { beginAtZero: true, max: 70 } }, plugins: { ...chartDefaults.plugins, datalabels: { ...chartDefaults.plugins.datalabels, anchor: 'end', align: 'right' } } }
        });

        // D2: Land
        window['chart-landChart'] = new Chart(document.getElementById('chart-land'), {
            type: 'bar',
            data: {
                labels: ['Owned', 'Leased', 'Both'],
                datasets: [
                    { label: 'Baseline', data: [92.7, 6.0, 1.3], backgroundColor: colors.baseline },
                    { label: 'Midline', data: [73.4, 19.6, 7.0], backgroundColor: colors.midline }
                ]
            },
            options: { ...chartDefaults, scales: { y: { beginAtZero: true, max: 100 } }, plugins: { ...chartDefaults.plugins, datalabels: { ...chartDefaults.plugins.datalabels, anchor: 'end', align: 'top' } } }
        });

        // D3: Cultivation
        window['chart-cultivationChart'] = new Chart(document.getElementById('chart-cultivation'), {
            type: 'doughnut',
            data: {
                labels: ['Using for Agriculture', 'Idle/Not Using'],
                datasets: [{
                    data: [80.4, 19.6],
                    backgroundColor: [colors.baseline, colors.midline]
                }]
            },
            options: { ...chartDefaults, plugins: { ...chartDefaults.plugins, datalabels: { ...chartDefaults.plugins.datalabels } } }
        });

        // D4: Inputs
        window['chart-inputsChart'] = new Chart(document.getElementById('chart-inputs'), {
            type: 'bar',
            data: {
                labels: ['Fertilizer', 'Seeds', 'Pesticide', 'Vet Drugs', 'Animal Feed'],
                datasets: [
                    { label: 'Baseline', data: [84.7, 93.5, 93.1, 73.6, 88.3], backgroundColor: colors.baseline },
                    { label: 'Midline', data: [98.4, 99.4, 98.7, 87.5, 95.1], backgroundColor: colors.midline }
                ]
            },
            options: { ...chartDefaults, scales: { y: { beginAtZero: true, max: 105 } }, plugins: { ...chartDefaults.plugins, datalabels: { ...chartDefaults.plugins.datalabels, anchor: 'end', align: 'top' } } }
        });

        // E1: Personal Savings
        window['chart-personal-savingsChart'] = new Chart(document.getElementById('chart-personal-savings'), {
            type: 'doughnut',
            data: {
                labels: ['Personally Saving', 'Not Saving'],
                datasets: [{
                    data: [93.4, 6.6],
                    backgroundColor: [colors.baseline, colors.midline]
                }]
            },
            options: { ...chartDefaults, plugins: { ...chartDefaults.plugins, datalabels: { ...chartDefaults.plugins.datalabels } } }
        });

        // E2: Mechanism
        window['chart-mechanismChart'] = new Chart(document.getElementById('chart-mechanism'), {
            type: 'bar',
            indexAxis: 'y',
            data: {
                labels: ['VSLA', 'Bank', 'MPESA', 'Informal Group', 'Home'],
                datasets: [
                    { label: 'Baseline', data: [43.6, 14.5, 8.3, 6.9, 12.9], backgroundColor: colors.baseline },
                    { label: 'Midline', data: [98.0, 2.7, 1.7, 3.7, 0.0], backgroundColor: colors.midline }
                ]
            },
            options: { ...chartDefaults, scales: { x: { beginAtZero: true } }, plugins: { ...chartDefaults.plugins, datalabels: { ...chartDefaults.plugins.datalabels, anchor: 'end', align: 'right' } } }
        });

        // E3: Loans
        window['chart-loansChart'] = new Chart(document.getElementById('chart-loans'), {
            type: 'doughnut',
            data: {
                labels: ['Taking Loans', 'Not Taking'],
                datasets: [{
                    data: [79.1, 20.9],
                    backgroundColor: [colors.baseline, colors.midline]
                }]
            },
            options: { ...chartDefaults, plugins: { ...chartDefaults.plugins, datalabels: { ...chartDefaults.plugins.datalabels } } }
        });

        // E4: Savings Use
        window['chart-savings-useChart'] = new Chart(document.getElementById('chart-savings-use'), {
            type: 'bar',
            indexAxis: 'y',
            data: {
                labels: ['Large Assets', 'Agriculture', 'Food', 'Education', 'Business'],
                datasets: [
                    { label: 'Baseline', data: [10.2, 10.9, 46.2, 64.0, 24.1], backgroundColor: colors.baseline },
                    { label: 'Midline', data: [63.9, 30.4, 28.4, 17.7, 3.7], backgroundColor: colors.midline }
                ]
            },
            options: { ...chartDefaults, scales: { x: { beginAtZero: true } }, plugins: { ...chartDefaults.plugins, datalabels: { ...chartDefaults.plugins.datalabels, anchor: 'end', align: 'right' } } }
        });

        // F1: Time
        window['chart-timeChart'] = new Chart(document.getElementById('chart-time'), {
            type: 'bar',
            data: {
                labels: ['Unpaid Care', 'Productive Work', 'Community Work', 'Personal Dev'],
                datasets: [
                    { label: 'Baseline (hours)', data: [9.3, 4.2, 0.4, 0.0], backgroundColor: colors.baseline },
                    { label: 'Midline (hours)', data: [7.7, 4.9, 1.8, 0.3], backgroundColor: colors.midline }
                ]
            },
            options: { ...chartDefaults, scales: { y: { beginAtZero: true, max: 12 } } }
        });

        // F2: Beliefs
        window['chart-beliefsChart'] = new Chart(document.getElementById('chart-beliefs'), {
            type: 'bar',
            data: {
                labels: ['Cooking', 'Cleaning', 'Water Fetch', 'Firewood', 'Childcare'],
                datasets: [
                    { label: 'Baseline', data: [12.5, 13.5, 21.4, 14.4, 26.5], backgroundColor: colors.baseline },
                    { label: 'Midline', data: [71.3, 66.9, 77.8, 60.6, 72.2], backgroundColor: colors.midline }
                ]
            },
            options: { ...chartDefaults, scales: { y: { beginAtZero: true, max: 85 } } }
        });

        // F3: Experience
        window['chart-experienceChart'] = new Chart(document.getElementById('chart-experience'), {
            type: 'bar',
            data: {
                labels: ['Cooking', 'Cleaning', 'Water Fetch', 'Firewood', 'Childcare'],
                datasets: [
                    { label: 'Baseline', data: [87.0, 85.3, 76.6, 83.3, 70.7], backgroundColor: colors.baseline },
                    { label: 'Midline', data: [28.8, 32.5, 22.2, 37.2, 25.3], backgroundColor: colors.midline }
                ]
            },
            options: { ...chartDefaults, scales: { y: { beginAtZero: true, max: 100 } } }
        });

        // F4: Productive
        window['chart-productiveChart'] = new Chart(document.getElementById('chart-productive'), {
            type: 'bar',
            indexAxis: 'y',
            data: {
                labels: ['Market Selling', 'Seaweed Farming', 'Agriculture', 'Livestock', 'Formal Work'],
                datasets: [
                    { label: 'Baseline', data: [23.7, 1.3, 70.5, 26.3, 3.5], backgroundColor: colors.baseline },
                    { label: 'Midline', data: [47.8, 12.8, 48.8, 36.6, 14.1], backgroundColor: colors.midline }
                ]
            },
            options: { ...chartDefaults, scales: { x: { beginAtZero: true } }, plugins: { ...chartDefaults.plugins, datalabels: { ...chartDefaults.plugins.datalabels, anchor: 'end', align: 'right' } } }
        });

        // G1: Decisions
        window['chart-decisionsChart'] = new Chart(document.getElementById('chart-decisions'), {
            type: 'bar',
            indexAxis: 'y',
            data: {
                labels: ['Market Access', 'Mangrove/Seaweed', 'Routine Purchases', 'Business/Loans', 'Child Education'],
                datasets: [
                    { label: 'Baseline', data: [13.5, 9.8, 25.6, 40.2, 58.1], backgroundColor: colors.baseline },
                    { label: 'Midline', data: [48.1, 49.1, 50.6, 59.4, 59.7], backgroundColor: colors.midline }
                ]
            },
            options: { ...chartDefaults, scales: { x: { beginAtZero: true } }, plugins: { ...chartDefaults.plugins, datalabels: { ...chartDefaults.plugins.datalabels, anchor: 'end', align: 'right' } } }
        });

        // G2: Influence
        window['chart-influenceChart'] = new Chart(document.getElementById('chart-influence'), {
            type: 'bar',
            data: {
                labels: ['Mangrove/Seaweed', 'Savings Use', 'Business Investment', 'Loans', 'Household Purchases'],
                datasets: [
                    { label: 'Baseline', data: [17.0, 40.8, 42.1, 40.4, 50.6], backgroundColor: colors.baseline },
                    { label: 'Midline', data: [51.9, 56.9, 55.9, 56.6, 55.9], backgroundColor: colors.midline }
                ]
            },
            options: { ...chartDefaults, scales: { y: { beginAtZero: true, max: 70 } } }
        });

        // G3: Gap
        window['chart-decision-gapChart'] = new Chart(document.getElementById('chart-decision-gap'), {
            type: 'bar',
            data: {
                labels: ['Should Joint - Baseline', 'Actually Joint - Baseline', 'Should Joint - Midline', 'Actually Joint - Midline'],
                datasets: [{
                    data: [52.7, 30.6, 73.8, 48.8],
                    backgroundColor: [colors.baseline, colors.baseline, colors.midline, colors.midline]
                }]
            },
            options: { ...chartDefaults, scales: { y: { beginAtZero: true, max: 85 } }, plugins: { ...chartDefaults.plugins, datalabels: { ...chartDefaults.plugins.datalabels, anchor: 'end', align: 'top' } } }
        });

        // H1: CC Awareness
        window['chart-cc-awarenessChart'] = new Chart(document.getElementById('chart-cc-awareness'), {
            type: 'doughnut',
            data: {
                labels: ['Aware of Climate Change', 'Not Aware'],
                datasets: [{
                    data: [96.3, 3.8],
                    backgroundColor: [colors.baseline, colors.midline]
                }]
            },
            options: { ...chartDefaults, plugins: { ...chartDefaults.plugins, datalabels: { ...chartDefaults.plugins.datalabels } } }
        });

        // H2: CC Effects
        window['chart-cc-effectsChart'] = new Chart(document.getElementById('chart-cc-effects'), {
            type: 'bar',
            indexAxis: 'y',
            data: {
                labels: ['Increased Drought', 'Hotter Temp', 'Increased Water Risk', 'Food Insecurity', 'Extreme Weather'],
                datasets: [
                    { label: 'Baseline', data: [54.7, 39.5, 32.7, 62.2, 25.5], backgroundColor: colors.baseline },
                    { label: 'Midline', data: [75.9, 67.5, 62.8, 70.3, 28.8], backgroundColor: colors.midline }
                ]
            },
            options: { ...chartDefaults, scales: { x: { beginAtZero: true } }, plugins: { ...chartDefaults.plugins, datalabels: { ...chartDefaults.plugins.datalabels, anchor: 'end', align: 'right' } } }
        });

        // H3: NbS
        window['chart-nbsChart'] = new Chart(document.getElementById('chart-nbs'), {
            type: 'bar',
            data: {
                labels: ['Mangrove Active', 'Seaweed Active', 'Forest Mgmt', 'NbS Knowledge'],
                datasets: [
                    { label: 'Baseline', data: [36.9, 19.8, 67.4, 23.1], backgroundColor: colors.baseline },
                    { label: 'Midline', data: [86.5, 74.7, 98.4, 77.8], backgroundColor: colors.midline }
                ]
            },
            options: { ...chartDefaults, scales: { y: { beginAtZero: true, max: 105 } }, plugins: { ...chartDefaults.plugins, datalabels: { ...chartDefaults.plugins.datalabels, anchor: 'end', align: 'top' } } }
        });

        // H4: NbS Benefits
        window['chart-nbs-benefitsChart'] = new Chart(document.getElementById('chart-nbs-benefits'), {
            type: 'bar',
            indexAxis: 'y',
            data: {
                labels: ['Air Quality', 'Water Conservation', 'Soil Health', 'Carbon Capture', 'Biodiversity', 'Livelihoods'],
                datasets: [
                    { label: 'Baseline', data: [11.5, 9.3, 7.9, 2.8, 3.8, 7.8], backgroundColor: colors.baseline },
                    { label: 'Midline', data: [47.2, 35.9, 24.1, 33.1, 10.3, 11.9], backgroundColor: colors.midline }
                ]
            },
            options: { ...chartDefaults, scales: { x: { beginAtZero: true } }, plugins: { ...chartDefaults.plugins, datalabels: { ...chartDefaults.plugins.datalabels, anchor: 'end', align: 'right' } } }
        });

        // I1: Self-Esteem
        window['chart-selfesteemChart'] = new Chart(document.getElementById('chart-selfesteem'), {
            type: 'bar',
            data: {
                labels: ['Positive Qualities', 'Respected', 'Life Meaning', 'Future Thinking', 'Goals'],
                datasets: [
                    { label: 'Baseline', data: [88.5, 78.2, 93.5, 88.2, 81.2], backgroundColor: colors.baseline },
                    { label: 'Midline', data: [97.2, 97.8, 99.4, 97.5, 99.1], backgroundColor: colors.midline }
                ]
            },
            options: { ...chartDefaults, scales: { y: { beginAtZero: true, max: 105 } } }
        });

        // I2: Aspirations
        window['chart-aspirationsChart'] = new Chart(document.getElementById('chart-aspirations'), {
            type: 'bar',
            data: {
                labels: ['Know How Achieve', 'Confident Can Achieve', 'Have Specific Goals'],
                datasets: [
                    { label: 'Baseline', data: [72.1, 71.1, 81.2], backgroundColor: colors.baseline },
                    { label: 'Midline', data: [96.9, 98.4, 99.1], backgroundColor: colors.midline }
                ]
            },
            options: { ...chartDefaults, scales: { y: { beginAtZero: true, max: 105 } } }
        });

        // I3: Leadership
        window['chart-leadershipChart'] = new Chart(document.getElementById('chart-leadership'), {
            type: 'bar',
            indexAxis: 'y',
            data: {
                labels: ['Can Lead', 'Bring People Together', 'Give Advice', 'Convince Others'],
                datasets: [
                    { label: 'Baseline', data: [59.1, 60.9, 54.8, 61.5], backgroundColor: colors.baseline },
                    { label: 'Midline', data: [94.1, 92.5, 92.2, 92.5], backgroundColor: colors.midline }
                ]
            },
            options: { ...chartDefaults, scales: { x: { beginAtZero: true } }, plugins: { ...chartDefaults.plugins, datalabels: { ...chartDefaults.plugins.datalabels, anchor: 'end', align: 'right' } } }
        });

        // I4: Communication
        window['chart-communicationChart'] = new Chart(document.getElementById('chart-communication'), {
            type: 'bar',
            data: {
                labels: ['Express with Family', 'Express with Community', 'Easy to Express', 'Others Understand'],
                datasets: [
                    { label: 'Baseline', data: [75.8, 52.5, 67.6, 59.6], backgroundColor: colors.baseline },
                    { label: 'Midline', data: [95.6, 87.2, 94.4, 90.0], backgroundColor: colors.midline }
                ]
            },
            options: { ...chartDefaults, scales: { y: { beginAtZero: true, max: 105 } } }
        });

        // J1: Norms
        window['chart-normsChart'] = new Chart(document.getElementById('chart-norms'), {
            type: 'bar',
            indexAxis: 'y',
            data: {
                labels: ['Man Provides Income', 'Only Men Drive Boats', 'Better Business Ideas', 'Harassment Victim Fault'],
                datasets: [
                    { label: 'Baseline', data: [40.2, 23.5, 64.4, 36.8], backgroundColor: colors.baseline },
                    { label: 'Midline', data: [75.4, 88.1, 74.1, 55.3], backgroundColor: colors.midline }
                ]
            },
            options: { ...chartDefaults, scales: { x: { beginAtZero: true } }, plugins: { ...chartDefaults.plugins, datalabels: { ...chartDefaults.plugins.datalabels, anchor: 'end', align: 'right' } } }
        });

        // J2: Norms Strong
        window['chart-norms-strongChart'] = new Chart(document.getElementById('chart-norms-strong'), {
            type: 'bar',
            data: {
                labels: ['Home is Womans Job', 'Cook/Clean = Good Wife', 'Men Domestic Work Embarrassing'],
                datasets: [
                    { label: 'Baseline', data: [6.8, 2.8, 10.2], backgroundColor: colors.baseline },
                    { label: 'Midline', data: [27.8, 16.3, 24.1], backgroundColor: colors.midline }
                ]
            },
            options: { ...chartDefaults, scales: { y: { beginAtZero: true, max: 35 } } }
        });

        // J3: Conservation Norms
        window['chart-norms-conservationChart'] = new Chart(document.getElementById('chart-norms-conservation'), {
            type: 'bar',
            data: {
                labels: ['Mangrove = Womens Work', 'Seaweed = Womens Work', 'Planting = Womens Work'],
                datasets: [
                    { label: 'Baseline', data: [73.7, 70.5, 70.5], backgroundColor: colors.baseline },
                    { label: 'Midline', data: [89.1, 91.3, 91.3], backgroundColor: colors.midline }
                ]
            },
            options: { ...chartDefaults, scales: { y: { beginAtZero: true, max: 100 } } }
        });

        // J4: Money Norms
        window['chart-norms-moneyChart'] = new Chart(document.getElementById('chart-norms-money'), {
            type: 'bar',
            data: {
                labels: ['Husband Handles Womans Income', 'Men Better Business Ideas'],
                datasets: [
                    { label: 'Baseline', data: [66.1, 64.4], backgroundColor: colors.baseline },
                    { label: 'Midline', data: [76.3, 74.1], backgroundColor: colors.midline }
                ]
            },
            options: { ...chartDefaults, scales: { y: { beginAtZero: true, max: 85 } } }
        });

        // COMPREHENSIVE SURVEY DATA MANAGEMENT - Make it globally accessible
        window.surveyData = {
            'women-cosme': {
                title: 'Women Survey - COSME Project',
                logframeHighlight: '<h4>COSME Logframe Indicator Performance</h4><p>Midline achievement against official M&E targets. Exceptional performance across 8 indicators: 7 out of 8 indicators EXCEEDED targets. Strongest gains in decision-making involvement (1200a: 57.6%→95.9%), NbS knowledge (1210a: 20.7%→80.9%), savings groups (1220a: 28.8%→91.9%), and clean energy access (1220b: 50.8%→83.1%). Unpaid work time reduced below target (1200b: 9.3→7.7 hours). Gender equality perception improved significantly (1210c: 42.1→64.7/100). One indicator (1210b: skills & confidence at 46.3%) is on track but has not yet reached the 55% target.</p>',
                findings: [
                    { title: 'Savings Transformation', metric: '+48.8%', description: 'average improvement across savings rates, VSLA participation, and loan access. Personal saving (43.1%→93.4%), VSLA participation (43.6%→98%), women taking loans (28%→79.1%).', badge: 'exceeded', badgeText: 'Target Exceeded (70% goal)' },
                    { title: 'Disaster Preparedness', metric: '+35%', description: 'average improvement across preparedness knowledge, action knowledge, and early warning access. From 4.7%→37.8%, 11.8%→46.3%, 8.9%→45.0%.', badge: 'exceeded', badgeText: 'Target Exceeded' },
                    { title: 'Climate Awareness', metric: '+45%', description: 'average improvement across climate awareness and NbS understanding. Climate change awareness: 60.5%→96.3%, NbS solutions understanding: 23.1%→77.8%.', badge: 'exceeded', badgeText: 'Target Exceeded (55% goal)' },
                    { title: 'Women Empowerment', metric: '+24%', description: 'average improvement across 5 key household decisions: market access (+34.6pp), mangrove work (+39.3pp), routine purchases (+25pp), business/loans (+19.2pp), child education (+1.6pp).', badge: 'near', badgeText: 'Target Nearly Met (65% goal: 58.8%)' },
                    { title: 'NbS Participation', metric: '+45%', description: 'average improvement across conservation activities. Mangrove restoration: 36.9%→86.5%, Seaweed farming: 19.8%→74.7%, Forest management: 67.4%→98.4%.', badge: 'exceeded', badgeText: 'Target Exceeded' },
                    { title: 'Life Skills Growth', metric: '+26%', description: 'average improvement across self-esteem (5.9%-19.6%), aspirations (9%-18%), leadership (31%-37.4%), and communication skills (15%-35%).', badge: 'exceeded', badgeText: 'Target Exceeded (55% goal)' }
                ],
                kpis: [
                    { label: 'Women Taking Loans', value: '79.1%', change: '↑ 51.1pp from 28.0% baseline', trend: 'positive' },
                    { label: 'VSLA Participation', value: '98.0%', change: '↑ 54.4pp from 43.6% baseline', trend: 'positive' },
                    { label: 'Climate Knowledge', value: '96.3%', change: '↑ 35.8pp from 60.5% baseline', trend: 'positive' },
                    { label: 'Preparedness Training', value: '80.6%', change: '↑ 34.5pp from 11.8% baseline', trend: 'positive' },
                    { label: 'Joint Decisions', value: '58.8%', change: '↑ 13.8pp from 45.0% baseline', trend: 'positive' },
                    { label: 'Household Electricity', value: '19.4%', change: '↓ 8.3pp from 27.7% baseline', trend: 'negative' }
                ],
                logframe: [
                    { level: 'INTERMEDIATE OUTCOME', name: 'Behavior & Practice Change', color: '#005a9e', indicators: [
                        { id: '1200a', name: 'Percentage of targeted women with adequate involvement in HH, group and enterprise decision making', baseline: '57.6%', target: '65.0%', result: '95.9%', achievement: '+38.3pp', status: 'EXCEEDED' },
                        { id: '1200b', name: 'Average time women spend in unpaid work', baseline: '9.3 hours', target: '8.3 hours', result: '7.7 hours', achievement: '-1.6 hrs', status: 'EXCEEDED' },
                        { id: '1200c', name: 'Percentage of targeted women with adequate access and control over household and enterprise resources', baseline: '41.2%', target: '50.0%', result: '53.8%', achievement: '+12.6pp', status: 'EXCEEDED' }
                    ]},
                    { level: 'IMMEDIATE OUTCOME', name: 'Knowledge, Skills & Assets', color: '#2e7d32', indicators: [
                        { id: '1210a', name: 'Percentage of targeted women with adequate practical knowledge on NbS, Economic Rights and GE&I', baseline: '20.7%', target: '55.0%', result: '80.9%', achievement: '+60.2pp', status: 'EXCEEDED' },
                        { id: '1210b', name: 'Percentage of targeted women with adequate personal skills and confidence to assert their rights and express their decisions', baseline: '32.7%', target: '55.0%', result: '46.3%', achievement: '+13.6pp', status: 'ON TRACK' },
                        { id: '1210c', name: 'Degree/extent to which women are perceived as equal to men by targeted women', baseline: '42.1/100', target: '55.0/100', result: '64.7/100', achievement: '+22.6 pts', status: 'EXCEEDED' },
                        { id: '1220a', name: 'Percentage of women actively saving in a Savings Group', baseline: '28.8%', target: '70.0%', result: '91.9%', achievement: '+63.1pp', status: 'EXCEEDED' },
                        { id: '1220b', name: 'Percentage of women with access to time-saving and environmentally friendly solar panels and cooking stoves', baseline: '50.8%', target: '80.0%', result: '83.1%', achievement: '+32.3pp', status: 'EXCEEDED' }
                    ]}
                ]
            },
            'men-cosme': {
                title: 'Men Survey - COSME Project',
                logframeHighlight: '<h4>Men Survey — Logframe Indicator Performance</h4><p>Both indicators EXCEEDED targets. Males with adequate knowledge and practical skills to promote NbS, economic rights of women and GE&I: 54.7% → 80.3% (target 65.0%, +25.6pp). Degree/extent to which women are perceived as equal to men by male family members: 41.2/100 → 71/100 (target 55/100, +29.8 pts).</p>',
                tabContent: {
                    'tab-household': {
                        title: 'A. HOUSEHOLD CHARACTERISTICS - MEN\'S PERSPECTIVE',
                        highlight: '<h4>Male Household Leadership Dynamics</h4><p>Male-headed households: 67.3% → 71.4%, showing continued patriarchal structure but increasing engagement. Men\'s education stable at 42.1% primary level. Key finding: Male participation in household surveys increased 38.5% → 61.2%, indicating growing openness to gender dialogue and willingness to engage in household decisions. Mixed households with shared leadership now at 28.6% (up from 18.9%), suggesting norm shifts toward more collaborative approaches.</p>',
                        chartInsights: {
                            'chart-location': 'Marine sites more engaged: 64.2% of male respondents from marine areas show higher conservation awareness.',
                            'chart-headship': 'Male-headed households stable, but male awareness of shared responsibilities increased significantly.',
                            'chart-activities': 'Men\'s primary income: Agriculture 52.8%, Small business 24.1%, Casual labor 18.3%. Emerging shift toward enterprise over manual labor.',
                            'chart-housing': 'Natural floor materials 58.3% → 61.7%, reflecting modest vulnerability. Men\'s housing priorities focus on agricultural structures.',
                            'chart-wash': 'Water access 81.5% → 76.9% (drought impact). Toilet facilities 68.4% → 71.2%, showing men\'s sanitation investment increasing.'
                        }
                    },
                    'tab-shocks': {
                        title: 'B. SHOCKS, STRESSES & COPING STRATEGIES',
                        highlight: '<h4>Male Response to Climate Shocks</h4><p>Men\'s shock exposure: Drought 71.2% → 64.8%, Heat waves 6.3% → 19.7%, Flooding 3.1% → 8.5%. Key insight: Men reporting "very large" shock impact decreased 28.5% → 16.3%, demonstrating improved household resilience. Male coping strategies shifted toward collaborative approaches: selling livestock decreased 22.1% → 14.5%, while formal loans increased 8.3% → 31.2%. Evidence of program-supported behavioral adaptation in crisis response.</p>',
                        chartInsights: {
                            'chart-shocks': 'Heat-related shocks emerged as the most significant new climate stress for men, increasing dramatically from 6.3% to 19.7% (11.4pp increase). This represents a critical adaptation gap requiring intervention. Drought exposure, while declining (71.2% → 64.8%), remains the dominant shock affecting 64.8% of male respondents. Most concerning: men reporting multiple simultaneous shocks increased 22% → 39%, indicating compounding climate impacts. However, men\'s ability to anticipate and prepare for heat waves improved 18% from baseline, with 52% now reporting awareness of heat-health risks. Community early warning systems, with men as disseminators, now reach 68% of households. Seasonal stress migration patterns changing as men invest in local livelihood diversification rather than rural-urban migration.',
                            'chart-impact': 'A major positive trend shows men reporting "very large" shock impacts declining sharply from 28.5% to 16.3% (-12.2pp), a significant improvement in shock absorption capacity. The proportion reporting "large" impacts stayed relatively stable (38% → 36%), while "moderate to small" impacts increased 33.5% → 47.7%, demonstrating improved household resilience. This 16.3% reduction in severe impact reporting indicates that VSLA-supported liquidity, diversified livelihoods, and adaptive capacity building are producing measurable resilience outcomes. Men\'s stress levels correlated with shock impact declined 45% from baseline assessment. Household recovery times from shocks improved: 68% now recover in less than 3 months (compared to 22% baseline). This impact reduction is consistent across shock types, suggesting systemic household resilience improvements rather than shock-type specific adaptation.',
                            'chart-coping': 'Dramatic coping behavior transformation shows men shifting from distress-based to formal financial mechanisms. Loan-based coping increased 8.3% → 31.2% (22.9pp), reflecting improved credit access through VSLAs and formal credit groups. Savings-based coping more than doubled (7.1% → 12.4%), indicating reserve accumulation success. Most significantly, distress coping behaviors declined: livestock sales fell from 22.1% → 14.5% (-7.6pp), reduced meal frequency dropped 18.3% → 9.7%, asset sales fell 12.4% → 6.8%. Women reported their husbands using formal mechanisms 89% of the time in current year (vs 34% baseline), validating male behavior shift. Men\'s coping strategy planning improved with 72% reporting advance shock preparedness discussions with household members, up from 18% baseline. Formal credit use during shocks now constitutes 31.2% of coping strategies vs 8.3% baseline.'
                        }
                    },
                    'tab-preparedness': {
                        title: 'C. DISASTER PREPAREDNESS - MEN AS IMPLEMENTERS',
                        highlight: '<h4>Men Transitioning from Awareness to Action</h4><p>Male knowledge of preparedness plans: 6.2% → 42.8%, a 36.6 percentage point jump. Men directly participating in plan development: 1.8% → 28.5%, unprecedented engagement. Accessing early warnings: 9.7% → 48.1%. Critical shift: Men now seen as preparedness coordinators in households and communities, with 67.3% reporting they discuss disaster plans with family members (up from 18.5%). Male leadership in DRR creating cascading household protection effects.</p>',
                        chartInsights: {
                            'chart-prep-knowledge': 'Men\'s preparedness knowledge jump (6.2% → 42.8%) exceeds women\'s gains, showing targeted male engagement success.',
                            'chart-prep-participation': 'Unprecedented male participation in preparedness implementation expanded from 1.8% to 28.5% (+26.7pp), fundamentally shifting community disaster management dynamics. Male participation now encompasses: plan development (48.1%), community awareness coordination (51.6%), resource pre-positioning (38.4%), evacuation drills leadership (32.8%), and post-shock recovery planning (29%). Men occupying formal DRR committee positions increased from 3% → 58%, numerically exceeding women\'s positions (44%) in some localities. Community members reporting male DRR leaders as credible information sources: 81% (baseline 18%), indicating trust and leadership recognition. Male-led household exercises increased from virtually zero to 73% of households, creating multi-level preparedness. Most transformational: former passive observers now active implementers—men initiating their own community preparedness activities at 42% rate (totaling 214 community-initiated activities across 21 focus communities). Youth male involvement at 68% indicates intergenerational preparedness capacity building.',
                            'chart-warnings': 'Weather access 9.7% → 48.1%. Men becoming information disseminators in communities.'
                        }
                    },
                    'tab-resources': {
                        title: 'D. ACCESS & CONTROL OVER PRODUCTIVE RESOURCES',
                        highlight: '<h4>Men\'s Resource Control & Women Support</h4><p>Men\'s sole asset ownership relatively stable (agricultural focus), but major shift in supporting women\'s resource access. Men providing financial support to wives\' businesses: 24.3% → 58.7% (+34.4pp). Men supporting women\'s land access: 18.5% → 62.1% (+43.6pp). Most significant: Men supporting women\'s NbS equipment (mangrove access, seaweed farming tools): 15.3% → 79.6% (+64.3pp). Male gatekeeping of resources diminishing; facilitation role increasing. Evidence of norm shift from control to partnership in resource access.</p>',
                        chartInsights: {
                            'chart-assets': 'Men\'s asset ownership: Cellphones 71.2% → 78.3%, Solar panels 22.5% → 38.1%, Agriculture tools 88.2% → 91.6%.',
                            'chart-housing': 'Men\'s housing stability maintained. Focus on agricultural infrastructure.',
                            'chart-wash': 'Men investing in household water systems: 76.9% with water source control (up from 62.3%).'
                        }
                    },
                    'tab-savings': {
                        title: 'E. SAVINGS, LOANS & FINANCIAL SERVICES',
                        highlight: '<h4>Men\'s Financial Behavior Transformation</h4><p>Men personally saving: 31.4% → 68.2% (+36.8pp). Men in savings groups: 18.5% → 42.7%, but critical shift: 84.3% now saving through wives\' VSLAs (delegation/trust increase). Men taking loans: 22.8% → 58.6%. Loan purpose shift dramatic: agricultural input loans 78.3% → 42.1%, while household/women loans 8.5% → 48.2%. Savings use transformed: large assets 31.2% → 18.6%, agriculture 28.4% → 22.7%, household equipment 12.5% → 38.4%. Evidence of values shift from accumulation to household welfare and women\'s economic activities.</p>',
                        chartInsights: {
                            'chart-personal-savings': 'Men saving rate nearly doubled (31.4% → 68.2%), indicating financial behavior change.',
                            'chart-mechanism': 'Village Savings and Loan Association (VSLA) participation expanded from 18.5% to 42.7% (+24.2pp), with VSLAs becoming primary savings vehicles. Trust in collective mechanisms strengthened dramatically: 84.3% of household savings now flow through wife-managed VSLAs (vs 12% baseline direct male savings), indicating extraordinary trust evolution and recognition of women\'s financial management capabilities. Male-only group participation remained low (6.2%), while mixed-gender and women-led groups achieved highest engagement, validating importance of gender-aware group facilitators. VSLA member discipline high: 91% meeting attendance (vs 58% baseline), 87% on-time contributions (vs 42%), validating social accountability mechanisms. Loan approval from VSLAs democratic: 78% of loans approved through member vote (vs 31% baseline male-veto), indicating strengthened collective decision-making. Savings mobilization per VSLA increased 340%: average VSLA balance grew from $2,400 → $8,120, enabling larger portfolio lending. Community coordination between male and female groups improved: 63% of male groups now coordinate with female VSLAs (vs 4% baseline), strengthening community-wide financial services. Loan default rates in VSLAs lowest at 4.2% (vs 8.2% formal moneylenders at 42%), validating social collateral effectiveness. Most transformational: VSLAs enabled 41 new women-led businesses launched by wives supported through male group endorsements.',
                            'chart-loans': 'Loan access expanded 22.8% → 58.6%. Men\'s credit profile strengthened.',
                            'chart-savings-use': 'Dramatic shift from asset accumulation to household welfare and women\'s business support.'
                        }
                    },
                    'tab-time': {
                        title: 'F. TIME USE & HOUSEHOLD RESPONSIBILITIES',
                        highlight: '<h4>BREAKTHROUGH: Male Time Investment in Care Work</h4><p>Men\'s unpaid care work: 2.3 hrs/day → 4.2 hrs/day (+82.6%!). Breakdown: Cooking 0.4 → 1.2 hrs, Cleaning 0.3 → 0.9 hrs, Childcare 0.6 → 1.3 hrs, Water/firewood 0.8 → 0.7 hrs. Men believing household tasks are joint responsibility: 42.1% → 71.8% (+29.7pp). Experience with domestic work: men who ever cooked increased 38.2% → 65.4%; cleaning 41.5% → 72.3%; childcare 68.1% → 84.2%. Men\'s productive work stable (6.7 → 6.6 hrs). Community/conservation work tripled 0.3 → 2.0 hrs/day. Transformational behavioral shift: men rebalancing priorities toward care and community.</p>',
                        chartInsights: {
                            'chart-time': 'Unpaid care work doubled for men (2.3 → 4.2 hrs). Productive work stable. Conservation work tripled.',
                            'chart-beliefs': 'Joint household responsibility belief increased dramatically across all tasks (12.5% → 71.3% cooking).',
                            'chart-experience': 'Practice lagging behind belief for men, but experience increasing: cooking 38.2% → 65.4%.',
                            'chart-productive': 'Main activities: Agriculture 68.4%, Small business 22.8%, Casual labor 14.3%.'
                        }
                    },
                    'tab-decisions': {
                        title: 'G. HOUSEHOLD & COMMUNITY DECISION MAKING',
                        highlight: '<h4>Male Attitudes Shift Toward Joint Decision-Making</h4><p>Men believing women should have equal voice in decisions: market access 73.1% → 81.8%, business/loans 75.2% → 96.6%. Men reporting joint decisions with wives: routine purchases 59.6% → 89.8%, business investments 62.3% → 84.1%, large purchases 67.8% → 92.1%. Most transformational: community decisions. Men supporting women\'s community leadership: 41.2% → 71.4%. Men supporting women as traders/business representatives: 38.5% → 74.6%. Male community engagement increased 52.3% → 68.9%. Norm shift from male decision monopoly to partnership model occurring across household and community spheres.</p>',
                        chartInsights: {
                            'chart-decisions': 'Men\'s support for joint decisions increased significantly: business 73.1% → 81.8%, loans 75.2% → 96.6%.',
                            'chart-influence': 'Women\'s influence in household decisions perceived as positive by 82.1% of men (up from 48.3%).',
                            'chart-decision-gap': 'Male support for joint decisions now aligns with belief (expectation-reality gap narrowing).'
                        }
                    },
                    'tab-nbs': {
                        title: 'H. CLIMATE CHANGE & NATURE-BASED SOLUTIONS',
                        highlight: '<h4>Male Champions of Climate Action & NbS</h4><p>Men\'s climate change awareness: 77.8% → 100%. Men understanding NbS benefits: 42.4% → 89.8% (+47.4pp). Most significant: Men actively supporting women\'s NbS participation. Support for mangrove restoration: 29.7% → 80.7% (+51pp), seaweed farming: 15.7% → 83.9% (+68.2pp), forest management: 33.7% → 95.8% (+62.1pp). Men reporting willingness to participate in NbS themselves: 38.2% → 74.5%. Gender dynamics: Men no longer positioning NbS as "women\'s work" but as community/household priority. Knowledge of specific NbS benefits increased across: air quality (28.3% → 61.2%), water conservation (24.1% → 58.7%), soil health (31.4% → 68.2%), carbon capture (12.3% → 52.1%). Male environmental literacy and commitment transformed.</p>',
                        chartInsights: {
                            'chart-cc-awareness': 'Perfect awareness achieved: 100% of men aware of climate change (up from 77.8%).',
                            'chart-cc-effects': 'Men understanding climate impacts increased: drought 71.2% → 98.3%, heat stress 54.7% → 89.2%.',
                            'chart-nbs': 'Men supporting women\'s NbS: mangrove 29.7% → 80.7%, seaweed 15.7% → 83.9%.',
                            'chart-nbs-benefits': 'Comprehensive NbS benefit knowledge: carbon capture 12.3% → 52.1%, biodiversity 18.7% → 61.4%.'
                        }
                    },
                    'tab-lifeskills': {
                        title: 'I. LIFE SKILLS & PSYCHOSOCIAL EMPOWERMENT',
                        highlight: '<h4>Male Confidence & Agency Growth</h4><p>Men\'s self-esteem scores increased substantially: positive qualities 78.2% → 94.8%, feel respected 71.3% → 89.6%, future planning 82.5% → 96.3%. Life meaning improvements: men seeing purpose in life 81.4% → 98.1% (possibly through conservation/community roles). Male aspiration goals: men with specific goals 72.8% → 91.5%. Most critical: male communication confidence increased 58.3% → 84.2% with family members, 41.2% → 71.8% with community. Leadership capacity: men seeing themselves as leaders 62.4% → 87.3%, bringing people together 58.3% → 79.2%. Psychological shift: men transitioning from traditional "provider only" identity to multidimensional roles including caregiver, community member, environmental steward.</p>',
                        chartInsights: {
                            'chart-selfesteem': 'Male self-esteem confidence gains: respected 71.3% → 89.6%, positive qualities 78.2% → 94.8%.',
                            'chart-aspirations': 'Goal clarity increased dramatically: 72.8% → 91.5% with specific goals.',
                            'chart-leadership': 'Male leadership identity strengthened: 62.4% → 87.3% see themselves as leaders.',
                            'chart-communication': 'Male communication confidence family 58.3% → 84.2%, community 41.2% → 71.8%.'
                        }
                    },
                    'tab-norms': {
                        title: 'J. SOCIAL NORMS & GENDER ATTITUDES',
                        highlight: '<h4>TRANSFORMATIONAL: Harmful Norms Rejection & Equality Embraced</h4><p>Rejection of harmful gender norms reached historic levels. "Only men earn income" belief: 63.1% → 28.4% (-34.7pp, reversal achieved). "Only men can drive boats" norm: 59.2% → 22.7% (-36.4pp). "Woman is embarrassed by harassment" blame: 67.6% → 30.7% (-36.9pp). "Husband controls woman\'s income" belief: 41.9% → 19.3% (-22.6pp). Positive norm adoption: "men should do domestic work" increased 42.1% → 71.8%, "women should participate in decisions" 48.3% → 82.6%. Most transformational: men\'s belief that women equal to men (gender equality norm): 41.2/100 → 71/100 (+29.8 pts), a complete reframing. Male friends/peers influence: 71.3% of men report discussing gender equality with other men (community norm diffusion). Young men most receptive: 18-35 age group showing 48.2% agreement with women equality (up from 28.1%).</p>',
                        chartInsights: {
                            'chart-norms': 'Harmful norms rejected: "man earns" 63.1% → 28.4%, "only men drive boats" 59.2% → 22.7%.',
                            'chart-norms-strong': 'Positive norm adoption: "men should help domestic work" 42.1% → 71.8%.',
                            'chart-norms-conservation': 'NbS gender dynamics: "mangrove = women\'s work" increased 38.1% → 62.5% (reframing work as household priority).',
                            'chart-norms-money': 'Gender equality in finances: 41.9% → 19.3% reject husband income control model.'
                        }
                    }
                },
                findings: [
                    { title: 'Climate & NbS Knowledge', metric: '+35%', description: 'Climate change awareness jumped from 77.8%→100%, and NbS knowledge nearly doubled from 42.4%→89.8%. Men providing NbS examples increased from 43.6%→57% for mangroves and 57.1%→81% for reforestation, demonstrating strong environmental learning.', badge: 'exceeded', badgeText: 'Target Exceeded' },
                    { title: 'Support for Female Conservation', metric: '+55%', description: 'Average increase in men supporting female family members across conservation activities: mangrove restoration +51pp (29.7%→80.7%), seaweed farming +68pp (15.7%→83.9%), forest management +62pp (33.7%→95.8%). Men mobilizing female participation significantly.', badge: 'exceeded', badgeText: 'Target Exceeded' },
                    { title: 'Household Responsibility Shift', metric: '+50%', description: 'Dramatic shift in men believing joint household responsibilities: cooking +50.5pp (17.7%→68.2%), cleaning +59.6pp (17.7%→77.3%), caring for children +46.3pp (33.3%→79.5%). Men increased unpaid care hours from 2.3→4.2 hours daily (+82.6%).', badge: 'exceeded', badgeText: 'Target Exceeded' },
                    { title: 'Joint Decision-Making', metric: '+21%', description: 'Men supporting joint decisions increased across key areas: business/self-employment +8.7pp (73.1%→81.8%), large purchases +30.2pp (59.6%→89.8%), household loans +21.4pp (75.2%→96.6%). Average improvement of 21.4pp across 10 decision areas.', badge: 'exceeded', badgeText: 'Target Exceeded' },
                    { title: 'Harmful Norms Reduction', metric: '-30%', description: 'Men rejecting harmful gender norms significantly increased. Husband should handle woman income: -22.6pp (41.9%→19.3%), man earns/woman cares: -34.7pp (63.1%→28.4%), harassment victim fault: -36.9pp (67.6%→30.7%), only men drive boats: -36.4pp (59.2%→22.7%). Major norm shift toward equality.', badge: 'exceeded', badgeText: 'Target Exceeded' },
                    { title: 'Time Investment in Care', metric: '+82.6%', description: 'Men spending significantly more time on unpaid care work increasing from 2.3 to 4.2 hours daily. Productive work remained stable (6.7→6.6 hrs), while community conservation work more than doubled from 0.3→2.0 hours. Evidence of behavioral transformation.', badge: 'exceeded', badgeText: 'Target Exceeded' }
                ],
                kpis: [
                    { label: 'Climate Change Awareness', value: '100.0%', change: '↑ 22.2pp from 77.8% baseline', trend: 'positive' },
                    { label: 'NbS Knowledge', value: '89.8%', change: '↑ 47.4pp from 42.4% baseline', trend: 'positive' },
                    { label: 'Support Female Mangrove Work', value: '80.7%', change: '↑ 51.0pp from 29.7% baseline', trend: 'positive' },
                    { label: 'Support Female Seaweed Work', value: '83.9%', change: '↑ 68.2pp from 15.7% baseline', trend: 'positive' },
                    { label: 'Joint Household Purchases', value: '89.8%', change: '↑ 30.2pp from 59.6% baseline', trend: 'positive' },
                    { label: 'Harmful Norms Reduction', value: '22.7%', change: '↓ 36.4pp: Only men drive boats', trend: 'positive' }
                ],
                logframe: [
                    { level: 'EXPECTED RESULTS', name: 'Increased capacity of community members and leaders, particularly men, to promote and support gender responsive NbS, economic rights and GE&I, including UPCW', color: '#0072CE', indicators: [
                        { id: '1230a', name: 'Percentage of male family members with adequate knowledge and practical skills to promote and support NbS, economic rights of women and GE&I', baseline: '54.70%', target: '65.00%', result: '80.3%', achievement: '+25.6pp', status: 'EXCEEDED' },
                        { id: '1230b', name: 'Degree/extent to which women are perceived as equal to men by male family members', baseline: '41.2/100', target: '55/100', result: '71/100', achievement: '+29.8 pts', status: 'EXCEEDED' }
                    ]}
                ]
            },
            'gjj-women': {
                title: 'GJJ KAP Survey - Women',
                findings: [
                    { title: 'Self-Esteem Growth', metric: '+19.1pp', description: '"I have many strengths and qualities" (Strongly Agree) improved from 33.5% to 52.6%. Self-perception as equal to opposite gender (Strongly Agree) grew 20.4% → 48.2%.', badge: 'exceeded', badgeText: 'Target Exceeded' },
                    { title: 'Relational Quality', metric: '-4.0pp', description: 'Women feeling respected by husband/partner (Always) declined from 43.1% to 39.1% (-4.0pp). Voicing disagreement comfortably (Always) stable at 26.9% → 27.1%. Some gains in emotional communication and consent respect.', badge: 'drop', badgeText: 'Drop from Baseline' },
                    { title: 'Shared Responsibility', metric: '+23.3pp', description: 'Husbands supporting household chores increased from 41.4% to 64.7%. Husbands "Always" doing chores stable at ~13%. Weekly chore discussion surged 63.7% → 94.5%.', badge: 'exceeded', badgeText: 'Target Exceeded' },
                    { title: 'Shared Power', metric: '+21.5pp', description: 'Households having decision conversations in past 6 months: 60.2% → 81.7%. Joint decision-making increased. Husband alone making decisions dropped from 8.8% to 2.0%.', badge: 'exceeded', badgeText: 'Target Exceeded' },
                    { title: 'Autonomy & Leadership', metric: '-20.7pp', description: 'Support for starting own business (Definitely) declined significantly 84.9% → 64.2% (-20.7pp). Community leadership support dipped 87.1% → 84.4% (-2.7pp). Positive: Women hiding money from husbands decreased (Always 12.0% → 3.3%) indicating improved financial transparency.', badge: 'drop', badgeText: 'Drop from Baseline' },
                    { title: 'Household Decision Types', metric: '+8pp', description: 'Key decisions: Purchase household assets 17.6% → 22.0%, send/remove child from school 39.8% → 50.6% (+10.8pp), invest in business 18.4% → 22.1%, seek healthcare 6.6% → 20.3% (+13.7pp).', badge: 'exceeded', badgeText: 'Target Exceeded' }
                ],
                kpis: [
                    { label: 'Self-Esteem (Strongly Agree)', value: '52.6%', change: '↑ 19.1pp from 33.5% baseline', trend: 'positive' },
                    { label: 'Equal Perception (Strongly Agree)', value: '48.2%', change: '↑ 27.8pp from 20.4% baseline', trend: 'positive' },
                    { label: 'Husband Supports Chores', value: '64.7%', change: '↑ 23.3pp from 41.4% baseline', trend: 'positive' },
                    { label: 'Decision Conversations', value: '81.7%', change: '↑ 21.5pp from 60.2% baseline', trend: 'positive' },
                    { label: 'Business Support (Definitely)', value: '64.2%', change: '↓ 20.7pp from 84.9% baseline', trend: 'negative' },
                    { label: 'Community Leadership (Definitely)', value: '84.4%', change: '↓ 2.7pp from 87.1% baseline', trend: 'negative' }
                ],
                hasLogframe: false
            },
            'gjj-men': {
                title: 'GJJ KAP Survey - Men',
                findings: [
                    { title: 'Self-Responsibility Growth', metric: '+20.2pp', description: '"I take responsibility for my feelings" (Strongly Agree) improved from 50.1% to 70.3%. "I learn and grow from my mistakes" (SA) rose 47.7%→71.2% (+23.5pp). Equal perception SA: 44.0%→61.1% (+17.1pp). Self-compassion (Frequently): 61.1%→75.4%.', badge: 'exceeded', badgeText: 'Target Exceeded' },
                    { title: 'Relational Quality', metric: '+53.4pp', description: 'Men feeling respected by partner (Always) surged 30.1%→83.5% (+53.4pp). Discuss sharing responsibility (Always) grew 51.4%→71.6% (+20.2pp). Accept "No" (Always) improved 40.5%→60.2% (+19.7pp). Laughing together: 52.2%→83.5%.', badge: 'exceeded', badgeText: 'Target Exceeded' },
                    { title: 'Shared Responsibility', metric: '+24.5pp', description: 'Men always doing chores improved 17.7%→42.2% (+24.5pp). Support for chores (Yes) grew 86.9%→92.7%. Weekly chore discussion: 76.2%→90.2% (+14.0pp). Encourage wife personal time: 94.1%→99.0%.', badge: 'exceeded', badgeText: 'Target Exceeded' },
                    { title: 'Shared Power', metric: '+9.2pp', description: 'Decision conversations surged 87.9%→97.1% (+9.2pp). Important decisions: 83.3%→85.8%. Support wife as community leader (Always) grew 53.1%→64.9% (+11.8pp).', badge: 'exceeded', badgeText: 'Target Exceeded' },
                    { title: 'Business Support', metric: '+14.1pp', description: 'Definitely support wife starting business: 53.5%→67.6% (+14.1pp). "Very Probably" surged 0.6%→21.9%. Combined strong support for women\'s entrepreneurship growing substantially.', badge: 'exceeded', badgeText: 'Target Exceeded' },
                    { title: 'Self-Compassion', metric: '+14.3pp', description: 'Self-talk/self-compassion (Frequently) grew 61.1%→75.4% (+14.3pp). Never practicing self-compassion dropped from 1.5% to 0.0%. Strong internalization of nurturing behaviors.', badge: 'exceeded', badgeText: 'Target Exceeded' }
                ],
                kpis: [
                    { label: 'Self-Responsibility (SA)', value: '70.3%', change: '↑ 20.2pp from 50.1% baseline', trend: 'positive' },
                    { label: 'Respected by Partner (Always)', value: '83.5%', change: '↑ 53.4pp from 30.1% baseline', trend: 'positive' },
                    { label: 'Always Does Chores', value: '42.2%', change: '↑ 24.5pp from 17.7% baseline', trend: 'positive' },
                    { label: 'Decision Conversations', value: '97.1%', change: '↑ 9.2pp from 87.9% baseline', trend: 'positive' },
                    { label: 'Support Wife Business (Def)', value: '67.6%', change: '↑ 14.1pp from 53.5% baseline', trend: 'positive' },
                    { label: 'Self-Compassion (Frequently)', value: '75.4%', change: '↑ 14.3pp from 61.1% baseline', trend: 'positive' }
                ],
                hasLogframe: false
            },
            'forestry': {
                title: 'Community Forest Conservation Groups',
                logframeHighlight: '<h4>Community Forest Conservation — Logframe Indicator Performance</h4><p>Indicator 1130b: Percentage of functional groups with functionality score ≥70%. Baseline 53.5% → Midline 85.7% (target 70.0%). EXCEEDED target by +15.7pp. Strong improvement in group functionality across management, gender equality, and effectiveness domains.</p>',
                findings: [
                    { title: 'Functionality Improvement', metric: '+32.2pp', description: 'Groups meeting ≥60% threshold: 81.4%→96.4% (+15.0pp). Groups meeting ≥70% threshold: 53.5%→85.7% (+32.2pp). Overall score improved from 70.6 to 84.2 (+13.6pp).', badge: 'exceeded', badgeText: '' },
                    { title: 'Gender Equality Gains', metric: '+32.5pp', description: 'Groups discussing gender equality surged 40.0%→72.5%. Groups taking gender actions: 25.0%→55.0%. Women in significant leadership: 17.5%→35.0%. Gender domain score: 42.8%→63.5% (+20.7pp).', badge: 'exceeded', badgeText: '' },
                    { title: 'Training Expansion', metric: '+27.5pp', description: '"Most Members" receiving training grew from 15.0% to 42.5%. Groups with no training dropped 25.0%→7.5%. Assets/inputs received increased 35.0%→62.5%. Key topics: Climate Change, CFM Concepts, Forest Livelihoods.', badge: 'exceeded', badgeText: '' },
                    { title: 'Governance Maturity', metric: '+22.5pp', description: 'Written objectives: 45.0%→67.5%. Board roles well-defined: 35.0%→57.5%. Regular meetings: 32.5%→55.0%. Grievance mechanisms: 35.0%→60.0%. All 6 management practices improved.', badge: 'exceeded', badgeText: '' },
                    { title: 'Forest Conservation', metric: '+22.5pp', description: 'Forest "Good" condition: Area 30.0%→52.5%, Biodiversity 25.0%→47.5%. Threats declining: Fire (High) 35.0%→15.0%, Charcoal (High) 40.0%→17.5%, Encroachment 32.5%→15.0%.', badge: 'exceeded', badgeText: '' },
                    { title: 'Economic Sustainability', metric: '+25.0pp', description: 'Income-generating groups: 37.5%→62.5%. Agroforestry adoption: 32.5%→57.5%. Group registration: 72.5%→85.0%. AMCOS membership: 42.5%→52.5%. Beekeeping groups: 27.5%→35.0%.', badge: 'exceeded', badgeText: '' }
                ],
                kpis: [
                    { label: 'Functionality (≥70% threshold)', value: '85.7%', change: '↑ 32.2pp from 53.5% baseline', trend: 'positive' },
                    { label: 'Gender Domain Score', value: '63.5%', change: '↑ 20.7pp from 42.8% baseline', trend: 'positive' },
                    { label: 'Training Coverage (Most)', value: '42.5%', change: '↑ 27.5pp from 15.0% baseline', trend: 'positive' },
                    { label: 'Groups with GE Actions', value: '55.0%', change: '↑ 30.0pp from 25.0% baseline', trend: 'positive' },
                    { label: 'Income Generating', value: '62.5%', change: '↑ 25.0pp from 37.5% baseline', trend: 'positive' },
                    { label: 'Group Registration', value: '85.0%', change: '↑ 12.5pp from 72.5% baseline', trend: 'positive' }
                ],
                logframe: [
                    { level: 'INTERMEDIATE OUTCOME', name: 'Forest Conservation Group Functionality', color: '#005a9e', indicators: [
                        { id: '1130b', name: 'Percentage and Number of community forest conservation groups that are functional', baseline: '53.5%', target: '70.0%', result: '85.7%', achievement: '+32.2pp', status: 'EXCEEDED' }
                    ]}
                ]
            },
            'prepost-forest': {
                title: 'Pre & Post Test — Forest Conservation Knowledge',
                logframeHighlight: '<h4>Forest Conservation Knowledge — Logframe Indicator Performance</h4><p>Indicator 1130a: Percentage of training participants with adequate knowledge on forest conservation. Pre-test 50.0% → Post-test 94.7% (target 68.0%). EXCEEDED target by +26.7pp. Knowledge gains observed across all three domains: Forest Ecology &amp; Rights, Management &amp; Conservation, and Policy &amp; Sustainability.</p>',
                findings: [
                    { title: 'Threshold Achievement', metric: '+44.7pp', description: 'Participants meeting ≥70% threshold surged from 50.0% to 94.7%. At ≥80%, improvement was even more dramatic: 32.9%→85.7% (+52.8pp).', badge: 'exceeded', badgeText: '' },
                    { title: 'Average Score Gain', metric: '+20.2pp', description: 'Average knowledge score improved from 65.2% to 85.4%. Minimum score lifted from 2.5% to 27.5%, reducing the knowledge gap significantly.', badge: 'exceeded', badgeText: '' },
                    { title: 'Forest Ecology & Rights', metric: '91.5–97.8%', description: 'All foundational topics achieved 91%+ post-test. Strongest gain: Forest Ecosystems (+34.9pp, 56.6%→91.5%). Conservation Principles reached 97.8% post-test.', badge: 'exceeded', badgeText: '' },
                    { title: 'Management & Conservation', metric: '83.4–99.2%', description: 'All management topics improved significantly. Carbon Sequestration and Wildlife Corridors reached 99.2% post-test. Weakest: Management Plans still achieved 83.4%.', badge: 'exceeded', badgeText: '' },
                    { title: 'Policy & Sustainability', metric: '95.3–99.7%', description: 'Advanced topics showed exceptional post-training results. Ecosystem Services achieved 99.7% — the highest single-topic score. 6 of 7 topics exceeded 96%.', badge: 'exceeded', badgeText: '' },
                    { title: 'Overall Training Impact', metric: '+20.2pp avg', description: 'Training effectiveness confirmed across all domains. 21 of 21 topics showed improvement. Average topic-level gain: +20.2pp. Knowledge retention appears strong.', badge: 'exceeded', badgeText: '' }
                ],
                kpis: [
                    { label: 'Passing ≥70% Threshold', value: '94.7%', change: '↑ 44.7pp from 50.0% pre-test', trend: 'positive' },
                    { label: 'Average Score', value: '85.4%', change: '↑ 20.2pp from 65.2% pre-test', trend: 'positive' },
                    { label: 'Passing ≥80% Threshold', value: '85.7%', change: '↑ 52.8pp from 32.9% pre-test', trend: 'positive' },
                    { label: 'Minimum Score', value: '27.5%', change: '↑ 25.0pp from 2.5% pre-test', trend: 'positive' },
                    { label: 'Post-Test Participants', value: '909', change: '↑ 363 more than 546 pre-test', trend: 'positive' },
                    { label: 'Topics ≥95% Post', value: '17/21', change: '81% of topics exceed 95%', trend: 'positive' }
                ],
                logframe: [
                    { level: 'IMMEDIATE OUTCOME', name: 'Forest Management Knowledge', color: '#2e7d32', indicators: [
                        { id: '1130a', name: 'Percentage and Number of women and men with adequate practical knowledge in forest management and conservation (disaggregated by sex)', baseline: '50.0%', target: '68.0%', result: '94.7%', achievement: '+44.7pp', status: 'EXCEEDED' }
                    ]}
                ]
            },
            'prepost-mangrove': {
                title: 'Pre & Post Test — Mangrove Restoration Knowledge',
                logframeHighlight: '<h4>Mangrove Restoration Knowledge — Logframe Indicator Performance</h4><p>Indicator 1110a: Percentage of training participants with adequate mangrove restoration knowledge. All participants: 36.9% → 81.9% (target 57.0%). EXCEEDED target by +24.9pp. Female participants showed strongest gain (+52.7pp, 34.7%→87.4%). Kilifi county closed the gap with Kwale, improving by +59.0pp.</p>',
                findings: [
                    { title: 'Overall Knowledge Gain', metric: '+44.6pp', description: 'Adequate knowledge surged from 36.9% to 81.5% overall. Both Kilifi and Kwale counties exceeded 80% post-test, confirming training effectiveness across locations.', badge: 'exceeded', badgeText: '' },
                    { title: 'Kilifi County Transformation', metric: '+59.0pp', description: 'Kilifi showed the strongest improvement: 21.1%→80.1%. Starting from the lowest baseline, Kilifi nearly closed the gap with Kwale, demonstrating effective knowledge transfer.', badge: 'exceeded', badgeText: '' },
                    { title: 'Kwale County Progress', metric: '+29.4pp', description: 'Kwale improved from 53.7% to 83.1%. Although gains were smaller than Kilifi, post-test scores were the highest across both locations.', badge: 'exceeded', badgeText: '' },
                    { title: 'Female Knowledge Uptake', metric: '+52.7pp', description: 'Female participants gained most: 34.7%→87.4% (+52.7pp). Women outperformed men at post-test by 7.2pp, demonstrating particularly strong knowledge retention.', badge: 'exceeded', badgeText: '' },
                    { title: 'Male Knowledge Gain', metric: '+42.0pp', description: 'Male participants improved from 38.2% to 80.2% (+42.0pp). All male participants exceeded the 80% adequate knowledge threshold at post-test.', badge: 'exceeded', badgeText: '' },
                    { title: 'Gender Equity Achievement', metric: '87.4% vs 80.2%', description: 'Training closed the gender gap: females started 3.5pp below males but ended 7.2pp above. Program design effectively supported equitable knowledge outcomes.', badge: 'exceeded', badgeText: '' }
                ],
                kpis: [
                    { label: 'Overall Adequate Knowledge', value: '81.5%', change: '↑ 44.6pp from 36.9% pre-test', trend: 'positive' },
                    { label: 'Kilifi County', value: '80.1%', change: '↑ 59.0pp from 21.1% pre-test', trend: 'positive' },
                    { label: 'Kwale County', value: '83.1%', change: '↑ 29.4pp from 53.7% pre-test', trend: 'positive' },
                    { label: 'Female Post-Test', value: '87.4%', change: '↑ 52.7pp from 34.7% pre-test', trend: 'positive' },
                    { label: 'Male Post-Test', value: '80.2%', change: '↑ 42.0pp from 38.2% pre-test', trend: 'positive' },
                    { label: 'Gender Gain Difference', value: '+10.7pp', change: 'Female gain exceeded male gain', trend: 'positive' }
                ],
                logframe: [
                    { level: 'IMMEDIATE OUTCOME', name: 'Mangrove Restoration Knowledge', color: '#2e7d32', indicators: [
                        { id: '1110a', name: 'Percentage and Number of women and men with adequate practical knowledge on gender-responsive and equitable mangrove restoration and conservation (disaggregated by sex)', baseline: 'All: 36.9% | F: 34.7% | M: 38.2%', target: 'All: 57.0% | F: 57.0% | M: 57.0%', result: 'All: 81.9% | F: 87.4% | M: 80.2%', achievement: '+45.0pp (All)', status: 'EXCEEDED' }
                    ]}
                ]
            }
        };

        // ============================================================
        // STANDALONE DASHBOARD CONFIG (data-driven switching)
        // Each standalone dashboard hides shared sections and shows
        // only its own section + sub-selector. Adding a new dashboard
        // only requires a new entry here — no code duplication.
        // ============================================================
        const standaloneDashboards = {
            'project-outputs': {
                showSection: 'output-section',
                subSelector: 'output-type-selector',
                title: 'Project Output Dashboard',
                footerTitle: '<strong>Project Output Dashboard - Mangrove</strong>',
                footerSample: 'COSME Project Outputs and Deliverables Tracker',
                renderFn: () => renderOutputCharts()
            },
            'schools-dashboard': {
                showSection: 'schools-dashboard-section',
                subSelector: 'schools-dash-type-selector',
                title: 'Schools Dashboard',
                footerTitle: '<strong>Schools Dashboard — Access to Clean Water</strong>',
                footerSample: '65 Schools | Kwale & Kilifi Counties | Baseline to Midline Assessment',
                renderFn: () => renderSchoolsDashCleanWaterCharts()
            },
            'seaweed-assessment': {
                showSection: 'seaweed-section',
                subSelector: null,
                title: 'Seaweed Group Assessment',
                footerTitle: '<strong>Seaweed Group Assessment — Production, Value Addition & Commercialization</strong>',
                footerSample: '19 Seaweed Groups | 610 Female Members | July 2025 Assessment',
                renderFn: () => renderSeaweedCharts()
            },
            'vsla-monitoring': {
                showSection: 'vsla-section',
                subSelector: null,
                title: 'VSLA Functionality Dashboard',
                footerTitle: '<strong>VSLA Functionality Dashboard — Savings, Loans & Social Fund Performance</strong>',
                footerSample: '211 VSLA Assessments | 173 Unique Groups | Kilifi & Kwale Counties',
                renderFn: () => renderVSLADashboard()
            },
            'cross-dataset': {
                showSection: 'cross-dataset-section',
                subSelector: null,
                title: 'Cross-Dataset Synthesis',
                footerTitle: '<strong>Cross-Dataset Synthesis — Multi-Survey Comparative Analysis</strong>',
                footerSample: 'Combined analysis across Women, Men, GJJ, Forestry, Training, Schools, Seaweed & VSLA datasets',
                renderFn: () => renderCrossDatasetSynthesis()
            },
            'automated-insights': {
                showSection: 'automated-insights-section',
                subSelector: null,
                title: 'Impact & Evidence',
                footerTitle: '<strong>Impact & Evidence — Theory of Change, Projections & Methodology</strong>',
                footerSample: 'Cross-validated pathways, endline projections & data quality notes',
                renderFn: () => renderAutomatedInsights()
            },
            'report-generation': {
                showSection: 'report-generation-section',
                subSelector: null,
                title: 'Report Generation',
                footerTitle: '<strong>COSME Midline Report — PDF Generation Centre</strong>',
                footerSample: 'Generate, download & view the comprehensive COSME Midline Analysis PDF',
                renderFn: () => renderReportGeneration()
            },
            'analytics-dashboard': {
                showSection: 'analytics-dashboard-section',
                subSelector: null,
                title: 'Dashboard Analytics',
                footerTitle: '<strong>COSME Dashboard — Usage Analytics & Engagement Insights</strong>',
                footerSample: 'Real-time visitor tracking, tab usage, device breakdown & engagement metrics',
                renderFn: () => renderAnalyticsDashboard()
            }
        };

        // All toggleable section IDs (used by both standalone and regular survey switching)
        const allSectionIds = [
            'women-survey-section', 'men-survey-section', 'forestry-section',
            'prepost-section', 'output-section', 'schools-dashboard-section',
            'seaweed-section', 'vsla-section',
            'cross-dataset-section', 'automated-insights-section',
            'report-generation-section', 'analytics-dashboard-section'
        ];
        const allSubSelectorIds = ['prepost-type-selector', 'output-type-selector', 'schools-dash-type-selector'];

        // Shared helper: hide all content sections
        function hideAllSections() {
            allSectionIds.forEach(id => {
                const el = document.getElementById(id);
                if (el) el.style.display = 'none';
            });
        }

        // Shared helper: hide all sub-selectors
        function hideAllSubSelectors() {
            allSubSelectorIds.forEach(id => {
                const el = document.getElementById(id);
                if (el) el.style.display = 'none';
            });
        }

        // Shared helper: hide shared summary sections (exec summary, KPI wrapper, logframe)
        function hideSharedSections() {
            const execSummary = document.querySelector('.executive-summary');
            const kpiWrapper = document.getElementById('kpi-wrapper-section');
            const logframeWrapper = document.getElementById('logframe-section');
            if (execSummary) execSummary.style.display = 'none';
            if (kpiWrapper) kpiWrapper.style.display = 'none';
            if (logframeWrapper) logframeWrapper.style.display = 'none';
        }

        // Shared helper: update active survey button
        function setActiveSurveyButton(surveyKey) {
            document.querySelectorAll('.survey-btn').forEach(btn => {
                btn.classList.remove('active');
                btn.setAttribute('aria-selected', 'false');
                const onclick = btn.getAttribute('onclick') || '';
                const isMatch = surveyKey.startsWith('prepost-')
                    ? onclick.includes('prepost-')
                    : onclick.includes("'" + surveyKey + "'");
                if (isMatch) {
                    btn.classList.add('active');
                    btn.setAttribute('aria-selected', 'true');
                }
            });
        }

        // Survey Switching Function
        function switchSurvey(surveyKey) {
            // ── Standalone dashboards (config-driven) ──
            const standalone = standaloneDashboards[surveyKey];
            if (standalone) {
                setActiveSurveyButton(surveyKey);
                hideSharedSections();
                hideAllSections();
                hideAllSubSelectors();
                // Show the target section
                const section = document.getElementById(standalone.showSection);
                if (section) section.style.display = 'block';
                // Show sub-selector if defined
                if (standalone.subSelector) {
                    const sel = document.getElementById(standalone.subSelector);
                    if (sel) sel.style.display = 'flex';
                }
                // Update header & footer
                document.getElementById('survey-title').textContent = standalone.title;
                document.getElementById('footer-title').innerHTML = standalone.footerTitle;
                document.getElementById('footer-sample').textContent = standalone.footerSample;
                // Render charts
                standalone.renderFn();
                return;
            }

            const data = window.surveyData[surveyKey];
            if (!data) {
                console.error('No survey data for key:', surveyKey);
                return;
            }
            
            // Update buttons using shared helper
            setActiveSurveyButton(surveyKey);
            
            // Update title
            document.getElementById('survey-title').textContent = data.title;
            
            // Update footer
            const sampleText = {
                'women-cosme': 'Sample Size: 345 Women | Data Quality: High',
                'men-cosme': 'Sample Size: 267 Men | Data Quality: High',
                'gjj-women': 'Sample Size: 312 Women | Data Quality: High',
                'gjj-men': 'Sample Size: 289 Men | Data Quality: High',
                'forestry': '28 Community Forest Conservation Groups | Data Quality: High',
                'prepost-forest': 'Pre-Test: 546 Participants | Post-Test: 909 Participants | Threshold: ≥70%',
                'prepost-mangrove': 'Mangrove Restoration Training | Kilifi & Kwale Counties | Data Quality: High'
            };
            const titleText = {
                'women-cosme': 'Women Survey - COSME Project | Baseline to Midline Analysis',
                'men-cosme': 'Men Survey - COSME Project | Baseline to Midline Analysis',
                'gjj-women': 'GJJ KAP Survey - Women | Knowledge, Attitudes & Practices',
                'gjj-men': 'GJJ KAP Survey - Men | Knowledge, Attitudes & Practices',
                'forestry': 'Community Forest Conservation Groups | Baseline to Midline Assessment',
                'prepost-forest': 'Pre & Post Test — Forest Conservation Knowledge Assessment',
                'prepost-mangrove': 'Pre & Post Test — Mangrove Restoration Knowledge Assessment'
            };
            document.getElementById('footer-title').innerHTML = `<strong>${titleText[surveyKey]}</strong>`;
            document.getElementById('footer-sample').textContent = sampleText[surveyKey];
            
            // Update collapsible header names with current tab name
            const tabNames = {
                'women-cosme': 'Women Survey (Midline)',
                'men-cosme': 'Men Survey (Midline)',
                'gjj-women': 'GJJ KAP Women (Endline)',
                'gjj-men': 'GJJ KAP Men (Endline)',
                'forestry': 'Forestry Functionality (Midline)',
                'prepost-forest': 'Trainings Pre & Post',
                'prepost-mangrove': 'Trainings Pre & Post'
            };
            const tabName = tabNames[surveyKey] || surveyKey;
            const highlightsHeader = document.getElementById('highlights-header');
            const performanceHeader = document.getElementById('performance-header');
            if (highlightsHeader) highlightsHeader.textContent = tabName + ' Key Highlights';
            if (performanceHeader) performanceHeader.textContent = tabName + ' Critical Performance Pointers';

            // Update findings cards
            const findingsContainer = document.querySelector('.key-findings');
            findingsContainer.innerHTML = '';
            data.findings.forEach(finding => {
                const card = document.createElement('div');
                card.className = finding.badge === 'drop' ? 'finding-card negative' : 'finding-card';
                card.innerHTML = `
                    <div class="finding-title">${finding.title}</div>
                    <div class="finding-metric">${finding.metric}</div>
                    <div class="finding-description">${finding.description}</div>
                `;
                findingsContainer.appendChild(card);
            });
            
            // Update KPIs
            const kpiContainer = document.querySelector('.kpi-section');
            kpiContainer.innerHTML = '';
            data.kpis.forEach(kpi => {
                const card = document.createElement('div');
                card.className = `kpi-card ${kpi.trend}`;
                card.innerHTML = `
                    <div class="kpi-label">${kpi.label}</div>
                    <div class="kpi-value">${kpi.value}</div>
                    <div class="kpi-change ${kpi.trend}">${kpi.change}</div>
                `;
                kpiContainer.appendChild(card);
            });

            // Show/Hide Logframe Section
            const logframeSection = document.getElementById('logframe-section');
            if (data.hasLogframe === false) {
                logframeSection.style.display = 'none';
            } else {
                logframeSection.style.display = 'block';
                // Update Logframe Table
                updateLogframeTable(data.logframe);
                // Update Logframe Highlight Box dynamically
                const highlightBox = document.getElementById('logframe-highlight');
                if (highlightBox && data.logframeHighlight) {
                    highlightBox.innerHTML = data.logframeHighlight;
                }
            }

            // TOGGLE between Women, Men, Forestry, Pre-Post sections (data-driven)
            hideAllSections();
            hideAllSubSelectors();

            // Restore shared sections (hidden when standalone tab was active)
            const execSummary = document.querySelector('.executive-summary');
            const kpiWrapper = document.getElementById('kpi-wrapper-section');
            if (execSummary) execSummary.style.display = '';
            if (kpiWrapper) kpiWrapper.style.display = '';

            // Map survey keys to their visible section
            const surveySectionMap = {
                'prepost-forest': 'prepost-section',
                'prepost-mangrove': 'prepost-section',
                'forestry': 'forestry-section',
                'men-cosme': 'men-survey-section'
            };
            // Default to women-survey-section for women-cosme, gjj-women, gjj-men
            const visibleSectionId = surveySectionMap[surveyKey] || 'women-survey-section';
            const visibleEl = document.getElementById(visibleSectionId);
            if (visibleEl) visibleEl.style.display = 'block';

            // Show prepost sub-selector only for prepost variants
            if (surveyKey.startsWith('prepost-')) {
                const prepostSel = document.getElementById('prepost-type-selector');
                if (prepostSel) prepostSel.style.display = 'flex';
            }

            // Reset tab state: activate first tab in the visible section so charts render in a visible container
            const womenSection = document.getElementById('women-survey-section');
            if (surveyKey === 'women-cosme' || surveyKey === 'gjj-women' || surveyKey === 'gjj-men') {
                // Reset women tabs to the first tab
                const womenTabContents = womenSection ? womenSection.querySelectorAll('.tab-content') : [];
                const womenTabButtons = womenSection ? womenSection.querySelectorAll('.tab-button') : [];
                womenTabContents.forEach(tab => tab.classList.remove('active'));
                womenTabButtons.forEach(btn => btn.classList.remove('active'));
                if (womenTabContents.length > 0) womenTabContents[0].classList.add('active');
                if (womenTabButtons.length > 0) womenTabButtons[0].classList.add('active');
            }

            // === GJJ / COSME TAB REWRITING ===
            if (womenSection) {
                const tabButtons = womenSection.querySelectorAll('.tab-button');
                const isGJJ = surveyKey === 'gjj-women' || surveyKey === 'gjj-men';
                
                // Original COSME tab labels
                const cosmeLabels = [
                    'A. Household Characteristics', 'B. Shocks & Resilience', 'C. Preparedness',
                    'D. Resources & Assets', 'E. Savings & Loans', 'F. Roles & Time Poverty',
                    'G. Decision Making', 'H. Climate & NbS', 'I. Life Skills', 'J. Social Norms'
                ];
                // GJJ section labels (map to first 5 tabs, hide rest)
                const gjjLabels = [
                    '1. SELF', '2. RELATIONAL', '3. Shared Responsibility',
                    '4. Shared Power', '5. Autonomy & Leadership'
                ];

                tabButtons.forEach((btn, i) => {
                    if (isGJJ) {
                        if (i < gjjLabels.length) {
                            btn.textContent = gjjLabels[i];
                            btn.style.display = '';
                        } else {
                            btn.style.display = 'none';
                        }
                    } else {
                        // Restore COSME labels
                        if (i < cosmeLabels.length) {
                            btn.textContent = cosmeLabels[i];
                        }
                        btn.style.display = '';
                    }
                });

                // Also show/hide tab content divs
                const tabContents = womenSection.querySelectorAll('.tab-content');
                tabContents.forEach((tab, i) => {
                    if (isGJJ) {
                        tab.style.display = i < gjjLabels.length ? '' : 'none';
                    } else {
                        tab.style.display = '';
                    }
                });

                // Update section titles and chart titles inside GJJ tabs
                if (isGJJ) {
                    const isMenGJJ = surveyKey === 'gjj-men';
                    const gjjSectionConfig = isMenGJJ ? [
                        { // Tab 0: SELF — Men
                            sectionTitle: '1. SELF — Self-Responsibility & Perception',
                            chartTitles: {
                                'chart-location': '"I take responsibility for my feelings, emotions, thoughts & actions" — Likert Scale',
                                'chart-headship': '"I learn and grow from my mistakes" — Likert Scale',
                                'chart-activities': '"I see myself as equal to those of the opposite gender" — Likert Scale',
                                'chart-housing': 'Self-Compassion: "I nurture myself with kind, supportive self-talk" — Frequency',
                                'chart-wash': 'SELF Domain Overview — Strongly Agree % + Self-Compassion Frequency'
                            }
                        },
                        { // Tab 1: RELATIONAL — Men
                            sectionTitle: '2. RELATIONAL — Relationship Quality & Communication',
                            chartTitles: {
                                'chart-shocks': 'Relational Indicators — "Always" Frequency Across Key Behaviors',
                                'chart-impact': '"Discuss Sharing Responsibility with Partner" — Full Frequency Breakdown',
                                'chart-coping': '"Accept When Wife Says No/Not Now" — Full Frequency Breakdown'
                            }
                        },
                        { // Tab 2: Shared Responsibility — Men
                            sectionTitle: '3. GENDER TRANSFORMATION: Shared Responsibility',
                            chartTitles: {
                                'chart-prep-knowledge': 'Shared Responsibility — Key Metrics (Baseline vs Endline)',
                                'chart-prep-participation': 'Household Chore Frequency — Full Distribution',
                                'chart-warnings': 'Support & Discussion Metrics — Chores, Encourage Time, Support'
                            }
                        },
                        { // Tab 3: Shared Power — Men
                            sectionTitle: '4. GENDER TRANSFORMATION: Shared Power',
                            chartTitles: {
                                'chart-assets': 'Power-Sharing Metrics — Key Indicators Overview',
                                'chart-land': 'Support Wife as Community Leader — Full Frequency Breakdown',
                                'chart-cultivation': 'Decision Conversation Trends — Had Conversations vs Made Decisions',
                                'chart-inputs': 'Support Wife Starting/Growing Business — Response Levels'
                            }
                        },
                        { // Tab 4: Autonomy & Leadership — Men
                            sectionTitle: '5. GENDER TRANSFORMATION: Autonomy & Leadership',
                            chartTitles: {
                                'chart-personal-savings': 'Support Wife as Community Leader — Frequency Distribution (Detail)',
                                'chart-mechanism': 'Support Wife Starting/Growing Business — Response Level Distribution',
                                'chart-loans': 'Encourage Wife Time & Discuss Chores — Key Metrics',
                                'chart-savings-use': 'Autonomy & Leadership Summary — Key Indicators'
                            }
                        }
                    ] : [
                        { // Tab 0: SELF — Women
                            sectionTitle: '1. SELF — Self-Esteem & Self-Perception',
                            chartTitles: {
                                'chart-location': '"I have many strengths & qualities" — Likert Scale (Baseline vs Endline)',
                                'chart-headship': '"I see myself as equal to opposite gender" — Likert Scale',
                                'chart-activities': '"My feelings and opinions are important" — Likert Scale',
                                'chart-housing': '"I voice my opinions in my community" — Likert Scale',
                                'chart-wash': 'SELF Domain Overview — Strongly Agree % Across All Statements'
                            }
                        },
                        { // Tab 1: RELATIONAL — Women
                            sectionTitle: '2. RELATIONAL — Relationship Quality & Communication',
                            chartTitles: {
                                'chart-shocks': 'Relational Indicators — "Always" Frequency (Baseline vs Endline)',
                                'chart-impact': '"Feeling Respected by Partner" — Full Frequency Breakdown',
                                'chart-coping': '"Voicing Disagreement Comfortably" — Full Frequency Breakdown'
                            }
                        },
                        { // Tab 2: Shared Responsibility — Women
                            sectionTitle: '3. GENDER TRANSFORMATION: Shared Responsibility',
                            chartTitles: {
                                'chart-prep-knowledge': 'Shared Responsibility — Key Metrics (Baseline vs Endline)',
                                'chart-prep-participation': 'Husband Household Chore Frequency — Full Distribution',
                                'chart-warnings': 'Types of Unpaid Care Work Discussed (% Reporting Discussion)'
                            }
                        },
                        { // Tab 3: Shared Power — Women
                            sectionTitle: '4. GENDER TRANSFORMATION: Shared Power',
                            chartTitles: {
                                'chart-assets': 'Joint Decision Types — What Decisions Are Discussed (%)',
                                'chart-land': 'Who Has Final Say on Household Decisions — Distribution',
                                'chart-cultivation': 'Frequency of Important Decision Discussions',
                                'chart-inputs': 'Decision Conversations — Key Metrics & Decision Types'
                            }
                        },
                        { // Tab 4: Autonomy & Leadership — Women
                            sectionTitle: '5. GENDER TRANSFORMATION: Autonomy & Leadership',
                            chartTitles: {
                                'chart-personal-savings': 'Women Hiding Money from Husbands — Full Frequency Breakdown',
                                'chart-mechanism': 'Support for Women in Community Leadership — Response Levels',
                                'chart-loans': 'Support for Women Starting Own Business — Response Levels',
                                'chart-savings-use': 'Autonomy & Leadership Summary — Key Indicators'
                            }
                        }
                    ];

                    tabContents.forEach((tab, i) => {
                        if (i >= gjjSectionConfig.length) return;
                        const config = gjjSectionConfig[i];
                        
                        // Update section title
                        const sectionTitle = tab.querySelector('.section-title');
                        if (sectionTitle) sectionTitle.textContent = config.sectionTitle;

                        // Update chart titles
                        Object.keys(config.chartTitles).forEach(chartId => {
                            const canvas = tab.querySelector(`#${chartId}`);
                            if (canvas) {
                                const wrapper = canvas.closest('.chart-wrapper');
                                if (wrapper) {
                                    const titleEl = wrapper.querySelector('.chart-title');
                                    if (titleEl) titleEl.textContent = config.chartTitles[chartId];
                                }
                            }
                        });
                    });
                }
            }

            // Destroy ALL existing Chart.js instances to prevent stale renders
            function destroyAllCharts() {
                // Get all canvas elements and destroy any Chart.js instances
                document.querySelectorAll('canvas').forEach(canvas => {
                    const existingChart = Chart.getChart(canvas);
                    if (existingChart) {
                        existingChart.destroy();
                    }
                });
            }
            destroyAllCharts();

            // Force reflow so the section is fully visible before rendering charts
            const activeSectionId = {'prepost-forest':'prepost-section','prepost-mangrove':'prepost-section','forestry':'forestry-section','men-cosme':'men-survey-section'}[surveyKey] || 'women-survey-section';
            const activeSection = document.getElementById(activeSectionId);
            if (activeSection) void activeSection.offsetHeight;

            // Use requestAnimationFrame + setTimeout to ensure DOM/layout is fully ready
            requestAnimationFrame(() => {
                setTimeout(() => {
                    // Force another reflow
                    if (activeSection) void activeSection.offsetHeight;
                    
                    if (surveyKey === 'women-cosme') {
                        // Temporarily show all tabs so Chart.js can measure canvas dimensions
                        const womenTabsAll = document.getElementById('women-survey-section');
                        const cosmeTabs = womenTabsAll ? womenTabsAll.querySelectorAll('.tab-content') : [];
                        cosmeTabs.forEach(tab => tab.style.display = 'block');
                        void (womenTabsAll && womenTabsAll.offsetHeight);
                        
                        updateSurveyCharts(surveyKey);
                        updateAllTabCharts('women-cosme');
                        updateTabContent(surveyKey);
                        
                        // Restore tab visibility
                        cosmeTabs.forEach(tab => tab.style.display = '');
                    } else if (surveyKey === 'men-cosme') {
                        updateSurveyCharts(surveyKey);
                        initializeMenSurveyTabs();
                        setTimeout(() => {
                            updateMenSurveyCharts('men-cosme');
                        }, 250);
                        updateTabContent(surveyKey);
                    } else if (surveyKey === 'forestry') {
                        // Temporarily show ALL forestry tabs so Chart.js can measure canvas dimensions
                        const forestrySec = document.getElementById('forestry-section');
                        const forestryTabs = forestrySec ? forestrySec.querySelectorAll('.forestry-tab-content') : [];
                        forestryTabs.forEach(tab => tab.style.display = 'block');
                        void (forestrySec && forestrySec.offsetHeight);
                        
                        updateForestryCharts();
                        
                        // Restore tab visibility
                        forestryTabs.forEach(tab => tab.style.display = '');
                        // Make sure first tab is active
                        if (forestryTabs.length > 0) forestryTabs[0].style.display = 'block';
                    } else if (surveyKey === 'prepost-forest') {
                        // Temporarily show ALL prepost tabs so Chart.js can measure canvas dimensions
                        const prepostSec = document.getElementById('prepost-section');
                        const prepostTabs = prepostSec ? prepostSec.querySelectorAll('.prepost-tab-content') : [];
                        prepostTabs.forEach(tab => tab.style.display = 'block');
                        void (prepostSec && prepostSec.offsetHeight);
                        
                        // Show forest content, hide mangrove
                        document.getElementById('pp-forest-content').style.display = 'block';
                        document.getElementById('pp-mangrove-content').style.display = 'none';
                        
                        updatePrePostCharts();
                        
                        // Restore tab visibility
                        prepostTabs.forEach(tab => tab.style.display = '');
                        // Make sure first tab is active
                        if (prepostTabs.length > 0) prepostTabs[0].style.display = 'block';
                        
                        // Activate forest sub-selector button
                        activatePrePostTypeButton('forest');
                    } else if (surveyKey === 'prepost-mangrove') {
                        const prepostSec = document.getElementById('prepost-section');
                        
                        // Show mangrove content, hide forest
                        document.getElementById('pp-forest-content').style.display = 'none';
                        document.getElementById('pp-mangrove-content').style.display = 'block';
                        void (prepostSec && prepostSec.offsetHeight);
                        
                        updateMangrovePrePostCharts();
                        
                        // Update header meta
                        document.getElementById('pp-meta-pre').textContent = 'Kilifi & Kwale';
                        document.getElementById('pp-meta-post').textContent = 'Counties';
                        
                        // Activate mangrove sub-selector button
                        activatePrePostTypeButton('mangrove');
                    } else {
                        // Temporarily show ALL GJJ tabs so Chart.js can measure canvas dimensions
                        const womenSec = document.getElementById('women-survey-section');
                        const gjjTabs = womenSec ? womenSec.querySelectorAll('.tab-content') : [];
                        gjjTabs.forEach((tab, i) => {
                            if (i < 5) tab.style.display = 'block';
                        });
                        void (womenSec && womenSec.offsetHeight); // force reflow
                        
                        updateSurveyCharts(surveyKey);
                        updateGJJTabCharts(surveyKey);
                        updateTabContent(surveyKey);
                        
                        // Restore tab visibility: only active tab visible via CSS class
                        gjjTabs.forEach((tab, i) => {
                            if (i < 5) tab.style.display = '';
                        });
                    }
                }, 200);
            });
        }

        // Update Charts Function
        function updateSurveyCharts(surveyKey) {
            // Only process surveys that use the women section canvases
            if (!['women-cosme', 'gjj-women', 'gjj-men'].includes(surveyKey)) {
                return;
            }

            // Define chart data for each survey (only charts with existing canvas elements)
            const chartDataByKey = {
                'women-cosme': {
                    decisions: { baseline: [45, 43.2, 32.1, 28.5, 52.1], midline: [58.8, 77.8, 62.2, 47.7, 53.7] },
                    nbs: { baseline: [36.9, 19.8, 67.4], midline: [86.5, 74.7, 98.4] }
                },
                'gjj-women': {
                    decisions: { baseline: [17.6, 36.4, 39.8, 18.4, 6.6], midline: [22.0, 28.3, 50.6, 22.1, 20.3] },
                    nbs: { baseline: [87.1, 84.9, 12.0], midline: [84.4, 64.2, 3.3] }
                },
                'gjj-men': {
                    decisions: { baseline: [52.2, 30.1, 52.4, 47.1, 40.5], midline: [83.5, 83.5, 70.3, 53.4, 60.2] },
                    nbs: { baseline: [53.1, 53.5, 94.1], midline: [64.9, 67.6, 99.0] }
                }
            };

            const data = chartDataByKey[surveyKey];
            if (!data) return;

            // Helper function to safely create charts
            function createChartIfExists(canvasId, chartConfig) {
                const canvas = document.getElementById(canvasId);
                if (!canvas) {
                    console.warn(`Canvas ${canvasId} not found, skipping chart creation`);
                    return null;
                }
                const varName = canvasId.replace('chart-', '').charAt(0).toUpperCase() + canvasId.replace('chart-', '').slice(1) + 'Chart';
                if (window[varName]) window[varName].destroy();
                return new Chart(canvas, chartConfig);
            }

            // GJJ-specific chart labels
            const isGJJWomen = surveyKey === 'gjj-women';
            const isGJJMen = surveyKey === 'gjj-men';
            const isGJJ = isGJJWomen || isGJJMen;
            const endlineLabel = isGJJ ? 'Endline' : 'Midline';

            const decisionsLabels = isGJJWomen
                ? ['Purchase Assets', 'Build on Land', 'Send/Remove Child', 'Invest in Business', 'Seek Healthcare']
                : isGJJMen
                ? ['Laugh Together', 'Respected', 'Check Safe', 'Talk Emotions', 'Accept No']
                : ['Market Access', 'Joint Work', 'Routine Purchases', 'Business/Loans', 'Child Education'];
            const nbsLabels = isGJJWomen
                ? ['Support Community Leadership', 'Support Starting Business', 'Hide Money (Always)']
                : isGJJMen
                ? ['Support Leadership\n(Always%)', 'Support Business\n(Definitely%)', 'Encourage Wife Time']
                : ['Mangrove Restoration', 'Seaweed Farming', 'Forest Management'];

            // Update Decisions / Household Decision Types Chart
            window.decisionsChart = createChartIfExists('chart-decisions', {
                type: 'bar',
                data: {
                    labels: decisionsLabels,
                    datasets: [
                        { label: 'Baseline', data: data.decisions.baseline, backgroundColor: colors.baseline },
                        { label: endlineLabel, data: data.decisions.midline, backgroundColor: colors.midline }
                    ]
                },
                options: { ...chartDefaults, scales: { y: { beginAtZero: true, max: 100 } }, plugins: { ...chartDefaults.plugins, datalabels: { ...chartDefaults.plugins.datalabels, anchor: 'end', align: 'top' } } }
            });

            // Update NbS / Autonomy & Leadership Chart
            window.nbsChart = createChartIfExists('chart-nbs', {
                type: 'bar',
                data: {
                    labels: nbsLabels,
                    datasets: [
                        { label: 'Baseline', data: data.nbs.baseline, backgroundColor: colors.baseline },
                        { label: endlineLabel, data: data.nbs.midline, backgroundColor: colors.midline }
                    ]
                },
                options: { ...chartDefaults, scales: { y: { beginAtZero: true, max: 105 } }, plugins: { ...chartDefaults.plugins, datalabels: { ...chartDefaults.plugins.datalabels, anchor: 'end', align: 'top' } } }
            });
        }

        // Update Logframe Table Dynamically
        function updateLogframeTable(logframeData) {
            const tbody = document.querySelector('.comparison-table tbody');
            tbody.innerHTML = '';
            
            logframeData.forEach(section => {
                // Add section header
                const headerRow = document.createElement('tr');
                headerRow.style.background = section.color;
                headerRow.style.fontWeight = '600';
                headerRow.innerHTML = `<td colspan="6"><strong style="color: white;">${section.level} - ${section.name}</strong></td>`;
                tbody.appendChild(headerRow);
                
                // Add indicators
                section.indicators.forEach(indicator => {
                    const row = document.createElement('tr');
                    const statusClass = indicator.status === 'EXCEEDED' ? 'badge-exceeded' : 
                                       indicator.status === 'TARGET MET' || indicator.status === 'ON TRACK' ? 'badge-met' : 'badge-near';
                    
                    row.innerHTML = `
                        <td><strong>${indicator.id}. ${indicator.name}</strong></td>
                        <td>${indicator.baseline}</td>
                        <td>${indicator.target}</td>
                        <td>${indicator.result}</td>
                        <td>${indicator.achievement}</td>
                        <td><span style="background: ${statusClass.includes('exceeded') ? '#c8e6c9' : statusClass.includes('near') ? '#ffe0b2' : '#a5d6a7'}; color: ${statusClass.includes('near') ? '#e65100' : '#1b5e20'}; padding: 4px 8px; border-radius: 4px; font-weight: 600;">${indicator.status}</span></td>
                    `;
                    tbody.appendChild(row);
                });
            });
        }

        // Update Tab Content Dynamically
        function updateTabContent(surveyKey) {
            if (!window.surveyData || !window.surveyData[surveyKey]) {
                console.error('ERROR: surveyData missing for key:', surveyKey);
                return;
            }

            const currentSurvey = window.surveyData[surveyKey];

            // === WOMEN-COSME: Restore original highlights and chart insights ===
            if (surveyKey === 'women-cosme') {
                if (window.originalWomenContent) {
                    const womenSection = document.getElementById('women-survey-section');
                    if (womenSection) {
                        Object.keys(window.originalWomenContent).forEach(tabId => {
                            const tab = document.getElementById(tabId);
                            if (!tab) return;
                            const saved = window.originalWomenContent[tabId];
                            // Restore section title
                            const sectionTitleEl = tab.querySelector('.section-title');
                            if (sectionTitleEl && saved.sectionTitle) {
                                sectionTitleEl.textContent = saved.sectionTitle;
                            }
                            // Restore highlight box
                            const highlightBox = tab.querySelector('.highlight-box');
                            if (highlightBox && saved.highlight) {
                                highlightBox.innerHTML = saved.highlight;
                            }
                            // Restore chart titles
                            if (saved.chartTitles) {
                                Object.keys(saved.chartTitles).forEach(chartId => {
                                    const canvas = document.getElementById(chartId);
                                    if (canvas) {
                                        const wrapper = canvas.closest('.chart-wrapper');
                                        if (wrapper) {
                                            const titleEl = wrapper.querySelector('.chart-title');
                                            if (titleEl) {
                                                titleEl.textContent = saved.chartTitles[chartId];
                                            }
                                        }
                                    }
                                });
                            }
                            // Restore chart insights
                            if (saved.insights) {
                                Object.keys(saved.insights).forEach(chartId => {
                                    const canvas = document.getElementById(chartId);
                                    if (canvas) {
                                        const wrapper = canvas.closest('.chart-wrapper');
                                        if (wrapper) {
                                            const insightEl = wrapper.querySelector('.chart-insight');
                                            if (insightEl) {
                                                insightEl.innerHTML = saved.insights[chartId];
                                            }
                                        }
                                    }
                                });
                            }
                        });
                    }
                }
                return;
            }

            // === MEN-COSME: Update the MEN section tabs (with -men suffix) ===
            if (surveyKey === 'men-cosme') {
                if (currentSurvey.tabContent) {
                    const tabIds = Object.keys(currentSurvey.tabContent);
                    tabIds.forEach(tabId => {
                        const tabInfo = currentSurvey.tabContent[tabId];
                        // Men tabs have '-men' suffix in their IDs
                        const menTabId = tabId + '-men';
                        const tabElement = document.getElementById(menTabId);
                        if (!tabElement) {
                            console.warn(`Tab element not found: ${menTabId}`);
                            return;
                        }
                        // Update highlight box
                        const highlightBox = tabElement.querySelector('.highlight-box');
                        if (highlightBox && tabInfo.highlight) {
                            highlightBox.innerHTML = tabInfo.highlight;
                        }
                        // Update chart insights (men charts have '-men' suffix on canvas IDs)
                        if (tabInfo.chartInsights) {
                            Object.keys(tabInfo.chartInsights).forEach(chartId => {
                                const menChartId = chartId + '-men';
                                const canvasElement = document.getElementById(menChartId);
                                if (canvasElement) {
                                    const chartWrapper = canvasElement.closest('.chart-wrapper');
                                    if (chartWrapper) {
                                        const insightElement = chartWrapper.querySelector('.chart-insight');
                                        if (insightElement) {
                                            insightElement.innerHTML = tabInfo.chartInsights[chartId];
                                        }
                                    }
                                }
                            });
                        }
                    });
                }
                return;
            }

            // === GJJ SURVEYS: Update women section with GJJ-appropriate content ===
            if (surveyKey === 'gjj-women' || surveyKey === 'gjj-men') {
                const womenSection = document.getElementById('women-survey-section');
                if (!womenSection) return;
                const surveyLabel = surveyKey === 'gjj-women' ? 'GJJ KAP Women' : 'GJJ KAP Men';

                // GJJ tabs: tab-household=SELF, tab-shocks=RELATIONAL, tab-preparedness=Shared Responsibility,
                // tab-resources=Shared Power, tab-savings=Autonomy & Leadership
                const gjjTabContent = surveyKey === 'gjj-men' ? {
                    'tab-household': {
                        highlight: `<h4>${surveyLabel} — 1. SELF: Self-Responsibility & Perception</h4>
                            <p>All three SELF domain statements and self-compassion show strong positive gains. "I take responsibility for my feelings" (Strongly Agree) improved from <strong>50.1% to 70.3%</strong> (+20.2pp). "I learn and grow from my mistakes" (SA) surged from <strong>47.7% to 71.2%</strong> (+23.5pp). "I see myself as equal to opposite gender" (SA) grew from <strong>44.0% to 61.1%</strong> (+17.1pp), with disagreement dropping from 8.6% to 4.5%. Self-compassion frequency rose from <strong>61.1% to 75.4%</strong> (+14.3pp) while "Never" practicing dropped from 1.5% to 0.0%.</p>`,
                        chartInsights: {
                            'chart-location': `<strong>"I take responsibility for my feelings..." (Likert):</strong> Strongly Agree surged +20.2pp (50.1%→70.3%). Agree declined as expected (44.6%→26.1%) as men shifted to stronger agreement. Disagree stable at 1.8%. Overall agreement: 96.4% (up from 95.4%).`,
                            'chart-headship': `<strong>"I learn and grow from my mistakes..." (Likert):</strong> Strongly Agree grew +23.5pp (47.7%→71.2%) — the largest SELF domain gain. Agree decreased (50.6%→27.8%) reflecting upward shift. Disagree dropped from 2.3% to 1.8%. Overall agreement: 98.2%, near-universal.`,
                            'chart-activities': `<strong>"I see myself as equal to opposite gender..." (Likert):</strong> Strongly Agree improved +17.1pp (44.0%→61.1%). Agree decreased slightly (43.8%→34.2%) as men shifted to stronger agreement. Disagree fell from 5.5% to 4.5% and Strongly Disagree dropped from 3.1% to 0.0%. Overall agreement: 95.5% (up from 88.3%).`,
                            'chart-housing': `<strong>Self-Compassion Frequency:</strong> "Frequently" practicing self-compassion grew +14.3pp (61.1%→75.4%). "Sometimes" dropped sharply from 33.3% to 13.8%. "Rarely" declined 3.1%→1.8%. "Never" dropped from 1.5% to 0.0%. Men are internalizing self-nurturing behaviors at growing rates.`,
                            'chart-wash': `<strong>SELF Domain Summary:</strong> All four indicators show substantial positive shifts. Learn & Grow leads with +23.5pp SA gain, followed by Responsibility (+20.2pp), Equal Perception (+17.1pp), and Self-Compassion (+14.3pp). Average improvement across the domain: +18.8pp.`
                        }
                    },
                    'tab-shocks': {
                        highlight: `<h4>${surveyLabel} — 2. RELATIONAL: Relationship Quality & Communication</h4>
                            <p>The RELATIONAL domain shows dramatic positive shifts across all key indicators. Men feeling respected by partner (Always) surged from <strong>30.1% to 83.5%</strong> (+53.4pp) — the single largest improvement across all domains. Laughing together (Always) grew from <strong>52.2% to 83.5%</strong> (+31.3pp). Discuss sharing responsibility (Always) improved from <strong>51.4% to 71.6%</strong> (+20.2pp). Accept "No" (Always) grew from <strong>40.5% to 60.2%</strong> (+19.7pp). Conflict escalation (Always) decreased slightly from 17.1% to 16.3%. Communication about emotions: 47.1%→53.4% (+6.3pp).</p>`,
                        chartInsights: {
                            'chart-shocks': `<strong>Relational "Always" Frequencies:</strong> Respected by Partner showed the most dramatic gain: 30.1%→83.5% (+53.4pp). Laugh Together surged to 83.5% (+31.3pp). Discuss Responsibility grew to 71.6% (+20.2pp). Accept "No" improved to 60.2% (+19.7pp). Check Wife Safe: 52.4%→70.3% (+17.9pp). Talk Emotions: 47.1%→53.4% (+6.3pp). All indicators moved positively.`,
                            'chart-impact': `<strong>Discuss Sharing Responsibility — Full Breakdown:</strong> "Always" grew +20.2pp (51.4%→71.6%). "Frequently" increased from 12.6% to 21.3%. "Sometimes" dropped sharply from 21.3% to 4.9%. "Rarely" and "Never" both fell to 0.0% (from 3.9% and 0.8%). Combined Always+Frequently: 74.0%→95.1% — now near-universal.`,
                            'chart-coping': `<strong>Accept "No/Not Now" — Full Breakdown:</strong> "Always" improved +19.7pp (40.5%→60.2%). "Frequently" grew from 13.6% to 21.4%. "Sometimes" dropped dramatically from 40.8% to 12.5%. "Rarely" decreased from 4.0% to 2.9%. "Never" slight increase from 0.8% to 2.9%. The significant shift from "Sometimes" to "Always/Frequently" indicates growing respect for partner consent.`
                        }
                    },
                    'tab-preparedness': {
                        highlight: `<h4>${surveyLabel} — 3. GENDER TRANSFORMATION: Shared Responsibility</h4>
                            <p>Men supporting household chores grew from <strong>86.9% to 92.7%</strong> (+5.8pp). Critically, men "Always" doing chores surged from <strong>17.7% to 42.2%</strong> (+24.5pp) — the most significant behavioral shift. Weekly chore discussions increased from <strong>76.2% to 90.2%</strong> (+14.0pp). Encouraging wife to make time for herself grew from <strong>94.1% to 99.0%</strong> (+4.9pp), now near-universal. "Often" doing chores grew from 36.3% to 41.1%. "Never" doing chores dropped from 6.2% to 0.0%.</p>`,
                        chartInsights: {
                            'chart-prep-knowledge': `<strong>Key Metrics:</strong> Support for chores (Yes) grew +5.8pp (86.9%→92.7%). "Always" does chores surged +24.5pp (17.7%→42.2%) — the strongest behavioral indicator. Discussed chores (past week) grew +14.0pp (76.2%→90.2%). Men are moving from attitudinal support to consistent behavioral action.`,
                            'chart-prep-participation': `<strong>Chore Frequency Distribution:</strong> "Always" surged +24.5pp (17.7%→42.2%). "Often" grew modestly (36.3%→41.1%). "Sometimes" dropped sharply from 28.3% to 10.1%. "Rarely" halved from 11.1% to 4.4%. "Never" dropped from 6.2% to 0.0%. The distribution shifted dramatically toward high-frequency participation.`,
                            'chart-warnings': `<strong>Support & Discussion Metrics:</strong> Discussed chores (past week): 76.2%→90.2% (+14.0pp). Encourage wife time: 94.1%→99.0% (+4.9pp), essentially universal. Support chores overall: 86.9%→92.7% (+5.8pp). All three support metrics are at or approaching 90%+ levels, showing comprehensive attitudinal transformation.`
                        }
                    },
                    'tab-resources': {
                        highlight: `<h4>${surveyLabel} — 4. GENDER TRANSFORMATION: Shared Power</h4>
                            <p>Households having decision conversations surged from <strong>87.9% to 97.1%</strong> (+9.2pp), now near-universal. Important household decisions being made: <strong>83.3% to 85.8%</strong> (+2.5pp). Support for wife as community leader (Always) grew from <strong>53.1% to 64.9%</strong> (+11.8pp), with combined Always+Frequently rising from 59.3% to 79.3%. "Definitely" support wife starting business improved from <strong>53.5% to 67.6%</strong> (+14.1pp). "Very Probably" support surged dramatically from 0.6% to 21.9%. "Possibly" support dropped from 22.1% to 3.5%, suggesting stronger commitment.</p>`,
                        chartInsights: {
                            'chart-assets': `<strong>Power-Sharing Metrics Overview:</strong> Decision Conversations: 87.9%→97.1% (+9.2pp). Important Decisions: 83.3%→85.8% (+2.5pp). Support Wife Leader (Always): 53.1%→64.9% (+11.8pp). Support Business (Definitely): 53.5%→67.6% (+14.1pp). All four power-sharing indicators improved, with leadership and business support showing the strongest gains.`,
                            'chart-land': `<strong>Support Wife as Leader — Frequency:</strong> "Always" grew +11.8pp (53.1%→64.9%). "Frequently" more than doubled from 6.2% to 14.4% (+8.2pp). "Sometimes" declined from 14.6% to 9.0% (-5.6pp). "Rarely" increased slightly (0.8%→2.7%). "Never" stable at ~3.5%. Combined Always+Frequently support surged from 59.3% to 79.3% (+20.0pp).`,
                            'chart-cultivation': `<strong>Decision Conversation Trends:</strong> Had decision conversations: 87.9%→97.1% (+9.2pp). Made important decisions: 83.3%→85.8% (+2.5pp). The gap between discussions and actual decisions narrowed from 4.6pp to 11.3pp, indicating that while conversations are now nearly universal, translating them into decisions remains an area for continued focus.`,
                            'chart-inputs': `<strong>Support Wife Business:</strong> "Definitely" grew +14.1pp (53.5%→67.6%). "Very Probably" surged from 0.6% to 21.9% (+21.3pp). "Possibly" dropped sharply from 22.1% to 3.5%. "Probably" increased slightly (0.6%→2.9%). Combined strong support (Definitely+Very Probably) soared from 54.1% to 89.5% (+35.4pp), showing a dramatic shift toward more definitive support for women's entrepreneurship.`
                        }
                    },
                    'tab-savings': {
                        highlight: `<h4>${surveyLabel} — 5. GENDER TRANSFORMATION: Autonomy & Leadership</h4>
                            <p>Support for wife as community leader (Always) grew from <strong>53.1% to 64.9%</strong> (+11.8pp), with combined Always+Frequently rising from 59.3% to 79.3% (+20.0pp). "Definitely" supporting wife starting/growing business improved from <strong>53.5% to 67.6%</strong> (+14.1pp). The "Very Probably" category surged from 0.6% to 21.9%. Encouraging wife to make time for herself: <strong>94.1% to 99.0%</strong>. Weekly chore discussions: <strong>76.2% to 90.2%</strong>. Men demonstrate growing commitment to supporting women's autonomy, leadership roles, and economic empowerment.</p>`,
                        chartInsights: {
                            'chart-personal-savings': `<strong>Support Wife as Leader — Detail:</strong> "Always" grew +11.8pp (53.1%→64.9%). "Frequently" doubled from 6.2% to 14.4%. "Sometimes" declined from 14.6% to 9.0%. "Rarely" increased slightly (0.8%→2.7%). "Never" stayed minimal at ~3.5%. The shift from "Sometimes" to "Always/Frequently" categories indicates deeper, more consistent support for women's leadership aspirations.`,
                            'chart-mechanism': `<strong>Support Wife Business — Detail:</strong> "Definitely" grew +14.1pp (53.5%→67.6%). "Very Probably" surged from 0.6% to 21.9%. "Possibly" collapsed from 22.1% to 3.5%. Total strong support (Definitely+Very Probably): 54.1%→89.5% (+35.4pp). This dramatic shift shows men moving from tentative to definitive support for women's economic empowerment.`,
                            'chart-loans': `<strong>Encourage & Discuss Metrics:</strong> Encourage wife to make time for self: 94.1%→99.0% (+4.9pp), now essentially universal. Discussed chores past week: 76.2%→90.2% (+14.0pp). Both metrics demonstrate that supportive behaviors and household communication are becoming normalized practices.`,
                            'chart-savings-use': `<strong>Autonomy & Leadership Summary:</strong> Support for leadership (Always) grew to 64.9% (+11.8pp). Business support (Definitely) reached 67.6% (+14.1pp). Encourage wife time: 99.0%. Discuss chores: 90.2%. All four indicators show consistent improvement, with the strongest gains in economic empowerment support. The comprehensive upward trend reflects genuine transformation in men's support for women's autonomy.`
                        }
                    }
                } : {
                    'tab-household': {
                        highlight: `<h4>${surveyLabel} — 1. SELF: Self-Esteem & Self-Perception</h4>
                            <p>All four SELF domain statements show strong positive gains from baseline to endline. "I have many strengths and qualities" (Strongly Agree) improved from <strong>33.5% to 52.6%</strong> (+19.1pp), with overall agreement (SA+A) rising from 72.2% to 83.8%. Self-perception as equal to opposite gender surged <strong>20.4%→48.2%</strong> (+27.8pp SA). "My feelings and opinions are important" grew <strong>28.9%→49.4%</strong> (+20.5pp SA) while disagreement halved. "I voice my opinions in my community" recorded the largest gain: <strong>26.7%→65.9%</strong> (+39.2pp SA), with neutral/disagree collapsing from 43.5% to 12.8%.</p>`,
                        chartInsights: {
                            'chart-location': `<strong>Strengths & Qualities (Likert):</strong> Strongly Agree surged +19.1pp (33.5%→52.6%). Neutral dropped 15.3%→10.1%, Disagree fell 8.6%→4.3%, and Strongly Disagree halved from 3.9% to 1.8%. The entire distribution shifted positively toward agreement.`,
                            'chart-headship': `<strong>Equal Self-Perception (Likert):</strong> Strongly Agree more than doubled from 20.4% to 48.2% (+27.8pp). Disagree categories collapsed from 24.7% combined to just 9.7%. This is the second-largest SELF domain improvement.`,
                            'chart-activities': `<strong>Feelings Important (Likert):</strong> Strongly Agree grew +20.5pp (28.9%→49.4%). Neutral shrank 19.2%→12.4% and Disagree fell from 18.5% to 7.4% combined. Nearly 80% of women now agree or strongly agree.`,
                            'chart-housing': `<strong>Voice Opinions (Likert):</strong> Strongly Agree surged +39.2pp (26.7%→65.9%) — the single largest improvement across all SELF indicators. Disagree/Strongly Disagree collapsed from 23.4% to just 4.4%. Two-thirds of women now strongly agree they can voice opinions.`,
                            'chart-wash': `<strong>SELF Domain Summary:</strong> All four indicators show dramatic positive shifts. Voice Opinions leads with +39.2pp, followed by Equal Perception (+27.8pp), Feelings Important (+20.5pp), and Strengths (+19.1pp). Average SA gain across the domain: +26.7pp.`
                        }
                    },
                    'tab-shocks': {
                        highlight: `<h4>${surveyLabel} — 2. RELATIONAL: Relationship Quality & Communication</h4>
                            <p>The RELATIONAL domain shows mixed results reflecting the complexity of shifting intimate-partner dynamics. Women feeling respected by partner (Always) <span style="color:#c62828;font-weight:600;">declined from 43.1% to 39.1%</span> (-4.0pp), though "Often" respect increased 28.3%→31.7%. Voicing disagreement comfortably (Always) remained stable at 26.9%→27.1%, but "Often" grew +3.8pp. Laughing together (Always) improved from 38.4% to 42.8% (+4.4pp). Consent respect (Always) showed the strongest gain: 45.8%→52.3% (+6.5pp). Overall, while "Always" respect declined, mid-frequency positive behaviors are strengthening.</p>`,
                        chartInsights: {
                            'chart-shocks': `<strong>Relational "Always" Frequencies:</strong> Consent Respect leads at 52.3% (+6.5pp). Laughing Together improved to 42.8% (+4.4pp). Sharing Feelings grew 31.2%→35.6%. <span style="color:#c62828;">Respected by Partner declined -4.0pp (43.1%→39.1%).</span> Disagreement comfort stable at 27.1%.`,
                            'chart-impact': `<strong>Respected by Partner — Full Breakdown:</strong> "Always" <span style="color:#c62828;">dropped from 43.1% to 39.1%</span>, but "Often" increased from 28.3% to 31.7% (+3.4pp). "Sometimes" remained stable at ~19%. "Rarely" and "Never" stayed low (~10% combined), suggesting the shift is from "Always" to "Often" rather than to negative categories.`,
                            'chart-coping': `<strong>Voicing Disagreement — Full Breakdown:</strong> "Always" barely changed (26.9%→27.1%), but "Often" grew +3.8pp (24.5%→28.3%). "Sometimes" was stable. "Rarely" and "Never" declined from 19.8% to 17.0% combined. The overall pattern is a modest positive shift in relationship communication comfort.`
                        }
                    },
                    'tab-preparedness': {
                        highlight: `<h4>${surveyLabel} — 3. GENDER TRANSFORMATION: Shared Responsibility</h4>
                            <p>Husband support for household chores increased significantly from <strong>41.4% to 64.7%</strong> (+23.3pp). Weekly discussions about sharing unpaid care work surged from <strong>63.7% to 94.5%</strong> (+30.8pp) — now near-universal. However, husbands "Always" doing chores <span style="color:#c62828;font-weight:600;">remained stubbornly low at 13.1%</span> (from 13.7%), while "Often" grew from 18.2% to 25.3% (+7.1pp). The biggest shifts in care work discussions were in cooking (52.3%→78.9%), cleaning (48.6%→72.4%), and childcare (45.1%→68.5%). This suggests strong attitudinal progress that is beginning to translate into behavioral change.</p>`,
                        chartInsights: {
                            'chart-prep-knowledge': `<strong>Key Metrics:</strong> Husband supports chores rose +23.3pp (41.4%→64.7%). Chore discussions surged +30.8pp to 94.5%. <span style="color:#c62828;">However, "Always" does chores barely moved at 13.1%.</span> Attitudinal support is outpacing consistent behavioral change — a common pattern in gender transformation programs.`,
                            'chart-prep-participation': `<strong>Chore Frequency Distribution:</strong> "Always" stayed flat at ~13%, but "Often" grew +7.1pp (18.2%→25.3%) and "Sometimes" increased from 27.5% to 33.2%. "Rarely" and "Never" both declined, from 40.6% combined to 28.4%. The shift is gradual but directionally positive — men are doing chores more frequently.`,
                            'chart-warnings': `<strong>Care Work Types Discussed:</strong> All five categories of unpaid care work show strong increases in discussion frequency. Cooking leads at 78.9% (+26.6pp), followed by Cleaning 72.4% (+23.8pp) and Childcare 68.5% (+23.4pp). Even Water/Firewood collection grew +22.5pp. Dialogue is now nearly universal across all care work types.`
                        }
                    },
                    'tab-resources': {
                        highlight: `<h4>${surveyLabel} — 4. GENDER TRANSFORMATION: Shared Power</h4>
                            <p>Households having decision conversations in past 6 months surged from <strong>60.2% to 81.7%</strong> (+21.5pp). Husband making decisions alone <strong>dropped to 2.0%</strong> (from 8.8%, -6.8pp) while joint decision-making grew from 42.6% to 58.4% (+15.8pp). Key decision gains: child schooling 39.8%→50.6% (+10.8pp), seek healthcare 6.6%→20.3% (+13.7pp). "Very Often" decision discussions tripled from 12.8% to 28.5%. <span style="color:#c62828;font-weight:600;">Build on land decisions decreased 36.4%→28.3%</span> (-8.1pp), suggesting shifting investment priorities.</p>`,
                        chartInsights: {
                            'chart-assets': `<strong>Decision Types:</strong> Biggest gains in seek healthcare (+13.7pp, 6.6%→20.3%) and child schooling (+10.8pp, 39.8%→50.6%). Purchase assets grew modestly (+4.4pp). Business investment stable (+3.7pp). <span style="color:#c62828;">Build on land decreased -8.1pp (36.4%→28.3%).</span>`,
                            'chart-land': `<strong>Final Say Distribution:</strong> Husband Alone decisions collapsed from 8.8% to 2.0% (-6.8pp). "Mostly Husband" also dropped 15.3%→8.7%. Joint Decision-making surged from 42.6% to 58.4% (+15.8pp). Wife's influence (Mostly Wife + Wife Alone) remained stable at ~31%. The power shift is primarily from male unilateral to joint decision-making.`,
                            'chart-cultivation': `<strong>Decision Discussion Frequency:</strong> "Very Often" more than doubled from 12.8% to 28.5% (+15.7pp). "Often" grew from 22.4% to 31.2%. "Rarely" halved from 19.8% to 10.3% and "Never" dropped from 9.4% to 4.2%. Couples are having important conversations much more frequently.`,
                            'chart-inputs': `<strong>Decision Conversations + Types:</strong> Overall decision conversations: 60.2%→81.7% (+21.5pp). Paired with specific decision types showing healthcare (+13.7pp) and child schooling (+10.8pp) as the biggest winners. Decisions are both more frequent and more inclusive in scope.`
                        }
                    },
                    'tab-savings': {
                        highlight: `<h4>${surveyLabel} — 5. GENDER TRANSFORMATION: Autonomy & Leadership</h4>
                            <p>Women hiding money from husbands (Always) decreased from <strong>12.0% to 3.3%</strong> (-8.7pp), with "Never" growing from 38.5% to 60.6% (+22.1pp) — indicating strong gains in financial openness and household trust. Support for community leadership (Definitely) <span style="color:#c62828;font-weight:600;">dipped slightly from 87.1% to 84.4%</span> (-2.7pp), with "Probably" absorbing most of the shift. Support for starting own business (Definitely) <span style="color:#c62828;font-weight:600;">declined significantly from 84.9% to 64.2%</span> (-20.7pp), with "Probably" growing from 8.5% to 18.3% and "Maybe" from 4.1% to 10.5%. This may reflect more realistic assessments of economic barriers rather than reduced aspiration.</p>`,
                        chartInsights: {
                            'chart-personal-savings': `<strong>Money Hiding — Full Breakdown:</strong> "Always" dropped -8.7pp (12.0%→3.3%). "Often" declined 8.3%→5.1%. "Sometimes" decreased from 18.5%→12.8%. Most dramatically, "Never" hiding money surged from 38.5% to 60.6% (+22.1pp). Financial transparency has improved substantially — a strong indicator of growing household trust.`,
                            'chart-mechanism': `<strong>Leadership Support Levels:</strong> "Definitely" <span style="color:#c62828;">dipped slightly -2.7pp (87.1%→84.4%)</span>. "Probably" absorbed the shift (7.2%→8.8%). "Maybe" and below remained minimal (~7%). Support is still very high at 93.2% positive (Definitely+Probably), suggesting this is a ceiling effect rather than declining support.`,
                            'chart-loans': `<strong>Business Support Levels:</strong> "Definitely" <span style="color:#c62828;">declined significantly -20.7pp (84.9%→64.2%)</span>. "Probably" grew from 8.5% to 18.3% (+9.8pp) and "Maybe" from 4.1% to 10.5% (+6.4pp). Combined positive support (Definitely+Probably) dropped from 93.4% to 82.5%. This warrants investigation into economic barriers and whether support is shifting to more conditional/realistic stances.`,
                            'chart-savings-use': `<strong>Autonomy Summary:</strong> Financial openness (Never hiding money) is the standout gain at 60.6% (+22.1pp). Leadership support remains high at 84.4%. <span style="color:#c62828;">Business support saw the largest decline at -20.7pp.</span> The mixed picture suggests internal household trust is growing while external economic confidence faces challenges. Focus on economic enablement programming recommended.`
                        }
                    }
                };

                // Apply tab-specific content
                Object.keys(gjjTabContent).forEach(tabId => {
                    const tabElement = document.getElementById(tabId);
                    if (!tabElement) return;
                    const tabInfo = gjjTabContent[tabId];
                    // Update highlight box
                    const highlightBox = tabElement.querySelector('.highlight-box');
                    if (highlightBox && tabInfo.highlight) {
                        highlightBox.innerHTML = tabInfo.highlight;
                    }
                    // Update ALL chart insights within this tab
                    if (tabInfo.chartInsights) {
                        Object.keys(tabInfo.chartInsights).forEach(chartId => {
                            const canvasElement = document.getElementById(chartId);
                            if (canvasElement) {
                                const chartWrapper = canvasElement.closest('.chart-wrapper');
                                if (chartWrapper) {
                                    const insightElement = chartWrapper.querySelector('.chart-insight');
                                    if (insightElement) {
                                        insightElement.innerHTML = tabInfo.chartInsights[chartId];
                                    }
                                }
                            }
                        });
                    }
                });
            }
        }

        // === GJJ Tab Charts — renders bar charts for GJJ survey domains ===
        function updateGJJTabCharts(surveyKey) {
            if (surveyKey !== 'gjj-women' && surveyKey !== 'gjj-men') return;
            function gjjChart(id, labels, bl, el, horiz) {
                const canvas = document.getElementById(id);
                if (!canvas) { console.warn('GJJ canvas not found:', id); return; }
                const existing = Chart.getChart(canvas);
                if (existing) existing.destroy();
                const maxVal = Math.min(Math.max(...bl, ...el) + 12, 105);
                return new Chart(canvas, {
                    type: 'bar',
                    data: {
                        labels: labels,
                        datasets: [
                            { label: 'Baseline', data: bl, backgroundColor: colors.baseline },
                            { label: 'Endline', data: el, backgroundColor: colors.midline }
                        ]
                    },
                    options: {
                        ...chartDefaults,
                        indexAxis: horiz ? 'y' : 'x',
                        scales: horiz
                            ? { x: { beginAtZero: true, max: maxVal } }
                            : { y: { beginAtZero: true, max: maxVal } },
                        plugins: {
                            ...chartDefaults.plugins,
                            datalabels: {
                                ...chartDefaults.plugins.datalabels,
                                anchor: 'end',
                                align: horiz ? 'right' : 'top'
                            }
                        }
                    }
                });
            }

            if (surveyKey === 'gjj-women') {
            // ============================================================
            // GJJ WOMEN — TAB 0: SELF
            // ============================================================
            gjjChart('chart-location',
                ['Strongly Agree', 'Agree', 'Neutral', 'Disagree', 'Strongly Disagree'],
                [33.5, 38.7, 15.3, 8.6, 3.9],
                [52.6, 31.2, 10.1, 4.3, 1.8]);
            gjjChart('chart-headship',
                ['Strongly Agree', 'Agree', 'Neutral', 'Disagree', 'Strongly Disagree'],
                [20.4, 32.1, 22.8, 16.5, 8.2],
                [48.2, 28.5, 13.6, 7.1, 2.6]);
            gjjChart('chart-activities',
                ['Strongly Agree', 'Agree', 'Neutral', 'Disagree', 'Strongly Disagree'],
                [28.9, 33.4, 19.2, 12.3, 6.2],
                [49.4, 30.8, 12.4, 5.2, 2.2]);
            gjjChart('chart-housing',
                ['Strongly Agree', 'Agree', 'Neutral', 'Disagree', 'Strongly Disagree'],
                [26.7, 29.8, 20.1, 15.6, 7.8],
                [65.9, 21.3, 8.4, 3.2, 1.2]);
            gjjChart('chart-wash',
                ['Strengths &\nQualities', 'Feelings\nImportant', 'Equal to\nOpposite Gender', 'Voice\nOpinions'],
                [33.5, 28.9, 20.4, 26.7],
                [52.6, 49.4, 48.2, 65.9]);

            // GJJ WOMEN — TAB 1: RELATIONAL
            gjjChart('chart-shocks',
                ['Respected by\nPartner', 'Voice\nDisagreement', 'Laugh\nTogether', 'Share\nFeelings', 'Consent\nRespect'],
                [43.1, 26.9, 38.4, 31.2, 45.8],
                [39.1, 27.1, 42.8, 35.6, 52.3], true);
            gjjChart('chart-impact',
                ['Always', 'Often', 'Sometimes', 'Rarely', 'Never'],
                [43.1, 28.3, 18.6, 7.2, 2.8],
                [39.1, 31.7, 19.5, 7.4, 2.3]);
            gjjChart('chart-coping',
                ['Always', 'Often', 'Sometimes', 'Rarely', 'Never'],
                [26.9, 24.5, 28.8, 13.6, 6.2],
                [27.1, 28.3, 27.6, 12.3, 4.7]);

            // GJJ WOMEN — TAB 2: SHARED RESPONSIBILITY
            gjjChart('chart-prep-knowledge',
                ['Husband Supports\nChores (%)', 'Husband Always\nDoes Chores (%)', 'Weekly Chore\nDiscussion (%)'],
                [41.4, 13.7, 63.7],
                [64.7, 13.1, 94.5]);
            gjjChart('chart-prep-participation',
                ['Always', 'Often', 'Sometimes', 'Rarely', 'Never'],
                [13.7, 18.2, 27.5, 24.8, 15.8],
                [13.1, 25.3, 33.2, 18.7, 9.7]);
            gjjChart('chart-warnings',
                ['Cooking', 'Cleaning', 'Childcare', 'Laundry', 'Water/\nFirewood'],
                [52.3, 48.6, 45.1, 38.2, 32.8],
                [78.9, 72.4, 68.5, 62.1, 55.3], true);

            // GJJ WOMEN — TAB 3: SHARED POWER
            gjjChart('chart-assets',
                ['Purchase\nHH Assets', 'Build on\nLand', 'Child\nSchooling', 'Business\nInvestment', 'Seek\nHealthcare'],
                [17.6, 36.4, 39.8, 18.4, 6.6],
                [22.0, 28.3, 50.6, 22.1, 20.3], true);
            gjjChart('chart-land',
                ['Husband\nAlone', 'Mostly\nHusband', 'Joint\nDecision', 'Mostly\nWife', 'Wife\nAlone'],
                [8.8, 15.3, 42.6, 21.8, 11.5],
                [2.0, 8.7, 58.4, 20.3, 10.6]);
            gjjChart('chart-cultivation',
                ['Very Often', 'Often', 'Sometimes', 'Rarely', 'Never'],
                [12.8, 22.4, 35.6, 19.8, 9.4],
                [28.5, 31.2, 25.8, 10.3, 4.2]);
            gjjChart('chart-inputs',
                ['Had Decision\nConversations', 'Purchase\nAssets', 'Child\nSchooling', 'Invest in\nBusiness', 'Seek\nHealthcare'],
                [60.2, 17.6, 39.8, 18.4, 6.6],
                [81.7, 22.0, 50.6, 22.1, 20.3]);

            // GJJ WOMEN — TAB 4: AUTONOMY & LEADERSHIP
            gjjChart('chart-personal-savings',
                ['Always', 'Often', 'Sometimes', 'Rarely', 'Never'],
                [12.0, 8.3, 18.5, 22.7, 38.5],
                [3.3, 5.1, 12.8, 18.2, 60.6]);
            gjjChart('chart-mechanism',
                ['Definitely', 'Probably', 'Maybe', 'Probably Not', 'Definitely Not'],
                [87.1, 7.2, 3.5, 1.4, 0.8],
                [84.4, 8.8, 4.2, 1.8, 0.8]);
            gjjChart('chart-loans',
                ['Definitely', 'Probably', 'Maybe', 'Probably Not', 'Definitely Not'],
                [84.9, 8.5, 4.1, 1.7, 0.8],
                [64.2, 18.3, 10.5, 4.8, 2.2]);
            gjjChart('chart-savings-use',
                ['Hide Money\n(Always %)', 'Leadership\n(Definitely %)', 'Business\n(Definitely %)', 'Financial\nOpenness (%)'],
                [12.0, 87.1, 84.9, 38.5],
                [3.3, 84.4, 64.2, 60.6]);

            } else if (surveyKey === 'gjj-men') {
            // ============================================================
            // GJJ MEN — TAB 0: SELF — Self-Responsibility & Perception
            // ============================================================

            // Chart 1: "I take responsibility for my feelings..." — SA, A, D, SD
            gjjChart('chart-location',
                ['Strongly Agree', 'Agree', 'Disagree', 'Strongly Disagree'],
                [50.1, 44.6, 1.8, 0.5],
                [70.3, 26.1, 1.8, 1.8]);

            // Chart 2: "I learn and grow from my mistakes..." — SA, A, D, SD
            gjjChart('chart-headship',
                ['Strongly Agree', 'Agree', 'Disagree', 'Strongly Disagree'],
                [47.7, 50.6, 2.3, 0.0],
                [71.2, 27.8, 1.8, 0.0]);

            // Chart 3: "I see myself as equal to opposite gender..." — SA, A, D, SD
            gjjChart('chart-activities',
                ['Strongly Agree', 'Agree', 'Disagree', 'Strongly Disagree'],
                [44.0, 43.8, 5.5, 3.1],
                [61.1, 34.2, 4.5, 0.0]);

            // Chart 4: Self-compassion frequency — "I nurture myself with kind, supportive self-talk"
            gjjChart('chart-housing',
                ['Frequently', 'Sometimes', 'Rarely', 'Never'],
                [61.1, 33.3, 3.1, 1.5],
                [75.4, 13.8, 1.8, 0.0]);

            // Chart 5: SELF Domain Overview — Strongly Agree % + Agreement %
            gjjChart('chart-wash',
                ['Responsibility\n(SA%)', 'Learn/Grow\n(SA%)', 'Equal\n(SA%)', 'Self-Compassion\n(Freq%)'],
                [50.1, 47.7, 44.0, 61.1],
                [70.3, 71.2, 61.1, 75.4]);

            // ============================================================
            // GJJ MEN — TAB 1: RELATIONAL — Relationship Quality
            // ============================================================

            // Chart 1: "Always" frequency across key relational indicators
            gjjChart('chart-shocks',
                ['Laugh\nTogether', 'Respected\nby Partner', 'Check Wife\nSafe', 'Talk About\nEmotions', 'Accept\n\"No\"', 'Discuss\nResponsibility'],
                [52.2, 30.1, 52.4, 47.1, 40.5, 51.4],
                [83.5, 83.5, 70.3, 53.4, 60.2, 71.6], true);

            // Chart 2: "Discuss Sharing Responsibility" — Full frequency breakdown
            gjjChart('chart-impact',
                ['Always', 'Frequently', 'Sometimes', 'Rarely', 'Never'],
                [51.4, 12.6, 21.3, 3.9, 0.8],
                [71.6, 21.3, 4.9, 0.0, 0.0]);

            // Chart 3: "Accept No/Not Now" — Full frequency breakdown
            gjjChart('chart-coping',
                ['Always', 'Frequently', 'Sometimes', 'Rarely', 'Never'],
                [40.5, 13.6, 40.8, 4.0, 0.8],
                [60.2, 21.4, 12.5, 2.9, 2.9]);

            // ============================================================
            // GJJ MEN — TAB 2: SHARED RESPONSIBILITY
            // ============================================================

            // Chart 1: Key Shared Responsibility Metrics
            gjjChart('chart-prep-knowledge',
                ['Support Chores\n(Yes%)', 'Always Does\nChores', 'Discussed\nChores (Yes%)'],
                [86.9, 17.7, 76.2],
                [92.7, 42.2, 90.2]);

            // Chart 2: Husband Household Chore Frequency — Full distribution
            gjjChart('chart-prep-participation',
                ['Always\n(Every day)', 'Often\n(Several/wk)', 'Sometimes\n(Several/mo)', 'Rarely\n(Several/yr)', 'Never'],
                [17.7, 36.3, 28.3, 11.1, 6.2],
                [42.2, 41.1, 10.1, 4.4, 0.0]);

            // Chart 3: Support & Discussion Metrics
            gjjChart('chart-warnings',
                ['Discussed Chores\n(Yes%)', 'Encourage Wife\nTime (Yes%)', 'Support Chores\n(Yes%)'],
                [76.2, 94.1, 86.9],
                [90.2, 99.0, 92.7]);

            // ============================================================
            // GJJ MEN — TAB 3: SHARED POWER
            // ============================================================

            // Chart 1: Key Power-Sharing Metrics
            gjjChart('chart-assets',
                ['Decision\nConversations', 'Important\nDecisions', 'Support Wife\nLeader (Always)', 'Support Wife\nBusiness (Def)'],
                [87.9, 83.3, 53.1, 53.5],
                [97.1, 85.8, 64.9, 67.6], true);

            // Chart 2: Support Wife as Community Leader — Full frequency
            gjjChart('chart-land',
                ['Always', 'Frequently', 'Sometimes', 'Rarely', 'Never'],
                [53.1, 6.2, 14.6, 0.8, 3.5],
                [64.9, 14.4, 9.0, 2.7, 3.6]);

            // Chart 3: Decision Conversations Trends (Yes%)
            gjjChart('chart-cultivation',
                ['Had Decision\nConversations', 'Made Important\nDecisions'],
                [87.9, 83.3],
                [97.1, 85.8]);

            // Chart 4: Support Wife Starting/Growing Business
            gjjChart('chart-inputs',
                ['Definitely', 'Possibly', 'Probably', 'Very Probably', 'NA'],
                [53.5, 22.1, 0.6, 0.6, 1.6],
                [67.6, 3.5, 2.9, 21.9, 3.5]);

            // ============================================================
            // GJJ MEN — TAB 4: AUTONOMY & LEADERSHIP
            // ============================================================

            // Chart 1: Support Wife as Leader — Full breakdown (repeated for detail)
            gjjChart('chart-personal-savings',
                ['Always', 'Frequently', 'Sometimes', 'Rarely', 'Never'],
                [53.1, 6.2, 14.6, 0.8, 3.5],
                [64.9, 14.4, 9.0, 2.7, 3.6]);

            // Chart 2: Support Wife Business — Full breakdown
            gjjChart('chart-mechanism',
                ['Definitely', 'Possibly', 'Probably', 'Very Probably', 'NA'],
                [53.5, 22.1, 0.6, 0.6, 1.6],
                [67.6, 3.5, 2.9, 21.9, 3.5]);

            // Chart 3: Encourage Wife & Discuss Chores
            gjjChart('chart-loans',
                ['Encourage Wife\nTime (Yes%)', 'Discussed\nChores (Yes%)'],
                [94.1, 76.2],
                [99.0, 90.2]);

            // Chart 4: Autonomy & Leadership Summary
            gjjChart('chart-savings-use',
                ['Leader\n(Always%)', 'Business\n(Definitely%)', 'Encourage\nTime (Yes%)', 'Discuss\nChores (Yes%)'],
                [53.1, 53.5, 94.1, 76.2],
                [64.9, 67.6, 99.0, 90.2]);

            } // end gjj-men
        }

        // Dynamic Tab Charts Data Structure - Make globally accessible
        window.tabChartData = {
            'women-cosme': {
                'chart-location': { data: [57.2, 42.8], labels: ['Marine', 'Terrestrial'] },
                'chart-headship': { baseline: [51.0, 49.0], midline: [57.7, 42.3] },
                'chart-activities': { baseline: [17.6, 34.8, 25.5, 22.1], midline: [30.3, 38.8, 11.6, 19.3] },
                'chart-housing': { baseline: [66.6, 33.4], midline: [79.4, 20.6] },
                'chart-wash': { baseline: [84.3, 70.3], midline: [79.7, 72.5] },
                'chart-shocks': { baseline: [69.1, 8.6, 4.7, 17.6], midline: [63.4, 22.8, 10.0, 3.8] },
                'chart-impact': { baseline: [32.7, 31.9, 17.6, 14.0, 2.9], midline: [20.0, 46.7, 24.2, 7.9, 0.4] },
                'chart-coping': { baseline: [4.7, 14.7, 11.2, 41.6, 28.0], midline: [25.8, 22.9, 15.8, 43.8, 17.0] },
                'chart-prep-knowledge': { baseline: [4.7, 45.2, 50.1], midline: [37.8, 42.2, 20.0] },
                'chart-prep-participation': { data: [26.9, 7.5, 65.6], labels: ['Directly Participate', 'Family Participation', 'No Participation'] },
                'chart-warnings': { baseline: [15.7, 8.9, 10.3], midline: [46.2, 45.0, 33.1] },
                'chart-assets': { baseline: [47.0, 9.2, 3.5, 17.3], midline: [62.5, 31.6, 39.7, 23.1] },
                'chart-land': { baseline: [92.7, 6.0, 1.3], midline: [73.4, 19.6, 7.0] },
                'chart-cultivation': { data: [80.4, 19.6], labels: ['Using for Agriculture', 'Idle/Not Using'] },
                'chart-inputs': { baseline: [84.7, 93.5, 93.1, 73.6, 88.3], midline: [98.4, 99.4, 98.7, 87.5, 95.1] },
                'chart-personal-savings': { data: [93.4, 6.6], labels: ['Personally Saving', 'Not Saving'] },
                'chart-mechanism': { baseline: [43.6, 14.5, 8.3, 6.9, 12.9], midline: [98.0, 2.7, 1.7, 3.7, 0.0] },
                'chart-loans': { data: [79.1, 20.9], labels: ['Taking Loans', 'Not Taking'] },
                'chart-savings-use': { baseline: [10.2, 10.9, 46.2, 64.0, 24.1], midline: [63.9, 30.4, 28.4, 17.7, 3.7] },
                'chart-time': { baseline: [9.3, 4.2, 0.4, 0.0], midline: [7.7, 4.9, 1.8, 0.3] },
                'chart-beliefs': { baseline: [12.5, 13.5, 21.4, 14.4, 26.5], midline: [71.3, 66.9, 77.8, 60.6, 72.2] },
                'chart-experience': { baseline: [87.0, 85.3, 76.6, 83.3, 70.7], midline: [28.8, 32.5, 22.2, 37.2, 25.3] },
                'chart-productive': { baseline: [23.7, 1.3, 70.5, 26.3, 3.5], midline: [47.8, 12.8, 48.8, 36.6, 14.1] },
                'chart-decisions': { baseline: [13.5, 9.8, 25.6, 40.2, 58.1], midline: [48.1, 49.1, 50.6, 59.4, 59.7] },
                'chart-influence': { baseline: [17.0, 40.8, 42.1, 40.4, 50.6], midline: [51.9, 56.9, 55.9, 56.6, 55.9] },
                'chart-decision-gap': { data: [52.7, 30.6, 73.8, 48.8], labels: ['Should Joint - Baseline', 'Actually Joint - Baseline', 'Should Joint - Midline', 'Actually Joint - Midline'] },
                'chart-cc-awareness': { data: [96.3, 3.8], labels: ['Aware of Climate Change', 'Not Aware'] },
                'chart-cc-effects': { baseline: [54.7, 39.5, 32.7, 62.2, 25.5], midline: [75.9, 67.5, 62.8, 70.3, 28.8] },
                'chart-nbs': { baseline: [36.9, 19.8, 67.4, 23.1], midline: [86.5, 74.7, 98.4, 77.8] },
                'chart-nbs-benefits': { baseline: [11.5, 9.3, 7.9, 2.8, 3.8, 7.8], midline: [47.2, 35.9, 24.1, 33.1, 10.3, 11.9] },
                'chart-selfesteem': { baseline: [88.5, 78.2, 93.5, 88.2, 81.2], midline: [97.2, 97.8, 99.4, 97.5, 99.1] },
                'chart-aspirations': { baseline: [72.1, 71.1, 81.2], midline: [96.9, 98.4, 99.1] },
                'chart-leadership': { baseline: [59.1, 60.9, 54.8, 61.5], midline: [94.1, 92.5, 92.2, 92.5] },
                'chart-communication': { baseline: [75.8, 52.5, 67.6, 59.6], midline: [95.6, 87.2, 94.4, 90.0] },
                'chart-norms': { baseline: [40.2, 23.5, 64.4, 36.8], midline: [75.4, 88.1, 74.1, 55.3] },
                'chart-norms-strong': { baseline: [6.8, 2.8, 10.2], midline: [27.8, 16.3, 24.1] },
                'chart-norms-conservation': { baseline: [73.7, 70.5, 70.5], midline: [89.1, 91.3, 91.3] },
                'chart-norms-money': { baseline: [66.1, 64.4], midline: [76.3, 74.1] }
            },
            'men-cosme': {
                'chart-location': { data: [64.2, 35.8], labels: ['Marine', 'Terrestrial'] },
                'chart-headship': { baseline: [32.7, 67.3], midline: [28.6, 71.4] },
                'chart-activities': { baseline: [18.4, 52.1, 21.8, 7.7], midline: [24.1, 52.8, 18.3, 4.8] },
                'chart-housing': { baseline: [58.1, 41.9], midline: [61.7, 38.3] },
                'chart-wash': { baseline: [81.5, 68.2], midline: [76.9, 71.2] },
                'chart-shocks': { baseline: [71.2, 6.3, 3.1, 19.4], midline: [64.8, 19.7, 8.5, 7.0] },
                'chart-impact': { baseline: [28.5, 35.2, 21.3, 12.8, 2.2], midline: [16.3, 38.1, 28.5, 13.0, 4.1] },
                'chart-coping': { baseline: [8.3, 22.1, 7.1, 38.4, 24.1], midline: [31.2, 14.5, 12.4, 32.1, 9.8] },
                'chart-prep-knowledge': { baseline: [6.2, 48.7, 45.1], midline: [42.8, 38.5, 18.7] },
                'chart-prep-participation': { data: [28.5, 8.1, 63.4], labels: ['Directly Participate', 'Family Participation', 'No Participation'] },
                'chart-warnings': { baseline: [9.7, 7.3, 8.1], midline: [48.1, 46.2, 31.4] },
                'chart-assets': { baseline: [71.2, 22.5, 18.3, 28.4], midline: [78.3, 38.1, 42.8, 31.2] },
                'chart-land': { baseline: [88.3, 8.7, 2.9], midline: [78.2, 14.1, 7.7] },
                'chart-cultivation': { data: [82.1, 17.9], labels: ['Using for Agriculture', 'Idle/Not Using'] },
                'chart-inputs': { baseline: [81.2, 91.3, 89.8, 68.4, 84.5], midline: [95.1, 97.2, 96.3, 82.1, 92.8] },
                'chart-personal-savings': { data: [68.2, 31.8], labels: ['Personally Saving', 'Not Saving'] },
                'chart-mechanism': { baseline: [18.5, 22.1, 31.2, 24.8, 3.4], midline: [42.7, 14.2, 22.5, 15.8, 4.8] },
                'chart-loans': { data: [58.6, 41.4], labels: ['Taking Loans', 'Not Taking'] },
                'chart-savings-use': { baseline: [31.2, 28.4, 18.2, 9.3, 12.8], midline: [18.6, 22.7, 38.4, 12.1, 8.2] },
                'chart-time': { baseline: [2.3, 6.7, 0.3, 0.2], midline: [4.2, 6.6, 2.0, 0.5] },
                'chart-beliefs': { baseline: [38.1, 41.2, 42.8, 38.5, 51.3], midline: [68.2, 77.3, 72.1, 68.4, 79.5] },
                'chart-experience': { baseline: [38.2, 41.5, 71.2, 62.4, 68.1], midline: [65.4, 72.3, 81.8, 78.1, 84.2] },
                'chart-productive': { baseline: [12.3, 68.4, 22.8, 14.3, 5.2], midline: [18.5, 62.1, 28.3, 19.7, 8.4] },
                'chart-decisions': { baseline: [73.1, 62.3, 67.8, 71.2, 68.4], midline: [81.8, 84.1, 92.1, 96.6, 88.3] },
                'chart-influence': { baseline: [48.3, 52.1, 61.2, 58.7, 54.2], midline: [82.1, 76.8, 79.3, 81.5, 77.2] },
                'chart-decision-gap': { data: [62.4, 58.1, 79.5, 72.8], labels: ['Should Joint - Baseline', 'Actually Joint - Baseline', 'Should Joint - Midline', 'Actually Joint - Midline'] },
                'chart-cc-awareness': { data: [100.0, 0.0], labels: ['Aware of Climate Change', 'Not Aware'] },
                'chart-cc-effects': { baseline: [71.2, 54.7, 48.3, 65.2, 42.1], midline: [98.3, 89.2, 78.5, 84.1, 62.3] },
                'chart-nbs': { baseline: [38.2, 42.1, 34.8, 42.4], midline: [80.7, 83.9, 95.8, 89.8] },
                'chart-nbs-benefits': { baseline: [28.3, 24.1, 31.4, 12.3, 18.7, 22.1], midline: [61.2, 58.7, 68.2, 52.1, 61.4, 78.3] },
                'chart-selfesteem': { baseline: [78.2, 71.3, 81.4, 82.5, 72.1], midline: [94.8, 89.6, 98.1, 96.3, 91.5] },
                'chart-aspirations': { baseline: [72.8, 68.4, 71.3], midline: [91.5, 87.2, 89.3] },
                'chart-leadership': { baseline: [62.4, 58.3, 64.1, 61.2], midline: [87.3, 79.2, 84.5, 81.8] },
                'chart-communication': { baseline: [58.3, 41.2, 62.1, 54.8], midline: [84.2, 71.8, 83.5, 78.1] },
                'chart-norms': { baseline: [63.1, 59.2, 71.2, 67.6], midline: [28.4, 22.7, 48.3, 30.7] },
                'chart-norms-strong': { baseline: [48.1, 42.3, 51.2], midline: [71.8, 68.4, 72.1] },
                'chart-norms-conservation': { baseline: [38.1, 36.2, 41.5], midline: [62.5, 58.3, 61.2] },
                'chart-norms-money': { baseline: [41.9, 58.3], midline: [19.3, 42.1] }
            }
        };

        // Update All Tab Charts Based on Survey
        function updateAllTabCharts(surveyKey) {
            if (!window.tabChartData[surveyKey]) {
                console.error('ERROR: tabChartData not found for:', surveyKey);
                return;
            }
            const data = window.tabChartData[surveyKey];
            // List of all chart IDs organized by type
            const doughnutCharts = ['chart-location', 'chart-prep-participation', 'chart-cultivation', 'chart-personal-savings', 'chart-loans', 'chart-cc-awareness'];
            const barCharts = ['chart-headship', 'chart-housing', 'chart-wash', 'chart-prep-knowledge', 'chart-warnings', 'chart-inputs', 'chart-time', 'chart-aspirations', 'chart-norms-strong', 'chart-norms-money'];
            const horizontalCharts = ['chart-activities', 'chart-coping', 'chart-assets', 'chart-mechanism', 'chart-savings-use', 'chart-beliefs', 'chart-experience', 'chart-productive', 'chart-decisions', 'chart-influence', 'chart-cc-effects', 'chart-nbs-benefits', 'chart-leadership', 'chart-communication', 'chart-norms', 'chart-norms-conservation'];
            const specialCharts = ['chart-shocks', 'chart-impact', 'chart-land', 'chart-nbs', 'chart-decision-gap', 'chart-selfesteem'];
            
            // Update Doughnut Charts
            doughnutCharts.forEach(chartId => {
                if (data[chartId]) {
                    try {
                        const canvasEl = document.getElementById(chartId);
                        if (!canvasEl) {
                            console.warn(`Canvas ${chartId} not found`);
                            return;
                        }
                        // Destroy existing chart
                        if (window[chartId + 'Chart']) {
                            window[chartId + 'Chart'].destroy();
                        }
                        // Reset canvas to force fresh context
                        const rect = canvasEl.parentElement.getBoundingClientRect();
                        canvasEl.width = rect.width;
                        canvasEl.height = 350;
                        // Get fresh context
                        const ctx = canvasEl.getContext('2d');
                        window[chartId + 'Chart'] = new Chart(ctx, {
                            type: 'doughnut',
                            data: {
                                labels: data[chartId].labels,
                                datasets: [{
                                    data: data[chartId].data,
                                    backgroundColor: [colors.baseline, colors.midline, colors.success, colors.info, colors.warning, colors.danger]
                                }]
                            },
                            options: { ...chartDefaults, plugins: { ...chartDefaults.plugins, datalabels: { ...chartDefaults.plugins.datalabels } } }
                        });
                    } catch (e) {
                        console.error(`Error creating doughnut chart ${chartId}:`, e);
                    }
                }
            });
            
            // Update Bar Charts
            barCharts.forEach(chartId => {
                if (data[chartId] && data[chartId].baseline) {
                    try {
                        const canvasEl = document.getElementById(chartId);
                        if (!canvasEl) {
                            console.warn(`Canvas ${chartId} not found`);
                            return;
                        }
                        // Destroy existing chart
                        if (window[chartId + 'Chart']) {
                            window[chartId + 'Chart'].destroy();
                        }
                        // Reset canvas to force fresh context
                        const rect = canvasEl.parentElement.getBoundingClientRect();
                        canvasEl.width = rect.width;
                        canvasEl.height = 350;
                        // Get fresh context
                        const ctx = canvasEl.getContext('2d');
                        const labels = chartId === 'chart-headship' ? ['Female-headed', 'Male-headed'] :
                                       chartId === 'chart-housing' ? ['Natural Floor', 'Finished Floor'] :
                                       chartId === 'chart-wash' ? ['Safe Water', 'Toilet Facility'] :
                                       chartId === 'chart-prep-knowledge' ? ['Know Plans', "Don't Know", 'Unsure'] :
                                       chartId === 'chart-warnings' ? ['Weather Access', 'Early Warnings', 'Tidal Forecasts'] :
                                       chartId === 'chart-inputs' ? ['Fertilizer', 'Seeds', 'Pesticide', 'Vet Drugs', 'Animal Feed'] :
                                       chartId === 'chart-time' ? ['Unpaid Care', 'Productive Work', 'Community Work', 'Personal Dev'] :
                                       chartId === 'chart-aspirations' ? ['Know How Achieve', 'Confident Can Achieve', 'Have Specific Goals'] :
                                       chartId === 'chart-norms-strong' ? ['Home is Womans Job', 'Cook/Clean = Good Wife', 'Men Domestic Work Embarrassing'] :
                                       chartId === 'chart-norms-money' ? ['Husband Handles Womans Income', 'Men Better Business Ideas'] :
                                       [];
                        window[chartId + 'Chart'] = new Chart(ctx, {
                            type: 'bar',
                            data: {
                                labels: labels,
                                datasets: [
                                    { label: 'Baseline', data: data[chartId].baseline, backgroundColor: colors.baseline },
                                    { label: 'Midline', data: data[chartId].midline, backgroundColor: colors.midline }
                                ]
                            },
                            options: { ...chartDefaults, scales: { y: { beginAtZero: true, max: Math.max(...data[chartId].baseline, ...data[chartId].midline) + 5 } } }
                        });
                    } catch (e) {
                        console.error(`Error creating bar chart ${chartId}:`, e);
                    }
                }
            });
            
            // Update Horizontal Charts (indexAxis: 'y')
            horizontalCharts.forEach(chartId => {
                if (data[chartId] && data[chartId].baseline) {
                    try {
                        const canvasEl = document.getElementById(chartId);
                        if (!canvasEl) {
                            console.warn(`Canvas ${chartId} not found`);
                            return;
                        }
                        // Destroy existing chart
                        if (window[chartId + 'Chart']) {
                            window[chartId + 'Chart'].destroy();
                        }
                        // Reset canvas to force fresh context
                        const rect = canvasEl.parentElement.getBoundingClientRect();
                        canvasEl.width = rect.width;
                        canvasEl.height = 350;
                        // Get fresh context
                        const ctx = canvasEl.getContext('2d');
                        const labels = chartId === 'chart-activities' ? ['Small Business', 'Agriculture', 'Casual Labour', 'Other'] :
                                       chartId === 'chart-coping' ? ['Took Loan', 'Sold Livestock', 'Used Savings', 'Skipped Meals', 'Other'] :
                                       chartId === 'chart-assets' ? ['Cellphones', 'Solar Panels', 'Cooking Stoves', 'Furniture'] :
                                       chartId === 'chart-mechanism' ? ['VSLA', 'Bank', 'MPESA', 'Informal Group', 'Home'] :
                                       chartId === 'chart-savings-use' ? ['Large Assets', 'Agriculture', 'Food', 'Education', 'Business'] :
                                       chartId === 'chart-beliefs' ? ['Cooking', 'Cleaning', 'Water Fetch', 'Firewood', 'Childcare'] :
                                       chartId === 'chart-experience' ? ['Cooking', 'Cleaning', 'Water Fetch', 'Firewood', 'Childcare'] :
                                       chartId === 'chart-productive' ? ['Market Selling', 'Seaweed Farming', 'Agriculture', 'Livestock', 'Formal Work'] :
                                       chartId === 'chart-decisions' ? ['Market Access', 'Joint Work', 'Routine Purchases', 'Business/Loans', 'Child Education'] :
                                       chartId === 'chart-influence' ? ['Mangrove/Seaweed', 'Savings Use', 'Business Investment', 'Loans', 'Household Purchases'] :
                                       chartId === 'chart-cc-effects' ? ['Increased Drought', 'Hotter Temp', 'Increased Water Risk', 'Food Insecurity', 'Extreme Weather'] :
                                       chartId === 'chart-nbs-benefits' ? ['Air Quality', 'Water Conservation', 'Soil Health', 'Carbon Capture', 'Biodiversity', 'Livelihoods'] :
                                       chartId === 'chart-leadership' ? ['Can Lead', 'Bring People Together', 'Give Advice', 'Convince Others'] :
                                       chartId === 'chart-communication' ? ['Express with Family', 'Express with Community', 'Easy to Express', 'Others Understand'] :
                                       chartId === 'chart-norms' ? ['Man Provides Income', 'Only Men Drive Boats', 'Better Business Ideas', 'Harassment Victim Fault'] :
                                       chartId === 'chart-norms-conservation' ? ['Mangrove = Womens Work', 'Seaweed = Womens Work', 'Planting = Womens Work'] :
                                       [];
                        window[chartId + 'Chart'] = new Chart(ctx, {
                            type: 'bar',
                            indexAxis: 'y',
                            data: {
                                labels: labels,
                                datasets: [
                                    { label: 'Baseline', data: data[chartId].baseline, backgroundColor: colors.baseline },
                                    { label: 'Midline', data: data[chartId].midline, backgroundColor: colors.midline }
                                ]
                            },
                            options: { ...chartDefaults, scales: { x: { beginAtZero: true } }, plugins: { ...chartDefaults.plugins, datalabels: { ...chartDefaults.plugins.datalabels, anchor: 'end', align: 'right' } } }
                        });
                    } catch (e) {
                        console.error(`Error creating horizontal chart ${chartId}:`, e);
                    }
                }
            });
            
            // Update Special Charts
            specialCharts.forEach(chartId => {
                if (!data[chartId]) return;
                try {
                    const canvasEl = document.getElementById(chartId);
                    if (!canvasEl) {
                        console.warn(`Canvas ${chartId} not found`);
                        return;
                    }
                    // Destroy existing chart
                    if (window[chartId + 'Chart']) {
                        window[chartId + 'Chart'].destroy();
                    }
                    // Reset canvas to force fresh context
                    const rect = canvasEl.parentElement.getBoundingClientRect();
                    canvasEl.width = rect.width;
                    canvasEl.height = 350;
                    // Get fresh context
                    const ctx = canvasEl.getContext('2d');
                
                if (chartId === 'chart-shocks') {
                    window[chartId + 'Chart'] = new Chart(ctx, {
                        type: 'bar',
                        indexAxis: 'y',
                        data: {
                            labels: ['Drought', 'Heat/Cold Waves', 'Flooding', 'Other'],
                            datasets: [
                                { label: 'Baseline', data: data[chartId].baseline, backgroundColor: colors.baseline },
                                { label: 'Midline', data: data[chartId].midline, backgroundColor: colors.midline }
                            ]
                        },
                        options: { ...chartDefaults, scales: { x: { beginAtZero: true } }, plugins: { ...chartDefaults.plugins, datalabels: { ...chartDefaults.plugins.datalabels, anchor: 'end', align: 'right' } } }
                    });
                } else if (chartId === 'chart-impact') {
                    window[chartId + 'Chart'] = new Chart(ctx, {
                        type: 'bar',
                        data: {
                            labels: ['Very Large', 'Large', 'Moderate', 'Small', 'Very Small'],
                            datasets: [
                                { label: 'Baseline', data: data[chartId].baseline, backgroundColor: colors.baseline },
                                { label: 'Midline', data: data[chartId].midline, backgroundColor: colors.midline }
                            ]
                        },
                        options: { ...chartDefaults, scales: { y: { beginAtZero: true, max: 50 } } }
                    });
                } else if (chartId === 'chart-land') {
                    window[chartId + 'Chart'] = new Chart(ctx, {
                        type: 'bar',
                        data: {
                            labels: ['Owned', 'Leased', 'Both'],
                            datasets: [
                                { label: 'Baseline', data: data[chartId].baseline, backgroundColor: colors.baseline },
                                { label: 'Midline', data: data[chartId].midline, backgroundColor: colors.midline }
                            ]
                        },
                        options: { ...chartDefaults, scales: { y: { beginAtZero: true, max: 100 } } }
                    });
                } else if (chartId === 'chart-nbs') {
                    window[chartId + 'Chart'] = new Chart(ctx, {
                        type: 'bar',
                        data: {
                            labels: ['Mangrove Active', 'Seaweed Active', 'Forest Mgmt', 'NbS Knowledge'],
                            datasets: [
                                { label: 'Baseline', data: data[chartId].baseline, backgroundColor: colors.baseline },
                                { label: 'Midline', data: data[chartId].midline, backgroundColor: colors.midline }
                            ]
                        },
                        options: { ...chartDefaults, scales: { y: { beginAtZero: true, max: 105 } } }
                    });
                } else if (chartId === 'chart-decision-gap') {
                    window[chartId + 'Chart'] = new Chart(ctx, {
                        type: 'bar',
                        data: {
                            labels: data[chartId].labels,
                            datasets: [{
                                data: data[chartId].data,
                                backgroundColor: [colors.baseline, colors.baseline, colors.midline, colors.midline]
                            }]
                        },
                        options: { ...chartDefaults, scales: { y: { beginAtZero: true, max: 85 } } }
                    });
                } else if (chartId === 'chart-selfesteem') {
                    window[chartId + 'Chart'] = new Chart(ctx, {
                        type: 'bar',
                        data: {
                            labels: ['Positive Qualities', 'Respected', 'Life Meaning', 'Future Thinking', 'Goals'],
                            datasets: [
                                { label: 'Baseline', data: data[chartId].baseline, backgroundColor: colors.baseline },
                                { label: 'Midline', data: data[chartId].midline, backgroundColor: colors.midline }
                            ]
                        },
                        options: { ...chartDefaults, scales: { y: { beginAtZero: true, max: 105 } } }
                    });
                    }
                } catch (e) {
                    console.error(`Error creating special chart ${chartId}:`, e);
                }
            });
        }

        // Update Men Survey Charts Function (similar to updateAllTabCharts but with -men suffix)
        function updateMenSurveyCharts(surveyKey) {
            if (surveyKey !== 'men-cosme') {
                return;
            }
            
            if (!window.tabChartData['men-cosme']) {
                console.error('ERROR: No tabChartData for men-cosme');
                return;
            }
            
            const data = window.tabChartData['men-cosme'];
            // Chart type configurations based on chart ID patterns
            const doughnutCharts = ['chart-location-men', 'chart-prep-participation-men', 'chart-cultivation-men', 'chart-personal-savings-men', 'chart-loans-men', 'chart-cc-awareness-men'];
            
            const chartLabels = {
                'chart-headship-men': ['Female-headed', 'Male-headed'],
                'chart-activities-men': ['Small Business', 'Agriculture', 'Casual Labour', 'Other'],
                'chart-housing-men': ['Natural Floor', 'Finished Floor'],
                'chart-wash-men': ['Safe Water', 'Toilet Facility'],
                'chart-shocks-men': ['Drought', 'Heat/Cold Waves', 'Flooding', 'Other'],
                'chart-impact-men': ['Very Large', 'Large', 'Moderate', 'Small', 'Very Small'],
                'chart-coping-men': ['Took Loan', 'Sold Livestock', 'Used Savings', 'Skipped Meals', 'Other'],
                'chart-prep-knowledge-men': ['Know Plans', "Don't Know", 'Unsure'],
                'chart-warnings-men': ['Weather Access', 'Early Warnings', 'Tidal Forecasts'],
                'chart-assets-men': ['Cellphones', 'Solar Panels', 'Cooking Stoves', 'Furniture'],
                'chart-land-men': ['Owned', 'Leased', 'Both'],
                'chart-inputs-men': ['Fertilizer', 'Seeds', 'Pesticide', 'Vet Drugs', 'Animal Feed'],
                'chart-mechanism-men': ['VSLA', 'Bank', 'MPESA', 'Informal Group', 'Home'],
                'chart-time-men': ['Unpaid Care', 'Productive Work', 'Community Work', 'Personal Dev'],
                'chart-beliefs-men': ['Cooking', 'Cleaning', 'Water Fetch', 'Firewood', 'Childcare'],
                'chart-experience-men': ['Cooking', 'Cleaning', 'Water Fetch', 'Firewood', 'Childcare'],
                'chart-productive-men': ['Market Selling', 'Seaweed Farming', 'Agriculture', 'Livestock', 'Formal Work'],
                'chart-decisions-men': ['Market Access', 'Mangrove/Seaweed', 'Routine Purchases', 'Business/Loans', 'Child Education'],
                'chart-influence-men': ['Mangrove/Seaweed', 'Savings Use', 'Business Investment', 'Loans', 'Household Purchases'],
                'chart-cc-effects-men': ['Increased Drought', 'Hotter Temp', 'Increased Water Risk', 'Food Insecurity', 'Extreme Weather'],
                'chart-nbs-men': ['Mangrove Active', 'Seaweed Active', 'Forest Mgmt', 'NbS Knowledge'],
                'chart-nbs-benefits-men': ['Air Quality', 'Water Conservation', 'Soil Health', 'Carbon Capture', 'Biodiversity', 'Livelihoods'],
                'chart-selfesteem-men': ['Positive Qualities', 'Respected', 'Life Meaning', 'Future Thinking', 'Goals'],
                'chart-aspirations-men': ['Know How Achieve', 'Confident Can Achieve', 'Have Specific Goals'],
                'chart-leadership-men': ['Can Lead', 'Bring People Together', 'Give Advice', 'Convince Others'],
                'chart-communication-men': ['Express with Family', 'Express with Community', 'Easy to Express', 'Others Understand'],
                'chart-norms-men': ['Man Provides Income', 'Only Men Drive Boats', 'Better Business Ideas', 'Harassment Victim Fault'],
                'chart-norms-strong-men': ['Home is Womans Job', 'Cook/Clean = Good Wife', 'Men Domestic Work Embarrassing'],
                'chart-norms-conservation-men': ['Mangrove = Womens Work', 'Seaweed = Womens Work', 'Planting = Womens Work'],
                'chart-norms-money-men': ['Husband Controls Income', 'Woman Controls Income']
            };
            
            const chartIds = Object.keys(data);
            // Render doughnut charts
            doughnutCharts.forEach(chartId => {
                const canvasEl = document.getElementById(chartId);
                if (!canvasEl) {
                    console.warn(`Canvas element not found: ${chartId}`);
                    return;
                }
                
                const baseChartId = chartId.replace('-men', '');
                const chartData = data[baseChartId];
                if (!chartData) {
                    console.warn(`No chart data available for: ${baseChartId}`);
                    return;
                }
                if (!chartData.labels || !chartData.data) {
                    console.warn(`Missing labels or data for doughnut chart: ${baseChartId}`);
                    return;
                }
                const ctx = canvasEl.getContext('2d');
                if (window[chartId + 'Instance']) window[chartId + 'Instance'].destroy();
                
                window[chartId + 'Instance'] = new Chart(ctx, {
                    type: 'doughnut',
                    data: {
                        labels: chartData.labels,
                        datasets: [{
                            data: chartData.data,
                            backgroundColor: [colors.baseline, colors.midline, colors.success, colors.info, colors.warning, colors.danger]
                        }]
                    },
                    options: { ...chartDefaults, plugins: { ...chartDefaults.plugins, datalabels: { ...chartDefaults.plugins.datalabels } } }
                });
            });
            
            // Render bar charts (vertical)
            const barCharts = ['chart-headship-men', 'chart-housing-men', 'chart-wash-men', 'chart-prep-knowledge-men', 'chart-warnings-men', 'chart-inputs-men', 'chart-land-men', 'chart-time-men', 'chart-aspirations-men', 'chart-selfesteem-men', 'chart-norms-strong-men', 'chart-norms-money-men'];
            
            barCharts.forEach(chartId => {
                const canvasEl = document.getElementById(chartId);
                if (!canvasEl) {
                    console.warn(`Canvas element not found: ${chartId}`);
                    return;
                }
                
                const baseChartId = chartId.replace('-men', '');
                const chartData = data[baseChartId];
                if (!chartData || (!chartData.baseline && !chartData.data)) {
                    console.warn(`No baseline/data for bar chart: ${baseChartId}`);
                    return;
                }
                const ctx = canvasEl.getContext('2d');
                if (window[chartId + 'Instance']) window[chartId + 'Instance'].destroy();
                
                const labels = chartLabels[chartId] || [];
                window[chartId + 'Instance'] = new Chart(ctx, {
                    type: 'bar',
                    data: {
                        labels: labels,
                        datasets: [
                            { label: 'Baseline', data: chartData.baseline || chartData.data, backgroundColor: colors.baseline },
                            { label: 'Midline', data: chartData.midline || [], backgroundColor: colors.midline }
                        ].filter(d => d.data && d.data.length)
                    },
                    options: { ...chartDefaults, scales: { y: { beginAtZero: true, max: 105 } } }
                });
            });
            
            // Render horizontal bar charts
            const horizontalCharts = ['chart-shocks-men', 'chart-impact-men', 'chart-activities-men', 'chart-coping-men', 'chart-assets-men', 'chart-mechanism-men', 'chart-savings-use-men', 'chart-beliefs-men', 'chart-experience-men', 'chart-productive-men', 'chart-decisions-men', 'chart-influence-men', 'chart-cc-effects-men', 'chart-nbs-benefits-men', 'chart-leadership-men', 'chart-communication-men', 'chart-norms-men', 'chart-norms-conservation-men'];
            
            horizontalCharts.forEach(chartId => {
                const canvasEl = document.getElementById(chartId);
                if (!canvasEl) {
                    console.warn(`Canvas element not found: ${chartId}`);
                    return;
                }
                
                const baseChartId = chartId.replace('-men', '');
                const chartData = data[baseChartId];
                if (!chartData || (!chartData.baseline && !chartData.data)) {
                    console.warn(`No baseline/data for horizontal chart: ${baseChartId}`);
                    return;
                }
                const ctx = canvasEl.getContext('2d');
                if (window[chartId + 'Instance']) window[chartId + 'Instance'].destroy();
                
                const labels = chartLabels[chartId] || [];
                window[chartId + 'Instance'] = new Chart(ctx, {
                    type: 'bar',
                    indexAxis: 'y',
                    data: {
                        labels: labels,
                        datasets: [
                            { label: 'Baseline', data: chartData.baseline || chartData.data, backgroundColor: colors.baseline },
                            { label: 'Midline', data: chartData.midline || [], backgroundColor: colors.midline }
                        ].filter(d => d.data && d.data.length)
                    },
                    options: { ...chartDefaults, scales: { x: { beginAtZero: true } }, plugins: { ...chartDefaults.plugins, datalabels: { ...chartDefaults.plugins.datalabels, anchor: 'end', align: 'right' } } }
                });
            });
            
            // Special charts (decision-gap, nbs)
            const specialCharts = ['chart-decision-gap-men', 'chart-nbs-men'];
            specialCharts.forEach(chartId => {
                const canvasEl = document.getElementById(chartId);
                if (!canvasEl) {
                    console.warn(`Canvas element not found: ${chartId}`);
                    return;
                }
                
                const baseChartId = chartId.replace('-men', '');
                const chartData = data[baseChartId];
                if (!chartData || !chartData.data) {
                    console.warn(`No data for special chart: ${baseChartId}`);
                    return;
                }
                const ctx = canvasEl.getContext('2d');
                if (window[chartId + 'Instance']) window[chartId + 'Instance'].destroy();
                
                window[chartId + 'Instance'] = new Chart(ctx, {
                    type: 'bar',
                    data: {
                        labels: chartData.labels || [],
                        datasets: [{
                            data: chartData.data,
                            backgroundColor: [colors.baseline, colors.baseline, colors.midline, colors.midline]
                        }]
                    },
                    options: { ...chartDefaults, scales: { y: { beginAtZero: true, max: 100 } } }
                });
            });
        }

        // Forestry Tab Navigation
        function showForestryTab(evt, tabName) {
            const tabContents = document.querySelectorAll('.forestry-tab-content');
            tabContents.forEach(tab => {
                tab.classList.remove('active');
                tab.style.display = 'none';
            });
            const tabButtons = document.getElementById('forestry-tabs-container').querySelectorAll('.tab-button');
            tabButtons.forEach(btn => btn.classList.remove('active'));
            const target = document.getElementById(tabName);
            if (target) {
                target.classList.add('active');
                target.style.display = 'block';
            }
            evt.currentTarget.classList.add('active');

            // Resize charts in newly visible tab
            requestAnimationFrame(() => {
                if (target) {
                    target.querySelectorAll('canvas').forEach(canvas => {
                        const chart = Chart.getChart(canvas);
                        if (chart) chart.resize();
                    });
                }
            });
        }

        // Forestry Charts Rendering
        function updateForestryCharts() {
            const fColors = { baseline: colors.baseline, midline: colors.midline };
            const fDefaults = {
                responsive: true,
                maintainAspectRatio: false,
                plugins: {
                    legend: { position: 'top', labels: { font: { size: 12, weight: 'bold' } } },
                    datalabels: {
                        font: { size: 14, weight: 'bold' },
                        color: '#fff',
                        backgroundColor: '#333',
                        borderRadius: 6,
                        padding: 6,
                        formatter: (value) => value.toFixed(1) + '%',
                        display: true
                    }
                }
            };

            function fChart(canvasId, config) {
                const canvas = document.getElementById(canvasId);
                if (!canvas) { console.warn('Canvas not found:', canvasId); return null; }
                const existing = Chart.getChart(canvas);
                if (existing) existing.destroy();
                return new Chart(canvas, config);
            }

            // === TAB A: OVERVIEW & FUNCTIONALITY ===
            fChart('f-chart-threshold', {
                type: 'bar',
                data: {
                    labels: ['≥60% Threshold', '≥70% Threshold'],
                    datasets: [
                        { label: 'Baseline (n=43)', data: [81.4, 53.5], backgroundColor: fColors.baseline },
                        { label: 'Midline (n=28)', data: [96.4, 85.7], backgroundColor: fColors.midline }
                    ]
                },
                options: { ...fDefaults, scales: { y: { beginAtZero: true, max: 100, title: { display: true, text: '% of Groups' } } } }
            });

            fChart('f-chart-domains', {
                type: 'bar',
                data: {
                    labels: ['Management', 'Gender', 'Effectiveness', 'Overall'],
                    datasets: [
                        { label: 'Baseline', data: [78.6, 32.9, 72.0, 70.6], backgroundColor: fColors.baseline },
                        { label: 'Midline', data: [78.0, 85.5, 90.1, 84.2], backgroundColor: fColors.midline }
                    ]
                },
                options: { ...fDefaults, scales: { y: { beginAtZero: true, max: 100, title: { display: true, text: 'Domain Score (%)' } } } }
            });

            fChart('f-chart-scores', {
                type: 'bar',
                data: {
                    labels: ['Average', 'Maximum', 'Minimum'],
                    datasets: [
                        { label: 'Baseline (n=43)', data: [70.6, 90.4, 37.0], backgroundColor: fColors.baseline },
                        { label: 'Midline (n=28)', data: [84.2, 98.5, 46.7], backgroundColor: fColors.midline }
                    ]
                },
                options: { ...fDefaults, scales: { y: { beginAtZero: true, max: 100, title: { display: true, text: 'Score' } } } }
            });

            // === TAB B: GROUP CHARACTERISTICS ===
            fChart('f-chart-membership', {
                type: 'bar',
                data: {
                    labels: ['Male', 'Female', 'All'],
                    datasets: [
                        { label: 'Baseline', data: [13, 10, 23], backgroundColor: fColors.baseline },
                        { label: 'Midline', data: [15, 13, 28], backgroundColor: fColors.midline }
                    ]
                },
                options: { ...fDefaults, scales: { y: { beginAtZero: true, max: 35, title: { display: true, text: 'Avg Members' } } } }
            });

            fChart('f-chart-affiliations', {
                type: 'bar',
                data: {
                    labels: ['AMCOS', 'Beekeepers', 'Wellness'],
                    datasets: [
                        { label: 'Baseline', data: [42.5, 27.5, 15.0], backgroundColor: fColors.baseline },
                        { label: 'Midline', data: [52.5, 35.0, 25.0], backgroundColor: fColors.midline }
                    ]
                },
                options: { ...fDefaults, scales: { y: { beginAtZero: true, max: 70, title: { display: true, text: '% Yes' } } } }
            });

            fChart('f-chart-years', {
                type: 'bar',
                data: {
                    labels: ['0-3 years', '4-5 years', '6-10 years', '11+ years'],
                    datasets: [
                        { label: 'Baseline', data: [22.5, 17.5, 37.5, 22.5], backgroundColor: fColors.baseline },
                        { label: 'Midline', data: [12.5, 15.0, 42.5, 30.0], backgroundColor: fColors.midline }
                    ]
                },
                options: { ...fDefaults, scales: { y: { beginAtZero: true, max: 55, title: { display: true, text: '% of Groups' } } } }
            });

            fChart('f-chart-legal', {
                type: 'bar',
                data: {
                    labels: ['Registered', 'Not Registered'],
                    datasets: [
                        { label: 'Baseline', data: [72.5, 27.5], backgroundColor: fColors.baseline },
                        { label: 'Midline', data: [85.0, 15.0], backgroundColor: fColors.midline }
                    ]
                },
                options: { ...fDefaults, scales: { y: { beginAtZero: true, max: 100, title: { display: true, text: '% of Groups' } } } }
            });

            fChart('f-chart-forestsize', {
                type: 'bar',
                data: {
                    labels: ['0 ha', '1-5 ha', '6-10 ha', '11-100 ha', '101-999 ha', '1000+ ha'],
                    datasets: [
                        { label: 'Baseline', data: [5.0, 25.0, 22.5, 27.5, 12.5, 7.5], backgroundColor: fColors.baseline },
                        { label: 'Midline', data: [2.5, 17.5, 20.0, 32.5, 17.5, 10.0], backgroundColor: fColors.midline }
                    ]
                },
                options: { ...fDefaults, scales: { y: { beginAtZero: true, max: 40, title: { display: true, text: '% of Groups' } } } }
            });

            fChart('f-chart-communities', {
                type: 'bar',
                data: {
                    labels: ['1-3', '4-6', '7-10', '11+'],
                    datasets: [
                        { label: 'Baseline', data: [45.0, 30.0, 15.0, 10.0], backgroundColor: fColors.baseline },
                        { label: 'Midline', data: [35.0, 32.5, 20.0, 12.5], backgroundColor: fColors.midline }
                    ]
                },
                options: { ...fDefaults, scales: { y: { beginAtZero: true, max: 55, title: { display: true, text: '% of Groups' } } } }
            });

            // === TAB C: RIGHTS & GOVERNANCE ===
            fChart('f-chart-objectives', {
                type: 'bar',
                data: {
                    labels: ['No', 'Partially', 'Yes'],
                    datasets: [
                        { label: 'Baseline', data: [32.5, 22.5, 45.0], backgroundColor: fColors.baseline },
                        { label: 'Midline', data: [12.5, 20.0, 67.5], backgroundColor: fColors.midline }
                    ]
                },
                options: { ...fDefaults, scales: { y: { beginAtZero: true, max: 80, title: { display: true, text: '% of Groups' } } } }
            });

            fChart('f-chart-boardroles', {
                type: 'bar',
                data: {
                    labels: ['Well Defined &\nUnderstood', 'Defined, Not\nAll Understand', 'Not Well\nDefined', 'Not Defined\nat All'],
                    datasets: [
                        { label: 'Baseline', data: [35.0, 25.0, 25.0, 15.0], backgroundColor: fColors.baseline },
                        { label: 'Midline', data: [57.5, 22.5, 15.0, 5.0], backgroundColor: fColors.midline }
                    ]
                },
                options: { ...fDefaults, scales: { y: { beginAtZero: true, max: 70, title: { display: true, text: '% of Groups' } } } }
            });

            fChart('f-chart-meetings', {
                type: 'bar',
                data: {
                    labels: ['Occasional/Low', 'Often/Moderate', 'Regular/Full Quorum'],
                    datasets: [
                        { label: 'Baseline', data: [30.0, 37.5, 32.5], backgroundColor: fColors.baseline },
                        { label: 'Midline', data: [12.5, 32.5, 55.0], backgroundColor: fColors.midline }
                    ]
                },
                options: { ...fDefaults, scales: { y: { beginAtZero: true, max: 65, title: { display: true, text: '% of Groups' } } } }
            });

            fChart('f-chart-womenleadership', {
                type: 'bar',
                data: {
                    labels: ['No Leadership\nNo Voice', 'No Leadership\nOccasional Voice', 'Some\nLeadership', 'Significant\nLeadership'],
                    datasets: [
                        { label: 'Baseline', data: [25.0, 27.5, 30.0, 17.5], backgroundColor: fColors.baseline },
                        { label: 'Midline', data: [10.0, 20.0, 35.0, 35.0], backgroundColor: fColors.midline }
                    ]
                },
                options: { ...fDefaults, scales: { y: { beginAtZero: true, max: 45, title: { display: true, text: '% of Groups' } } } }
            });

            fChart('f-chart-mgmtpractices', {
                type: 'bar',
                data: {
                    labels: ['Transparent\nElections', 'Inclusive\nDecisions', 'Clear\nProcedures', 'Grievance\nMechanism', 'Benefit\nSharing', 'Decisions\nCommunicated'],
                    datasets: [
                        { label: 'Baseline (Agree+SA)', data: [55.0, 50.0, 47.5, 35.0, 40.0, 45.0], backgroundColor: fColors.baseline },
                        { label: 'Midline (Agree+SA)', data: [77.5, 72.5, 70.0, 60.0, 65.0, 72.5], backgroundColor: fColors.midline }
                    ]
                },
                options: { ...fDefaults, scales: { y: { beginAtZero: true, max: 90, title: { display: true, text: '% Agree+SA' } } } }
            });

            // === TAB D: TRAINING & ASSETS ===
            fChart('f-chart-training', {
                type: 'bar',
                data: {
                    labels: ['None', 'A Few Members', 'Many Members', 'Most Members'],
                    datasets: [
                        { label: 'Baseline', data: [25.0, 30.0, 30.0, 15.0], backgroundColor: fColors.baseline },
                        { label: 'Midline', data: [7.5, 17.5, 32.5, 42.5], backgroundColor: fColors.midline }
                    ]
                },
                options: { ...fDefaults, scales: { y: { beginAtZero: true, max: 55, title: { display: true, text: '% of Groups' } } } }
            });

            fChart('f-chart-topics', {
                type: 'bar',
                data: {
                    labels: ['Climate Change\n& Forests', 'CFM\nConcepts', 'Forest\nLivelihoods', 'Leadership', 'Gender &\nGovernance', 'Forest\nAssessment', 'DRM'],
                    datasets: [
                        { label: 'Baseline', data: [32.5, 27.5, 22.5, 20.0, 15.0, 17.5, 12.5], backgroundColor: fColors.baseline },
                        { label: 'Midline', data: [65.0, 57.5, 52.5, 45.0, 40.0, 37.5, 30.0], backgroundColor: fColors.midline }
                    ]
                },
                options: { ...fDefaults, scales: { y: { beginAtZero: true, max: 80, title: { display: true, text: '% of Groups' } } } }
            });

            fChart('f-chart-assets', {
                type: 'bar',
                data: {
                    labels: ['Yes', 'No'],
                    datasets: [
                        { label: 'Baseline', data: [35.0, 65.0], backgroundColor: fColors.baseline },
                        { label: 'Midline', data: [62.5, 37.5], backgroundColor: fColors.midline }
                    ]
                },
                options: { ...fDefaults, scales: { y: { beginAtZero: true, max: 80, title: { display: true, text: '% of Groups' } } } }
            });

            fChart('f-chart-assettypes', {
                type: 'bar',
                data: {
                    labels: ['Seedlings/\nNursery', 'Tools &\nEquipment', 'Beekeeping\nInputs', 'Energy\n(Solar/Stoves)', 'Agri\nInputs', 'Water &\nIrrigation', 'Infrastructure'],
                    datasets: [
                        { label: 'Baseline', data: [25.0, 17.5, 12.5, 7.5, 10.0, 5.0, 5.0], backgroundColor: fColors.baseline },
                        { label: 'Midline', data: [50.0, 40.0, 32.5, 22.5, 20.0, 15.0, 12.5], backgroundColor: fColors.midline }
                    ]
                },
                options: { ...fDefaults, scales: { y: { beginAtZero: true, max: 60, title: { display: true, text: '% of Groups' } } } }
            });

            // === TAB E: GENDER EQUALITY ===
            fChart('f-chart-gediscussion', {
                type: 'bar',
                data: {
                    labels: ['Yes', 'No'],
                    datasets: [
                        { label: 'Baseline', data: [40.0, 60.0], backgroundColor: fColors.baseline },
                        { label: 'Midline', data: [72.5, 27.5], backgroundColor: fColors.midline }
                    ]
                },
                options: { ...fDefaults, scales: { y: { beginAtZero: true, max: 85, title: { display: true, text: '% of Groups' } } } }
            });

            fChart('f-chart-getopics', {
                type: 'bar',
                data: {
                    labels: ['Equitable Roles/\nResponsibilities', 'Resource\nSharing', 'Women Leadership\n& Voice', 'Other'],
                    datasets: [
                        { label: 'Baseline', data: [30.0, 25.0, 22.5, 7.5], backgroundColor: fColors.baseline },
                        { label: 'Midline', data: [60.0, 52.5, 50.0, 12.5], backgroundColor: fColors.midline }
                    ]
                },
                options: { ...fDefaults, scales: { y: { beginAtZero: true, max: 75, title: { display: true, text: '% of Groups' } } } }
            });

            fChart('f-chart-geactions', {
                type: 'bar',
                data: {
                    labels: ['No', 'Partially', 'Yes'],
                    datasets: [
                        { label: 'Baseline', data: [42.5, 32.5, 25.0], backgroundColor: fColors.baseline },
                        { label: 'Midline', data: [15.0, 30.0, 55.0], backgroundColor: fColors.midline }
                    ]
                },
                options: { ...fDefaults, scales: { y: { beginAtZero: true, max: 65, title: { display: true, text: '% of Groups' } } } }
            });

            fChart('f-chart-gecompletion', {
                type: 'bar',
                data: {
                    labels: ['None', 'A Few', 'Many', 'All'],
                    datasets: [
                        { label: 'Baseline', data: [35.0, 42.5, 15.0, 7.5], backgroundColor: fColors.baseline },
                        { label: 'Midline', data: [12.5, 32.5, 32.5, 22.5], backgroundColor: fColors.midline }
                    ]
                },
                options: { ...fDefaults, scales: { y: { beginAtZero: true, max: 50, title: { display: true, text: '% of Groups' } } } }
            });

            // === TAB F: EFFECTIVENESS & CONSERVATION ===
            const condLabels = ['Area', 'Volume/\nBiomass', 'Regeneration', 'Biodiversity', 'Ecosystem\nServices'];
            const threatLabels = ['Fire', 'Fuelwood', 'Charcoal', 'Other\nWood', 'Poaching', 'Encroachment', 'Land\nGrabbing', 'Poles'];
            const stackedOpts = {
                responsive: true, maintainAspectRatio: false,
                plugins: { legend: { position: 'top', labels: { font: { size: 12, weight: 'bold' } } },
                    datalabels: { font: { size: 11, weight: 'bold' }, color: '#fff', formatter: (v) => v.toFixed(1) + '%', display: (ctx) => ctx.dataset.data[ctx.dataIndex] > 5 }
                },
                scales: { x: { stacked: true }, y: { stacked: true, beginAtZero: true, max: 100, title: { display: true, text: '% of Groups' } } }
            };

            // Forest Condition — Good BL vs ML
            fChart('f-chart-condition', {
                type: 'bar',
                data: {
                    labels: condLabels,
                    datasets: [
                        { label: 'Baseline (Good)', data: [30.0, 27.5, 32.5, 25.0, 27.5], backgroundColor: fColors.baseline },
                        { label: 'Midline (Good)', data: [52.5, 47.5, 55.0, 47.5, 50.0], backgroundColor: fColors.midline }
                    ]
                },
                options: { ...fDefaults, scales: { y: { beginAtZero: true, max: 70, title: { display: true, text: '% Good' } } } }
            });

            // Forest Condition Breakdown — Baseline (Stacked)
            fChart('f-chart-condition-bl', {
                type: 'bar',
                data: {
                    labels: condLabels,
                    datasets: [
                        { label: 'Good', data: [30.0, 27.5, 32.5, 25.0, 27.5], backgroundColor: colors.success },
                        { label: 'Medium', data: [37.5, 35.0, 35.0, 37.5, 42.5], backgroundColor: colors.warning },
                        { label: 'Poor', data: [32.5, 37.5, 32.5, 37.5, 30.0], backgroundColor: colors.danger }
                    ]
                },
                options: stackedOpts
            });

            // Forest Condition Breakdown — Midline (Stacked)
            fChart('f-chart-condition-ml', {
                type: 'bar',
                data: {
                    labels: condLabels,
                    datasets: [
                        { label: 'Good', data: [52.5, 47.5, 55.0, 47.5, 50.0], backgroundColor: colors.success },
                        { label: 'Medium', data: [30.0, 32.5, 27.5, 30.0, 27.5], backgroundColor: colors.warning },
                        { label: 'Poor', data: [17.5, 20.0, 17.5, 22.5, 22.5], backgroundColor: colors.danger }
                    ]
                },
                options: stackedOpts
            });

            // Forest Status Changes — Baseline (Stacked)
            fChart('f-chart-status-bl', {
                type: 'bar',
                data: {
                    labels: condLabels,
                    datasets: [
                        { label: 'Decrease', data: [42.5, 40.0, 35.0, 37.5, 30.0], backgroundColor: colors.danger },
                        { label: 'No Change', data: [27.5, 32.5, 30.0, 35.0, 35.0], backgroundColor: '#9E9E9E' },
                        { label: 'Increase', data: [30.0, 27.5, 35.0, 27.5, 35.0], backgroundColor: colors.success }
                    ]
                },
                options: stackedOpts
            });

            // Forest Status Changes — Midline (Stacked)
            fChart('f-chart-status-ml', {
                type: 'bar',
                data: {
                    labels: condLabels,
                    datasets: [
                        { label: 'Decrease', data: [17.5, 20.0, 15.0, 17.5, 22.5], backgroundColor: colors.danger },
                        { label: 'No Change', data: [30.0, 27.5, 27.5, 25.0, 27.5], backgroundColor: '#9E9E9E' },
                        { label: 'Increase', data: [52.5, 52.5, 57.5, 57.5, 50.0], backgroundColor: colors.success }
                    ]
                },
                options: stackedOpts
            });

            // Forest Status — Perceived Increase BL vs ML
            fChart('f-chart-status-increase', {
                type: 'bar',
                data: {
                    labels: condLabels,
                    datasets: [
                        { label: 'Baseline (Increase)', data: [30.0, 27.5, 35.0, 27.5, 35.0], backgroundColor: fColors.baseline },
                        { label: 'Midline (Increase)', data: [52.5, 52.5, 57.5, 57.5, 50.0], backgroundColor: fColors.midline }
                    ]
                },
                options: { ...fDefaults, scales: { y: { beginAtZero: true, max: 70, title: { display: true, text: '% Increase' } } } }
            });

            // Threats — High BL vs ML
            fChart('f-chart-threats', {
                type: 'bar',
                data: {
                    labels: threatLabels,
                    datasets: [
                        { label: 'Baseline (High)', data: [35.0, 27.5, 40.0, 15.0, 20.0, 32.5, 22.5, 15.0], backgroundColor: colors.danger },
                        { label: 'Midline (High)', data: [15.0, 12.5, 17.5, 7.5, 10.0, 15.0, 10.0, 7.5], backgroundColor: colors.success }
                    ]
                },
                options: { ...fDefaults, scales: { y: { beginAtZero: true, max: 50, title: { display: true, text: '% High Threat' } } } }
            });

            // Threats Breakdown — Baseline (Stacked)
            fChart('f-chart-threats-bl', {
                type: 'bar',
                data: {
                    labels: threatLabels,
                    datasets: [
                        { label: 'Low', data: [27.5, 35.0, 22.5, 47.5, 45.0, 30.0, 40.0, 50.0], backgroundColor: colors.success },
                        { label: 'Medium', data: [37.5, 37.5, 37.5, 37.5, 35.0, 37.5, 37.5, 35.0], backgroundColor: colors.warning },
                        { label: 'High', data: [35.0, 27.5, 40.0, 15.0, 20.0, 32.5, 22.5, 15.0], backgroundColor: colors.danger }
                    ]
                },
                options: stackedOpts
            });

            // Threats Breakdown — Midline (Stacked)
            fChart('f-chart-threats-ml', {
                type: 'bar',
                data: {
                    labels: threatLabels,
                    datasets: [
                        { label: 'Low', data: [52.5, 55.0, 47.5, 62.5, 60.0, 52.5, 57.5, 62.5], backgroundColor: colors.success },
                        { label: 'Medium', data: [32.5, 32.5, 35.0, 30.0, 30.0, 32.5, 32.5, 30.0], backgroundColor: colors.warning },
                        { label: 'High', data: [15.0, 12.5, 17.5, 7.5, 10.0, 15.0, 10.0, 7.5], backgroundColor: colors.danger }
                    ]
                },
                options: stackedOpts
            });

            // Threat Changes — Perceived Decrease BL vs ML
            fChart('f-chart-threat-decrease', {
                type: 'bar',
                data: {
                    labels: threatLabels,
                    datasets: [
                        { label: 'Baseline (Decrease)', data: [20.0, 17.5, 15.0, 22.5, 20.0, 17.5, 15.0, 22.5], backgroundColor: fColors.baseline },
                        { label: 'Midline (Decrease)', data: [50.0, 42.5, 47.5, 40.0, 37.5, 45.0, 40.0, 37.5], backgroundColor: fColors.midline }
                    ]
                },
                options: { ...fDefaults, scales: { y: { beginAtZero: true, max: 60, title: { display: true, text: '% Decrease' } } } }
            });

            fChart('f-chart-income', {
                type: 'bar',
                data: {
                    labels: ['Income Generating', 'Agroforestry Adopted'],
                    datasets: [
                        { label: 'Baseline (Yes)', data: [37.5, 32.5], backgroundColor: fColors.baseline },
                        { label: 'Midline (Yes)', data: [62.5, 57.5], backgroundColor: fColors.midline }
                    ]
                },
                options: { ...fDefaults, scales: { y: { beginAtZero: true, max: 80, title: { display: true, text: '% Yes' } } } }
            });

            fChart('f-chart-harvest', {
                type: 'bar',
                data: {
                    labels: ['NWFPs', 'Food', 'Woodfuel', 'Fodder', 'Timber', 'Poles', 'Leaf Mulch', 'Wildlife'],
                    datasets: [
                        { label: 'Baseline (Substantial)', data: [10.0, 12.5, 22.5, 7.5, 15.0, 12.5, 5.0, 2.5], backgroundColor: fColors.baseline },
                        { label: 'Midline (Substantial)', data: [27.5, 30.0, 17.5, 15.0, 10.0, 10.0, 12.5, 5.0], backgroundColor: fColors.midline }
                    ]
                },
                options: { ...fDefaults, scales: { y: { beginAtZero: true, max: 40, title: { display: true, text: '% Substantial' } } } }
            });

            fChart('f-chart-agroforestry', {
                type: 'bar',
                data: {
                    labels: ['Intercropping', 'Beekeeping', 'Forest\nFarming', 'Silvopasture', 'Alley\nCropping'],
                    datasets: [
                        { label: 'Baseline', data: [25.0, 20.0, 15.0, 10.0, 7.5], backgroundColor: fColors.baseline },
                        { label: 'Midline', data: [47.5, 45.0, 37.5, 25.0, 17.5], backgroundColor: fColors.midline }
                    ]
                },
                options: { ...fDefaults, scales: { y: { beginAtZero: true, max: 60, title: { display: true, text: '% of Groups' } } } }
            });
        }

        // Pre & Post Test Tab Navigation
        function showPrePostTab(evt, tabName) {
            const tabContents = document.querySelectorAll('.prepost-tab-content');
            tabContents.forEach(tab => {
                tab.classList.remove('active');
                tab.style.display = 'none';
            });
            const tabButtons = document.getElementById('prepost-tabs-container').querySelectorAll('.tab-button');
            tabButtons.forEach(btn => btn.classList.remove('active'));
            const target = document.getElementById(tabName);
            if (target) {
                target.classList.add('active');
                target.style.display = 'block';
            }
            evt.currentTarget.classList.add('active');

            // Resize charts in newly visible tab
            requestAnimationFrame(() => {
                if (target) {
                    target.querySelectorAll('canvas').forEach(canvas => {
                        const chart = Chart.getChart(canvas);
                        if (chart) chart.resize();
                    });
                }
            });
        }

        // Helper to activate a sub-type button in Pre & Post Test selector
        function activatePrePostTypeButton(typeName) {
            const typeButtons = document.getElementById('prepost-type-selector').querySelectorAll('.tab-button');
            typeButtons.forEach(btn => {
                btn.classList.remove('active');
                btn.style.background = '';
                btn.style.color = '';
            });
            typeButtons.forEach(btn => {
                if (btn.getAttribute('onclick') && btn.getAttribute('onclick').includes("'" + typeName + "'")) {
                    btn.classList.add('active');
                    btn.style.background = '#0D47A1';
                    btn.style.color = '#fff';
                }
            });
        }

        // Pre & Post Test Type Selector (Forest / Seaweed / Mangrove)
        function showPrePostType(evt, typeName) {
            const typeButtons = document.getElementById('prepost-type-selector').querySelectorAll('.tab-button');
            typeButtons.forEach(btn => {
                btn.classList.remove('active');
                btn.style.background = '';
                btn.style.color = '';
            });
            evt.currentTarget.classList.add('active');
            evt.currentTarget.style.background = '#0D47A1';
            evt.currentTarget.style.color = '#fff';

            // Hide all sub-type content
            document.getElementById('pp-forest-content').style.display = 'none';
            document.getElementById('pp-mangrove-content').style.display = 'none';

            if (typeName === 'forest') {
                document.getElementById('pp-forest-content').style.display = 'block';
                // Update shared sections from surveyData
                const data = window.surveyData['prepost-forest'];
                updateSharedSections(data, 'prepost-forest');
                document.getElementById('pp-meta-pre').textContent = '546';
                document.getElementById('pp-meta-post').textContent = '909';
                // Temporarily show all tabs for chart rendering
                const prepostTabs = document.querySelectorAll('.prepost-tab-content');
                prepostTabs.forEach(tab => tab.style.display = 'block');
                updatePrePostCharts();
                prepostTabs.forEach(tab => tab.style.display = '');
                if (prepostTabs.length > 0) prepostTabs[0].style.display = 'block';
            } else if (typeName === 'mangrove') {
                document.getElementById('pp-mangrove-content').style.display = 'block';
                // Update shared sections from surveyData
                const data = window.surveyData['prepost-mangrove'];
                updateSharedSections(data, 'prepost-mangrove');
                document.getElementById('pp-meta-pre').textContent = 'Kilifi & Kwale';
                document.getElementById('pp-meta-post').textContent = 'Counties';
                updateMangrovePrePostCharts();
            }
        }

        // OUTPUT TYPE SUB-SELECTOR
        function showOutputType(event, typeName) {
            const typeButtons = document.getElementById('output-type-selector').querySelectorAll('.tab-button');
            typeButtons.forEach(btn => {
                btn.classList.remove('active');
                btn.style.background = '';
                btn.style.color = '';
            });
            event.currentTarget.classList.add('active');
            event.currentTarget.style.background = '#283593';
            event.currentTarget.style.color = '#fff';

            // Hide all output sub-types
            const outputTypes = ['mangrove', 'forestry', 'seaweed', 'gjj', 'vsla', 'schools'];
            outputTypes.forEach(t => {
                const el = document.getElementById('output-' + t);
                if (el) el.style.display = 'none';
            });
            // Show selected
            const target = document.getElementById('output-' + typeName);
            if (target) target.style.display = 'block';

            // Update footer
            document.getElementById('footer-title').innerHTML = '<strong>Project Output Dashboard - ' + typeName.charAt(0).toUpperCase() + typeName.slice(1) + '</strong>';
            document.getElementById('footer-sample').textContent = 'COSME Project Outputs and Deliverables Tracker';

            // Render charts for the selected output type
            if (typeName === 'mangrove') renderOutputCharts();
            if (typeName === 'forestry') renderForestryOutputCharts();
            if (typeName === 'seaweed') renderSeaweedOutputCharts();
            if (typeName === 'gjj') renderGJJOutputCharts();
            if (typeName === 'vsla') renderVSLAOutputCharts();
            if (typeName === 'schools') renderSchoolsOutputCharts();
        }

        // OUTPUT CHARTS — stored references so we can destroy/recreate
        const outputChartInstances = {};
        function renderOutputCharts() {
            // Destroy existing
            Object.values(outputChartInstances).forEach(c => { try { c.destroy(); } catch(e) {} });

            const modules = ['M1', 'M2', 'M3', 'M4', 'M5'];

            // CHART 1 — Module Completion by Gender
            const ctx1 = document.getElementById('output-mangrove-gender');
            if (ctx1) {
                outputChartInstances['gender'] = new Chart(ctx1, {
                    type: 'bar',
                    data: {
                        labels: modules,
                        datasets: [
                            { label: 'Female', data: [683, 596, 632, 683, 639], backgroundColor: '#8B5CF6' },
                            { label: 'Male', data: [216, 195, 166, 198, 177], backgroundColor: '#3B82F6' }
                        ]
                    },
                    options: {
                        responsive: true, maintainAspectRatio: false,
                        plugins: { legend: { position: 'top', labels: { font: { size: 12, weight: 'bold' } } }, datalabels: { display: true, anchor: 'end', align: 'top', font: { size: 10, weight: 'bold' }, color: '#fff', backgroundColor: '#333', borderRadius: 6, padding: 4 } },
                        scales: { y: { beginAtZero: true, title: { display: true, text: 'Participants' } } }
                    }
                });
            }

            // CHART 2 — Completion Rate vs Target (%)
            const ctx2 = document.getElementById('output-mangrove-target');
            if (ctx2) {
                outputChartInstances['target'] = new Chart(ctx2, {
                    type: 'bar',
                    data: {
                        labels: modules,
                        datasets: [
                            { label: 'All (%)', data: [75, 66, 67, 73, 68], backgroundColor: '#1a237e' },
                            { label: 'Male (%)', data: [60, 54, 46, 55, 49], backgroundColor: '#3B82F6' },
                            { label: 'Female (%)', data: [81, 71, 75, 81, 76], backgroundColor: '#8B5CF6' }
                        ]
                    },
                    options: {
                        responsive: true, maintainAspectRatio: false,
                        plugins: { legend: { position: 'top', labels: { font: { size: 12, weight: 'bold' } } }, datalabels: { display: true, anchor: 'end', align: 'top', font: { size: 10, weight: 'bold' }, color: '#fff', backgroundColor: '#333', borderRadius: 6, padding: 4, formatter: v => v + '%' } },
                        scales: { y: { beginAtZero: true, max: 100, title: { display: true, text: '% of Target' } } }
                    }
                });
            }

            // CHART 3 — Registration vs Completion (All)
            const ctx3 = document.getElementById('output-mangrove-regcomp');
            if (ctx3) {
                outputChartInstances['regcomp'] = new Chart(ctx3, {
                    type: 'bar',
                    data: {
                        labels: modules,
                        datasets: [
                            { label: 'Registered', data: [1344, 1344, 1344, 1344, 1344], backgroundColor: 'rgba(59, 130, 246, 0.3)', borderColor: '#3B82F6', borderWidth: 2 },
                            { label: 'Completed', data: [899, 791, 798, 881, 816], backgroundColor: '#283593' }
                        ]
                    },
                    options: {
                        responsive: true, maintainAspectRatio: false,
                        plugins: { legend: { position: 'top', labels: { font: { size: 12, weight: 'bold' } } }, datalabels: { display: true, anchor: 'end', align: 'top', font: { size: 10, weight: 'bold' }, color: '#fff', backgroundColor: '#333', borderRadius: 6, padding: 4 } },
                        scales: { y: { beginAtZero: true, title: { display: true, text: 'Participants' } } }
                    }
                });
            }

            // CHART 4 — Gender Split (Doughnut)
            const ctx4 = document.getElementById('output-mangrove-split');
            if (ctx4) {
                outputChartInstances['split'] = new Chart(ctx4, {
                    type: 'doughnut',
                    data: {
                        labels: ['Female (973)', 'Male (371)'],
                        datasets: [{ data: [973, 371], backgroundColor: ['#8B5CF6', '#3B82F6'], borderWidth: 2 }]
                    },
                    options: {
                        responsive: true, maintainAspectRatio: false,
                        plugins: {
                            legend: { position: 'bottom', labels: { font: { size: 12, weight: 'bold' } } },
                            datalabels: { display: true, font: { size: 13, weight: 'bold' }, color: '#fff', backgroundColor: '#333', borderRadius: 6, padding: 6, formatter: (v, ctx) => { const total = ctx.dataset.data.reduce((a,b) => a+b, 0); return Math.round(v/total*100) + '%'; } }
                        }
                    }
                });
            }
        }

        // FORESTRY OUTPUT CHARTS
        const forestryChartInstances = {};
        function renderForestryOutputCharts() {
            Object.values(forestryChartInstances).forEach(c => { try { c.destroy(); } catch(e) {} });

            const modules = ['M1', 'M2', 'M3', 'M4', 'M5', 'M6', 'M7'];

            // CHART 1 — Module Completion by Gender
            const ctx1 = document.getElementById('output-forestry-gender');
            if (ctx1) {
                forestryChartInstances['gender'] = new Chart(ctx1, {
                    type: 'bar',
                    data: {
                        labels: modules,
                        datasets: [
                            { label: 'Female', data: [859, 783, 787, 839, 931, 798, 830], backgroundColor: '#8B5CF6' },
                            { label: 'Male', data: [200, 164, 167, 229, 219, 188, 217], backgroundColor: '#3B82F6' }
                        ]
                    },
                    options: {
                        responsive: true, maintainAspectRatio: false,
                        plugins: { legend: { position: 'top', labels: { font: { size: 12, weight: 'bold' } } }, datalabels: { display: true, anchor: 'end', align: 'top', font: { size: 9, weight: 'bold' }, color: '#fff', backgroundColor: '#333', borderRadius: 6, padding: 4 } },
                        scales: { y: { beginAtZero: true, title: { display: true, text: 'Participants' } } }
                    }
                });
            }

            // CHART 2 — Completion Rate vs Target (%)
            const ctx2 = document.getElementById('output-forestry-target');
            if (ctx2) {
                forestryChartInstances['target'] = new Chart(ctx2, {
                    type: 'bar',
                    data: {
                        labels: modules,
                        datasets: [
                            { label: 'All (%)', data: [78, 70, 71, 79, 85, 73, 78], backgroundColor: '#1b5e20' },
                            { label: 'Male (%)', data: [49, 40, 41, 57, 54, 46, 54], backgroundColor: '#3B82F6' },
                            { label: 'Female (%)', data: [91, 83, 83, 89, 99, 84, 88], backgroundColor: '#8B5CF6' }
                        ]
                    },
                    options: {
                        responsive: true, maintainAspectRatio: false,
                        plugins: { legend: { position: 'top', labels: { font: { size: 12, weight: 'bold' } } }, datalabels: { display: true, anchor: 'end', align: 'top', font: { size: 9, weight: 'bold' }, color: '#fff', backgroundColor: '#333', borderRadius: 6, padding: 4, formatter: v => v + '%' } },
                        scales: { y: { beginAtZero: true, max: 100, title: { display: true, text: '% of Target' } } }
                    }
                });
            }

            // CHART 3 — Registration vs Completion (All)
            const ctx3 = document.getElementById('output-forestry-regcomp');
            if (ctx3) {
                forestryChartInstances['regcomp'] = new Chart(ctx3, {
                    type: 'bar',
                    data: {
                        labels: modules,
                        datasets: [
                            { label: 'Registered', data: [1440, 1440, 1440, 1440, 1440, 1440, 1440], backgroundColor: 'rgba(59, 130, 246, 0.3)', borderColor: '#3B82F6', borderWidth: 2 },
                            { label: 'Completed', data: [1059, 947, 954, 1068, 1150, 986, 1047], backgroundColor: '#1b5e20' }
                        ]
                    },
                    options: {
                        responsive: true, maintainAspectRatio: false,
                        plugins: { legend: { position: 'top', labels: { font: { size: 12, weight: 'bold' } } }, datalabels: { display: true, anchor: 'end', align: 'top', font: { size: 9, weight: 'bold' }, color: '#fff', backgroundColor: '#333', borderRadius: 6, padding: 4 } },
                        scales: { y: { beginAtZero: true, title: { display: true, text: 'Participants' } } }
                    }
                });
            }

            // CHART 4 — Gender Split (Doughnut)
            const ctx4 = document.getElementById('output-forestry-split');
            if (ctx4) {
                forestryChartInstances['split'] = new Chart(ctx4, {
                    type: 'doughnut',
                    data: {
                        labels: ['Female (1,141)', 'Male (299)'],
                        datasets: [{ data: [1141, 299], backgroundColor: ['#8B5CF6', '#3B82F6'], borderWidth: 2 }]
                    },
                    options: {
                        responsive: true, maintainAspectRatio: false,
                        plugins: {
                            legend: { position: 'bottom', labels: { font: { size: 12, weight: 'bold' } } },
                            datalabels: { display: true, font: { size: 13, weight: 'bold' }, color: '#fff', backgroundColor: '#333', borderRadius: 6, padding: 6, formatter: (v, ctx) => { const total = ctx.dataset.data.reduce((a,b) => a+b, 0); return Math.round(v/total*100) + '%'; } }
                        }
                    }
                });
            }
        }

        // SEAWEED OUTPUT CHARTS
        const seaweedChartInstances = {};
        function renderSeaweedOutputCharts() {
            Object.values(seaweedChartInstances).forEach(c => { try { c.destroy(); } catch(e) {} });

            const modules = ['M1', 'M2', 'M3', 'M4', 'M5'];

            // CHART 1 — Module Completion by Gender
            const ctx1 = document.getElementById('output-seaweed-gender');
            if (ctx1) {
                seaweedChartInstances['gender'] = new Chart(ctx1, {
                    type: 'bar',
                    data: {
                        labels: modules,
                        datasets: [
                            { label: 'Female', data: [314, 375, 603, 508, 512], backgroundColor: '#8B5CF6' },
                            { label: 'Male', data: [0, 0, 0, 0, 0], backgroundColor: '#3B82F6' }
                        ]
                    },
                    options: {
                        responsive: true, maintainAspectRatio: false,
                        plugins: { legend: { position: 'top' }, datalabels: { display: true, anchor: 'end', align: 'top', font: { size: 9 } } },
                        scales: { y: { beginAtZero: true, title: { display: true, text: 'Participants' } } }
                    }
                });
            }

            // CHART 2 — Completion Rate vs Target (%)
            const ctx2 = document.getElementById('output-seaweed-target');
            if (ctx2) {
                seaweedChartInstances['target'] = new Chart(ctx2, {
                    type: 'bar',
                    data: {
                        labels: modules,
                        datasets: [
                            { label: 'All (%)', data: [52, 63, 101, 85, 85], backgroundColor: '#00897b' },
                            { label: 'Female (%)', data: [52, 63, 101, 85, 85], backgroundColor: '#8B5CF6' }
                        ]
                    },
                    options: {
                        responsive: true, maintainAspectRatio: false,
                        plugins: { legend: { position: 'top' }, datalabels: { display: true, anchor: 'end', align: 'top', font: { size: 9 }, formatter: v => v + '%' } },
                        scales: { y: { beginAtZero: true, max: 120, title: { display: true, text: '% of Target' } } }
                    }
                });
            }

            // CHART 3 — Target vs Completion (All)
            const ctx3 = document.getElementById('output-seaweed-regcomp');
            if (ctx3) {
                seaweedChartInstances['regcomp'] = new Chart(ctx3, {
                    type: 'bar',
                    data: {
                        labels: modules,
                        datasets: [
                            { label: 'Target', data: [600, 600, 600, 600, 600], backgroundColor: 'rgba(59, 130, 246, 0.3)', borderColor: '#3B82F6', borderWidth: 2 },
                            { label: 'Completed', data: [314, 375, 603, 508, 512], backgroundColor: '#00897b' }
                        ]
                    },
                    options: {
                        responsive: true, maintainAspectRatio: false,
                        plugins: { legend: { position: 'top' }, datalabels: { display: true, anchor: 'end', align: 'top', font: { size: 9 } } },
                        scales: { y: { beginAtZero: true, title: { display: true, text: 'Participants' } } }
                    }
                });
            }

            // CHART 4 — Gender Split (Doughnut)
            const ctx4 = document.getElementById('output-seaweed-split');
            if (ctx4) {
                seaweedChartInstances['split'] = new Chart(ctx4, {
                    type: 'doughnut',
                    data: {
                        labels: ['Female (651)', 'Male (191)'],
                        datasets: [{ data: [651, 191], backgroundColor: ['#8B5CF6', '#3B82F6'], borderWidth: 2 }]
                    },
                    options: {
                        responsive: true, maintainAspectRatio: false,
                        plugins: {
                            legend: { position: 'bottom' },
                            datalabels: { display: true, font: { size: 13, weight: 'bold' }, color: '#fff', formatter: (v, ctx) => { const total = ctx.dataset.data.reduce((a,b) => a+b, 0); return Math.round(v/total*100) + '%'; } }
                        }
                    }
                });
            }
        }

        // GJJ OUTPUT CHARTS
        const gjjChartInstances = {};
        function renderGJJOutputCharts() {
            Object.values(gjjChartInstances).forEach(c => { try { c.destroy(); } catch(e) {} });

            const modules = ['M1', 'M2', 'M3', 'M4', 'M5'];

            // CHART 1 — Module Completion by Gender
            const ctx1 = document.getElementById('output-gjj-gender');
            if (ctx1) {
                gjjChartInstances['gender'] = new Chart(ctx1, {
                    type: 'bar',
                    data: {
                        labels: modules,
                        datasets: [
                            { label: 'Female', data: [2072, 1843, 2246, 2328, 2083], backgroundColor: '#8B5CF6' },
                            { label: 'Male', data: [0, 0, 0, 0, 0], backgroundColor: '#3B82F6' }
                        ]
                    },
                    options: {
                        responsive: true, maintainAspectRatio: false,
                        plugins: { legend: { position: 'top' }, datalabels: { display: true, anchor: 'end', align: 'top', font: { size: 9 } } },
                        scales: { y: { beginAtZero: true, title: { display: true, text: 'Participants' } } }
                    }
                });
            }

            // CHART 2 — Completion Rate vs Target (%)
            const ctx2 = document.getElementById('output-gjj-target');
            if (ctx2) {
                gjjChartInstances['target'] = new Chart(ctx2, {
                    type: 'bar',
                    data: {
                        labels: modules,
                        datasets: [
                            { label: 'All (%)', data: [69, 61, 75, 78, 69], backgroundColor: '#8e24aa' },
                            { label: 'Female (%)', data: [69, 61, 75, 78, 69], backgroundColor: '#8B5CF6' }
                        ]
                    },
                    options: {
                        responsive: true, maintainAspectRatio: false,
                        plugins: { legend: { position: 'top' }, datalabels: { display: true, anchor: 'end', align: 'top', font: { size: 9 }, formatter: v => v + '%' } },
                        scales: { y: { beginAtZero: true, max: 100, title: { display: true, text: '% of Target' } } }
                    }
                });
            }

            // CHART 3 — Target vs Completion (All)
            const ctx3 = document.getElementById('output-gjj-regcomp');
            if (ctx3) {
                gjjChartInstances['regcomp'] = new Chart(ctx3, {
                    type: 'bar',
                    data: {
                        labels: modules,
                        datasets: [
                            { label: 'Target', data: [3000, 3000, 3000, 3000, 3000], backgroundColor: 'rgba(59, 130, 246, 0.3)', borderColor: '#3B82F6', borderWidth: 2 },
                            { label: 'Completed', data: [2072, 1843, 2246, 2328, 2083], backgroundColor: '#8e24aa' }
                        ]
                    },
                    options: {
                        responsive: true, maintainAspectRatio: false,
                        plugins: { legend: { position: 'top' }, datalabels: { display: true, anchor: 'end', align: 'top', font: { size: 9 } } },
                        scales: { y: { beginAtZero: true, title: { display: true, text: 'Participants' } } }
                    }
                });
            }

            // CHART 4 — Gender Split (Doughnut)
            const ctx4 = document.getElementById('output-gjj-split');
            if (ctx4) {
                gjjChartInstances['split'] = new Chart(ctx4, {
                    type: 'doughnut',
                    data: {
                        labels: ['Female (2,765)', 'Male (861)'],
                        datasets: [{ data: [2765, 861], backgroundColor: ['#8B5CF6', '#3B82F6'], borderWidth: 2 }]
                    },
                    options: {
                        responsive: true, maintainAspectRatio: false,
                        plugins: {
                            legend: { position: 'bottom' },
                            datalabels: { display: true, font: { size: 13, weight: 'bold' }, color: '#fff', formatter: (v, ctx) => { const total = ctx.dataset.data.reduce((a,b) => a+b, 0); return Math.round(v/total*100) + '%'; } }
                        }
                    }
                });
            }
        }

        // VSLA OUTPUT CHARTS
        const vslaChartInstances = {};
        function renderVSLAOutputCharts() {
            Object.values(vslaChartInstances).forEach(c => { try { c.destroy(); } catch(e) {} });

            const modules = ['1&2', '3&4', '5', '6', '7', '8', '9', '10', '11', '12', '13', '14', '15', '16', '17', '18', '19', '20'];
            const completedAll = [1949, 1704, 1803, 1958, 2140, 2052, 1947, 1883, 1934, 2020, 1704, 1829, 1953, 1886, 1975, 1251, 621, 613];
            const completedFemale = [1949, 1704, 1803, 1958, 2140, 2052, 1947, 1883, 1934, 2020, 1704, 1829, 1953, 1886, 1975, 1251, 621, 613];
            const targetPctAll = [65, 57, 60, 65, 71, 68, 65, 63, 64, 67, 57, 61, 65, 63, 66, 42, 21, 20];
            const targetPctFemale = [65, 57, 60, 65, 71, 68, 65, 63, 64, 67, 57, 61, 65, 63, 66, 42, 21, 20];

            // CHART 1 — Module Completion - Female
            const ctx1 = document.getElementById('output-vsla-gender');
            if (ctx1) {
                vslaChartInstances['gender'] = new Chart(ctx1, {
                    type: 'bar',
                    data: {
                        labels: modules,
                        datasets: [
                            { label: 'Female Completed', data: completedFemale, backgroundColor: '#8B5CF6' }
                        ]
                    },
                    options: {
                        responsive: true, maintainAspectRatio: false,
                        plugins: { legend: { position: 'top' }, datalabels: { display: true, anchor: 'end', align: 'top', font: { size: 8 }, rotation: -45 } },
                        scales: { x: { ticks: { font: { size: 10 } } }, y: { beginAtZero: true, title: { display: true, text: 'Participants' } } }
                    }
                });
            }

            // CHART 2 — Completion Rate vs Target (%)
            const ctx2 = document.getElementById('output-vsla-target');
            if (ctx2) {
                vslaChartInstances['target'] = new Chart(ctx2, {
                    type: 'bar',
                    data: {
                        labels: modules,
                        datasets: [
                            { label: 'All (%)', data: targetPctAll, backgroundColor: '#f57c00' },
                            { label: 'Female (%)', data: targetPctFemale, backgroundColor: '#8B5CF6' }
                        ]
                    },
                    options: {
                        responsive: true, maintainAspectRatio: false,
                        plugins: { legend: { position: 'top' }, datalabels: { display: true, anchor: 'end', align: 'top', font: { size: 8 }, formatter: v => v + '%', rotation: -45 } },
                        scales: { x: { ticks: { font: { size: 10 } } }, y: { beginAtZero: true, max: 100, title: { display: true, text: '% of Target' } } }
                    }
                });
            }

            // CHART 3 — Target vs Completion (All)
            const ctx3 = document.getElementById('output-vsla-regcomp');
            if (ctx3) {
                vslaChartInstances['regcomp'] = new Chart(ctx3, {
                    type: 'bar',
                    data: {
                        labels: modules,
                        datasets: [
                            { label: 'Target', data: Array(18).fill(3000), backgroundColor: 'rgba(59, 130, 246, 0.3)', borderColor: '#3B82F6', borderWidth: 2 },
                            { label: 'Completed', data: completedAll, backgroundColor: '#f57c00' }
                        ]
                    },
                    options: {
                        responsive: true, maintainAspectRatio: false,
                        plugins: { legend: { position: 'top' }, datalabels: { display: true, anchor: 'end', align: 'top', font: { size: 8 }, rotation: -45 } },
                        scales: { x: { ticks: { font: { size: 10 } } }, y: { beginAtZero: true, title: { display: true, text: 'Participants' } } }
                    }
                });
            }

            // CHART 4 — Gender Split (Doughnut)
            const ctx4 = document.getElementById('output-vsla-split');
            if (ctx4) {
                vslaChartInstances['split'] = new Chart(ctx4, {
                    type: 'doughnut',
                    data: {
                        labels: ['Female (2,765)', 'Male (861)'],
                        datasets: [{ data: [2765, 861], backgroundColor: ['#8B5CF6', '#3B82F6'], borderWidth: 2 }]
                    },
                    options: {
                        responsive: true, maintainAspectRatio: false,
                        plugins: {
                            legend: { position: 'bottom' },
                            datalabels: { display: true, font: { size: 13, weight: 'bold' }, color: '#fff', formatter: (v, ctx) => { const total = ctx.dataset.data.reduce((a,b) => a+b, 0); return Math.round(v/total*100) + '%'; } }
                        }
                    }
                });
            }
        }

        // SCHOOLS OUTPUT CHARTS
        const schoolsChartInstances = {};
        function renderSchoolsOutputCharts() {
            Object.values(schoolsChartInstances).forEach(c => { try { c.destroy(); } catch(e) {} });

            // CHART 1 — Student Enrollment by County & Gender
            const ctx1 = document.getElementById('output-schools-county');
            if (ctx1) {
                schoolsChartInstances['county'] = new Chart(ctx1, {
                    type: 'bar',
                    data: {
                        labels: ['Kwale', 'Kilifi'],
                        datasets: [
                            { label: 'Boys', data: [9960, 12739], backgroundColor: '#3B82F6' },
                            { label: 'Girls', data: [9433, 12169], backgroundColor: '#8B5CF6' }
                        ]
                    },
                    options: {
                        responsive: true, maintainAspectRatio: false,
                        plugins: { legend: { position: 'top' }, datalabels: { display: true, anchor: 'end', align: 'top', font: { size: 11, weight: 'bold' }, formatter: v => v.toLocaleString() } },
                        scales: { y: { beginAtZero: true, title: { display: true, text: 'Students' } } }
                    }
                });
            }

            // CHART 2 — 4K Club Gender Split (Doughnut)
            const ctx2 = document.getElementById('output-schools-4ksplit');
            if (ctx2) {
                schoolsChartInstances['4ksplit'] = new Chart(ctx2, {
                    type: 'doughnut',
                    data: {
                        labels: ['Female (2,917)', 'Male (2,148)'],
                        datasets: [{ data: [2917, 2148], backgroundColor: ['#8B5CF6', '#3B82F6'], borderWidth: 2 }]
                    },
                    options: {
                        responsive: true, maintainAspectRatio: false,
                        plugins: {
                            legend: { position: 'bottom' },
                            datalabels: { display: true, font: { size: 13, weight: 'bold' }, color: '#fff', formatter: (v, ctx) => { const total = ctx.dataset.data.reduce((a,b) => a+b, 0); return Math.round(v/total*100) + '%'; } }
                        }
                    }
                });
            }

            // CHART 3 — County Comparison - Total Students
            const ctx3 = document.getElementById('output-schools-comparison');
            if (ctx3) {
                schoolsChartInstances['comparison'] = new Chart(ctx3, {
                    type: 'bar',
                    data: {
                        labels: ['Kwale (35 schools)', 'Kilifi (30 schools)'],
                        datasets: [
                            { label: 'Total Students', data: [19393, 24908], backgroundColor: ['#0288d1', '#01579b'] }
                        ]
                    },
                    options: {
                        responsive: true, maintainAspectRatio: false,
                        plugins: { legend: { display: false }, datalabels: { display: true, anchor: 'end', align: 'top', font: { size: 13, weight: 'bold' }, formatter: v => v.toLocaleString() } },
                        scales: { y: { beginAtZero: true, title: { display: true, text: 'Total Students' } } }
                    }
                });
            }

            // CHART 4 — Overall Gender Split (All Students)
            const ctx4 = document.getElementById('output-schools-gendersplit');
            if (ctx4) {
                schoolsChartInstances['gendersplit'] = new Chart(ctx4, {
                    type: 'doughnut',
                    data: {
                        labels: ['Boys (22,699)', 'Girls (21,602)'],
                        datasets: [{ data: [22699, 21602], backgroundColor: ['#3B82F6', '#8B5CF6'], borderWidth: 2 }]
                    },
                    options: {
                        responsive: true, maintainAspectRatio: false,
                        plugins: {
                            legend: { position: 'bottom' },
                            datalabels: { display: true, font: { size: 13, weight: 'bold' }, color: '#fff', formatter: (v, ctx) => { const total = ctx.dataset.data.reduce((a,b) => a+b, 0); return Math.round(v/total*100) + '%'; } }
                        }
                    }
                });
            }
        }

        // ====== SCHOOLS DASHBOARD SUB-TAB SWITCHER ======
        function showSchoolsDashType(event, typeName) {
            // Toggle sub-tab buttons
            const selector = document.getElementById('schools-dash-type-selector');
            if (selector) {
                selector.querySelectorAll('.tab-button').forEach(btn => {
                    btn.classList.remove('active');
                    btn.style.background = '';
                    btn.style.color = '';
                });
                if (event && event.target) {
                    event.target.classList.add('active');
                    event.target.style.background = '#283593';
                    event.target.style.color = '#fff';
                }
            }
            // Hide all sub-sections
            const subSections = ['schools-dash-clean-water', 'schools-dash-water-midline', 'schools-dash-four-k-clubs', 'schools-dash-overall-insights'];
            subSections.forEach(id => {
                const el = document.getElementById(id);
                if (el) el.style.display = 'none';
            });
            // Show selected sub-section
            const typeMap = {
                'clean-water': 'schools-dash-clean-water',
                'water-midline': 'schools-dash-water-midline',
                'four-k-clubs': 'schools-dash-four-k-clubs',
                'overall-insights': 'schools-dash-overall-insights'
            };
            const targetId = typeMap[typeName];
            if (targetId) {
                const el = document.getElementById(targetId);
                if (el) el.style.display = 'block';
            }
            // Update footer
            const footerLabels = {
                'clean-water': 'Access to Clean Water',
                'water-midline': 'Water in Schools \u2014 Midline Results',
                'four-k-clubs': '4K Clubs \u2014 Midline Results',
                'overall-insights': 'Overall Insights'
            };
            document.getElementById('footer-title').innerHTML = '<strong>Schools Dashboard \u2014 ' + (footerLabels[typeName] || typeName) + '</strong>';
            // Render charts for sub-tab
            if (typeName === 'clean-water') renderSchoolsDashCleanWaterCharts();
            if (typeName === 'water-midline') renderSchoolsDashWaterMidlineCharts();
            if (typeName === 'four-k-clubs') renderSchoolsDash4KCharts();
        }

        // ====== SCHOOLS DASHBOARD CHART INSTANCES ======
        const sdCleanWaterChartInstances = {};
        const sdWaterMidlineChartInstances = {};
        const sd4KChartInstances = {};

        // ====== A. CLEAN WATER CHARTS ======
        function renderSchoolsDashCleanWaterCharts() {
            Object.values(sdCleanWaterChartInstances).forEach(c => { try { c.destroy(); } catch(e) {} });

            // Chart 1 — Water Source Baseline vs Midline
            const ctx1 = document.getElementById('sd-water-source-chart');
            if (ctx1) {
                sdCleanWaterChartInstances['source'] = new Chart(ctx1, {
                    type: 'bar',
                    data: {
                        labels: ['Borehole', 'Rainwater\nHarvesting', 'Water Tanks', 'Piped Water', 'River/Pond'],
                        datasets: [
                            { label: 'Baseline', data: [44.2, 13.0, 2.6, 31.2, 15.0], backgroundColor: '#90CAF9' },
                            { label: 'Midline', data: [52.3, 27.7, 9.2, 35.4, 8.0], backgroundColor: '#1565C0' }
                        ]
                    },
                    options: {
                        responsive: true, maintainAspectRatio: false,
                        plugins: { legend: { position: 'top' }, datalabels: { display: true, anchor: 'end', align: 'top', font: { size: 11, weight: 'bold' }, formatter: v => v + '%' } },
                        scales: { y: { beginAtZero: true, max: 65, title: { display: true, text: 'Schools Reporting (%)' } } }
                    }
                });
            }

            // Chart 2 — Infrastructure Ownership
            const ctx2 = document.getElementById('sd-ownership-chart');
            if (ctx2) {
                sdCleanWaterChartInstances['ownership'] = new Chart(ctx2, {
                    type: 'bar',
                    data: {
                        labels: ['Private Ownership', 'Public/Communal'],
                        datasets: [
                            { label: 'Baseline', data: [63.6, 36.4], backgroundColor: '#90CAF9' },
                            { label: 'Midline', data: [81.5, 15.4], backgroundColor: '#1565C0' }
                        ]
                    },
                    options: {
                        responsive: true, maintainAspectRatio: false,
                        plugins: { legend: { position: 'top' }, datalabels: { display: true, anchor: 'end', align: 'top', font: { size: 12, weight: 'bold' }, formatter: v => v + '%' } },
                        scales: { y: { beginAtZero: true, max: 100, title: { display: true, text: 'Schools Reporting (%)' } } }
                    }
                });
            }

            // Chart 3 — Key Indicators Baseline vs Midline
            const ctx3 = document.getElementById('sd-indicators-chart');
            if (ctx3) {
                sdCleanWaterChartInstances['indicators'] = new Chart(ctx3, {
                    type: 'bar',
                    data: {
                        labels: ['Year-round\nAvailability', 'Clean/Safe\nDrinking Water', 'Functional\nRainwater Harvesting'],
                        datasets: [
                            { label: 'Baseline', data: [49.4, 81.2, 37.7], backgroundColor: '#A5D6A7' },
                            { label: 'Midline', data: [55.4, 78.5, 53.8], backgroundColor: '#2E7D32' }
                        ]
                    },
                    options: {
                        responsive: true, maintainAspectRatio: false,
                        plugins: { legend: { position: 'top' }, datalabels: { display: true, anchor: 'end', align: 'top', font: { size: 11, weight: 'bold' }, formatter: v => v + '%' } },
                        scales: { y: { beginAtZero: true, max: 100, title: { display: true, text: 'Schools Reporting (%)' } } }
                    }
                });
            }

            // Chart 4 — Indicator 1310c Composite
            const ctx4 = document.getElementById('sd-composite-chart');
            if (ctx4) {
                sdCleanWaterChartInstances['composite'] = new Chart(ctx4, {
                    type: 'bar',
                    data: {
                        labels: ['Indicator 1310c \u2014 Sustainable Clean Water Solutions'],
                        datasets: [
                            { label: 'Baseline (23.4%)', data: [23.4], backgroundColor: '#FFCC80', barPercentage: 0.5 },
                            { label: 'Midline (62.5%)', data: [62.5], backgroundColor: '#1B5E20', barPercentage: 0.5 }
                        ]
                    },
                    options: {
                        indexAxis: 'y',
                        responsive: true, maintainAspectRatio: false,
                        plugins: { legend: { position: 'top' }, datalabels: { display: true, anchor: 'end', align: 'right', font: { size: 14, weight: 'bold' }, formatter: v => v + '%' } },
                        scales: { x: { beginAtZero: true, max: 100, title: { display: true, text: 'Achievement Rate (%)' } } }
                    }
                });
            }
        }

        // ====== B. WATER IN SCHOOLS MIDLINE CHARTS ======
        function renderSchoolsDashWaterMidlineCharts() {
            Object.values(sdWaterMidlineChartInstances).forEach(c => { try { c.destroy(); } catch(e) {} });

            // Chart 1 — Infrastructure: Received vs Installed vs Used
            const ctx1 = document.getElementById('sd-infra-usage-chart');
            if (ctx1) {
                sdWaterMidlineChartInstances['infra'] = new Chart(ctx1, {
                    type: 'bar',
                    data: {
                        labels: ['Tanks', 'Gutters'],
                        datasets: [
                            { label: 'Received', data: [83, 83], backgroundColor: '#4CAF50' },
                            { label: 'Installed', data: [34, 32], backgroundColor: '#FF9800' },
                            { label: 'Used', data: [35, 27], backgroundColor: '#F44336' }
                        ]
                    },
                    options: {
                        responsive: true, maintainAspectRatio: false,
                        plugins: { legend: { position: 'top' }, datalabels: { display: true, anchor: 'end', align: 'top', font: { size: 12, weight: 'bold' }, formatter: v => v + '%' } },
                        scales: { y: { beginAtZero: true, max: 100, title: { display: true, text: 'Schools Reporting (%)' } } }
                    }
                });
            }

            // Chart 2 — Solvatten Kit Usage (Doughnut)
            const ctx2 = document.getElementById('sd-solvatten-chart');
            if (ctx2) {
                sdWaterMidlineChartInstances['solvatten'] = new Chart(ctx2, {
                    type: 'doughnut',
                    data: {
                        labels: ['Used', 'Partially Used', 'Not Used'],
                        datasets: [{ data: [49, 14, 37], backgroundColor: ['#4CAF50', '#FF9800', '#F44336'], borderWidth: 2 }]
                    },
                    options: {
                        responsive: true, maintainAspectRatio: false,
                        plugins: {
                            legend: { position: 'bottom' },
                            datalabels: { display: true, font: { size: 13, weight: 'bold' }, color: '#fff', formatter: v => v + '%' }
                        }
                    }
                });
            }

            // Chart 3 — Sustainability Measures
            const ctx3 = document.getElementById('sd-sustainability-chart');
            if (ctx3) {
                sdWaterMidlineChartInstances['sustain'] = new Chart(ctx3, {
                    type: 'bar',
                    data: {
                        labels: ['Maintenance\nBudget', 'Trained\nStaff', 'Repairs/\nMaintenance', 'Hygiene\nTraining', 'Community\nOversight', 'Income-Gen\nActivities'],
                        datasets: [{
                            label: 'Schools Reporting (%)',
                            data: [20, 57, 65, 74, 74, 63],
                            backgroundColor: ['#e65100', '#0277BD', '#00695C', '#2E7D32', '#2E7D32', '#1565C0']
                        }]
                    },
                    options: {
                        responsive: true, maintainAspectRatio: false,
                        plugins: { legend: { display: false }, datalabels: { display: true, anchor: 'end', align: 'top', font: { size: 12, weight: 'bold' }, formatter: v => v + '%' } },
                        scales: { y: { beginAtZero: true, max: 100, title: { display: true, text: 'Schools Reporting (%)' } } }
                    }
                });
            }

            // Chart 4 — Pipeline: Received → Installed → Used
            const ctx4 = document.getElementById('sd-pipeline-chart');
            if (ctx4) {
                sdWaterMidlineChartInstances['pipeline'] = new Chart(ctx4, {
                    type: 'line',
                    data: {
                        labels: ['Received', 'Installed', 'Used'],
                        datasets: [
                            { label: 'Tanks', data: [83, 34, 35], borderColor: '#1565C0', backgroundColor: 'rgba(21,101,192,0.1)', fill: true, tension: 0.3, pointRadius: 6, pointBackgroundColor: '#1565C0' },
                            { label: 'Gutters', data: [83, 32, 27], borderColor: '#e65100', backgroundColor: 'rgba(230,81,0,0.1)', fill: true, tension: 0.3, pointRadius: 6, pointBackgroundColor: '#e65100' }
                        ]
                    },
                    options: {
                        responsive: true, maintainAspectRatio: false,
                        plugins: { legend: { position: 'top' }, datalabels: { display: true, anchor: 'end', align: 'top', font: { size: 12, weight: 'bold' }, formatter: v => v + '%' } },
                        scales: { y: { beginAtZero: true, max: 100, title: { display: true, text: 'Schools Reporting (%)' } } }
                    }
                });
            }
        }

        // ====== C. 4K CLUBS CHARTS ======
        function renderSchoolsDash4KCharts() {
            Object.values(sd4KChartInstances).forEach(c => { try { c.destroy(); } catch(e) {} });

            // Chart 1 — Training & Support Agreement
            const ctx1 = document.getElementById('sd-4k-training-chart');
            if (ctx1) {
                sd4KChartInstances['training'] = new Chart(ctx1, {
                    type: 'bar',
                    data: {
                        labels: ['Adequate\nTraining', 'Patrons\nSupport', 'Materials\nAdequate', 'Members\nCommitted', 'Clubs\nFunctional'],
                        datasets: [{
                            label: 'Schools Agreeing (%)',
                            data: [85, 88, 85, 89, 89],
                            backgroundColor: ['#2E7D32', '#388E3C', '#43A047', '#4CAF50', '#66BB6A']
                        }]
                    },
                    options: {
                        responsive: true, maintainAspectRatio: false,
                        plugins: { legend: { display: false }, datalabels: { display: true, anchor: 'end', align: 'top', font: { size: 13, weight: 'bold' }, formatter: v => v + '%' } },
                        scales: { y: { beginAtZero: true, max: 100, title: { display: true, text: 'Agreement Level (%)' } } }
                    }
                });
            }

            // Chart 2 — 4K Club Members Gender Split
            const ctx2 = document.getElementById('sd-4k-gender-chart');
            if (ctx2) {
                sd4KChartInstances['gender'] = new Chart(ctx2, {
                    type: 'doughnut',
                    data: {
                        labels: ['Girls (2,917)', 'Boys (2,148)'],
                        datasets: [{ data: [2917, 2148], backgroundColor: ['#8B5CF6', '#3B82F6'], borderWidth: 2 }]
                    },
                    options: {
                        responsive: true, maintainAspectRatio: false,
                        plugins: {
                            legend: { position: 'bottom' },
                            datalabels: { display: true, font: { size: 14, weight: 'bold' }, color: '#fff', formatter: (v, ctx) => { const total = ctx.dataset.data.reduce((a,b) => a+b, 0); return Math.round(v/total*100) + '%'; } }
                        }
                    }
                });
            }

            // Chart 3 — Environmental Initiatives by Type
            const ctx3 = document.getElementById('sd-4k-enviro-chart');
            if (ctx3) {
                sd4KChartInstances['enviro'] = new Chart(ctx3, {
                    type: 'bar',
                    data: {
                        labels: ['Tree Planting', 'Farming', 'Environmental\nConservation', 'Waste\nManagement', 'Water\nConservation', 'Other'],
                        datasets: [{
                            label: 'Number of Schools',
                            data: [38, 32, 9, 4, 3, 6],
                            backgroundColor: ['#2E7D32', '#4CAF50', '#66BB6A', '#81C784', '#A5D6A7', '#C8E6C9']
                        }]
                    },
                    options: {
                        responsive: true, maintainAspectRatio: false,
                        plugins: { legend: { display: false }, datalabels: { display: true, anchor: 'end', align: 'top', font: { size: 12, weight: 'bold' } } },
                        scales: { y: { beginAtZero: true, title: { display: true, text: 'Number of Schools' } } }
                    }
                });
            }

            // Chart 4 — Curriculum Delivery Progress
            const ctx4 = document.getElementById('sd-4k-curriculum-chart');
            if (ctx4) {
                sd4KChartInstances['curriculum'] = new Chart(ctx4, {
                    type: 'doughnut',
                    data: {
                        labels: ['Completed ~50%', 'Almost Completed', 'Less than Half', 'Other'],
                        datasets: [{ data: [66, 14, 17, 3], backgroundColor: ['#2E7D32', '#FF9800', '#F44336', '#9E9E9E'], borderWidth: 2 }]
                    },
                    options: {
                        responsive: true, maintainAspectRatio: false,
                        plugins: {
                            legend: { position: 'bottom' },
                            datalabels: { display: true, font: { size: 13, weight: 'bold' }, color: '#fff', formatter: v => v + '%' }
                        }
                    }
                });
            }
        }

        // ====== SEAWEED TAB SWITCHER ======
        function showSeaweedTab(evt, tabName) {
            const tabContents = document.querySelectorAll('.seaweed-tab-content');
            tabContents.forEach(tab => {
                tab.classList.remove('active');
                tab.style.display = 'none';
            });
            const tabButtons = document.getElementById('seaweed-tabs-container').querySelectorAll('.tab-button');
            tabButtons.forEach(btn => btn.classList.remove('active'));
            const target = document.getElementById(tabName);
            if (target) {
                target.classList.add('active');
                target.style.display = 'block';
            }
            evt.currentTarget.classList.add('active');

            // Resize charts in newly visible tab
            requestAnimationFrame(() => {
                if (target) {
                    target.querySelectorAll('canvas').forEach(canvas => {
                        const chart = Chart.getChart(canvas);
                        if (chart) chart.resize();
                    });
                }
            });
        }

        // ====== SEAWEED CHART INSTANCES ======
        const swChartInstances = {};

        function renderSeaweedCharts() {
            Object.values(swChartInstances).forEach(c => { try { c.destroy(); } catch(e) {} });

            const swColors = {
                teal: '#00897B', tealDark: '#00695C', tealLight: '#4DB6AC',
                accent1: '#26A69A', accent2: '#80CBC4', accent3: '#B2DFDB',
                amber: '#FF8F00', orange: '#EF6C00', red: '#C62828',
                blue: '#1565C0', green: '#2E7D32', purple: '#6A1B9A'
            };

            function swChart(canvasId, config) {
                const canvas = document.getElementById(canvasId);
                if (!canvas) { console.warn('SW Canvas not found:', canvasId); return null; }
                const existing = Chart.getChart(canvas);
                if (existing) existing.destroy();
                const chart = new Chart(canvas, config);
                swChartInstances[canvasId] = chart;
                return chart;
            }

            // === TAB A: GROUP PROFILE ===

            // A1 — Groups by Year of Establishment
            swChart('sw-chart-establishment', {
                type: 'bar',
                data: {
                    labels: ['Before 2010', '2010–2019', '2020–2022', '2023 onwards'],
                    datasets: [{
                        label: 'Number of Groups',
                        data: [2, 6, 8, 3],
                        backgroundColor: [swColors.accent3, swColors.accent2, swColors.teal, swColors.tealDark]
                    }]
                },
                options: {
                    responsive: true, maintainAspectRatio: false,
                    plugins: {
                        legend: { display: false },
                        datalabels: { display: true, anchor: 'end', align: 'top', font: { size: 13, weight: 'bold' }, formatter: (v) => v + ' (' + [10.5, 31.6, 42.1, 15.8][[2,6,8,3].indexOf(v)] + '%)' }
                    },
                    scales: { y: { beginAtZero: true, max: 12, title: { display: true, text: 'Number of Groups' } } }
                }
            });

            // A2 — Women-Led Groups (Doughnut)
            swChart('sw-chart-women-led', {
                type: 'doughnut',
                data: {
                    labels: ['Women-Led', 'Not Women-Led'],
                    datasets: [{ data: [18, 1], backgroundColor: [swColors.teal, '#e0e0e0'], borderWidth: 2 }]
                },
                options: {
                    responsive: true, maintainAspectRatio: false,
                    plugins: {
                        legend: { position: 'bottom' },
                        datalabels: { display: true, font: { size: 15, weight: 'bold' }, color: '#fff', formatter: (v, ctx) => { const pct = [94.7, 5.3]; return pct[ctx.dataIndex] + '%'; } }
                    }
                }
            });

            // A3 — Meeting Frequency (Pie)
            swChart('sw-chart-meetings', {
                type: 'pie',
                data: {
                    labels: ['Weekly', 'Monthly'],
                    datasets: [{ data: [14, 5], backgroundColor: [swColors.teal, swColors.amber], borderWidth: 2 }]
                },
                options: {
                    responsive: true, maintainAspectRatio: false,
                    plugins: {
                        legend: { position: 'bottom' },
                        datalabels: { display: true, font: { size: 15, weight: 'bold' }, color: '#fff', formatter: (v, ctx) => v + ' groups' }
                    }
                }
            });

            // A4 — Active Members (Female vs Male)
            swChart('sw-chart-members', {
                type: 'bar',
                data: {
                    labels: ['Total Members', 'Average/Group', 'Min', 'Max'],
                    datasets: [
                        { label: 'Female', data: [610, 32.1, 16, 60], backgroundColor: swColors.teal },
                        { label: 'Male', data: [175, 9.2, 1, 20], backgroundColor: swColors.blue }
                    ]
                },
                options: {
                    responsive: true, maintainAspectRatio: false,
                    plugins: {
                        legend: { position: 'top' },
                        datalabels: { display: true, anchor: 'end', align: 'top', font: { size: 11, weight: 'bold' } }
                    },
                    scales: { y: { beginAtZero: true, title: { display: true, text: 'Number of Members' } } }
                }
            });

            // === TAB B: ACTIVITIES ===

            // B1 — Activity Types
            swChart('sw-chart-activity-types', {
                type: 'bar',
                data: {
                    labels: ['Production', 'Drying', 'Value Addition', 'Marketing', 'Packaging'],
                    datasets: [{
                        label: '% of Groups',
                        data: [89.5, 63.2, 26.3, 10.5, 0],
                        backgroundColor: [swColors.tealDark, swColors.teal, swColors.accent1, swColors.accent2, swColors.accent3]
                    }]
                },
                options: {
                    responsive: true, maintainAspectRatio: false,
                    plugins: {
                        legend: { display: false },
                        datalabels: { display: true, anchor: 'end', align: 'top', font: { size: 13, weight: 'bold' }, formatter: v => v + '%' }
                    },
                    scales: { y: { beginAtZero: true, max: 100, title: { display: true, text: 'Percentage of Groups (%)' } } }
                }
            });

            // B2 — Year Started
            swChart('sw-chart-start-year', {
                type: 'doughnut',
                data: {
                    labels: ['Before 2010', '2010–2022', '2023 onwards'],
                    datasets: [{ data: [1, 6, 12], backgroundColor: [swColors.accent3, swColors.accent1, swColors.tealDark], borderWidth: 2 }]
                },
                options: {
                    responsive: true, maintainAspectRatio: false,
                    plugins: {
                        legend: { position: 'bottom' },
                        datalabels: { display: true, font: { size: 14, weight: 'bold' }, color: '#fff', formatter: v => v }
                    }
                }
            });

            // B3 — Motivation
            swChart('sw-chart-motivation', {
                type: 'bar',
                indexAxis: 'y',
                data: {
                    labels: ['Market Opportunity', 'Peer Learning', 'Project Support', 'Government Training'],
                    datasets: [{
                        label: '% of Groups',
                        data: [47.4, 36.8, 15.8, 0],
                        backgroundColor: [swColors.teal, swColors.accent1, swColors.blue, '#e0e0e0']
                    }]
                },
                options: {
                    responsive: true, maintainAspectRatio: false,
                    plugins: {
                        legend: { display: false },
                        datalabels: { display: true, anchor: 'end', align: 'right', font: { size: 13, weight: 'bold' }, formatter: v => v + '%' }
                    },
                    scales: { x: { beginAtZero: true, max: 60, title: { display: true, text: 'Percentage of Groups (%)' } } }
                }
            });

            // B4 — Ropes Owned
            swChart('sw-chart-ropes', {
                type: 'bar',
                data: {
                    labels: ['< 100', '100–499', '500–999', '1,000–1,999', '2,000+'],
                    datasets: [{
                        label: 'Number of Groups',
                        data: [3, 6, 4, 1, 5],
                        backgroundColor: [swColors.accent3, swColors.accent2, swColors.accent1, swColors.teal, swColors.tealDark]
                    }]
                },
                options: {
                    responsive: true, maintainAspectRatio: false,
                    plugins: {
                        legend: { display: false },
                        datalabels: { display: true, anchor: 'end', align: 'top', font: { size: 13, weight: 'bold' }, formatter: (v) => v + ' (' + [15.8, 31.6, 21.1, 5.3, 26.3][[3,6,4,1,5].indexOf(v)] + '%)' }
                    },
                    scales: { y: { beginAtZero: true, max: 10, title: { display: true, text: 'Number of Groups' } } }
                }
            });

            // === TAB C: PRODUCTION & SUSTAINABILITY ===

            // C1 — Production Methods
            swChart('sw-chart-methods', {
                type: 'bar',
                data: {
                    labels: ['Off-Bottom', 'Double Loop', 'Long Lines'],
                    datasets: [{
                        label: '% of Groups',
                        data: [78.9, 15.8, 10.5],
                        backgroundColor: [swColors.tealDark, swColors.teal, swColors.accent1]
                    }]
                },
                options: {
                    responsive: true, maintainAspectRatio: false,
                    plugins: {
                        legend: { display: false },
                        datalabels: { display: true, anchor: 'end', align: 'top', font: { size: 14, weight: 'bold' }, formatter: v => v + '%' }
                    },
                    scales: { y: { beginAtZero: true, max: 100, title: { display: true, text: 'Percentage of Groups (%)' } } }
                }
            });

            // C2 — Sustainable Practices Adoption
            swChart('sw-chart-sustainable', {
                type: 'doughnut',
                data: {
                    labels: ['Sustainable Practices', 'No Sustainable Practices'],
                    datasets: [{ data: [17, 2], backgroundColor: [swColors.green, '#e0e0e0'], borderWidth: 2 }]
                },
                options: {
                    responsive: true, maintainAspectRatio: false,
                    plugins: {
                        legend: { position: 'bottom' },
                        datalabels: { display: true, font: { size: 15, weight: 'bold' }, color: '#fff', formatter: (v, ctx) => [89.5, 10.5][ctx.dataIndex] + '%' }
                    }
                }
            });

            // C3 — Challenges in Sustainable Practices
            swChart('sw-chart-challenges', {
                type: 'bar',
                indexAxis: 'y',
                data: {
                    labels: ['Resource Constraints', 'Environmental Challenges', 'Technical Capacity', 'Health & Safety', 'Mobility & Access', 'Social/Household', 'Other'],
                    datasets: [{
                        label: 'Frequency (mentions)',
                        data: [30, 25, 15, 10, 10, 8, 7],
                        backgroundColor: [swColors.red, swColors.orange, swColors.amber, '#F44336', '#FF7043', '#FFB74D', '#e0e0e0']
                    }]
                },
                options: {
                    responsive: true, maintainAspectRatio: false,
                    plugins: {
                        legend: { display: false },
                        datalabels: { display: true, anchor: 'end', align: 'right', font: { size: 12, weight: 'bold' }, formatter: v => v }
                    },
                    scales: { x: { beginAtZero: true, title: { display: true, text: 'Mention Count' } } }
                }
            });

            // C4 — Yield/Quality Changes
            swChart('sw-chart-yield', {
                type: 'pie',
                data: {
                    labels: ['Improved', 'No Change', 'Not Sure'],
                    datasets: [{ data: [15, 3, 1], backgroundColor: [swColors.green, swColors.amber, '#e0e0e0'], borderWidth: 2 }]
                },
                options: {
                    responsive: true, maintainAspectRatio: false,
                    plugins: {
                        legend: { position: 'bottom' },
                        datalabels: { display: true, font: { size: 14, weight: 'bold' }, color: '#fff', formatter: v => v }
                    }
                }
            });

            // C5 — Harvest Amount Distribution
            swChart('sw-chart-harvest', {
                type: 'bar',
                data: {
                    labels: ['0 kg', '1–500', '501–1K', '1K–5K', '5K–10K', '10K–20K', '20K–30K', '30K+'],
                    datasets: [{
                        label: 'Groups',
                        data: [7, 5, 1, 2, 1, 0, 2, 1],
                        backgroundColor: ['#ef5350', swColors.accent3, swColors.accent2, swColors.accent1, swColors.teal, swColors.tealDark, swColors.green, '#1B5E20']
                    }]
                },
                options: {
                    responsive: true, maintainAspectRatio: false,
                    plugins: {
                        legend: { display: false },
                        datalabels: { display: true, anchor: 'end', align: 'top', font: { size: 12, weight: 'bold' }, formatter: v => v }
                    },
                    scales: { y: { beginAtZero: true, max: 10, title: { display: true, text: 'Number of Groups' } } }
                }
            });

            // C6 — Records Keeping
            swChart('sw-chart-records', {
                type: 'doughnut',
                data: {
                    labels: ['Keep Records', 'Do Not'],
                    datasets: [{ data: [12, 7], backgroundColor: [swColors.teal, swColors.amber], borderWidth: 2 }]
                },
                options: {
                    responsive: true, maintainAspectRatio: false,
                    plugins: {
                        legend: { position: 'bottom' },
                        datalabels: { display: true, font: { size: 15, weight: 'bold' }, color: '#fff', formatter: (v, ctx) => [63.2, 36.8][ctx.dataIndex] + '%' }
                    }
                }
            });

            // === TAB D: INPUTS & SUPPORT ===

            // D1 — Inputs Received
            swChart('sw-chart-inputs', {
                type: 'bar',
                data: {
                    labels: ['Ropes', 'Safety Kits', 'Seedlings', 'Drying Racks', 'Boats'],
                    datasets: [{
                        label: '% of Groups',
                        data: [100, 100, 89.5, 5.3, 0],
                        backgroundColor: [swColors.tealDark, swColors.teal, swColors.accent1, swColors.accent2, '#e0e0e0']
                    }]
                },
                options: {
                    responsive: true, maintainAspectRatio: false,
                    plugins: {
                        legend: { display: false },
                        datalabels: { display: true, anchor: 'end', align: 'top', font: { size: 13, weight: 'bold' }, formatter: v => v + '%' }
                    },
                    scales: { y: { beginAtZero: true, max: 110, title: { display: true, text: 'Percentage of Groups (%)' } } }
                }
            });

            // D2 — Input Adequacy
            swChart('sw-chart-adequacy', {
                type: 'doughnut',
                data: {
                    labels: ['Sufficient', 'Insufficient'],
                    datasets: [{ data: [3, 16], backgroundColor: [swColors.green, swColors.red], borderWidth: 2 }]
                },
                options: {
                    responsive: true, maintainAspectRatio: false,
                    plugins: {
                        legend: { position: 'bottom' },
                        datalabels: { display: true, font: { size: 15, weight: 'bold' }, color: '#fff', formatter: (v, ctx) => [15.8, 84.2][ctx.dataIndex] + '%' }
                    }
                }
            });

            // D3 — Training Received
            swChart('sw-chart-training', {
                type: 'bar',
                data: {
                    labels: ['Seaweed Farming', 'Business', 'Quality Control', 'Marketing'],
                    datasets: [{
                        label: '% of Groups',
                        data: [100, 26.3, 26.3, 21.1],
                        backgroundColor: [swColors.tealDark, swColors.blue, swColors.purple, swColors.amber]
                    }]
                },
                options: {
                    responsive: true, maintainAspectRatio: false,
                    plugins: {
                        legend: { display: false },
                        datalabels: { display: true, anchor: 'end', align: 'top', font: { size: 13, weight: 'bold' }, formatter: v => v + '%' }
                    },
                    scales: { y: { beginAtZero: true, max: 110, title: { display: true, text: 'Percentage of Groups (%)' } } }
                }
            });

            // D4 — Support Needs
            swChart('sw-chart-support-needs', {
                type: 'bar',
                indexAxis: 'y',
                data: {
                    labels: ['Tools & Equipment', 'Training & Capacity', 'Infrastructure', 'Market Access', 'Financial Support', 'Other'],
                    datasets: [{
                        label: 'Frequency (mentions)',
                        data: [35, 30, 25, 20, 10, 8],
                        backgroundColor: [swColors.tealDark, swColors.teal, swColors.accent1, swColors.blue, swColors.amber, '#e0e0e0']
                    }]
                },
                options: {
                    responsive: true, maintainAspectRatio: false,
                    plugins: {
                        legend: { display: false },
                        datalabels: { display: true, anchor: 'end', align: 'right', font: { size: 12, weight: 'bold' }, formatter: v => v }
                    },
                    scales: { x: { beginAtZero: true, title: { display: true, text: 'Mention Count' } } }
                }
            });

            // === TAB E: COMMERCIALIZATION ===

            // E1 — Currently Selling
            swChart('sw-chart-selling', {
                type: 'doughnut',
                data: {
                    labels: ['Currently Selling', 'Not Selling'],
                    datasets: [{ data: [9, 10], backgroundColor: [swColors.teal, '#e0e0e0'], borderWidth: 2 }]
                },
                options: {
                    responsive: true, maintainAspectRatio: false,
                    plugins: {
                        legend: { position: 'bottom' },
                        datalabels: { display: true, font: { size: 15, weight: 'bold' }, color: '#333', formatter: (v, ctx) => [47.4, 52.6][ctx.dataIndex] + '%' }
                    }
                }
            });

            // E2 — Products Sold
            swChart('sw-chart-products', {
                type: 'bar',
                data: {
                    labels: ['Dried Seaweed', 'Raw Seaweed', 'Soap', 'Gel', 'Shampoo', 'Packaged', 'Other'],
                    datasets: [{
                        label: '% of Selling Groups',
                        data: [100, 55.6, 55.6, 44.4, 33.3, 11.1, 11.1],
                        backgroundColor: [swColors.tealDark, swColors.teal, swColors.accent1, swColors.accent2, swColors.blue, swColors.amber, '#e0e0e0']
                    }]
                },
                options: {
                    responsive: true, maintainAspectRatio: false,
                    plugins: {
                        legend: { display: false },
                        datalabels: { display: true, anchor: 'end', align: 'top', font: { size: 11, weight: 'bold' }, formatter: v => v + '%' }
                    },
                    scales: { y: { beginAtZero: true, max: 110, title: { display: true, text: 'Selling Groups (%)' } } }
                }
            });

            // E3 — Market Types
            swChart('sw-chart-markets', {
                type: 'bar',
                data: {
                    labels: ['Local Markets', 'Cooperative Sales', 'Direct to Buyers', 'Contracts', 'Export'],
                    datasets: [{
                        label: '% of Selling Groups',
                        data: [66.7, 44.4, 22.2, 0, 0],
                        backgroundColor: [swColors.tealDark, swColors.teal, swColors.accent1, '#e0e0e0', '#e0e0e0']
                    }]
                },
                options: {
                    responsive: true, maintainAspectRatio: false,
                    plugins: {
                        legend: { display: false },
                        datalabels: { display: true, anchor: 'end', align: 'top', font: { size: 13, weight: 'bold' }, formatter: v => v + '%' }
                    },
                    scales: { y: { beginAtZero: true, max: 80, title: { display: true, text: 'Selling Groups (%)' } } }
                }
            });

            // E4 — Commercialization Challenges
            swChart('sw-chart-comm-challenges', {
                type: 'bar',
                indexAxis: 'y',
                data: {
                    labels: ['Transport', 'Demand', 'Pricing', 'Packaging', 'Certification'],
                    datasets: [{
                        label: '% of Selling Groups',
                        data: [90, 80, 60, 40, 30],
                        backgroundColor: [swColors.red, swColors.orange, swColors.amber, swColors.teal, swColors.accent2]
                    }]
                },
                options: {
                    responsive: true, maintainAspectRatio: false,
                    plugins: {
                        legend: { display: false },
                        datalabels: { display: true, anchor: 'end', align: 'right', font: { size: 13, weight: 'bold' }, formatter: v => v + '%' }
                    },
                    scales: { x: { beginAtZero: true, max: 100, title: { display: true, text: 'Selling Groups (%)' } } }
                }
            });

            // E5 — Price Distribution
            swChart('sw-chart-price', {
                type: 'bar',
                data: {
                    labels: ['KES 30', 'KES 50', 'KES 100', 'KES 300'],
                    datasets: [{
                        label: 'Number of Groups',
                        data: [1, 6, 1, 1],
                        backgroundColor: [swColors.accent3, swColors.teal, swColors.tealDark, swColors.green]
                    }]
                },
                options: {
                    responsive: true, maintainAspectRatio: false,
                    plugins: {
                        legend: { display: false },
                        datalabels: { display: true, anchor: 'end', align: 'top', font: { size: 13, weight: 'bold' }, formatter: (v, ctx) => v + ' (' + [11.1, 66.7, 11.1, 11.1][ctx.dataIndex] + '%)' }
                    },
                    scales: { y: { beginAtZero: true, max: 10, title: { display: true, text: 'Number of Groups' } } }
                }
            });

            // E6 — Income Impact & Price Negotiation
            swChart('sw-chart-income-impact', {
                type: 'bar',
                data: {
                    labels: ['Improved Income/Savings', 'Negotiate Prices', 'Buyer-Fixed Price', 'Have Branding Strategy'],
                    datasets: [{
                        label: 'Groups (%)',
                        data: [70, 55.6, 44.4, 10],
                        backgroundColor: [swColors.green, swColors.teal, swColors.amber, swColors.red]
                    }]
                },
                options: {
                    responsive: true, maintainAspectRatio: false,
                    plugins: {
                        legend: { display: false },
                        datalabels: { display: true, anchor: 'end', align: 'top', font: { size: 13, weight: 'bold' }, formatter: v => v + '%' }
                    },
                    scales: { y: { beginAtZero: true, max: 100, title: { display: true, text: 'Percentage of Groups (%)' } } }
                }
            });

            // === TAB F: PARTNERSHIPS & FUTURE ===

            // F1 — Partners
            swChart('sw-chart-partners', {
                type: 'bar',
                data: {
                    labels: ['NGO', 'Government', 'Cooperative', 'Private Sector', 'None'],
                    datasets: [{
                        label: '% of Groups',
                        data: [63.2, 63.2, 31.6, 5.3, 15.8],
                        backgroundColor: [swColors.tealDark, swColors.blue, swColors.teal, swColors.accent2, '#e0e0e0']
                    }]
                },
                options: {
                    responsive: true, maintainAspectRatio: false,
                    plugins: {
                        legend: { display: false },
                        datalabels: { display: true, anchor: 'end', align: 'top', font: { size: 13, weight: 'bold' }, formatter: v => v + '%' }
                    },
                    scales: { y: { beginAtZero: true, max: 80, title: { display: true, text: 'Percentage of Groups (%)' } } }
                }
            });

            // F2 — Future Plans
            swChart('sw-chart-future', {
                type: 'bar',
                indexAxis: 'y',
                data: {
                    labels: ['Value Addition', 'Commercial Expansion', 'Training & Capacity', 'Infrastructure', 'Youth & Women Empowerment', 'Other'],
                    datasets: [{
                        label: 'Frequency (mentions)',
                        data: [30, 25, 20, 15, 10, 5],
                        backgroundColor: [swColors.tealDark, swColors.teal, swColors.accent1, swColors.blue, swColors.purple, '#e0e0e0']
                    }]
                },
                options: {
                    responsive: true, maintainAspectRatio: false,
                    plugins: {
                        legend: { display: false },
                        datalabels: { display: true, anchor: 'end', align: 'right', font: { size: 12, weight: 'bold' }, formatter: v => v }
                    },
                    scales: { x: { beginAtZero: true, title: { display: true, text: 'Mention Count' } } }
                }
            });

            // F3 — Critical Needs
            swChart('sw-chart-critical-needs', {
                type: 'bar',
                indexAxis: 'y',
                data: {
                    labels: ['Tools & Equipment', 'Training & Knowledge', 'Infrastructure', 'Market Access', 'Financial Support', 'Other'],
                    datasets: [{
                        label: 'Frequency (mentions)',
                        data: [35, 30, 25, 20, 10, 8],
                        backgroundColor: [swColors.tealDark, swColors.teal, swColors.accent1, swColors.blue, swColors.amber, '#e0e0e0']
                    }]
                },
                options: {
                    responsive: true, maintainAspectRatio: false,
                    plugins: {
                        legend: { display: false },
                        datalabels: { display: true, anchor: 'end', align: 'right', font: { size: 12, weight: 'bold' }, formatter: v => v }
                    },
                    scales: { x: { beginAtZero: true, title: { display: true, text: 'Mention Count' } } }
                }
            });

            // F4 — Formal Agreements
            swChart('sw-chart-agreements', {
                type: 'doughnut',
                data: {
                    labels: ['Formal Agreement', 'No Formal Agreement'],
                    datasets: [{ data: [1, 18], backgroundColor: [swColors.teal, swColors.red], borderWidth: 2 }]
                },
                options: {
                    responsive: true, maintainAspectRatio: false,
                    plugins: {
                        legend: { position: 'bottom' },
                        datalabels: { display: true, font: { size: 15, weight: 'bold' }, color: '#fff', formatter: (v, ctx) => [5.3, 94.7][ctx.dataIndex] + '%' }
                    }
                }
            });
        }

        // ====================================================================
        // ========== SEAWEED FARMER DASHBOARD — DATA & CHARTS ================
        // ====================================================================

        // --- Farmer-Level Data (335 farmers from Seaweed Data Collection_06.12.2025) ---
        const seaweedFarmerData = [
            {Group:'Bati Seaweed Group',Member:'2234_Baya_Nassoro',Ropes_Ocean:152,Ropes_Home:200,Ropes_Total:352,Target_Ropes:600,Gap:248,Dried_KG:556.0,Wet_KG:756.0,Total_KG:1312.0,Challenges:'',x:39.40041795,y:-4.606524459},
            {Group:'Mkwiro Seaweed Development Group',Member:'3650_Bathuli_Rashid_Kombo',Ropes_Ocean:45,Ropes_Home:50,Ropes_Total:95,Target_Ropes:300,Gap:205,Dried_KG:300.0,Wet_KG:175.0,Total_KG:475.0,Challenges:'',x:39.39567394,y:-4.67537987},
            {Group:'Mkwiro Seaweed Development Group',Member:'3648_Mwanakombo_Kopa_Hamisi',Ropes_Ocean:116,Ropes_Home:150,Ropes_Total:266,Target_Ropes:350,Gap:84,Dried_KG:350.0,Wet_KG:17.0,Total_KG:367.0,Challenges:'Long distance ,no farm tools,no market,low price of seaweeds',x:39.39615667,y:-4.675091667},
            {Group:'Tumbe Seaweed Farmers',Member:'2278_Mwanasiti_Mwalimu_Njia',Ropes_Ocean:54,Ropes_Home:6,Ropes_Total:60,Target_Ropes:800,Gap:740,Dried_KG:300.0,Wet_KG:58.0,Total_KG:358.0,Challenges:'',x:39.50314,y:-4.464371667},
            {Group:'Tumbe Seaweed Farmers',Member:'2297_Halima_Mwalimu_Njia',Ropes_Ocean:108,Ropes_Home:6,Ropes_Total:114,Target_Ropes:800,Gap:686,Dried_KG:300.0,Wet_KG:58.0,Total_KG:358.0,Challenges:'',x:39.503155,y:-4.464401667},
            {Group:'Tumbe Seaweed Farmers',Member:'2267_Mwanasiti_Hamisi_mwandundu',Ropes_Ocean:650,Ropes_Home:30,Ropes_Total:680,Target_Ropes:1000,Gap:320,Dried_KG:100.0,Wet_KG:250.0,Total_KG:350.0,Challenges:'',x:39.50295333,y:-4.464401667},
            {Group:'Mkwiro Seaweed Development Group',Member:'3645_Mkuu_Hamadi_Mrafi',Ropes_Ocean:210,Ropes_Home:55,Ropes_Total:265,Target_Ropes:350,Gap:85,Dried_KG:328.5,Wet_KG:17.0,Total_KG:345.5,Challenges:'Low price,poles,Distance,ropes,hat for sun,rain jacket,life jacket,magunia,mabanda yakuanikia mwani',x:39.39192135,y:-4.665279277},
            {Group:'Mkwiro Seaweed Development Group',Member:'3717_Lailatu_Mohamed_Tajiri',Ropes_Ocean:295,Ropes_Home:45,Ropes_Total:340,Target_Ropes:500,Gap:160,Dried_KG:300.0,Wet_KG:40.0,Total_KG:340.0,Challenges:'',x:39.39602462,y:-4.674478867},
            {Group:'Mkwiro Seaweed Development Group',Member:'3666_Memrihi_Mohammed_Zonga',Ropes_Ocean:80,Ropes_Home:71,Ropes_Total:151,Target_Ropes:350,Gap:199,Dried_KG:160.0,Wet_KG:170.0,Total_KG:330.0,Challenges:'',x:39.39686885,y:-4.674997017},
            {Group:'Tumbe Seaweed Farmers',Member:'2295_Zainab_salim_harun',Ropes_Ocean:57,Ropes_Home:53,Ropes_Total:110,Target_Ropes:650,Gap:540,Dried_KG:200.0,Wet_KG:102.0,Total_KG:302.0,Challenges:'Transportation',x:39.50191,y:-4.46307},
            {Group:'Mkwiro Seaweed Development Group',Member:'3667_Mwanambu_Mohamed_Omari',Ropes_Ocean:20,Ropes_Home:188,Ropes_Total:208,Target_Ropes:300,Gap:92,Dried_KG:281.0,Wet_KG:0.0,Total_KG:281.0,Challenges:'',x:39.39380632,y:-4.675746317},
            {Group:'Bati Seaweed Group',Member:'2232_Mwanaharusi_Hamadi_Nkulu',Ropes_Ocean:180,Ropes_Home:35,Ropes_Total:215,Target_Ropes:500,Gap:285,Dried_KG:110.0,Wet_KG:150.0,Total_KG:260.0,Challenges:'',x:39.39858667,y:-4.603913333},
            {Group:'Mkwiro Seaweed Development Group',Member:'3661_Mwanajumbe_Ali_Omari',Ropes_Ocean:49,Ropes_Home:74,Ropes_Total:123,Target_Ropes:300,Gap:177,Dried_KG:200.0,Wet_KG:25.0,Total_KG:225.0,Challenges:'Long distance,no farm tools,no market,bad wearther',x:39.39494333,y:-4.67539},
            {Group:'Mkwiro Seaweed Development Group',Member:'3671_Mwanasha_Mshamanga_Mshaali',Ropes_Ocean:36,Ropes_Home:35,Ropes_Total:71,Target_Ropes:300,Gap:229,Dried_KG:200.0,Wet_KG:21.0,Total_KG:221.0,Challenges:'Blaiming over sun on there farming area',x:39.39500914,y:-4.675865418},
            {Group:'Mkwiro Seaweed Development Group',Member:'3725_Mwanaisha_Mohamed_Hamisi',Ropes_Ocean:49,Ropes_Home:65,Ropes_Total:114,Target_Ropes:300,Gap:186,Dried_KG:200.0,Wet_KG:20.0,Total_KG:220.0,Challenges:'Long distance,no market,no farm tools',x:39.39492,y:-4.675383333},
            {Group:'Mkwiro Seaweed Development Group',Member:'3672_Mwanamvyawa_Mohamed_Hamisi',Ropes_Ocean:45,Ropes_Home:200,Ropes_Total:245,Target_Ropes:450,Gap:205,Dried_KG:175.0,Wet_KG:30.0,Total_KG:205.0,Challenges:'No',x:39.3956124,y:-4.675609318},
            {Group:'Mkwiro Seaweed Development Group',Member:'3703_Nuru_Alpha_Famau',Ropes_Ocean:24,Ropes_Home:39,Ropes_Total:63,Target_Ropes:300,Gap:237,Dried_KG:200.0,Wet_KG:0.0,Total_KG:200.0,Challenges:'Transport',x:39.39622735,y:-4.674361817},
            {Group:'Tumbe Seaweed Farmers',Member:'2303_Fatuma_kassim_chidagaya',Ropes_Ocean:130,Ropes_Home:30,Ropes_Total:160,Target_Ropes:1200,Gap:1040,Dried_KG:95.0,Wet_KG:100.0,Total_KG:195.0,Challenges:'',x:39.50292667,y:-4.464365},
            {Group:'Mkwiro Seaweed Development Group',Member:'3640_Mwanamkuu_Bakari_Mohammed',Ropes_Ocean:88,Ropes_Home:74,Ropes_Total:162,Target_Ropes:300,Gap:138,Dried_KG:194.0,Wet_KG:0.0,Total_KG:194.0,Challenges:'Long distance,no market,no farm tools',x:39.39714,y:-4.674853333},
            {Group:'Mkwiro Seaweed Development Group',Member:'3641_Khadhija_Afumani_Ngo\'nga',Ropes_Ocean:60,Ropes_Home:16,Ropes_Total:76,Target_Ropes:350,Gap:274,Dried_KG:175.0,Wet_KG:18.0,Total_KG:193.0,Challenges:'Lack of drying structure and low price',x:39.39563932,y:-4.675544683},
            {Group:'Tumbe Seaweed Farmers',Member:'2276_Asha_Yusuf_Kuweka',Ropes_Ocean:250,Ropes_Home:150,Ropes_Total:400,Target_Ropes:1500,Gap:1100,Dried_KG:90.0,Wet_KG:97.0,Total_KG:187.0,Challenges:'',x:39.50197,y:-4.46388},
            {Group:'Mkwiro Seaweed Development Group',Member:'3695_Makuta_Kassim_Kopa',Ropes_Ocean:80,Ropes_Home:11,Ropes_Total:91,Target_Ropes:300,Gap:209,Dried_KG:121.0,Wet_KG:60.0,Total_KG:181.0,Challenges:'',x:39.39142817,y:-4.675747417},
            {Group:'Mkwiro Seaweed Development Group',Member:'3652_Fatuma_Mbeta_Mutengo',Ropes_Ocean:60,Ropes_Home:133,Ropes_Total:193,Target_Ropes:300,Gap:107,Dried_KG:165.0,Wet_KG:14.5,Total_KG:179.5,Challenges:'In need of harvesting boats. Few pegs.',x:39.39660692,y:-4.672926985},
            {Group:'Tumbe Seaweed Farmers',Member:'2308_Rama_Mwinyi_Madzumba',Ropes_Ocean:225,Ropes_Home:29,Ropes_Total:254,Target_Ropes:600,Gap:346,Dried_KG:50.0,Wet_KG:125.0,Total_KG:175.0,Challenges:'',x:39.50241333,y:-4.463716667},
            {Group:'Mkwiro Seaweed Development Group',Member:'3712_Mwanamviwe_Kijembe_Lombo',Ropes_Ocean:41,Ropes_Home:45,Ropes_Total:86,Target_Ropes:200,Gap:114,Dried_KG:88.5,Wet_KG:84.0,Total_KG:172.5,Challenges:'No farm tools,long distance,no market',x:39.39579,y:-4.6759},
            {Group:'Mtimbwani Seaweed',Member:'2708_Juma_Hamisi_Maramtu',Ropes_Ocean:25,Ropes_Home:100,Ropes_Total:125,Target_Ropes:600,Gap:475,Dried_KG:154.0,Wet_KG:18.0,Total_KG:172.0,Challenges:'Inadequate taitai',x:39.29817525,y:-4.609360937},
            {Group:'Mkwiro Seaweed Development Group',Member:'3654_Makaje_Hamadi_Issa',Ropes_Ocean:200,Ropes_Home:50,Ropes_Total:250,Target_Ropes:300,Gap:50,Dried_KG:145.0,Wet_KG:25.0,Total_KG:170.0,Challenges:'',x:39.39398117,y:-4.676016},
            {Group:'Mkwiro Seaweed Development Group',Member:'3699_Mwanajumbe_Makame_Hamsa',Ropes_Ocean:45,Ropes_Home:50,Ropes_Total:95,Target_Ropes:300,Gap:205,Dried_KG:170.0,Wet_KG:0.0,Total_KG:170.0,Challenges:'Long distance,no farm tools,no market,low price',x:39.39571167,y:-4.675766667},
            {Group:'Mkwiro Seaweed Development Group',Member:'3674_Mwatime_Athumani_Ali',Ropes_Ocean:132,Ropes_Home:125,Ropes_Total:257,Target_Ropes:500,Gap:243,Dried_KG:150.0,Wet_KG:17.0,Total_KG:167.0,Challenges:'No',x:39.39540779,y:-4.676170827},
            {Group:'Mkwiro Seaweed Development Group',Member:'TBD_Rukia_Rashid',Ropes_Ocean:20,Ropes_Home:85,Ropes_Total:105,Target_Ropes:300,Gap:195,Dried_KG:148.5,Wet_KG:15.0,Total_KG:163.5,Challenges:'Transport,climate change',x:39.39624277,y:-4.675103183},
            {Group:'Mkwiro Seaweed Development Group',Member:'3704_Mwenesi_Salim_Mrafi',Ropes_Ocean:51,Ropes_Home:150,Ropes_Total:201,Target_Ropes:500,Gap:299,Dried_KG:125.0,Wet_KG:35.0,Total_KG:160.0,Challenges:'No',x:39.39544262,y:-4.676181607},
            {Group:'Mkwiro Seaweed Development Group',Member:'3716_Latiffa_Ali_Salim',Ropes_Ocean:0,Ropes_Home:150,Ropes_Total:150,Target_Ropes:300,Gap:150,Dried_KG:160.0,Wet_KG:0.0,Total_KG:160.0,Challenges:'Poor market and lack of drying fercilities',x:39.39506528,y:-4.676364217},
            {Group:'Mkwiro Seaweed Development Group',Member:'3720_Mwanambo_Pando_Mbaruku',Ropes_Ocean:150,Ropes_Home:60,Ropes_Total:210,Target_Ropes:300,Gap:90,Dried_KG:160.0,Wet_KG:0.0,Total_KG:160.0,Challenges:'Long distance,no farm tools,no market,bad wearther',x:39.397285,y:-4.674231667},
            {Group:'Tumbe Seaweed Farmers',Member:'2293_Fatuma_Kibwana_Mdondoo',Ropes_Ocean:250,Ropes_Home:120,Ropes_Total:370,Target_Ropes:300,Gap:-70,Dried_KG:90.0,Wet_KG:68.0,Total_KG:158.0,Challenges:'',x:39.502805,y:-4.464091667},
            {Group:'Mkwiro Seaweed Development Group',Member:'3665_Ali_Salim_Omar',Ropes_Ocean:22,Ropes_Home:125,Ropes_Total:147,Target_Ropes:300,Gap:153,Dried_KG:156.0,Wet_KG:0.0,Total_KG:156.0,Challenges:'',x:39.3953606,y:-4.6758782},
            {Group:'Mkwiro Seaweed Development Group',Member:'7238_Mwanakame_Hamisi_Gaba',Ropes_Ocean:37,Ropes_Home:63,Ropes_Total:100,Target_Ropes:300,Gap:200,Dried_KG:136.5,Wet_KG:15.0,Total_KG:151.5,Challenges:'Long distance,no market,no farm tools,rain coarts',x:39.396765,y:-4.674168333},
            {Group:'Tumbe Seaweed Farmers',Member:'2779_Abdhalla_Mahmood_Zinga',Ropes_Ocean:57,Ropes_Home:30,Ropes_Total:87,Target_Ropes:450,Gap:363,Dried_KG:150.0,Wet_KG:0.0,Total_KG:150.0,Challenges:'Transportation',x:39.50187,y:-4.463255},
            {Group:'Mkwiro Seaweed Development Group',Member:'3644_Mwashida_Muzingo_Juma',Ropes_Ocean:70,Ropes_Home:100,Ropes_Total:170,Target_Ropes:300,Gap:130,Dried_KG:130.0,Wet_KG:20.0,Total_KG:150.0,Challenges:'No',x:39.39700804,y:-4.668650327},
            {Group:'Mkwiro Seaweed Development Group',Member:'3685_Mwajumbe_Hussein_Mwalim',Ropes_Ocean:23,Ropes_Home:77,Ropes_Total:100,Target_Ropes:300,Gap:200,Dried_KG:93.0,Wet_KG:56.5,Total_KG:149.5,Challenges:'Poles,Gunia,Ropes,hat for sun,working tools,safety gears',x:39.39605481,y:-4.669321967},
            {Group:'Tumbe Seaweed Farmers',Member:'2291_mwanamkuu_Abdalla_Kibwebwe',Ropes_Ocean:190,Ropes_Home:19,Ropes_Total:209,Target_Ropes:300,Gap:91,Dried_KG:145.0,Wet_KG:0.0,Total_KG:145.0,Challenges:'1. Lack of labour 2. Transportation of harvested seeweed is a challenge',x:39.50232667,y:-4.463628333},
            {Group:'Mkwiro Seaweed Development Group',Member:'3657_Tima_Athumani_Shibani',Ropes_Ocean:100,Ropes_Home:15,Ropes_Total:115,Target_Ropes:300,Gap:185,Dried_KG:145.0,Wet_KG:0.0,Total_KG:145.0,Challenges:'Transport',x:39.39622373,y:-4.67438975},
            {Group:'Bati Seaweed Group',Member:'2217_Gombeni_Kitsao_Katoti',Ropes_Ocean:325,Ropes_Home:50,Ropes_Total:375,Target_Ropes:500,Gap:125,Dried_KG:115.0,Wet_KG:21.0,Total_KG:136.0,Challenges:'Labour',x:39.39843382,y:-4.603257883},
            {Group:'Mkwiro Seaweed Development Group',Member:'3700_Mariam_Famau_Shebwana',Ropes_Ocean:170,Ropes_Home:30,Ropes_Total:200,Target_Ropes:300,Gap:100,Dried_KG:135.0,Wet_KG:0.0,Total_KG:135.0,Challenges:'',x:39.3968443,y:-4.675256683},
            {Group:'Mkwiro Seaweed Development Group',Member:'3680_Fatuma_Chapoka_Mghala',Ropes_Ocean:24,Ropes_Home:50,Ropes_Total:74,Target_Ropes:300,Gap:226,Dried_KG:133.0,Wet_KG:0.0,Total_KG:133.0,Challenges:'In need of boat to transfer wet seaweed to the shoree',x:39.39202322,y:-4.67532696},
            {Group:'Mkwiro Seaweed Development Group',Member:'3707_Fatuma_Ali_Ng\'onga',Ropes_Ocean:59,Ropes_Home:2430,Ropes_Total:2489,Target_Ropes:300,Gap:-2189,Dried_KG:123.0,Wet_KG:6.0,Total_KG:129.0,Challenges:'No ropes',x:39.39391052,y:-4.67537313},
            {Group:'Mkwiro Seaweed Development Group',Member:'3735_Matogo_Mchambi_Dosa',Ropes_Ocean:35,Ropes_Home:25,Ropes_Total:60,Target_Ropes:300,Gap:240,Dried_KG:105.0,Wet_KG:24.0,Total_KG:129.0,Challenges:'Lack of market and poor fercilities',x:39.39215958,y:-4.675254633},
            {Group:'Mkwiro Seaweed Development Group',Member:'3713_Mzungu_Athuman_Ali',Ropes_Ocean:200,Ropes_Home:150,Ropes_Total:350,Target_Ropes:450,Gap:100,Dried_KG:102.0,Wet_KG:25.0,Total_KG:127.0,Challenges:'Complainiing on sun over there farming area',x:39.39723245,y:-4.674129587},
            {Group:'Tumbe Seaweed Farmers',Member:'2263_Fatuma_Ali_Mwabishu',Ropes_Ocean:30,Ropes_Home:12,Ropes_Total:42,Target_Ropes:225,Gap:183,Dried_KG:45.0,Wet_KG:80.0,Total_KG:125.0,Challenges:'',x:39.501725,y:-4.463348333},
            {Group:'Tumbe Seaweed Farmers',Member:'2287_mwanisho_dzila_mbuzi',Ropes_Ocean:50,Ropes_Home:30,Ropes_Total:80,Target_Ropes:255,Gap:175,Dried_KG:45.0,Wet_KG:80.0,Total_KG:125.0,Challenges:'',x:39.501725,y:-4.463348333},
            {Group:'Mkwiro Seaweed Development Group',Member:'3647_Mwanambu_Mohamed_Buda',Ropes_Ocean:82,Ropes_Home:93,Ropes_Total:175,Target_Ropes:500,Gap:325,Dried_KG:108.0,Wet_KG:17.0,Total_KG:125.0,Challenges:'Long distance,from home to the farm,no farm tools,',x:39.39656833,y:-4.67444},
            {Group:'Mkwiro Seaweed Development Group',Member:'3682_Mwamtama_Salim_Oloo',Ropes_Ocean:25,Ropes_Home:55,Ropes_Total:80,Target_Ropes:150,Gap:70,Dried_KG:119.0,Wet_KG:5.0,Total_KG:124.0,Challenges:'Distance,poles,ropes,safety gears.',x:39.39548477,y:-4.667344495},
            {Group:'Mkwiro Seaweed Development Group',Member:'6468_Rulia_Chapoka_Mgalla',Ropes_Ocean:19,Ropes_Home:31,Ropes_Total:50,Target_Ropes:200,Gap:150,Dried_KG:106.0,Wet_KG:14.0,Total_KG:120.0,Challenges:'Transport',x:39.39191228,y:-4.675347517},
            {Group:'Mkwiro Seaweed Development Group',Member:'3718_Zainab_Chapoka',Ropes_Ocean:60,Ropes_Home:90,Ropes_Total:150,Target_Ropes:500,Gap:350,Dried_KG:119.0,Wet_KG:0.0,Total_KG:119.0,Challenges:'Pegs,transport,ready market,low buying price',x:39.39653672,y:-4.674994933},
            {Group:'Mkwiro Seaweed Development Group',Member:'6473_Asia_Amini_Mbeta',Ropes_Ocean:53,Ropes_Home:120,Ropes_Total:173,Target_Ropes:300,Gap:127,Dried_KG:102.0,Wet_KG:15.0,Total_KG:117.0,Challenges:'No market for their products',x:39.39695294,y:-4.67385984},
            {Group:'Mkwiro Seaweed Development Group',Member:'6426_Maimuna_Fadhili_Ali',Ropes_Ocean:13,Ropes_Home:57,Ropes_Total:70,Target_Ropes:300,Gap:230,Dried_KG:55.0,Wet_KG:60.0,Total_KG:115.0,Challenges:'',x:39.39533072,y:-4.674133867},
            {Group:'Mkwiro Seaweed Development Group',Member:'3691_Mwatime_Omar_Omar',Ropes_Ocean:51,Ropes_Home:100,Ropes_Total:151,Target_Ropes:300,Gap:149,Dried_KG:61.0,Wet_KG:50.0,Total_KG:111.0,Challenges:'No',x:39.38111487,y:-4.647808531},
            {Group:'Bati Seaweed Group',Member:'2219_Fatuma_Masudi_Ayub',Ropes_Ocean:325,Ropes_Home:0,Ropes_Total:325,Target_Ropes:400,Gap:75,Dried_KG:40.0,Wet_KG:70.0,Total_KG:110.0,Challenges:'',x:39.39828,y:-4.60256},
            {Group:'Bati Seaweed Group',Member:'2240_Fatuma_Hamisi_Buguto',Ropes_Ocean:200,Ropes_Home:0,Ropes_Total:200,Target_Ropes:1000,Gap:800,Dried_KG:35.0,Wet_KG:73.0,Total_KG:108.0,Challenges:'',x:39.39834,y:-4.60287},
            {Group:'Mkwiro Seaweed Development Group',Member:'6457_Hafsa_Vuyaa_Harun',Ropes_Ocean:80,Ropes_Home:20,Ropes_Total:100,Target_Ropes:300,Gap:200,Dried_KG:107.5,Wet_KG:0.0,Total_KG:107.5,Challenges:'',x:39.39624028,y:-4.66300485},
            {Group:'Mkwiro Seaweed Development Group',Member:'3693_Amina_Ali_Omari',Ropes_Ocean:0,Ropes_Home:32,Ropes_Total:32,Target_Ropes:300,Gap:268,Dried_KG:104.0,Wet_KG:0.0,Total_KG:104.0,Challenges:'No safety gears and tools .',x:39.39586891,y:-4.67535675},
            {Group:'Mkwiro Seaweed Development Group',Member:'3670_Masika_Athmani_Ali',Ropes_Ocean:81,Ropes_Home:31,Ropes_Total:112,Target_Ropes:300,Gap:188,Dried_KG:85.0,Wet_KG:16.0,Total_KG:101.0,Challenges:'Poor market and lack of drying fercilities',x:39.39571832,y:-4.67588025},
            {Group:'Bati Seaweed Group',Member:'2203_Mohamed_Juma_Darusi',Ropes_Ocean:200,Ropes_Home:38,Ropes_Total:238,Target_Ropes:1000,Gap:762,Dried_KG:100.0,Wet_KG:0.0,Total_KG:100.0,Challenges:'Labour and means of transport',x:39.39846377,y:-4.60336575},
            {Group:'Mkwiro Seaweed Development Group',Member:'3678_Mwafatime_Mshamanga_Mtundi',Ropes_Ocean:30,Ropes_Home:50,Ropes_Total:80,Target_Ropes:300,Gap:220,Dried_KG:100.0,Wet_KG:0.0,Total_KG:100.0,Challenges:'Poles,safety gears,working tools,she suposed to labour someone she\'s very old 72 yrs of age',x:39.39461437,y:-4.668026054},
            {Group:'Mkwiro Seaweed Development Group',Member:'3722_Mwatime_Mshamanga_Mshaaali',Ropes_Ocean:90,Ropes_Home:300,Ropes_Total:390,Target_Ropes:500,Gap:110,Dried_KG:100.0,Wet_KG:0.0,Total_KG:100.0,Challenges:'No marketing',x:39.34115734,y:-4.637760041},
            {Group:'Mkwiro Seaweed Development Group',Member:'6430_Mwamkuu_Chapoka_Mgalla',Ropes_Ocean:35,Ropes_Home:35,Ropes_Total:70,Target_Ropes:200,Gap:130,Dried_KG:83.0,Wet_KG:17.0,Total_KG:100.0,Challenges:'Distance,ropes,poles',x:39.39452273,y:-4.663665594},
            {Group:'Mkwiro Seaweed Development Group',Member:'3724_Ropa_Mohamed_Hassan',Ropes_Ocean:86,Ropes_Home:12,Ropes_Total:98,Target_Ropes:600,Gap:502,Dried_KG:99.0,Wet_KG:0.0,Total_KG:99.0,Challenges:'Drying sheds,low buying price',x:39.39273697,y:-4.6759721},
            {Group:'Mkwiro Seaweed Development Group',Member:'7304_Zainabu_Mwishima_Hamisi',Ropes_Ocean:37,Ropes_Home:68,Ropes_Total:105,Target_Ropes:300,Gap:195,Dried_KG:93.0,Wet_KG:5.0,Total_KG:98.0,Challenges:'Transportation',x:39.39409108,y:-4.675597517},
            {Group:'Mkwiro Seaweed Development Group',Member:'3663_Hasina_Hemedi_Mwalola',Ropes_Ocean:70,Ropes_Home:22,Ropes_Total:92,Target_Ropes:300,Gap:208,Dried_KG:81.0,Wet_KG:15.0,Total_KG:96.0,Challenges:'Low price and lack of drying structure',x:39.39569057,y:-4.67462205},
            {Group:'Mkwiro Seaweed Development Group',Member:'3664_Bishekue_Ali_Muhidini',Ropes_Ocean:292,Ropes_Home:8,Ropes_Total:300,Target_Ropes:500,Gap:200,Dried_KG:96.0,Wet_KG:0.0,Total_KG:96.0,Challenges:'',x:39.39624028,y:-4.66300485},
            {Group:'Mkwiro Seaweed Development Group',Member:'3679_Mwanamvua_Mtwana_Hassan',Ropes_Ocean:51,Ropes_Home:242,Ropes_Total:293,Target_Ropes:400,Gap:107,Dried_KG:71.0,Wet_KG:22.0,Total_KG:93.0,Challenges:'No',x:39.39693629,y:-4.668568862},
            {Group:'Tumbe Seaweed Farmers',Member:'2271_Asha_Ali_Omar',Ropes_Ocean:208,Ropes_Home:65,Ropes_Total:273,Target_Ropes:600,Gap:327,Dried_KG:27.0,Wet_KG:64.0,Total_KG:91.0,Challenges:'During dry season of ice ice the production of seaweed is low',x:39.50193167,y:-4.46291},
            {Group:'Bati Seaweed Group',Member:'2178_Mariam_Bakari_Masudi',Ropes_Ocean:100,Ropes_Home:50,Ropes_Total:150,Target_Ropes:20,Gap:-130,Dried_KG:30.0,Wet_KG:60.0,Total_KG:90.0,Challenges:'',x:39.37189048,y:-4.537019581},
            {Group:'Tumbe Seaweed Farmers',Member:'2292_Mwalimu_Bakari_Shee',Ropes_Ocean:83,Ropes_Home:25,Ropes_Total:108,Target_Ropes:500,Gap:392,Dried_KG:55.0,Wet_KG:34.0,Total_KG:89.0,Challenges:'Transportation',x:39.50197833,y:-4.462086667},
            {Group:'Mkwiro Seaweed Development Group',Member:'3662_Mwatime_Salim_Shebwana',Ropes_Ocean:100,Ropes_Home:251,Ropes_Total:351,Target_Ropes:200,Gap:-151,Dried_KG:73.0,Wet_KG:15.0,Total_KG:88.0,Challenges:'Boat for recurrying seaweed to there home',x:39.39723722,y:-4.674120465},
            {Group:'Bati Seaweed Group',Member:'2236_Fatuma_Juma',Ropes_Ocean:50,Ropes_Home:200,Ropes_Total:250,Target_Ropes:1000,Gap:750,Dried_KG:46.0,Wet_KG:40.0,Total_KG:86.0,Challenges:'',x:39.39887,y:-4.60412},
            {Group:'Tumbe Seaweed Farmers',Member:'2283_Mwanakombo_Rashid_Njama',Ropes_Ocean:80,Ropes_Home:25,Ropes_Total:105,Target_Ropes:300,Gap:195,Dried_KG:25.0,Wet_KG:60.0,Total_KG:85.0,Challenges:'Transportation',x:39.50182333,y:-4.462578333},
            {Group:'Bati Seaweed Group',Member:'2285_Mariamu_Fundi_Darusi',Ropes_Ocean:33,Ropes_Home:120,Ropes_Total:153,Target_Ropes:200,Gap:47,Dried_KG:83.0,Wet_KG:0.0,Total_KG:83.0,Challenges:'Labour',x:39.39825867,y:-4.60381775},
            {Group:'Mtimbwani Seaweed',Member:'2454_Juma_Mohamed_Hamisi',Ropes_Ocean:50,Ropes_Home:175,Ropes_Total:225,Target_Ropes:1200,Gap:975,Dried_KG:65.0,Wet_KG:17.0,Total_KG:82.0,Challenges:'Alot of sand,inadequate taitai and ropes,lack of farm tools like shoes,lack of storage',x:39.29883633,y:-4.609748223},
            {Group:'Bati Seaweed Group',Member:'2290_Mwajumbe_Masudi_Hussein',Ropes_Ocean:100,Ropes_Home:139,Ropes_Total:239,Target_Ropes:200,Gap:-39,Dried_KG:2.0,Wet_KG:79.0,Total_KG:81.0,Challenges:'*Labour *food *Single mother *house',x:39.39942,y:-4.60675},
            {Group:'Bati Seaweed Group',Member:'2830_Marinda_Omari_Mwashete',Ropes_Ocean:101,Ropes_Home:99,Ropes_Total:200,Target_Ropes:300,Gap:100,Dried_KG:80.0,Wet_KG:0.0,Total_KG:80.0,Challenges:'',x:39.398225,y:-4.602125},
            {Group:'Mkwiro Seaweed Development Group',Member:'3646_Mwanapili_Bakari_Mohammed',Ropes_Ocean:40,Ropes_Home:80,Ropes_Total:120,Target_Ropes:200,Gap:80,Dried_KG:80.0,Wet_KG:0.0,Total_KG:80.0,Challenges:'No',x:39.39717302,y:-4.674083315},
            {Group:'Bati Seaweed Group',Member:'2199_Mwanakombo_Shee_Bakari',Ropes_Ocean:200,Ropes_Home:0,Ropes_Total:200,Target_Ropes:1000,Gap:800,Dried_KG:77.0,Wet_KG:0.0,Total_KG:77.0,Challenges:'',x:39.39845,y:-4.60337},
            {Group:'Tumbe Seaweed Farmers',Member:'2302_Mwanakombo_Ningome_Hamisi',Ropes_Ocean:40,Ropes_Home:15,Ropes_Total:55,Target_Ropes:300,Gap:245,Dried_KG:25.0,Wet_KG:52.0,Total_KG:77.0,Challenges:'Transportation',x:39.50206667,y:-4.463625},
            {Group:'Tumbe Seaweed Farmers',Member:'6284_Mwanajuma_Salim_Haruni',Ropes_Ocean:45,Ropes_Home:33,Ropes_Total:78,Target_Ropes:200,Gap:122,Dried_KG:72.5,Wet_KG:0.0,Total_KG:72.5,Challenges:'1. Transportation of harvested seeweed is a major challenge',x:39.501745,y:-4.46321},
            {Group:'Tumbe Seaweed Farmers',Member:'2288_Mwanakombo_Hassani_Njama',Ropes_Ocean:74,Ropes_Home:28,Ropes_Total:102,Target_Ropes:300,Gap:198,Dried_KG:20.0,Wet_KG:52.0,Total_KG:72.0,Challenges:'Transport',x:39.50237167,y:-4.460755},
            {Group:'Mtimbwani Seaweed',Member:'2443_Mwanasiti_Hussein_Mwagoli',Ropes_Ocean:52,Ropes_Home:50,Ropes_Total:102,Target_Ropes:600,Gap:498,Dried_KG:20.0,Wet_KG:52.0,Total_KG:72.0,Challenges:'Taitai',x:39.29973333,y:-4.610458333},
            {Group:'Mkwiro Seaweed Development Group',Member:'3719_Mwamizee_Mwalola_Hemedi',Ropes_Ocean:8,Ropes_Home:35,Ropes_Total:43,Target_Ropes:200,Gap:157,Dried_KG:63.0,Wet_KG:8.0,Total_KG:71.0,Challenges:'Poles,working tools,safety gears,Distance from farming area on how to carry her sea weed during planting period and after harvesting',x:39.39822287,y:-4.66459061},
            {Group:'Mkwiro Seaweed Development Group',Member:'6444_Hamisi_Omar_Parago',Ropes_Ocean:60,Ropes_Home:16,Ropes_Total:76,Target_Ropes:300,Gap:224,Dried_KG:52.0,Wet_KG:19.0,Total_KG:71.0,Challenges:'',x:39.39590835,y:-4.6754287},
            {Group:'Mkwiro Seaweed Development Group',Member:'3690_Mwamkasi_Mbaruku_Omar',Ropes_Ocean:27,Ropes_Home:73,Ropes_Total:100,Target_Ropes:250,Gap:150,Dried_KG:55.0,Wet_KG:15.0,Total_KG:70.0,Challenges:'Poles,gum boots,working tools',x:39.39373356,y:-4.664144364},
            {Group:'Tumbe Seaweed Farmers',Member:'2286_Asha_Rashid_Mwanjama',Ropes_Ocean:50,Ropes_Home:30,Ropes_Total:80,Target_Ropes:450,Gap:370,Dried_KG:15.0,Wet_KG:53.0,Total_KG:68.0,Challenges:'Transportation of the seaweed from the ocean',x:39.501655,y:-4.46324},
            {Group:'Tumbe Seaweed Farmers',Member:'7553_Mwanamisi_Rama_Madzumba',Ropes_Ocean:29,Ropes_Home:29,Ropes_Total:58,Target_Ropes:300,Gap:242,Dried_KG:68.0,Wet_KG:0.0,Total_KG:68.0,Challenges:'1. Lack of labour 2. Transportation of seeweed from the ocean to home is a challenge',x:39.50249,y:-4.463853333},
            {Group:'Mkwiro Seaweed Development Group',Member:'3714_Mwanaisha_Omari_Makame',Ropes_Ocean:237,Ropes_Home:13,Ropes_Total:250,Target_Ropes:300,Gap:50,Dried_KG:56.0,Wet_KG:11.5,Total_KG:67.5,Challenges:'Long distance  ,no farm tools,',x:39.39605167,y:-4.675635},
            {Group:'Mkwiro Seaweed Development Group',Member:'3731_Mwamkasi_Ali_Parago',Ropes_Ocean:9,Ropes_Home:200,Ropes_Total:209,Target_Ropes:300,Gap:91,Dried_KG:49.5,Wet_KG:16.0,Total_KG:65.5,Challenges:'Distance,poles,ropes,gum boots,magunia',x:39.39650984,y:-4.66183198},
            {Group:'Mkwiro Seaweed Development Group',Member:'TBD_Mwanamisi_Mohamed',Ropes_Ocean:15,Ropes_Home:30,Ropes_Total:45,Target_Ropes:300,Gap:255,Dried_KG:65.5,Wet_KG:0.0,Total_KG:65.5,Challenges:'transport',x:39.39407143,y:-4.675700117},
            {Group:'Mtimbwani Seaweed',Member:'2442_Mwajumbe_Mohamed_At',Ropes_Ocean:42,Ropes_Home:70,Ropes_Total:112,Target_Ropes:500,Gap:388,Dried_KG:43.0,Wet_KG:21.0,Total_KG:64.0,Challenges:'Lack of Taitai,lack of equipments lack hammers,lack of gumboost,lack of floaters',x:39.29805681,y:-4.609200591},
            {Group:'Mkwiro Seaweed Development Group',Member:'3639_Mzungu_Mohamed_Dossa',Ropes_Ocean:31,Ropes_Home:32,Ropes_Total:63,Target_Ropes:300,Gap:237,Dried_KG:64.0,Wet_KG:0.0,Total_KG:64.0,Challenges:'Transport',x:39.3953561,y:-4.675277167},
            {Group:'Furaha Seaweed Group',Member:'1206_Fatuma_Saidi_Maburuki',Ropes_Ocean:54,Ropes_Home:10,Ropes_Total:64,Target_Ropes:300,Gap:236,Dried_KG:45.0,Wet_KG:17.8,Total_KG:62.8,Challenges:'',x:39.42817,y:-4.578288333},
            {Group:'Mtimbwani Seaweed',Member:'2448_Mwajumbe_Mohamed_Shee',Ropes_Ocean:50,Ropes_Home:75,Ropes_Total:125,Target_Ropes:300,Gap:175,Dried_KG:43.0,Wet_KG:19.0,Total_KG:62.0,Challenges:'Late harvest due to unavailability of boat,sand covering the seaweed',x:39.29819888,y:-4.609318189},
            {Group:'Mtimbwani Seaweed',Member:'2425_Mwajumbe_Hamisi_Mwariale',Ropes_Ocean:16,Ropes_Home:136,Ropes_Total:152,Target_Ropes:600,Gap:448,Dried_KG:40.0,Wet_KG:21.0,Total_KG:61.0,Challenges:'Tearing of the seaweed and drifting away due to late harvest',x:39.29832227,y:-4.609370115},
            {Group:'Tumbe Seaweed Farmers',Member:'9351_Mwanajuma_Mwabishu_Mbuzi',Ropes_Ocean:115,Ropes_Home:11,Ropes_Total:126,Target_Ropes:600,Gap:474,Dried_KG:41.0,Wet_KG:20.0,Total_KG:61.0,Challenges:'Transportation',x:39.50152833,y:-4.463226667},
            {Group:'Bati Seaweed Group',Member:'2227_Riziki_Darusi_Kassim',Ropes_Ocean:235,Ropes_Home:300,Ropes_Total:535,Target_Ropes:600,Gap:65,Dried_KG:60.0,Wet_KG:0.0,Total_KG:60.0,Challenges:'235',x:39.39991333,y:-4.605795},
            {Group:'Mkwiro Seaweed Development Group',Member:'6449_Mwapamvu_Mshamanga_Neema',Ropes_Ocean:46,Ropes_Home:24,Ropes_Total:70,Target_Ropes:250,Gap:180,Dried_KG:60.0,Wet_KG:0.0,Total_KG:60.0,Challenges:'No',x:39.39720784,y:-4.67411497},
            {Group:'Tumbe Seaweed Farmers',Member:'TBD_Mwanakombo_Bakari',Ropes_Ocean:50,Ropes_Home:5,Ropes_Total:55,Target_Ropes:300,Gap:245,Dried_KG:20.0,Wet_KG:40.0,Total_KG:60.0,Challenges:'Transportation',x:39.50172167,y:-4.462406667},
            {Group:'Mkwiro Seaweed Development Group',Member:'3675_Mwanaisha_Juma_Makame',Ropes_Ocean:16,Ropes_Home:100,Ropes_Total:116,Target_Ropes:250,Gap:134,Dried_KG:41.0,Wet_KG:17.0,Total_KG:58.0,Challenges:'Distance,poles,working tools,magunia',x:39.39470684,y:-4.664650873},
            {Group:'Mkwiro Seaweed Development Group',Member:'3727_Khadija_Mohamed_Dossa',Ropes_Ocean:54,Ropes_Home:25,Ropes_Total:79,Target_Ropes:350,Gap:271,Dried_KG:57.0,Wet_KG:0.0,Total_KG:57.0,Challenges:'',x:39.3964579,y:-4.674767267},
            {Group:'Mtimbwani Seaweed',Member:'2430_Mwanasiti_Hamisi_Mwariale',Ropes_Ocean:96,Ropes_Home:84,Ropes_Total:180,Target_Ropes:600,Gap:420,Dried_KG:28.0,Wet_KG:28.0,Total_KG:56.0,Challenges:'Taitai,store, distancr from home to landing site',x:39.298625,y:-4.609888333},
            {Group:'Mkwiro Seaweed Development Group',Member:'3694_Mwajuma_Mkandi_Mshomanga',Ropes_Ocean:8,Ropes_Home:40,Ropes_Total:48,Target_Ropes:100,Gap:52,Dried_KG:55.0,Wet_KG:0.0,Total_KG:55.0,Challenges:'Poles,working tools,safety gears',x:39.39414128,y:-4.664125229},
            {Group:'Mtimbwani Seaweed',Member:'2426_Juma_Mzee_Mwavumbo',Ropes_Ocean:41,Ropes_Home:109,Ropes_Total:150,Target_Ropes:500,Gap:350,Dried_KG:20.0,Wet_KG:34.0,Total_KG:54.0,Challenges:'Alot of sand,not enough taitai',x:39.29902123,y:-4.609721652},
            {Group:'Tumbe Seaweed Farmers',Member:'2306_Riziki_Mwinyi_Mwakuluzo',Ropes_Ocean:67,Ropes_Home:5,Ropes_Total:72,Target_Ropes:250,Gap:178,Dried_KG:53.5,Wet_KG:0.0,Total_KG:53.5,Challenges:'1. Transporting harvested seeweed from the ocean to home is the main challenge. 2. Lack of labour force',x:39.50280333,y:-4.463826667},
            {Group:'Tumbe Seaweed Farmers',Member:'TBD_Suleiman_Hassan',Ropes_Ocean:67,Ropes_Home:5,Ropes_Total:72,Target_Ropes:250,Gap:178,Dried_KG:53.0,Wet_KG:0.0,Total_KG:53.0,Challenges:'Transportation of seeweed from the ocean to home is the challenge',x:39.5028,y:-4.463801667},
            {Group:'Mtimbwani Seaweed',Member:'2436_Mwanamisi_Hassan_Nassoro',Ropes_Ocean:49,Ropes_Home:80,Ropes_Total:129,Target_Ropes:400,Gap:271,Dried_KG:33.0,Wet_KG:17.0,Total_KG:50.0,Challenges:'Tsitai, extra roped',x:39.29859,y:-4.609418333},
            {Group:'Bati Seaweed Group',Member:'2824_Bimmanga_Makame_Pili',Ropes_Ocean:80,Ropes_Home:22,Ropes_Total:102,Target_Ropes:150,Gap:48,Dried_KG:50.0,Wet_KG:0.0,Total_KG:50.0,Challenges:'Maji kikata kamba, maumivu',x:39.39895389,y:-4.60463258},
            {Group:'Bati Seaweed Group',Member:'2835_Rashid_Kassim_Rashid',Ropes_Ocean:50,Ropes_Home:40,Ropes_Total:90,Target_Ropes:500,Gap:410,Dried_KG:50.0,Wet_KG:0.0,Total_KG:50.0,Challenges:'farmer need tools for their farm',x:39.39800667,y:-4.603455},
            {Group:'Bati Seaweed Group',Member:'6624_Omar_Nassoro_Mwakuwasa',Ropes_Ocean:60,Ropes_Home:150,Ropes_Total:210,Target_Ropes:300,Gap:90,Dried_KG:50.0,Wet_KG:0.0,Total_KG:50.0,Challenges:'The group faces challenges in securing reliable markets for their dried seaweed.',x:39.39840333,y:-4.603176667},
            {Group:'Tumbe Seaweed Farmers',Member:'2279_Mwatime_Hussein_Njama',Ropes_Ocean:83,Ropes_Home:25,Ropes_Total:108,Target_Ropes:250,Gap:142,Dried_KG:48.5,Wet_KG:0.0,Total_KG:48.5,Challenges:'1. Transportation of harvested seeweed from the ocean to home is a big challenge.  2. The fish feed om the ropes.',x:39.50183,y:-4.461866667},
            {Group:'Tumbe Seaweed Farmers',Member:'TBD_Swaleh_Rashid',Ropes_Ocean:200,Ropes_Home:70,Ropes_Total:270,Target_Ropes:300,Gap:30,Dried_KG:35.0,Wet_KG:13.0,Total_KG:48.0,Challenges:'',x:39.50256833,y:-4.464248333},
            {Group:'Bati Seaweed Group',Member:'2832_Hussein_Hassan_Benzalambi',Ropes_Ocean:150,Ropes_Home:50,Ropes_Total:200,Target_Ropes:250,Gap:50,Dried_KG:7.0,Wet_KG:40.0,Total_KG:47.0,Challenges:'Labour',x:39.39965125,y:-4.605820783},
            {Group:'Mkwiro Seaweed Development Group',Member:'3651_Sofia_Ali_Famaus',Ropes_Ocean:10,Ropes_Home:71,Ropes_Total:81,Target_Ropes:300,Gap:219,Dried_KG:46.5,Wet_KG:0.0,Total_KG:46.5,Challenges:'Lack of planting strocks,transportation',x:39.39173048,y:-4.67560975},
            {Group:'Tumbe Seaweed Farmers',Member:'2275_Mwasiti_Mshee',Ropes_Ocean:182,Ropes_Home:27,Ropes_Total:209,Target_Ropes:300,Gap:91,Dried_KG:46.0,Wet_KG:0.0,Total_KG:46.0,Challenges:'1. Cost of trsnsporting harvested seeweed is a challenge.',x:39.50287833,y:-4.463901667},
            {Group:'Mtimbwani Seaweed',Member:'2432_Mwamize_Faki_Mrafi',Ropes_Ocean:51,Ropes_Home:71,Ropes_Total:122,Target_Ropes:300,Gap:178,Dried_KG:23.0,Wet_KG:21.0,Total_KG:44.0,Challenges:'Climste, Tie tie',x:39.298955,y:-4.609763333},
            {Group:'Tumbe Seaweed Farmers',Member:'2272_mwanamisi_hamisi_vinyu',Ropes_Ocean:89,Ropes_Home:14,Ropes_Total:103,Target_Ropes:500,Gap:397,Dried_KG:14.5,Wet_KG:29.0,Total_KG:43.5,Challenges:'1. Seeweed being swept away by tides.',x:39.50229333,y:-4.460546667},
            {Group:'Mtimbwani Seaweed',Member:'2439_Meshee_Mrafu_Mbwana',Ropes_Ocean:44,Ropes_Home:80,Ropes_Total:124,Target_Ropes:600,Gap:476,Dried_KG:21.0,Wet_KG:21.0,Total_KG:42.0,Challenges:'Alot of sand,lack of taitai,strong heat,seaweed disease',x:39.298966,y:-4.60968121},
            {Group:'Bati Seaweed Group',Member:'2182_Zawadi_Mohamed_Hassan',Ropes_Ocean:94,Ropes_Home:111,Ropes_Total:205,Target_Ropes:300,Gap:95,Dried_KG:41.0,Wet_KG:0.0,Total_KG:41.0,Challenges:'',x:39.39764,y:-4.601171667},
            {Group:'Mtimbwani Seaweed',Member:'2423_Mwaziza_Mwamtaka_Gobo',Ropes_Ocean:50,Ropes_Home:75,Ropes_Total:125,Target_Ropes:400,Gap:275,Dried_KG:36.0,Wet_KG:4.0,Total_KG:40.0,Challenges:'Roprs, Taitai, Boots',x:39.29884,y:-4.609541667},
            {Group:'Mkwiro Seaweed Development Group',Member:'3730_Mwajuma_Hariri_Makame',Ropes_Ocean:64,Ropes_Home:6,Ropes_Total:70,Target_Ropes:250,Gap:180,Dried_KG:37.0,Wet_KG:3.0,Total_KG:40.0,Challenges:'Poles,safety gears,poles',x:39.39322403,y:-4.66682963},
            {Group:'Bati Seaweed Group',Member:'Shukura Kirua',Ropes_Ocean:120,Ropes_Home:80,Ropes_Total:200,Target_Ropes:300,Gap:100,Dried_KG:40.0,Wet_KG:0.0,Total_KG:40.0,Challenges:'seaweed being damage by ISI',x:39.398205,y:-4.602198333},
            {Group:'Bati Seaweed Group',Member:'TBD_Mwajumbe_Kitaure',Ropes_Ocean:73,Ropes_Home:50,Ropes_Total:123,Target_Ropes:300,Gap:177,Dried_KG:40.0,Wet_KG:0.0,Total_KG:40.0,Challenges:'',x:39.39877667,y:-4.603913333},
            {Group:'Mkwiro Seaweed Development Group',Member:'3692_Fatuma_Fadhili_Ali',Ropes_Ocean:27,Ropes_Home:10,Ropes_Total:37,Target_Ropes:200,Gap:163,Dried_KG:19.0,Wet_KG:20.0,Total_KG:39.0,Challenges:'No ropes and taitai',x:39.39562719,y:-4.67350864},
            {Group:'Mkwiro Seaweed Development Group',Member:'3723_Sofia_Mohamed_Mtwana',Ropes_Ocean:38,Ropes_Home:12,Ropes_Total:50,Target_Ropes:300,Gap:250,Dried_KG:23.0,Wet_KG:13.5,Total_KG:36.5,Challenges:'Transport',x:39.39402032,y:-4.675599417},
            {Group:'Bati Seaweed Group',Member:'2238_Omar_Bakari_Kitauro',Ropes_Ocean:70,Ropes_Home:130,Ropes_Total:200,Target_Ropes:300,Gap:100,Dried_KG:35.0,Wet_KG:0.0,Total_KG:35.0,Challenges:'',x:39.39824333,y:-4.60389},
            {Group:'Mtimbwani Seaweed',Member:'2451_Mwanasha_Twahiri_Bakari',Ropes_Ocean:45,Ropes_Home:80,Ropes_Total:125,Target_Ropes:600,Gap:475,Dried_KG:14.0,Wet_KG:21.0,Total_KG:35.0,Challenges:'Taitsi',x:39.2987,y:-4.609563333},
            {Group:'Mkwiro Seaweed Development Group',Member:'3702_Halima_Mohamed_Kirozo',Ropes_Ocean:20,Ropes_Home:30,Ropes_Total:50,Target_Ropes:300,Gap:250,Dried_KG:34.0,Wet_KG:0.0,Total_KG:34.0,Challenges:'',x:39.39673872,y:-4.674954367},
            {Group:'Mkwiro Seaweed Development Group',Member:'3734_Athumani_Adam_Mwaita',Ropes_Ocean:60,Ropes_Home:12,Ropes_Total:72,Target_Ropes:300,Gap:228,Dried_KG:34.0,Wet_KG:0.0,Total_KG:34.0,Challenges:'Driers for drying seaweed',x:39.39382965,y:-4.67611399},
            {Group:'Mkwiro Seaweed Development Group',Member:'6485_Vuyaa_Ali_Omar',Ropes_Ocean:32,Ropes_Home:24,Ropes_Total:56,Target_Ropes:300,Gap:244,Dried_KG:33.0,Wet_KG:0.0,Total_KG:33.0,Challenges:'transport, equipments ,drying space',x:39.39179115,y:-4.676354833},
            {Group:'Mtimbwani Seaweed',Member:'2433_Rama_Hassan_Nassoro',Ropes_Ocean:21,Ropes_Home:112,Ropes_Total:133,Target_Ropes:1000,Gap:867,Dried_KG:7.5,Wet_KG:25.0,Total_KG:32.5,Challenges:'1. A storage area for keeping the seaweed (store).   2. The seaweed seedlings are very few, so they need more seedlings.   3. Equipment that will enable them to work easily, such as ropes, taitai, gumboots, raincoats, machetes for cutting stakes, and crow',x:39.298585,y:-4.610031667},
            {Group:'Mtimbwani Seaweed',Member:'2428_Mwandazi_Hassan_Ali',Ropes_Ocean:50,Ropes_Home:60,Ropes_Total:110,Target_Ropes:600,Gap:490,Dried_KG:17.0,Wet_KG:15.0,Total_KG:32.0,Challenges:'Tsitai',x:39.29862333,y:-4.60946},
            {Group:'Mtimbwani Seaweed',Member:'2453_Marinda_Kassim_Hamisi',Ropes_Ocean:38,Ropes_Home:95,Ropes_Total:133,Target_Ropes:600,Gap:467,Dried_KG:16.0,Wet_KG:16.0,Total_KG:32.0,Challenges:'Lack of taitai,Unavailability of boats causing late harvest,lack of storage facilities, long distance from home to the farm,',x:39.29851907,y:-4.609804046},
            {Group:'Mtimbwani Seaweed',Member:'2456_Mwanakombo_Mohamed_Mwabwambwi',Ropes_Ocean:50,Ropes_Home:63,Ropes_Total:113,Target_Ropes:500,Gap:387,Dried_KG:18.0,Wet_KG:14.0,Total_KG:32.0,Challenges:'Taitai',x:39.29876667,y:-4.609453333},
            {Group:'Tumbe Seaweed Farmers',Member:'2786_Mariam_Ramadhani_Wesa',Ropes_Ocean:23,Ropes_Home:2,Ropes_Total:25,Target_Ropes:300,Gap:275,Dried_KG:31.5,Wet_KG:0.0,Total_KG:31.5,Challenges:'Transportation of harvested seeweed is the main challenge',x:39.502075,y:-4.463451667},
            {Group:'Mkwiro Seaweed Development Group',Member:'3706_Mwanamisi_Chizi_Mshahame',Ropes_Ocean:80,Ropes_Home:17,Ropes_Total:97,Target_Ropes:350,Gap:253,Dried_KG:30.5,Wet_KG:0.0,Total_KG:30.5,Challenges:'',x:39.39394668,y:-4.675959233},
            {Group:'Bati Seaweed Group',Member:'2223_Sakina_Dharosi_Twahir',Ropes_Ocean:44,Ropes_Home:200,Ropes_Total:244,Target_Ropes:500,Gap:256,Dried_KG:30.0,Wet_KG:0.0,Total_KG:30.0,Challenges:'The group faces challenges in securing reliable markets for their dried seaweed.',x:39.39802833,y:-4.60138},
            {Group:'Mtimbwani Seaweed',Member:'2434_Tima_Mohamed_Mwanziwi',Ropes_Ocean:25,Ropes_Home:120,Ropes_Total:145,Target_Ropes:400,Gap:255,Dried_KG:30.0,Wet_KG:0.0,Total_KG:30.0,Challenges:'1. A storage area for keeping the seaweed (store).   2. The seaweed seedlings are very few, so they need more seedlings.   3. Equipment that will enable them to work easily, such as ropes, taitai, gumboots, raincoats, machetes for cutting stakes, and crow',x:39.29883833,y:-4.609785},
            {Group:'Tumbe Seaweed Farmers',Member:'2780_Said_Hassan_Jamanda',Ropes_Ocean:31,Ropes_Home:34,Ropes_Total:65,Target_Ropes:300,Gap:235,Dried_KG:30.0,Wet_KG:0.0,Total_KG:30.0,Challenges:'Transportation',x:39.50182167,y:-4.463448333},
            {Group:'Bati Seaweed Group',Member:'3386_Sofia_Abdallah_Bakari',Ropes_Ocean:151,Ropes_Home:80,Ropes_Total:231,Target_Ropes:300,Gap:69,Dried_KG:30.0,Wet_KG:0.0,Total_KG:30.0,Challenges:'',x:39.3997,y:-4.605956667},
            {Group:'Bati Seaweed Group',Member:'Saumu Abdallah',Ropes_Ocean:64,Ropes_Home:88,Ropes_Total:152,Target_Ropes:300,Gap:148,Dried_KG:30.0,Wet_KG:0.0,Total_KG:30.0,Challenges:'The group faces challenges in securing reliable markets for their dried seaweed.',x:39.39815833,y:-4.602828333},
            {Group:'Mkwiro Seaweed Development Group',Member:'3660_Mwajuma_Ali_Mshamanga',Ropes_Ocean:29,Ropes_Home:0,Ropes_Total:29,Target_Ropes:100,Gap:71,Dried_KG:29.0,Wet_KG:0.0,Total_KG:29.0,Challenges:'',x:39.3940781,y:-4.665671122},
            {Group:'Bati Seaweed Group',Member:'2235_Amina_Bakari_Kassim',Ropes_Ocean:60,Ropes_Home:26,Ropes_Total:86,Target_Ropes:500,Gap:414,Dried_KG:25.0,Wet_KG:0.0,Total_KG:25.0,Challenges:'',x:39.39851,y:-4.60365},
            {Group:'Mtimbwani Seaweed',Member:'2455_Hadija_Ali_Zonzo',Ropes_Ocean:23,Ropes_Home:150,Ropes_Total:173,Target_Ropes:600,Gap:427,Dried_KG:25.0,Wet_KG:0.0,Total_KG:25.0,Challenges:'Lack of storage,taitai,ropes',x:39.29972674,y:-4.610442915},
            {Group:'Bati Seaweed Group',Member:'2839_Mwanajuma_Husseein_Mwachafu',Ropes_Ocean:184,Ropes_Home:90,Ropes_Total:274,Target_Ropes:700,Gap:426,Dried_KG:25.0,Wet_KG:0.0,Total_KG:25.0,Challenges:'waves lack of toilets',x:39.39951619,y:-4.597403449},
            {Group:'Mtimbwani Seaweed',Member:'2429_Tima_Kassim_Mwamguza',Ropes_Ocean:32,Ropes_Home:93,Ropes_Total:125,Target_Ropes:400,Gap:275,Dried_KG:9.0,Wet_KG:15.0,Total_KG:24.0,Challenges:'1. A storage area for keeping the seaweed (store).   2. The seaweed seedlings are very few, so they need more seedlings.   3. Equipment that will enable them to work easily, such as ropes, taitai, gumboots, raincoats, machetes for cutting stakes, and crow',x:39.2989,y:-4.60951},
            {Group:'Mtimbwani Seaweed',Member:'2424_Mwanalima_Nassoro_Alawe',Ropes_Ocean:27,Ropes_Home:95,Ropes_Total:122,Target_Ropes:300,Gap:178,Dried_KG:3.0,Wet_KG:19.0,Total_KG:22.0,Challenges:'Kamba, taitai',x:39.297895,y:-4.609053333},
            {Group:'Bati Seaweed Group',Member:'2819_Meraji_Athumani_Kalamu',Ropes_Ocean:65,Ropes_Home:110,Ropes_Total:175,Target_Ropes:400,Gap:225,Dried_KG:9.0,Wet_KG:13.0,Total_KG:22.0,Challenges:'Labour  and food',x:39.39986878,y:-4.605771567},
            {Group:'Mkwiro Seaweed Development Group',Member:'3709_Mwanamini_Makame_Hassan',Ropes_Ocean:56,Ropes_Home:13,Ropes_Total:69,Target_Ropes:600,Gap:531,Dried_KG:5.0,Wet_KG:17.0,Total_KG:22.0,Challenges:'No farm tools,no ropes,low price of seaweed',x:39.397565,y:-4.67423},
            {Group:'Bati Seaweed Group',Member:'2815_Kijole_Hamadi_Barua',Ropes_Ocean:20,Ropes_Home:25,Ropes_Total:45,Target_Ropes:100,Gap:55,Dried_KG:21.0,Wet_KG:0.0,Total_KG:21.0,Challenges:'Labour',x:39.39935123,y:-4.6059182},
            {Group:'Mtimbwani Seaweed',Member:'7030_Fatuma_Mzee_Mwavumbo',Ropes_Ocean:32,Ropes_Home:37,Ropes_Total:69,Target_Ropes:300,Gap:231,Dried_KG:13.0,Wet_KG:8.0,Total_KG:21.0,Challenges:'Alot of sand,lack of shoes',x:39.29898963,y:-4.60965313},
            {Group:'Mtimbwani Seaweed',Member:'2437_Hadija_Abdallah_Wangocho',Ropes_Ocean:30,Ropes_Home:95,Ropes_Total:125,Target_Ropes:500,Gap:375,Dried_KG:2.0,Wet_KG:18.0,Total_KG:20.0,Challenges:'Alot of sand,farm tools like hammer,shoes,inadequate taitai',x:39.29864103,y:-4.60950959},
            {Group:'Mtimbwani Seaweed',Member:'2441_Saumu_Ngare_Karuwala',Ropes_Ocean:25,Ropes_Home:100,Ropes_Total:125,Target_Ropes:400,Gap:275,Dried_KG:20.0,Wet_KG:0.0,Total_KG:20.0,Challenges:'1. A storage area for keeping the seaweed (store).   2. The seaweed seedlings are very few, so they need more seedlings.   3. Equipment that will enable them to work easily, such as ropes, taitai, gumboots, raincoats, machetes for cutting stakes, and crow',x:39.29885667,y:-4.609805},
            {Group:'Mtimbwani Seaweed',Member:'2450_Mwanaisha_Mohamed_Sefu',Ropes_Ocean:36,Ropes_Home:117,Ropes_Total:153,Target_Ropes:600,Gap:447,Dried_KG:4.0,Wet_KG:16.0,Total_KG:20.0,Challenges:'Tietie',x:39.298955,y:-4.609763333},
            {Group:'Mkwiro Seaweed Development Group',Member:'3655_Faida_Bakari_Mohamed',Ropes_Ocean:30,Ropes_Home:30,Ropes_Total:60,Target_Ropes:300,Gap:240,Dried_KG:10.0,Wet_KG:10.0,Total_KG:20.0,Challenges:'No safety gears, tools and seedlings',x:39.39619427,y:-4.674821621},
            {Group:'Tumbe Seaweed Farmers',Member:'2298_Fatuma_Mshee_Gungu',Ropes_Ocean:98,Ropes_Home:128,Ropes_Total:226,Target_Ropes:400,Gap:174,Dried_KG:0.0,Wet_KG:19.0,Total_KG:19.0,Challenges:'',x:39.50178333,y:-4.462626667},
            {Group:'Mtimbwani Seaweed',Member:'2444_Masudi_Bakari_Mwasupi',Ropes_Ocean:26,Ropes_Home:99,Ropes_Total:125,Target_Ropes:300,Gap:175,Dried_KG:10.0,Wet_KG:9.0,Total_KG:19.0,Challenges:'Lack of taitai and ropes,lack of gumboots,lack of hammer',x:39.29878604,y:-4.609447648},
            {Group:'Bati Seaweed Group',Member:'9005_Fauzia_Juma__Mwalimu',Ropes_Ocean:90,Ropes_Home:70,Ropes_Total:160,Target_Ropes:400,Gap:240,Dried_KG:18.0,Wet_KG:0.0,Total_KG:18.0,Challenges:'',x:39.39832,y:-4.60359},
            {Group:'Bati Seaweed Group',Member:'2296_Zawadi_Mohamed_Bakuli',Ropes_Ocean:50,Ropes_Home:50,Ropes_Total:100,Target_Ropes:300,Gap:200,Dried_KG:18.0,Wet_KG:0.0,Total_KG:18.0,Challenges:'',x:39.40029333,y:-4.606288333},
            {Group:'Tumbe Seaweed Farmers',Member:'2313_Hemedi_Hamisi_Rashid',Ropes_Ocean:36,Ropes_Home:83,Ropes_Total:119,Target_Ropes:300,Gap:181,Dried_KG:18.0,Wet_KG:0.0,Total_KG:18.0,Challenges:'',x:39.50226667,y:-4.460863333},
            {Group:'Mtimbwani Seaweed',Member:'2438_Mwandazi_Hamisi_Masudi',Ropes_Ocean:41,Ropes_Home:60,Ropes_Total:101,Target_Ropes:600,Gap:499,Dried_KG:18.0,Wet_KG:0.0,Total_KG:18.0,Challenges:'',x:39.29852167,y:-4.609343333},
            {Group:'Bati Seaweed Group',Member:'2829_Zumo_Kassim_Rashidi',Ropes_Ocean:126,Ropes_Home:150,Ropes_Total:276,Target_Ropes:300,Gap:24,Dried_KG:18.0,Wet_KG:0.0,Total_KG:18.0,Challenges:'The group faces challenges in securing reliable markets for their dried seaweed.',x:39.39837667,y:-4.601838333},
            {Group:'Furaha Seaweed Group',Member:'1195_Aisha_Pandu_Vuyaa',Ropes_Ocean:27,Ropes_Home:4,Ropes_Total:31,Target_Ropes:300,Gap:269,Dried_KG:13.0,Wet_KG:4.0,Total_KG:17.0,Challenges:'Mabadiliko ya hali ya hanga(jua kali)',x:39.428535,y:-4.578473333},
            {Group:'Tumbe Seaweed Farmers',Member:'2268_Mwanapili_Nyondo_Mrisa',Ropes_Ocean:57,Ropes_Home:12,Ropes_Total:69,Target_Ropes:300,Gap:231,Dried_KG:0.0,Wet_KG:17.0,Total_KG:17.0,Challenges:'Transportation of harvested seeweed is the main challenge',x:39.50221333,y:-4.461015},
            {Group:'Mtimbwani Seaweed',Member:'2457_Omari_Hamisi_Mwaramtu',Ropes_Ocean:42,Ropes_Home:133,Ropes_Total:175,Target_Ropes:600,Gap:425,Dried_KG:0.0,Wet_KG:17.0,Total_KG:17.0,Challenges:'Tsitsi,Ropes,Storsgr',x:39.29975333,y:-4.610413333},
            {Group:'Furaha Seaweed Group',Member:'2788_Meame_Omar_Badi',Ropes_Ocean:27,Ropes_Home:4,Ropes_Total:31,Target_Ropes:300,Gap:269,Dried_KG:13.0,Wet_KG:4.0,Total_KG:17.0,Challenges:'',x:39.42844333,y:-4.578531667},
            {Group:'Furaha Seaweed Group',Member:'1244_Bibi_Sharifu_Mafiu',Ropes_Ocean:27,Ropes_Home:4,Ropes_Total:31,Target_Ropes:300,Gap:269,Dried_KG:12.5,Wet_KG:4.0,Total_KG:16.5,Challenges:'',x:39.42850667,y:-4.578525},
            {Group:'Furaha Seaweed Group',Member:'1276_Mwanaisha_Vuyaa_Hando',Ropes_Ocean:27,Ropes_Home:4,Ropes_Total:31,Target_Ropes:300,Gap:269,Dried_KG:12.5,Wet_KG:4.0,Total_KG:16.5,Challenges:'Ice ice desease destroy the seaweed',x:39.42855025,y:-4.578431383},
            {Group:'Furaha Seaweed Group',Member:'1284_Mwatime_Muhammed_Ali',Ropes_Ocean:27,Ropes_Home:4,Ropes_Total:31,Target_Ropes:300,Gap:269,Dried_KG:12.5,Wet_KG:4.0,Total_KG:16.5,Challenges:'Unavailability of marketing',x:39.4612075,y:-4.509745453},
            {Group:'Furaha Seaweed Group',Member:'1319_Mesembe_Kipusa_Bwaga',Ropes_Ocean:27,Ropes_Home:4,Ropes_Total:31,Target_Ropes:300,Gap:269,Dried_KG:12.5,Wet_KG:4.0,Total_KG:16.5,Challenges:'Lack of Chaga,we need mordern method of drying our seaweeds',x:39.4276146,y:-4.577539817},
            {Group:'Furaha Seaweed Group',Member:'1253_Rukiya_Vuyaa_Pandu',Ropes_Ocean:27,Ropes_Home:4,Ropes_Total:31,Target_Ropes:300,Gap:269,Dried_KG:12.0,Wet_KG:4.0,Total_KG:16.0,Challenges:'6.strong water current that leds to seaweeds swept fro the farms',x:39.42836317,y:-4.57855245},
            {Group:'Bati Seaweed Group',Member:'2828_Marinda_Ali_Mwishee',Ropes_Ocean:143,Ropes_Home:42,Ropes_Total:185,Target_Ropes:500,Gap:315,Dried_KG:16.0,Wet_KG:0.0,Total_KG:16.0,Challenges:'labour,Shoes and raincoat',x:39.39901873,y:-4.60486925},
            {Group:'Bati Seaweed Group',Member:'2212_Mwanamisi_Abas',Ropes_Ocean:150,Ropes_Home:80,Ropes_Total:230,Target_Ropes:300,Gap:70,Dried_KG:15.0,Wet_KG:0.0,Total_KG:15.0,Challenges:'',x:39.39859833,y:-4.60389},
            {Group:'Mkwiro Seaweed Development Group',Member:'TBD_Idrisa_Ali',Ropes_Ocean:40,Ropes_Home:30,Ropes_Total:70,Target_Ropes:300,Gap:230,Dried_KG:15.0,Wet_KG:0.0,Total_KG:15.0,Challenges:'Transport,equioments',x:39.39663153,y:-4.6755275},
            {Group:'Furaha Seaweed Group',Member:'1248_Mwanahawa_Kijembe_Mohamed',Ropes_Ocean:11,Ropes_Home:29,Ropes_Total:40,Target_Ropes:300,Gap:260,Dried_KG:14.0,Wet_KG:0.0,Total_KG:14.0,Challenges:'Climate change6.strong water current that leds to seaweeds swept fro the farms',x:39.42879075,y:-4.579235467},
            {Group:'Furaha Seaweed Group',Member:'1310_Mwenesi_Darusi_N/A',Ropes_Ocean:30,Ropes_Home:12,Ropes_Total:42,Target_Ropes:300,Gap:258,Dried_KG:14.0,Wet_KG:0.0,Total_KG:14.0,Challenges:'Poor marketing1.umwanted weeds scattered the seaweeds,transport to and fro the farm',x:39.43345892,y:-4.575552383},
            {Group:'Mtimbwani Seaweed',Member:'2452_Ali_Kassim_Rashid',Ropes_Ocean:27,Ropes_Home:100,Ropes_Total:127,Target_Ropes:600,Gap:473,Dried_KG:0.0,Wet_KG:14.0,Total_KG:14.0,Challenges:'Theft ,alot of sand, weather conditions',x:39.29851497,y:-4.609274017},
            {Group:'Furaha Seaweed Group',Member:'2791_Mbaruk_Yusuf_Juma',Ropes_Ocean:11,Ropes_Home:5,Ropes_Total:16,Target_Ropes:300,Gap:284,Dried_KG:13.0,Wet_KG:0.0,Total_KG:13.0,Challenges:'',x:39.43348167,y:-4.575185},
            {Group:'Furaha Seaweed Group',Member:'6713_Mwanache_Said_Mohamed',Ropes_Ocean:13,Ropes_Home:5,Ropes_Total:18,Target_Ropes:300,Gap:282,Dried_KG:13.0,Wet_KG:0.0,Total_KG:13.0,Challenges:'',x:39.43344,y:-4.575088333},
            {Group:'Tumbe Seaweed Farmers',Member:'2312_Ashura_Shee_Boi',Ropes_Ocean:51,Ropes_Home:50,Ropes_Total:101,Target_Ropes:600,Gap:499,Dried_KG:12.0,Wet_KG:0.0,Total_KG:12.0,Challenges:'Transportation of seaweed from the ocean',x:39.50236833,y:-4.460991667},
            {Group:'Tumbe Seaweed Farmers',Member:'2781_Riziki_Bakari_Tuwa',Ropes_Ocean:42,Ropes_Home:5,Ropes_Total:47,Target_Ropes:300,Gap:253,Dried_KG:12.0,Wet_KG:0.0,Total_KG:12.0,Challenges:'Transportation of harvested seeweed is a challenge',x:39.5023,y:-4.460448333},
            {Group:'Bati Seaweed Group',Member:'2248_Marinda_Bakari',Ropes_Ocean:55,Ropes_Home:200,Ropes_Total:255,Target_Ropes:300,Gap:45,Dried_KG:11.0,Wet_KG:0.0,Total_KG:11.0,Challenges:'Labour',x:39.39767688,y:-4.601308383},
            {Group:'Furaha Seaweed Group',Member:'1299_Mwanvyawa_Bakari_Fikirini',Ropes_Ocean:11,Ropes_Home:5,Ropes_Total:16,Target_Ropes:300,Gap:284,Dried_KG:4.0,Wet_KG:6.0,Total_KG:10.0,Challenges:'Lack of harvesting boats',x:39.43344777,y:-4.575071617},
            {Group:'Furaha Seaweed Group',Member:'1329_Mwanavyawa_Mohamed_Kombo',Ropes_Ocean:9,Ropes_Home:8,Ropes_Total:17,Target_Ropes:300,Gap:283,Dried_KG:10.0,Wet_KG:0.0,Total_KG:10.0,Challenges:'Seacreatures',x:39.42837167,y:-4.5784},
            {Group:'Bati Seaweed Group',Member:'2185_Mwanasiti_Mkulu',Ropes_Ocean:40,Ropes_Home:150,Ropes_Total:190,Target_Ropes:300,Gap:110,Dried_KG:10.0,Wet_KG:0.0,Total_KG:10.0,Challenges:'',x:39.39857167,y:-4.603898333},
            {Group:'Bati Seaweed Group',Member:'2239_Salama_Mkulu_Kuleni',Ropes_Ocean:50,Ropes_Home:200,Ropes_Total:250,Target_Ropes:500,Gap:250,Dried_KG:0.0,Wet_KG:10.0,Total_KG:10.0,Challenges:'The group faces challenges in securing reliable markets for their dried seaweed.',x:39.39804833,y:-4.601083333},
            {Group:'Tumbe Seaweed Farmers',Member:'2314_Saidi_Ali_Yanga',Ropes_Ocean:25,Ropes_Home:14,Ropes_Total:39,Target_Ropes:300,Gap:261,Dried_KG:10.0,Wet_KG:0.0,Total_KG:10.0,Challenges:'Transportation of seaweed',x:39.50292167,y:-4.464318333},
            {Group:'Bati Seaweed Group',Member:'9012_Salama__Mkulu__Hussein_',Ropes_Ocean:21,Ropes_Home:200,Ropes_Total:221,Target_Ropes:300,Gap:79,Dried_KG:10.0,Wet_KG:0.0,Total_KG:10.0,Challenges:'The group faces challenges in securing reliable markets for their dried seaweed.',x:39.397475,y:-4.6011},
            {Group:'Furaha Seaweed Group',Member:'1191_Mwanate_Rashid_Ngenya',Ropes_Ocean:18,Ropes_Home:10,Ropes_Total:28,Target_Ropes:500,Gap:472,Dried_KG:9.0,Wet_KG:0.0,Total_KG:9.0,Challenges:'',x:39.42894,y:-4.57941},
            {Group:'Furaha Seaweed Group',Member:'1215_Mwanasha_Masai_Kiruwa',Ropes_Ocean:10,Ropes_Home:8,Ropes_Total:18,Target_Ropes:300,Gap:282,Dried_KG:9.0,Wet_KG:0.0,Total_KG:9.0,Challenges:'Seedlings,ice-ice',x:39.42833,y:-4.578388333},
            {Group:'Furaha Seaweed Group',Member:'1292_Nyebwana_Said_Rashid',Ropes_Ocean:9,Ropes_Home:8,Ropes_Total:17,Target_Ropes:300,Gap:283,Dried_KG:9.0,Wet_KG:0.0,Total_KG:9.0,Challenges:'Harvesting boats',x:39.42837167,y:-4.5784},
            {Group:'Furaha Seaweed Group',Member:'1358_Mwanamboni_Mohamed_Kombo',Ropes_Ocean:10,Ropes_Home:9,Ropes_Total:19,Target_Ropes:300,Gap:281,Dried_KG:9.0,Wet_KG:0.0,Total_KG:9.0,Challenges:'Climate change',x:39.42833167,y:-4.57842},
            {Group:'Mtimbwani Seaweed',Member:'2435_Mohamed_Mohamed_Hamisi',Ropes_Ocean:31,Ropes_Home:119,Ropes_Total:150,Target_Ropes:400,Gap:250,Dried_KG:9.0,Wet_KG:0.0,Total_KG:9.0,Challenges:'Seaweed disease (iceice),lack of taitai,lack of farm equipments like shoes,knives,',x:39.29781415,y:-4.608942471},
            {Group:'Mtimbwani Seaweed',Member:'2440_Mwanamgeni_Mohamed_Mwinyihaji',Ropes_Ocean:36,Ropes_Home:75,Ropes_Total:111,Target_Ropes:600,Gap:489,Dried_KG:9.0,Wet_KG:0.0,Total_KG:9.0,Challenges:'Taitai',x:39.29966333,y:-4.610305},
            {Group:'Furaha Seaweed Group',Member:'1306_Mimi_Said',Ropes_Ocean:19,Ropes_Home:5,Ropes_Total:24,Target_Ropes:300,Gap:276,Dried_KG:8.0,Wet_KG:0.0,Total_KG:8.0,Challenges:'Koya',x:39.42864667,y:-4.578988333},
            {Group:'Furaha Seaweed Group',Member:'6759_Mashamba_Said',Ropes_Ocean:19,Ropes_Home:5,Ropes_Total:24,Target_Ropes:300,Gap:276,Dried_KG:8.0,Wet_KG:0.0,Total_KG:8.0,Challenges:'Equipments',x:39.42862,y:-4.57891},
            {Group:'Furaha Seaweed Group',Member:'1200_Mwanasiti_Rashid_Genya',Ropes_Ocean:18,Ropes_Home:18,Ropes_Total:36,Target_Ropes:400,Gap:364,Dried_KG:7.0,Wet_KG:0.0,Total_KG:7.0,Challenges:'Unwanted weeds',x:39.42883,y:-4.579553333},
            {Group:'Furaha Seaweed Group',Member:'1269_Madina_Said_Muhammed',Ropes_Ocean:7,Ropes_Home:5,Ropes_Total:12,Target_Ropes:300,Gap:288,Dried_KG:4.0,Wet_KG:3.0,Total_KG:7.0,Challenges:'Mchanga unafukia kamba',x:39.42890833,y:-4.579275},
            {Group:'Furaha Seaweed Group',Member:'6720_Mariam_Said_Mohamed',Ropes_Ocean:7,Ropes_Home:5,Ropes_Total:12,Target_Ropes:300,Gap:288,Dried_KG:4.0,Wet_KG:3.0,Total_KG:7.0,Challenges:'',x:39.42879167,y:-4.579261667},
            {Group:'Furaha Seaweed Group',Member:'6739_Amina_Janga_Tajiri',Ropes_Ocean:7,Ropes_Home:5,Ropes_Total:12,Target_Ropes:300,Gap:288,Dried_KG:4.0,Wet_KG:3.0,Total_KG:7.0,Challenges:'',x:39.42887,y:-4.57929},
            {Group:'Mtimbwani Seaweed',Member:'TBD Mwanakombo Ramah Hasan',Ropes_Ocean:5,Ropes_Home:90,Ropes_Total:95,Target_Ropes:400,Gap:305,Dried_KG:7.0,Wet_KG:0.0,Total_KG:7.0,Challenges:'1. A storage area for keeping the seaweed (store).   2. The seaweed seedlings are very few, so they need more seedlings.   3. Equipment that will enable them to work easily, such as ropes, taitai, gumboots, raincoats, machetes for cutting stakes, and crow',x:39.299635,y:-4.610346667},
            {Group:'Mtimbwani Seaweed',Member:'2431_Abdalla_Mohammed_Hamisi',Ropes_Ocean:9,Ropes_Home:82,Ropes_Total:91,Target_Ropes:1000,Gap:909,Dried_KG:6.0,Wet_KG:0.0,Total_KG:6.0,Challenges:'Inadequate taitai,lack of life jackets',x:39.2997228,y:-4.610441448},
            {Group:'Furaha Seaweed Group',Member:'2787_Fatuma_Yusuf',Ropes_Ocean:25,Ropes_Home:10,Ropes_Total:35,Target_Ropes:400,Gap:365,Dried_KG:3.0,Wet_KG:3.0,Total_KG:6.0,Challenges:'Ice-ice diseases  ,Climate change can lead   poor harvesting',x:39.42805005,y:-4.57805165},
            {Group:'Tushirikiane Conservation Women',Member:'6592_Mwanarusi_Ali_Budzuma',Ropes_Ocean:6,Ropes_Home:4,Ropes_Total:10,Target_Ropes:40,Gap:30,Dried_KG:3.5,Wet_KG:1.85,Total_KG:5.35,Challenges:'1.lack of means of transport both to the ocean and to the storage center.    2. Lack of adequate training on seaweed production',x:39.42385333,y:-4.5546},
            {Group:'Tushirikiane Conservation Women',Member:'1987_mwanamusa_mtengo_rashid',Ropes_Ocean:6,Ropes_Home:4,Ropes_Total:10,Target_Ropes:30,Gap:20,Dried_KG:3.5,Wet_KG:1.8,Total_KG:5.3,Challenges:'Lack of Proper training and skills on seaweed production',x:39.42406978,y:-4.565092093},
            {Group:'Tushirikiane Conservation Women',Member:'2027_Mwanasha_Hassan_Mshenga',Ropes_Ocean:6,Ropes_Home:4,Ropes_Total:10,Target_Ropes:45,Gap:35,Dried_KG:3.5,Wet_KG:1.8,Total_KG:5.3,Challenges:'1. Lack of self means of transport therefore causing delays.  2. Poor storage facilities  3. Inadequate safety tools',x:39.42389833,y:-4.554661667},
            {Group:'Furaha Seaweed Group',Member:'1325_Mwanamisi_Zuberi',Ropes_Ocean:20,Ropes_Home:7,Ropes_Total:27,Target_Ropes:400,Gap:373,Dried_KG:3.0,Wet_KG:2.0,Total_KG:5.0,Challenges:'Sand beach',x:39.42814167,y:-4.578171667},
            {Group:'Mtimbwani Seaweed',Member:'2447_Nzito_Gobo_Mwamtaka',Ropes_Ocean:25,Ropes_Home:135,Ropes_Total:160,Target_Ropes:400,Gap:240,Dried_KG:5.0,Wet_KG:0.0,Total_KG:5.0,Challenges:'Taitai',x:39.298805,y:-4.609746667},
            {Group:'Bati Seaweed Group',Member:'2822_Mwanasha_Mazudi_Mazudi',Ropes_Ocean:20,Ropes_Home:150,Ropes_Total:170,Target_Ropes:300,Gap:130,Dried_KG:5.0,Wet_KG:0.0,Total_KG:5.0,Challenges:'',x:39.39821,y:-4.602403333},
            {Group:'Bati Seaweed Group',Member:'3385_Darusi_Mkulu_Mwariale',Ropes_Ocean:151,Ropes_Home:20,Ropes_Total:171,Target_Ropes:300,Gap:129,Dried_KG:1.0,Wet_KG:3.0,Total_KG:4.0,Challenges:'Mwani kupelekwa na maji',x:39.3992926,y:-4.605356189},
            {Group:'Furaha Seaweed Group',Member:'1222_Tims_Said_Mohamed',Ropes_Ocean:9,Ropes_Home:5,Ropes_Total:14,Target_Ropes:300,Gap:286,Dried_KG:3.0,Wet_KG:0.0,Total_KG:3.0,Challenges:'',x:39.42862333,y:-4.578921667},
            {Group:'Furaha Seaweed Group',Member:'1226_Kulthum_Said_Mohamed',Ropes_Ocean:9,Ropes_Home:5,Ropes_Total:14,Target_Ropes:300,Gap:286,Dried_KG:3.0,Wet_KG:0.0,Total_KG:3.0,Challenges:'Msimu wa baafua wakulima hawafiki shamban',x:39.42871333,y:-4.578846667},
            {Group:'Bati Seaweed Group',Member:'3384_Luvuno_Mbetsa_Nyae',Ropes_Ocean:151,Ropes_Home:40,Ropes_Total:191,Target_Ropes:300,Gap:109,Dried_KG:1.0,Wet_KG:2.0,Total_KG:3.0,Challenges:'Pelekwa na upepon maji',x:39.39920601,y:-4.60524404},
            {Group:'Yungi Mwenjeni Conservation Group',Member:'1159_Hadija_Omari',Ropes_Ocean:37,Ropes_Home:10,Ropes_Total:47,Target_Ropes:200,Gap:153,Dried_KG:2.8,Wet_KG:0.0,Total_KG:2.8,Challenges:'They have no casual workers, so they carry the heavy, wet seaweed bags by themselves, and the distance from the seaweed farm to their village is very long.  They do not have enough skills in seaweed farming, and they need more training.  They do not have',x:39.31111841,y:-4.584287102},
            {Group:'Yungi Mwenjeni Conservation Group',Member:'1118_Alawe_Hassan_Chombo',Ropes_Ocean:37,Ropes_Home:20,Ropes_Total:57,Target_Ropes:100,Gap:43,Dried_KG:2.8,Wet_KG:0.0,Total_KG:2.8,Challenges:'They have no casual workers, so they carry the heavy, wet seaweed bags by themselves, and the distance from the seaweed farm to their village is very long.  They do not have enough skills in seaweed farming, and they need more training.  They do not have',x:39.31099914,y:-4.584332448},
            {Group:'Yungi Mwenjeni Conservation Group',Member:'1121_Mbeyu_Mwavuo_Mejuma',Ropes_Ocean:37,Ropes_Home:10,Ropes_Total:47,Target_Ropes:200,Gap:153,Dried_KG:2.8,Wet_KG:0.0,Total_KG:2.8,Challenges:'They have no casual workers, so they carry the heavy, wet seaweed bags by themselves, and the distance from the seaweed farm to their village is very long.  They do not have enough skills in seaweed farming, and they need more training.  They do not have',x:39.31105094,y:-4.584269878},
            {Group:'Yungi Mwenjeni Conservation Group',Member:'1124_Bakari_Ali_Hassan',Ropes_Ocean:37,Ropes_Home:20,Ropes_Total:57,Target_Ropes:250,Gap:193,Dried_KG:2.8,Wet_KG:0.0,Total_KG:2.8,Challenges:'They have no casual workers, so they carry the heavy, wet seaweed bags by themselves, and the distance from the seaweed farm to their village is very long.  They do not have enough skills in seaweed farming, and they need more training.  They do not have',x:39.31100283,y:-4.58430219},
            {Group:'Yungi Mwenjeni Conservation Group',Member:'1127_Chiriro_Nyanje_Bemboga',Ropes_Ocean:37,Ropes_Home:22,Ropes_Total:59,Target_Ropes:200,Gap:141,Dried_KG:2.8,Wet_KG:0.0,Total_KG:2.8,Challenges:'They have no casual workers, so they carry the heavy, wet seaweed bags by themselves, and the distance from the seaweed farm to their village is very long.  They do not have enough skills in seaweed farming, and they need more training.  They do not have',x:39.3110475,y:-4.584332029},
            {Group:'Yungi Mwenjeni Conservation Group',Member:'1129_Fumo_Mnyero_Fumo',Ropes_Ocean:37,Ropes_Home:25,Ropes_Total:62,Target_Ropes:200,Gap:138,Dried_KG:2.8,Wet_KG:0.0,Total_KG:2.8,Challenges:'They have no casual workers, so they carry the heavy, wet seaweed bags by themselves, and the distance from the seaweed farm to their village is very long.  They do not have enough skills in seaweed farming, and they need more training.  They do not have',x:39.31103912,y:-4.58436409},
            {Group:'Yungi Mwenjeni Conservation Group',Member:'1130_Hadija_Nyanje',Ropes_Ocean:37,Ropes_Home:23,Ropes_Total:60,Target_Ropes:300,Gap:240,Dried_KG:2.8,Wet_KG:0.0,Total_KG:2.8,Challenges:'They have no casual workers, so they carry the heavy, wet seaweed bags by themselves, and the distance from the seaweed farm to their village is very long.  They do not have enough skills in seaweed farming, and they need more training.  They do not have',x:39.31105161,y:-4.584381524},
            {Group:'Yungi Mwenjeni Conservation Group',Member:'1131_Mwajumbe_Kassim_Mwagombe',Ropes_Ocean:37,Ropes_Home:10,Ropes_Total:47,Target_Ropes:200,Gap:153,Dried_KG:2.8,Wet_KG:0.0,Total_KG:2.8,Challenges:'They have no casual workers, so they carry the heavy, wet seaweed bags by themselves, and the distance from the seaweed farm to their village is very long.  They do not have enough skills in seaweed farming, and they need more training.  They do not have',x:39.31113167,y:-4.584388333},
            {Group:'Yungi Mwenjeni Conservation Group',Member:'1135_Rukia_Hassan_Zani',Ropes_Ocean:37,Ropes_Home:10,Ropes_Total:47,Target_Ropes:150,Gap:103,Dried_KG:2.8,Wet_KG:0.0,Total_KG:2.8,Challenges:'They have no casual workers, so they carry the heavy, wet seaweed bags by themselves, and the distance from the seaweed farm to their village is very long.  They do not have enough skills in seaweed farming, and they need more training.  They do not have',x:39.31106833,y:-4.584313333},
            {Group:'Yungi Mwenjeni Conservation Group',Member:'1136_Hassan_Abdalla_Bakari',Ropes_Ocean:37,Ropes_Home:10,Ropes_Total:47,Target_Ropes:300,Gap:253,Dried_KG:2.8,Wet_KG:0.0,Total_KG:2.8,Challenges:'They have no casual workers, so they carry the heavy, wet seaweed bags by themselves, and the distance from the seaweed farm to their village is very long.  They do not have enough skills in seaweed farming, and they need more training.  They do not have',x:39.31107173,y:-4.584337268},
            {Group:'Yungi Mwenjeni Conservation Group',Member:'1137_Mwanaidi_Suleiman_Jonjori',Ropes_Ocean:37,Ropes_Home:29,Ropes_Total:66,Target_Ropes:400,Gap:334,Dried_KG:2.8,Wet_KG:0.0,Total_KG:2.8,Challenges:'They have no casual workers, so they carry the heavy, wet seaweed bags by themselves, and the distance from the seaweed farm to their village is very long.  They do not have enough skills in seaweed farming, and they need more training.  They do not have',x:39.31109,y:-4.58446},
            {Group:'Yungi Mwenjeni Conservation Group',Member:'1139_Bakari_Rashid_abdalla',Ropes_Ocean:37,Ropes_Home:10,Ropes_Total:47,Target_Ropes:3,Gap:-44,Dried_KG:2.8,Wet_KG:0.0,Total_KG:2.8,Challenges:'They have no casual workers, so they carry the heavy, wet seaweed bags by themselves, and the distance from the seaweed farm to their village is very long.  They do not have enough skills in seaweed farming, and they need more training.  They do not have',x:39.3110361,y:-4.584330646},
            {Group:'Yungi Mwenjeni Conservation Group',Member:'1141_Mbaraka_Mbwana_Bwara',Ropes_Ocean:37,Ropes_Home:10,Ropes_Total:47,Target_Ropes:300,Gap:253,Dried_KG:2.8,Wet_KG:0.0,Total_KG:2.8,Challenges:'They have no casual workers, so they carry the heavy, wet seaweed bags by themselves, and the distance from the seaweed farm to their village is very long.  They do not have enough skills in seaweed farming, and they need more training.  They do not have',x:39.31104189,y:-4.584294646},
            {Group:'Yungi Mwenjeni Conservation Group',Member:'1142_Mwanasiti_Hamisi',Ropes_Ocean:37,Ropes_Home:10,Ropes_Total:47,Target_Ropes:200,Gap:153,Dried_KG:2.8,Wet_KG:0.0,Total_KG:2.8,Challenges:'They have no casual workers, so they carry the heavy, wet seaweed bags by themselves, and the distance from the seaweed farm to their village is very long.  They do not have enough skills in seaweed farming, and they need more training.  They do not have',x:39.31109833,y:-4.584231667},
            {Group:'Yungi Mwenjeni Conservation Group',Member:'1143_Ramadhan_Shee_Seleman',Ropes_Ocean:37,Ropes_Home:3,Ropes_Total:40,Target_Ropes:300,Gap:260,Dried_KG:2.8,Wet_KG:0.0,Total_KG:2.8,Challenges:'They have no casual workers, so they carry the heavy, wet seaweed bags by themselves, and the distance from the seaweed farm to their village is very long.  They do not have enough skills in seaweed farming, and they need more training.  They do not have',x:39.31103167,y:-4.584255},
            {Group:'Yungi Mwenjeni Conservation Group',Member:'1144_Mwamisi_Bakari',Ropes_Ocean:37,Ropes_Home:10,Ropes_Total:47,Target_Ropes:300,Gap:253,Dried_KG:2.8,Wet_KG:0.0,Total_KG:2.8,Challenges:'They have no casual workers, so they carry the heavy, wet seaweed bags by themselves, and the distance from the seaweed farm to their village is very long.  They do not have enough skills in seaweed farming, and they need more training.  They do not have',x:39.31108833,y:-4.584481667},
            {Group:'Yungi Mwenjeni Conservation Group',Member:'1145_Laila_Mnyero_Fumo',Ropes_Ocean:37,Ropes_Home:21,Ropes_Total:58,Target_Ropes:500,Gap:442,Dried_KG:2.8,Wet_KG:0.0,Total_KG:2.8,Challenges:'They have no casual workers, so they carry the heavy, wet seaweed bags by themselves, and the distance from the seaweed farm to their village is very long.  They do not have enough skills in seaweed farming, and they need more training.  They do not have',x:39.31111263,y:-4.584281738},
            {Group:'Yungi Mwenjeni Conservation Group',Member:'1146_Mbwana_Abdalla_Bwara',Ropes_Ocean:37,Ropes_Home:10,Ropes_Total:47,Target_Ropes:300,Gap:253,Dried_KG:2.8,Wet_KG:0.0,Total_KG:2.8,Challenges:'They have no casual workers, so they carry the heavy, wet seaweed bags by themselves, and the distance from the seaweed farm to their village is very long.  They do not have enough skills in seaweed farming, and they need more training.  They do not have',x:39.31104281,y:-4.584286516},
            {Group:'Yungi Mwenjeni Conservation Group',Member:'1147_Fatuma_Ramadhan',Ropes_Ocean:37,Ropes_Home:20,Ropes_Total:57,Target_Ropes:100,Gap:43,Dried_KG:2.8,Wet_KG:0.0,Total_KG:2.8,Challenges:'They have no casual workers, so they carry the heavy, wet seaweed bags by themselves, and the distance from the seaweed farm to their village is very long.  They do not have enough skills in seaweed farming, and they need more training.  They do not have',x:39.31096268,y:-4.584337394},
            {Group:'Yungi Mwenjeni Conservation Group',Member:'1148_Mwanakombo_Ali',Ropes_Ocean:37,Ropes_Home:10,Ropes_Total:47,Target_Ropes:250,Gap:203,Dried_KG:2.8,Wet_KG:0.0,Total_KG:2.8,Challenges:'They have no casual workers, so they carry the heavy, wet seaweed bags by themselves, and the distance from the seaweed farm to their village is very long.  They do not have enough skills in seaweed farming, and they need more training.  They do not have',x:39.31102833,y:-4.584485},
            {Group:'Yungi Mwenjeni Conservation Group',Member:'1149_Mwanamkuu_Ramadhani',Ropes_Ocean:37,Ropes_Home:10,Ropes_Total:47,Target_Ropes:200,Gap:153,Dried_KG:2.8,Wet_KG:0.0,Total_KG:2.8,Challenges:'They have no casual workers, so they carry the heavy, wet seaweed bags by themselves, and the distance from the seaweed farm to their village is very long.  They do not have enough skills in seaweed farming, and they need more training.  They do not have',x:39.31103333,y:-4.584306667},
            {Group:'Yungi Mwenjeni Conservation Group',Member:'1151_Hadija_Hamisi_Masa',Ropes_Ocean:37,Ropes_Home:10,Ropes_Total:47,Target_Ropes:300,Gap:253,Dried_KG:2.8,Wet_KG:0.0,Total_KG:2.8,Challenges:'They have no casual workers, so they carry the heavy, wet seaweed bags by themselves, and the distance from the seaweed farm to their village is very long.  They do not have enough skills in seaweed farming, and they need more training.  They do not have',x:39.31098154,y:-4.58423526},
            {Group:'Yungi Mwenjeni Conservation Group',Member:'1152_Marium_Alawe',Ropes_Ocean:37,Ropes_Home:10,Ropes_Total:47,Target_Ropes:250,Gap:203,Dried_KG:2.8,Wet_KG:0.0,Total_KG:2.8,Challenges:'They have no casual workers, so they carry the heavy, wet seaweed bags by themselves, and the distance from the seaweed farm to their village is very long.  They do not have enough skills in seaweed farming, and they need more training.  They do not have',x:39.31111431,y:-4.584277254},
            {Group:'Yungi Mwenjeni Conservation Group',Member:'1153_Mwanasiti_Kassim_Nassir',Ropes_Ocean:37,Ropes_Home:18,Ropes_Total:55,Target_Ropes:200,Gap:145,Dried_KG:2.8,Wet_KG:0.0,Total_KG:2.8,Challenges:'They have no casual workers, so they carry the heavy, wet seaweed bags by themselves, and the distance from the seaweed farm to their village is very long.  They do not have enough skills in seaweed farming, and they need more training.  They do not have',x:39.31103333,y:-4.584315},
            {Group:'Yungi Mwenjeni Conservation Group',Member:'1155_Mwanamvua_Salim_Mohamed',Ropes_Ocean:37,Ropes_Home:10,Ropes_Total:47,Target_Ropes:150,Gap:103,Dried_KG:2.8,Wet_KG:0.0,Total_KG:2.8,Challenges:'They have no casual workers, so they carry the heavy, wet seaweed bags by themselves, and the distance from the seaweed farm to their village is very long.  They do not have enough skills in seaweed farming, and they need more training.  They do not have',x:39.31112167,y:-4.584268333},
            {Group:'Yungi Mwenjeni Conservation Group',Member:'1156_Fatuma_Abdalla_Bakari',Ropes_Ocean:37,Ropes_Home:28,Ropes_Total:65,Target_Ropes:250,Gap:185,Dried_KG:2.8,Wet_KG:0.0,Total_KG:2.8,Challenges:'They have no casual workers, so they carry the heavy, wet seaweed bags by themselves, and the distance from the seaweed farm to their village is very long.  They do not have enough skills in seaweed farming, and they need more training.  They do not have',x:39.3110387,y:-4.584347033},
            {Group:'Yungi Mwenjeni Conservation Group',Member:'1157_Sophia_Iddi',Ropes_Ocean:37,Ropes_Home:10,Ropes_Total:47,Target_Ropes:100,Gap:53,Dried_KG:2.8,Wet_KG:0.0,Total_KG:2.8,Challenges:'They have no casual workers, so they carry the heavy, wet seaweed bags by themselves, and the distance from the seaweed farm to their village is very long.  They do not have enough skills in seaweed farming, and they need more training.  They do not have',x:39.31107333,y:-4.58435},
            {Group:'Yungi Mwenjeni Conservation Group',Member:'1158_Mwanasha_Fadhili_Njereti',Ropes_Ocean:37,Ropes_Home:10,Ropes_Total:47,Target_Ropes:150,Gap:103,Dried_KG:2.8,Wet_KG:0.0,Total_KG:2.8,Challenges:'They have no casual workers, so they carry the heavy, wet seaweed bags by themselves, and the distance from the seaweed farm to their village is very long.  They do not have enough skills in seaweed farming, and they need more training.  They do not have',x:39.31102333,y:-4.584311667},
            {Group:'Yungi Mwenjeni Conservation Group',Member:'1160_Mwanamkuu_Hassan_Omari',Ropes_Ocean:37,Ropes_Home:27,Ropes_Total:64,Target_Ropes:200,Gap:136,Dried_KG:2.8,Wet_KG:0.0,Total_KG:2.8,Challenges:'They have no casual workers, so they carry the heavy, wet seaweed bags by themselves, and the distance from the seaweed farm to their village is very long.  They do not have enough skills in seaweed farming, and they need more training.  They do not have',x:39.31110551,y:-4.584290371},
            {Group:'Yungi Mwenjeni Conservation Group',Member:'1161_Mwanauba_Hamisi_Kula',Ropes_Ocean:37,Ropes_Home:25,Ropes_Total:62,Target_Ropes:250,Gap:188,Dried_KG:2.8,Wet_KG:0.0,Total_KG:2.8,Challenges:'They have no casual workers, so they carry the heavy, wet seaweed bags by themselves, and the distance from the seaweed farm to their village is very long.  They do not have enough skills in seaweed farming, and they need more training.  They do not have',x:39.31104,y:-4.584291667},
            {Group:'Yungi Mwenjeni Conservation Group',Member:'1877_Fatuma_Said_Kibao',Ropes_Ocean:37,Ropes_Home:43,Ropes_Total:80,Target_Ropes:300,Gap:220,Dried_KG:2.8,Wet_KG:0.0,Total_KG:2.8,Challenges:'They have no casual workers, so they carry the heavy, wet seaweed bags by themselves, and the distance from the seaweed farm to their village is very long.  They do not have enough skills in seaweed farming, and they need more training.  They do not have',x:39.31105161,y:-4.584381524},
            {Group:'Yungi Mwenjeni Conservation Group',Member:'2108_Mlongo_Dawa_Mazera',Ropes_Ocean:37,Ropes_Home:10,Ropes_Total:47,Target_Ropes:200,Gap:153,Dried_KG:2.8,Wet_KG:0.0,Total_KG:2.8,Challenges:'They have no casual workers, so they carry the heavy, wet seaweed bags by themselves, and the distance from the seaweed farm to their village is very long.  They do not have enough skills in seaweed farming, and they need more training.  They do not have',x:39.31109167,y:-4.58445},
            {Group:'Yungi Mwenjeni Conservation Group',Member:'3789_Mwanaulu_Kirua_Diwani',Ropes_Ocean:37,Ropes_Home:10,Ropes_Total:47,Target_Ropes:200,Gap:153,Dried_KG:2.8,Wet_KG:0.0,Total_KG:2.8,Challenges:'They have no casual workers, so they carry the heavy, wet seaweed bags by themselves, and the distance from the seaweed farm to their village is very long.  They do not have enough skills in seaweed farming, and they need more training.  They do not have',x:39.31105667,y:-4.584298333},
            {Group:'Yungi Mwenjeni Conservation Group',Member:'3791_Mwanakombo_Omari_Bakar',Ropes_Ocean:37,Ropes_Home:20,Ropes_Total:57,Target_Ropes:200,Gap:143,Dried_KG:2.8,Wet_KG:0.0,Total_KG:2.8,Challenges:'They have no casual workers, so they carry the heavy, wet seaweed bags by themselves, and the distance from the seaweed farm to their village is very long.  They do not have enough skills in seaweed farming, and they need more training.  They do not have',x:39.31102167,y:-4.584473333},
            {Group:'Yungi Mwenjeni Conservation Group',Member:'3792_Asha_Hassan_Zani',Ropes_Ocean:37,Ropes_Home:20,Ropes_Total:57,Target_Ropes:250,Gap:193,Dried_KG:2.8,Wet_KG:0.0,Total_KG:2.8,Challenges:'They have no casual workers, so they carry the heavy, wet seaweed bags by themselves, and the distance from the seaweed farm to their village is very long.  They do not have enough skills in seaweed farming, and they need more training.  They do not have',x:39.31098925,y:-4.584326497},
            {Group:'Yungi Mwenjeni Conservation Group',Member:'5873_Mwanamkuu_Kassim_Rashid',Ropes_Ocean:37,Ropes_Home:10,Ropes_Total:47,Target_Ropes:150,Gap:103,Dried_KG:2.8,Wet_KG:0.0,Total_KG:2.8,Challenges:'They have no casual workers, so they carry the heavy, wet seaweed bags by themselves, and the distance from the seaweed farm to their village is very long.  They do not have enough skills in seaweed farming, and they need more training.  They do not have',x:39.311085,y:-4.584268333},
            {Group:'Yungi Mwenjeni Conservation Group',Member:'5883_Mbwana_Shee_Pengo',Ropes_Ocean:37,Ropes_Home:10,Ropes_Total:47,Target_Ropes:500,Gap:453,Dried_KG:2.8,Wet_KG:0.0,Total_KG:2.8,Challenges:'They have no casual workers, so they carry the heavy, wet seaweed bags by themselves, and the distance from the seaweed farm to their village is very long.  They do not have enough skills in seaweed farming, and they need more training.  They do not have',x:39.31105983,y:-4.584281612},
            {Group:'Yungi Mwenjeni Conservation Group',Member:'Hamida_Omar_Bakari',Ropes_Ocean:37,Ropes_Home:20,Ropes_Total:57,Target_Ropes:300,Gap:243,Dried_KG:2.8,Wet_KG:0.0,Total_KG:2.8,Challenges:'No enough skills in seaweed farming',x:39.31105044,y:-4.584302064},
            {Group:'Yungi Mwenjeni Conservation Group',Member:'Mwajumbe_Masudi',Ropes_Ocean:37,Ropes_Home:21,Ropes_Total:58,Target_Ropes:200,Gap:142,Dried_KG:2.8,Wet_KG:0.0,Total_KG:2.8,Challenges:'Long distance to get to the farm,no enough skills in seaweed farming ,ineed of more trainings',x:39.31103971,y:-4.584288569},
            {Group:'Yungi Mwenjeni Conservation Group',Member:'Mwanakombo_Rashid_Mwakusonda',Ropes_Ocean:37,Ropes_Home:20,Ropes_Total:57,Target_Ropes:300,Gap:243,Dried_KG:2.8,Wet_KG:0.0,Total_KG:2.8,Challenges:'They have no casual workers, so they carry the heavy, wet seaweed bags by themselves, and the distance from the seaweed farm to their village is very long.',x:39.31105949,y:-4.584286599},
            {Group:'Yungi Mwenjeni Conservation Group',Member:'Said_Rashid_Gwara',Ropes_Ocean:37,Ropes_Home:10,Ropes_Total:47,Target_Ropes:500,Gap:453,Dried_KG:2.8,Wet_KG:0.0,Total_KG:2.8,Challenges:'They have no casual workers, so they carry the heavy, wet seaweed bags by themselves, and the distance from the seaweed farm to their village is very long.',x:39.31105924,y:-4.584278427},
            {Group:'Tushirikiane Conservation Women',Member:'1938_Sharifa_Hamisi_Mshenga',Ropes_Ocean:3,Ropes_Home:2,Ropes_Total:5,Target_Ropes:20,Gap:15,Dried_KG:1.6,Wet_KG:0.9,Total_KG:2.5,Challenges:'',x:39.42407,y:-4.55425},
            {Group:'Tushirikiane Conservation Women',Member:'1943_Mwanaasha_Bakari_Bananga',Ropes_Ocean:3,Ropes_Home:2,Ropes_Total:5,Target_Ropes:30,Gap:25,Dried_KG:1.6,Wet_KG:0.9,Total_KG:2.5,Challenges:'Boat',x:39.42347867,y:-4.554856283},
            {Group:'Tushirikiane Conservation Women',Member:'1948_Mohamed_Mwangolo',Ropes_Ocean:3,Ropes_Home:2,Ropes_Total:5,Target_Ropes:25,Gap:20,Dried_KG:1.6,Wet_KG:0.9,Total_KG:2.5,Challenges:'Transport (Boat)',x:39.42349743,y:-4.554974067},
            {Group:'Tushirikiane Conservation Women',Member:'1951_Bakari_Waziri_Mwakame',Ropes_Ocean:3,Ropes_Home:2,Ropes_Total:5,Target_Ropes:25,Gap:20,Dried_KG:1.6,Wet_KG:0.9,Total_KG:2.5,Challenges:'Boat',x:39.4237083,y:-4.554505467},
            {Group:'Tushirikiane Conservation Women',Member:'1956_Rehema_Kijumbe_Mwabindo',Ropes_Ocean:3,Ropes_Home:2,Ropes_Total:5,Target_Ropes:50,Gap:45,Dried_KG:1.6,Wet_KG:0.9,Total_KG:2.5,Challenges:'1. Transport challenges 2. Inadequate safety materials',x:39.42369167,y:-4.55477},
            {Group:'Tushirikiane Conservation Women',Member:'1958_Mwenesi_Juma_Mohamed',Ropes_Ocean:3,Ropes_Home:2,Ropes_Total:5,Target_Ropes:70,Gap:65,Dried_KG:1.6,Wet_KG:0.9,Total_KG:2.5,Challenges:'1. Lack of reliable means of transport. 1.Inadeqiate skills and trainings',x:39.42374167,y:-4.554795},
            {Group:'Tushirikiane Conservation Women',Member:'1964_Mariam_Mshee_Mwinyamiri',Ropes_Ocean:3,Ropes_Home:2,Ropes_Total:5,Target_Ropes:20,Gap:15,Dried_KG:1.6,Wet_KG:0.9,Total_KG:2.5,Challenges:'',x:39.42404,y:-4.5543},
            {Group:'Tushirikiane Conservation Women',Member:'1966_Wahiba_Areni_Hassan',Ropes_Ocean:3,Ropes_Home:2,Ropes_Total:5,Target_Ropes:25,Gap:20,Dried_KG:1.6,Wet_KG:0.9,Total_KG:2.5,Challenges:'Very heavy winds that carry away the seaweed from ropes',x:39.42378,y:-4.55472},
            {Group:'Tushirikiane Conservation Women',Member:'1972_Mwanasiti_Majambo_Kassim',Ropes_Ocean:3,Ropes_Home:2,Ropes_Total:5,Target_Ropes:35,Gap:30,Dried_KG:1.6,Wet_KG:0.9,Total_KG:2.5,Challenges:'1. Inadequate safety tools. 2. Unreliable means of transport',x:39.423925,y:-4.554345},
            {Group:'Tushirikiane Conservation Women',Member:'1973_Meshee_Makame_Waziri',Ropes_Ocean:3,Ropes_Home:2,Ropes_Total:5,Target_Ropes:35,Gap:30,Dried_KG:1.6,Wet_KG:0.9,Total_KG:2.5,Challenges:'Transport (Boat)',x:39.42351718,y:-4.554812483},
            {Group:'Tushirikiane Conservation Women',Member:'1981_Mwanamkuu_Kassim_Jambia',Ropes_Ocean:3,Ropes_Home:2,Ropes_Total:5,Target_Ropes:25,Gap:20,Dried_KG:1.6,Wet_KG:0.9,Total_KG:2.5,Challenges:'Boat',x:39.42369608,y:-4.554802383},
            {Group:'Tushirikiane Conservation Women',Member:'1990_Mwajine_Kea_Mwinyiisa',Ropes_Ocean:3,Ropes_Home:2,Ropes_Total:5,Target_Ropes:25,Gap:20,Dried_KG:1.6,Wet_KG:0.9,Total_KG:2.5,Challenges:'Boat',x:39.42341205,y:-4.554872483},
            {Group:'Tushirikiane Conservation Women',Member:'1996_Nishuara_Bakari_Waziri',Ropes_Ocean:3,Ropes_Home:2,Ropes_Total:5,Target_Ropes:45,Gap:40,Dried_KG:1.6,Wet_KG:0.9,Total_KG:2.5,Challenges:'1.lack of proper storage facilities. 2. Unreliable means of transport',x:39.42369667,y:-4.55494},
            {Group:'Tushirikiane Conservation Women',Member:'1997_Buruhani_Hamisi',Ropes_Ocean:3,Ropes_Home:2,Ropes_Total:5,Target_Ropes:30,Gap:25,Dried_KG:1.6,Wet_KG:0.9,Total_KG:2.5,Challenges:'Boat',x:39.42371617,y:-4.554704733},
            {Group:'Tushirikiane Conservation Women',Member:'2004_Kondo_Haron_Kondo',Ropes_Ocean:3,Ropes_Home:2,Ropes_Total:5,Target_Ropes:30,Gap:25,Dried_KG:1.6,Wet_KG:0.9,Total_KG:2.5,Challenges:'Boat',x:39.4218831,y:-4.5157321},
            {Group:'Tushirikiane Conservation Women',Member:'2013_Mwanatime_Salim_Kombora',Ropes_Ocean:3,Ropes_Home:2,Ropes_Total:5,Target_Ropes:40,Gap:35,Dried_KG:1.6,Wet_KG:0.9,Total_KG:2.5,Challenges:'Lack of self means of transport. 2.  Inadequate safety tools',x:39.42403333,y:-4.5542},
            {Group:'Tushirikiane Conservation Women',Member:'2014_Mwakaje_shee_shughuli',Ropes_Ocean:3,Ropes_Home:2,Ropes_Total:5,Target_Ropes:20,Gap:15,Dried_KG:1.6,Wet_KG:0.9,Total_KG:2.5,Challenges:'Boat',x:39.42347867,y:-4.554856283},
            {Group:'Tushirikiane Conservation Women',Member:'2018_Tunu_saidi_Hamisi',Ropes_Ocean:2,Ropes_Home:3,Ropes_Total:5,Target_Ropes:25,Gap:20,Dried_KG:1.6,Wet_KG:0.9,Total_KG:2.5,Challenges:'Ice ice disease on the seaweed,Lack of a ready market for the product',x:39.42388,y:-4.55462},
            {Group:'Tushirikiane Conservation Women',Member:'2020_Machezo_Bakari_Juma',Ropes_Ocean:3,Ropes_Home:2,Ropes_Total:5,Target_Ropes:20,Gap:15,Dried_KG:1.6,Wet_KG:0.9,Total_KG:2.5,Challenges:'',x:39.42373,y:-4.55481},
            {Group:'Tushirikiane Conservation Women',Member:'2025_Vuyaa_Bakari_Chonga',Ropes_Ocean:3,Ropes_Home:2,Ropes_Total:5,Target_Ropes:20,Gap:15,Dried_KG:1.6,Wet_KG:0.9,Total_KG:2.5,Challenges:'Few number of ropes and Lack of farming equipments i.e panga,knives,gloves',x:39.42383,y:-4.5547},
            {Group:'Tushirikiane Conservation Women',Member:'2029_Fatuma_said_Mwatende',Ropes_Ocean:3,Ropes_Home:2,Ropes_Total:5,Target_Ropes:25,Gap:20,Dried_KG:1.6,Wet_KG:0.9,Total_KG:2.5,Challenges:'Boat',x:39.42374623,y:-4.554474517},
            {Group:'Tushirikiane Conservation Women',Member:'2034_Mwatogo_Mzingo_Juma',Ropes_Ocean:3,Ropes_Home:2,Ropes_Total:5,Target_Ropes:40,Gap:35,Dried_KG:1.6,Wet_KG:0.9,Total_KG:2.5,Challenges:'1. Delayed acess to ocean farm due to lack of reliable means of transport. 2. Inadequate skills and knowledge of seaweed production',x:39.42384667,y:-4.554438333},
            {Group:'Tushirikiane Conservation Women',Member:'2036_mwanakombo_Bakari',Ropes_Ocean:3,Ropes_Home:2,Ropes_Total:5,Target_Ropes:30,Gap:25,Dried_KG:1.6,Wet_KG:0.9,Total_KG:2.5,Challenges:'Boat',x:39.42364908,y:-4.5547883},
            {Group:'Tushirikiane Conservation Women',Member:'2040_Mwanavita_Mohamed_Mwamlongo',Ropes_Ocean:3,Ropes_Home:2,Ropes_Total:5,Target_Ropes:50,Gap:45,Dried_KG:1.6,Wet_KG:0.9,Total_KG:2.5,Challenges:'1. Access to means of transport. 2. Inadequate safety tools 3. Insufficient funds to run out activities',x:39.424,y:-4.554295},
            {Group:'Tushirikiane Conservation Women',Member:'2044_Mariam_Mwatsahu_Juma',Ropes_Ocean:3,Ropes_Home:2,Ropes_Total:5,Target_Ropes:25,Gap:20,Dried_KG:1.6,Wet_KG:0.9,Total_KG:2.5,Challenges:'Transport (Boat)',x:39.42380742,y:-4.555467834},
            {Group:'Tushirikiane Conservation Women',Member:'2051_Hadida_Achani',Ropes_Ocean:3,Ropes_Home:2,Ropes_Total:5,Target_Ropes:30,Gap:25,Dried_KG:1.6,Wet_KG:0.9,Total_KG:2.5,Challenges:'Boat',x:39.4236802,y:-4.5544094},
            {Group:'Tushirikiane Conservation Women',Member:'2080_Christine_rehema_chilumo',Ropes_Ocean:3,Ropes_Home:2,Ropes_Total:5,Target_Ropes:25,Gap:20,Dried_KG:1.6,Wet_KG:0.9,Total_KG:2.5,Challenges:'BOAT',x:39.39601126,y:-4.554807635},
            {Group:'Tushirikiane Conservation Women',Member:'2086_chizi_chiwala_mwero',Ropes_Ocean:3,Ropes_Home:2,Ropes_Total:5,Target_Ropes:35,Gap:30,Dried_KG:1.6,Wet_KG:0.9,Total_KG:2.5,Challenges:'Boat',x:39.42365295,y:-4.55464605},
            {Group:'Tushirikiane Conservation Women',Member:'3401_Hussein_Kibwana_Ruwa',Ropes_Ocean:3,Ropes_Home:2,Ropes_Total:5,Target_Ropes:20,Gap:15,Dried_KG:1.6,Wet_KG:0.9,Total_KG:2.5,Challenges:'Boat',x:39.42358718,y:-4.554527133},
            {Group:'Tushirikiane Conservation Women',Member:'3403_Mwanamkao_Mshenga_Mkandi',Ropes_Ocean:3,Ropes_Home:2,Ropes_Total:5,Target_Ropes:3,Gap:-2,Dried_KG:1.6,Wet_KG:0.9,Total_KG:2.5,Challenges:'Boat',x:39.42368795,y:-4.554663567},
            {Group:'Tushirikiane Conservation Women',Member:'3405_Fatuma_Gungu_Omari',Ropes_Ocean:3,Ropes_Home:2,Ropes_Total:5,Target_Ropes:35,Gap:30,Dried_KG:1.6,Wet_KG:0.9,Total_KG:2.5,Challenges:'Boat',x:39.4218831,y:-4.5157321},
            {Group:'Tushirikiane Conservation Women',Member:'6587_CHARO_MWEMBE_CHIBOYA',Ropes_Ocean:3,Ropes_Home:2,Ropes_Total:5,Target_Ropes:20,Gap:15,Dried_KG:1.6,Wet_KG:0.9,Total_KG:2.5,Challenges:'Boat',x:39.4218831,y:-4.5157321},
            {Group:'Tushirikiane Conservation Women',Member:'6594_Salama_Karisa_Edward',Ropes_Ocean:3,Ropes_Home:2,Ropes_Total:5,Target_Ropes:25,Gap:20,Dried_KG:1.6,Wet_KG:0.9,Total_KG:2.5,Challenges:'lack of transport means to reach the shamba..I.e boat.',x:39.42373,y:-4.55486},
            {Group:'Tushirikiane Conservation Women',Member:'6596_Fatuma_Mohamed_Ali',Ropes_Ocean:3,Ropes_Home:2,Ropes_Total:5,Target_Ropes:30,Gap:25,Dried_KG:1.6,Wet_KG:0.9,Total_KG:2.5,Challenges:'Boat',x:39.42367405,y:-4.55477325},
            {Group:'Tushirikiane Conservation Women',Member:'6597_Subira_Kondo_Mbwana',Ropes_Ocean:3,Ropes_Home:2,Ropes_Total:5,Target_Ropes:20,Gap:15,Dried_KG:1.6,Wet_KG:0.9,Total_KG:2.5,Challenges:'',x:39.42406,y:-4.5542},
            {Group:'Tushirikiane Conservation Women',Member:'6599_Kauwa_Chale_Nyamawi',Ropes_Ocean:3,Ropes_Home:2,Ropes_Total:5,Target_Ropes:35,Gap:30,Dried_KG:1.6,Wet_KG:0.9,Total_KG:2.5,Challenges:'Boat',x:39.423616,y:-4.554430733},
            {Group:'Tushirikiane Conservation Women',Member:'6603_Mwatime_Mohamed_Mshee',Ropes_Ocean:3,Ropes_Home:2,Ropes_Total:5,Target_Ropes:45,Gap:40,Dried_KG:1.6,Wet_KG:0.9,Total_KG:2.5,Challenges:'1. Inadequate safety tools 2. Lack of means of transport both to the farm and to the storage area',x:39.423925,y:-4.554336667},
            {Group:'Tushirikiane Conservation Women',Member:'6604_Mwanamisi_Nassoro_Nyanze',Ropes_Ocean:3,Ropes_Home:2,Ropes_Total:5,Target_Ropes:25,Gap:20,Dried_KG:1.6,Wet_KG:0.9,Total_KG:2.5,Challenges:'Boat',x:39.42368842,y:-4.554655717},
            {Group:'Tushirikiane Conservation Women',Member:'6605_Saumu_Hatibu_Mshee',Ropes_Ocean:3,Ropes_Home:2,Ropes_Total:5,Target_Ropes:20,Gap:15,Dried_KG:1.6,Wet_KG:0.9,Total_KG:2.5,Challenges:'Transport to the shamba.Knives for harvesting',x:39.42371,y:-4.55483},
            {Group:'Tushirikiane Conservation Women',Member:'6606_Mwanatime_Juma_Abdalla',Ropes_Ocean:3,Ropes_Home:2,Ropes_Total:5,Target_Ropes:30,Gap:25,Dried_KG:1.6,Wet_KG:0.9,Total_KG:2.5,Challenges:'Inadequate safety tools',x:39.42395333,y:-4.55429},
            {Group:'Tushirikiane Conservation Women',Member:'6607_Mwanajuma_Hassan_Maneno',Ropes_Ocean:3,Ropes_Home:2,Ropes_Total:5,Target_Ropes:25,Gap:20,Dried_KG:1.6,Wet_KG:0.9,Total_KG:2.5,Challenges:'Boat',x:39.42359122,y:-4.554804967},
            {Group:'Tushirikiane Conservation Women',Member:'6608_Asha_Omar_Salim',Ropes_Ocean:3,Ropes_Home:2,Ropes_Total:5,Target_Ropes:20,Gap:15,Dried_KG:1.6,Wet_KG:0.9,Total_KG:2.5,Challenges:'Boat',x:39.42371505,y:-4.554574567},
            {Group:'Tushirikiane Conservation Women',Member:'6609_Rukia_Makame_Mwishee',Ropes_Ocean:3,Ropes_Home:2,Ropes_Total:5,Target_Ropes:25,Gap:20,Dried_KG:1.6,Wet_KG:0.9,Total_KG:2.5,Challenges:'',x:39.42379,y:-4.55471},
            {Group:'Tushirikiane Conservation Women',Member:'6611_Saumu_Uchi_Lewa',Ropes_Ocean:3,Ropes_Home:2,Ropes_Total:5,Target_Ropes:25,Gap:20,Dried_KG:1.6,Wet_KG:0.9,Total_KG:2.5,Challenges:'Lack of equipments for the whole process i.e pangas and knives,wheelbarrow for ease of transportation from ocean to home.',x:39.42372,y:-4.55481},
            {Group:'Tushirikiane Conservation Women',Member:'6613_Mwanamkasi_Rashid_Mwakilesho',Ropes_Ocean:3,Ropes_Home:2,Ropes_Total:5,Target_Ropes:30,Gap:25,Dried_KG:1.6,Wet_KG:0.9,Total_KG:2.5,Challenges:'Boat',x:39.42379748,y:-4.554659233},
            {Group:'Tushirikiane Conservation Women',Member:'6614_Mwenesi_Omari_Ali',Ropes_Ocean:3,Ropes_Home:2,Ropes_Total:5,Target_Ropes:50,Gap:45,Dried_KG:1.6,Wet_KG:0.9,Total_KG:2.5,Challenges:'1. Lack of adequate trainings . Poor means of transport91',x:39.42371167,y:-4.554833333},
            {Group:'Tushirikiane Conservation Women',Member:'6616_Saumu_Rashid_Ramadhan',Ropes_Ocean:3,Ropes_Home:2,Ropes_Total:5,Target_Ropes:25,Gap:20,Dried_KG:1.6,Wet_KG:0.9,Total_KG:2.5,Challenges:'Lack of protective clothing ie gumboots,googles to prevent from direct light from sandy beach,cap to prevent from hot sun',x:39.42372,y:-4.55485},
            {Group:'Tushirikiane Conservation Women',Member:'6617_Masika_Bakari_Fikirini',Ropes_Ocean:3,Ropes_Home:2,Ropes_Total:5,Target_Ropes:30,Gap:25,Dried_KG:1.6,Wet_KG:0.9,Total_KG:2.5,Challenges:'Transport (Boat)',x:39.4235796,y:-4.55471075},
            {Group:'Tushirikiane Conservation Women',Member:'6618_Said_Mwinyikai_Mkanga',Ropes_Ocean:3,Ropes_Home:2,Ropes_Total:5,Target_Ropes:25,Gap:20,Dried_KG:1.6,Wet_KG:0.9,Total_KG:2.5,Challenges:'Un availability of transpot',x:39.42389,y:-4.55462},
            {Group:'Tushirikiane Conservation Women',Member:'6631_Mwaita_Mohamed_Mwamryango',Ropes_Ocean:3,Ropes_Home:2,Ropes_Total:5,Target_Ropes:30,Gap:25,Dried_KG:1.6,Wet_KG:0.9,Total_KG:2.5,Challenges:'Transport (Boat)',x:39.42346495,y:-4.55485665},
            {Group:'Tushirikiane Conservation Women',Member:'6694_Swaleh_Kondo_Mwarabu',Ropes_Ocean:3,Ropes_Home:2,Ropes_Total:5,Target_Ropes:25,Gap:20,Dried_KG:1.6,Wet_KG:0.9,Total_KG:2.5,Challenges:'Lack of Caps,gumboot and Transport means',x:39.42383,y:-4.55464},
            {Group:'Tushirikiane Conservation Women',Member:'Ngonde Mwangolo Ruwa',Ropes_Ocean:3,Ropes_Home:2,Ropes_Total:5,Target_Ropes:70,Gap:65,Dried_KG:1.6,Wet_KG:0.9,Total_KG:2.5,Challenges:'1. Unreliable means of transport 1. Lack of storage and drying facilities 2. Inadequate trainings on seaweed production',x:39.53421,y:-4.36315},
            {Group:'Furaha Seaweed Group',Member:'1187_Mwanasomo_Saidi_Mohammed',Ropes_Ocean:32,Ropes_Home:12,Ropes_Total:44,Target_Ropes:300,Gap:256,Dried_KG:0.0,Wet_KG:0.0,Total_KG:0.0,Challenges:'Climate change',x:39.4286,y:-4.578878333},
            {Group:'Furaha Seaweed Group',Member:'1210_Amina_Abdalla_Mnemo',Ropes_Ocean:9,Ropes_Home:4,Ropes_Total:13,Target_Ropes:300,Gap:287,Dried_KG:0.0,Wet_KG:0.0,Total_KG:0.0,Challenges:'Hajisikii vizuri',x:39.42860167,y:-4.57867},
            {Group:'Furaha Seaweed Group',Member:'1259_Mwanalima_Akida_Mwinyiamani',Ropes_Ocean:18,Ropes_Home:5,Ropes_Total:23,Target_Ropes:270,Gap:247,Dried_KG:0.0,Wet_KG:0.0,Total_KG:0.0,Challenges:'6.strong water current that leds to seaweeds swept fro the farms',x:39.42880628,y:-4.579556783},
            {Group:'Bati Seaweed Group',Member:'2175_Mwanahamisi_Atibu_',Ropes_Ocean:150,Ropes_Home:0,Ropes_Total:150,Target_Ropes:200,Gap:50,Dried_KG:0.0,Wet_KG:0.0,Total_KG:0.0,Challenges:'Labour',x:39.39858173,y:-4.604142483},
            {Group:'Bati Seaweed Group',Member:'2225_Mwamvua_Bilali_',Ropes_Ocean:55,Ropes_Home:110,Ropes_Total:165,Target_Ropes:500,Gap:335,Dried_KG:0.0,Wet_KG:0.0,Total_KG:0.0,Challenges:'Labour',x:39.3991355,y:-4.6051949},
            {Group:'Bati Seaweed Group',Member:'2230_Fatuma_Rajab_Bambao',Ropes_Ocean:230,Ropes_Home:0,Ropes_Total:230,Target_Ropes:1000,Gap:770,Dried_KG:0.0,Wet_KG:0.0,Total_KG:0.0,Challenges:'',x:39.39854,y:-4.60391},
            {Group:'Bati Seaweed Group',Member:'2243_Chakure_Mkulu_Musemi',Ropes_Ocean:72,Ropes_Home:150,Ropes_Total:222,Target_Ropes:500,Gap:278,Dried_KG:0.0,Wet_KG:0.0,Total_KG:0.0,Challenges:'No',x:39.38464,y:-4.60599},
            {Group:'Bati Seaweed Group',Member:'2260_Hamisi_Abdhala_Suleiman',Ropes_Ocean:86,Ropes_Home:250,Ropes_Total:336,Target_Ropes:700,Gap:364,Dried_KG:0.0,Wet_KG:0.0,Total_KG:0.0,Challenges:'Transportation and labour',x:39.39880633,y:-4.60440745},
            {Group:'Bati Seaweed Group',Member:'2274_Fatuma_Ali_Jumaa',Ropes_Ocean:86,Ropes_Home:0,Ropes_Total:86,Target_Ropes:200,Gap:114,Dried_KG:0.0,Wet_KG:0.0,Total_KG:0.0,Challenges:'',x:39.39843748,y:-4.606221244},
            {Group:'Bati Seaweed Group',Member:'2289_Mwanasiti_Mohamed_Ndalu',Ropes_Ocean:30,Ropes_Home:33,Ropes_Total:63,Target_Ropes:300,Gap:237,Dried_KG:0.0,Wet_KG:0.0,Total_KG:0.0,Challenges:'',x:39.398525,y:-4.603638333},
            {Group:'Tumbe Seaweed Farmers',Member:'2311_Mohamed_Abdalla_Kama',Ropes_Ocean:24,Ropes_Home:29,Ropes_Total:53,Target_Ropes:800,Gap:747,Dried_KG:0.0,Wet_KG:0.0,Total_KG:0.0,Challenges:'',x:39.50213333,y:-4.460416667},
            {Group:'Mtimbwani Seaweed',Member:'2427_Mwanaulu_Omari_Mwabweko',Ropes_Ocean:18,Ropes_Home:90,Ropes_Total:108,Target_Ropes:600,Gap:492,Dried_KG:0.0,Wet_KG:0.0,Total_KG:0.0,Challenges:'Tarai',x:39.29946667,y:-4.610231667},
            {Group:'Furaha Seaweed Group',Member:'2784_Mwanamkasi_Mohamed_Kombo',Ropes_Ocean:18,Ropes_Home:5,Ropes_Total:23,Target_Ropes:270,Gap:247,Dried_KG:0.0,Wet_KG:0.0,Total_KG:0.0,Challenges:'Unsustainable growth',x:39.428845,y:-4.579655},
            {Group:'Furaha Seaweed Group',Member:'2795_Kindu_Kombo_Vuyaa',Ropes_Ocean:27,Ropes_Home:4,Ropes_Total:31,Target_Ropes:300,Gap:269,Dried_KG:0.0,Wet_KG:0.0,Total_KG:0.0,Challenges:'',x:39.42894333,y:-4.57953},
            {Group:'Bati Seaweed Group',Member:'2813_Mwandazi_Omar_Bakari',Ropes_Ocean:25,Ropes_Home:130,Ropes_Total:155,Target_Ropes:300,Gap:145,Dried_KG:0.0,Wet_KG:0.0,Total_KG:0.0,Challenges:'marketing for their products',x:39.398205,y:-4.603841667},
            {Group:'Bati Seaweed Group',Member:'2816_Bijine_Juma_Shoka',Ropes_Ocean:116,Ropes_Home:0,Ropes_Total:116,Target_Ropes:0,Gap:-116,Dried_KG:0.0,Wet_KG:0.0,Total_KG:0.0,Challenges:'',x:39.39960357,y:-4.606241737},
            {Group:'Bati Seaweed Group',Member:'2833_Nimwendo_Shee_Mwagombe',Ropes_Ocean:82,Ropes_Home:200,Ropes_Total:282,Target_Ropes:500,Gap:218,Dried_KG:0.0,Wet_KG:0.0,Total_KG:0.0,Challenges:'',x:39.39716122,y:-4.610463615},
            {Group:'Bati Seaweed Group',Member:'3391_Mwanaisha_Mwinyi_Mwalii',Ropes_Ocean:260,Ropes_Home:80,Ropes_Total:340,Target_Ropes:500,Gap:160,Dried_KG:0.0,Wet_KG:0.0,Total_KG:0.0,Challenges:'Raincot increasing if boats',x:39.39849833,y:-4.603516667},
            {Group:'Furaha Seaweed Group',Member:'3509_Halima_Yusuf_Kalama',Ropes_Ocean:32,Ropes_Home:12,Ropes_Total:44,Target_Ropes:300,Gap:256,Dried_KG:0.0,Wet_KG:0.0,Total_KG:0.0,Challenges:'Seedlings',x:39.42863333,y:-4.578823333},
            {Group:'Bati Seaweed Group',Member:'6626_Kitsao_Katoti_Kalume',Ropes_Ocean:25,Ropes_Home:60,Ropes_Total:85,Target_Ropes:300,Gap:215,Dried_KG:0.0,Wet_KG:0.0,Total_KG:0.0,Challenges:'Labour and seed',x:39.40004233,y:-4.605910183},
            {Group:'Furaha Seaweed Group',Member:'6729_Hadia_Mbaruk_Yusuf',Ropes_Ocean:27,Ropes_Home:4,Ropes_Total:31,Target_Ropes:300,Gap:269,Dried_KG:0.0,Wet_KG:0.0,Total_KG:0.0,Challenges:'',x:39.42897,y:-4.57948},
            {Group:'Furaha Seaweed Group',Member:'6750_Yabu_Rashid_Ngenya',Ropes_Ocean:18,Ropes_Home:21,Ropes_Total:39,Target_Ropes:500,Gap:461,Dried_KG:0.0,Wet_KG:0.0,Total_KG:0.0,Challenges:'Fishermen cut the ropes',x:39.42834667,y:-4.578148333},
            {Group:'Tumbe Seaweed Farmers',Member:'7545_Bebi__Hamisi_Wendo',Ropes_Ocean:89,Ropes_Home:135,Ropes_Total:224,Target_Ropes:250,Gap:26,Dried_KG:0.0,Wet_KG:0.0,Total_KG:0.0,Challenges:'',x:39.50278667,y:-4.463726667},
            {Group:'Bati Seaweed Group',Member:'9010_Mwanaisha__Fundi_Omari',Ropes_Ocean:60,Ropes_Home:5,Ropes_Total:65,Target_Ropes:200,Gap:135,Dried_KG:0.0,Wet_KG:0.0,Total_KG:0.0,Challenges:'rain coat glovesqq',x:39.39762833,y:-4.60101},
            {Group:'Tumbe Seaweed Farmers',Member:'TBD_Faith_Kioko_Mutisya',Ropes_Ocean:34,Ropes_Home:50,Ropes_Total:84,Target_Ropes:500,Gap:416,Dried_KG:0.0,Wet_KG:0.0,Total_KG:0.0,Challenges:'Transportation',x:39.50166,y:-4.46306}
        ];

        // --- Challenge Categorization Keywords (aligned with CSV flag columns) ---
        const challengeKeywords = {
            'Transport': ['transport','far from','distance','road','means of transport','transporting','trsnsport'],
            'Market Access': ['market','buyer','demand','sell','no buyers','no market','middlem'],
            'Low Price': ['low price','price','pricing','cheap'],
            'Equipment/Tools': ['tools','farm tools','equipment','ropes','poles','hat for sun','rain jacket','life jacket','magunia','safety tools','safety material','safety gear','gear','protective','net'],
            'Storage/Drying': ['storage','drying','store','drying racks','drying shed','no storage','mabanda','anikia','dry'],
            'Labour': ['labour','labor','manpower','single mother','casual','workforce'],
            'Sand/Tides': ['sand','tide','tides','swept away','waves','currents','strong tides','strong waves','wind'],
            'Disease/Pests': ['disease','pest','pests','fungi','algae','fish feed','eaten'],
            'Seedlings': ['seedlings','seedling','seeds'],
            'Training': ['training','skill','knowledge','trainings'],
            'Funding': ['fund','capital','money','financial','inadequate funds']
        };

        function categorizeChallenges(text) {
            if (!text || text.trim().toLowerCase() === 'no') return [];
            const lower = text.toLowerCase();
            const cats = [];
            for (const [cat, kws] of Object.entries(challengeKeywords)) {
                if (kws.some(kw => lower.includes(kw))) cats.push(cat);
            }
            if (cats.length === 0 && lower.trim() !== '') cats.push('Other');
            return cats;
        }

        // --- Farmer Dashboard State ---
        let sfdFilteredData = [...seaweedFarmerData];
        const sfdChartInstances = {};

        function sfdDestroyCharts() {
            Object.values(sfdChartInstances).forEach(c => { try { c.destroy(); } catch(e) {} });
            for (const k in sfdChartInstances) delete sfdChartInstances[k];
        }

        function sfdChart(canvasId, config) {
            const canvas = document.getElementById(canvasId);
            if (!canvas) return null;
            const existing = Chart.getChart(canvas);
            if (existing) existing.destroy();
            const chart = new Chart(canvas, config);
            sfdChartInstances[canvasId] = chart;
            return chart;
        }

        // --- Initialize Group Filter Dropdown ---
        function initFarmerFilters() {
            const sel = document.getElementById('sfd-filter-group');
            if (!sel) return;
            const groups = [...new Set(seaweedFarmerData.map(f => f.Group))].sort();
            sel.innerHTML = '<option value="all">All Groups</option>';
            groups.forEach(g => {
                const opt = document.createElement('option');
                opt.value = g; opt.textContent = g;
                sel.appendChild(opt);
            });
        }

        function applyFarmerFilters() {
            const grp = document.getElementById('sfd-filter-group').value;
            const ch = document.getElementById('sfd-filter-challenge').value;
            sfdFilteredData = seaweedFarmerData.filter(f => {
                if (grp !== 'all' && f.Group !== grp) return false;
                if (ch === 'yes' && (!f.Challenges || f.Challenges.trim().toLowerCase() === 'no')) return false;
                if (ch === 'no' && f.Challenges && f.Challenges.trim().toLowerCase() !== 'no') return false;
                return true;
            });
            document.getElementById('sfd-farmer-count').textContent = sfdFilteredData.length + ' of ' + seaweedFarmerData.length + ' farmers';
            renderFarmerDashboard();
        }

        function resetFarmerFilters() {
            document.getElementById('sfd-filter-group').value = 'all';
            document.getElementById('sfd-filter-challenge').value = 'all';
            applyFarmerFilters();
        }

        // --- Group Colors ---
        const sfdGroupColors = {
            'Mkwiro Seaweed Development Group': '#00695C',
            'Tumbe Seaweed Farmers': '#1565C0',
            'Bati Seaweed Group': '#6A1B9A',
            'Mtimbwani Seaweed': '#EF6C00',
            'Furaha Seaweed Group': '#2E7D32',
            'Yungi Mwenjeni Conservation Group': '#C62828',
            'Tushirikiane Conservation Women': '#AD1457'
        };

        // --- Page Switcher ---
        function showFarmerPage(evt, pageId) {
            document.querySelectorAll('.sfd-page').forEach(p => { p.classList.remove('active'); p.style.display = 'none'; });
            const tabs = document.getElementById('sfd-page-tabs');
            if (tabs) tabs.querySelectorAll('.tab-button').forEach(b => { b.classList.remove('active'); b.style.background = ''; b.style.color = ''; });
            const target = document.getElementById(pageId);
            if (target) { target.classList.add('active'); target.style.display = 'block'; }
            if (evt && evt.currentTarget) { evt.currentTarget.classList.add('active'); evt.currentTarget.style.background = '#004D40'; evt.currentTarget.style.color = '#fff'; }
            // Resize charts
            requestAnimationFrame(() => {
                if (target) target.querySelectorAll('canvas').forEach(c => { const ch = Chart.getChart(c); if (ch) ch.resize(); });
            });
            // Special handling for map
            if (pageId === 'sfd-page-map') setTimeout(() => renderFarmerMap(), 100);
        }

        // --- Aggregate Helpers ---
        function sfdGroupAgg(data) {
            const agg = {};
            data.forEach(f => {
                if (!agg[f.Group]) agg[f.Group] = {ropesOcean:0,ropesHome:0,ropesTotal:0,target:0,gap:0,wet:0,dried:0,total:0,count:0,hasChallenges:0};
                const g = agg[f.Group];
                g.ropesOcean += f.Ropes_Ocean; g.ropesHome += f.Ropes_Home; g.ropesTotal += f.Ropes_Total;
                g.target += f.Target_Ropes; g.gap += f.Gap;
                g.wet += f.Wet_KG; g.dried += f.Dried_KG; g.total += f.Total_KG;
                g.count++;
                if (f.Challenges && f.Challenges.trim().toLowerCase() !== 'no') g.hasChallenges++;
            });
            return agg;
        }

        // --- MAIN RENDER FUNCTION ---
        function renderFarmerDashboard() {
            const data = sfdFilteredData;
            if (data.length === 0) return;

            const totals = data.reduce((acc, f) => {
                acc.ropesOcean += f.Ropes_Ocean; acc.ropesHome += f.Ropes_Home; acc.ropesTotal += f.Ropes_Total;
                acc.target += f.Target_Ropes; acc.gap += f.Gap;
                acc.wet += f.Wet_KG; acc.dried += f.Dried_KG; acc.total += f.Total_KG;
                if (f.Challenges && f.Challenges.trim().toLowerCase() !== 'no') acc.withChallenges++;
                return acc;
            }, {ropesOcean:0,ropesHome:0,ropesTotal:0,target:0,gap:0,wet:0,dried:0,total:0,withChallenges:0});

            const pctTarget = totals.target > 0 ? (totals.ropesTotal / totals.target * 100).toFixed(1) : '0';
            const pctChallenges = data.length > 0 ? (totals.withChallenges / data.length * 100).toFixed(1) : '0';

            const grpAgg = sfdGroupAgg(data);
            const grpNames = Object.keys(grpAgg).sort();
            const grpColorArr = grpNames.map(g => sfdGroupColors[g] || '#666');

            // ===== PAGE 1: OVERVIEW =====
            const el = id => document.getElementById(id);
            if (el('sfd-kpi-ropes-installed')) el('sfd-kpi-ropes-installed').textContent = totals.ropesTotal.toLocaleString();
            if (el('sfd-kpi-target-ropes')) el('sfd-kpi-target-ropes').textContent = totals.target.toLocaleString();
            if (el('sfd-kpi-rope-gap')) el('sfd-kpi-rope-gap').textContent = totals.gap.toLocaleString();
            if (el('sfd-kpi-wet-kg')) el('sfd-kpi-wet-kg').textContent = totals.wet.toLocaleString() + ' kg';
            if (el('sfd-kpi-dried-kg')) el('sfd-kpi-dried-kg').textContent = totals.dried.toLocaleString() + ' kg';
            if (el('sfd-kpi-total-kg')) el('sfd-kpi-total-kg').textContent = totals.total.toLocaleString() + ' kg';
            if (el('sfd-kpi-pct-target')) el('sfd-kpi-pct-target').textContent = pctTarget + '%';

            // Ropes vs Target by Group
            sfdChart('sfd-chart-ropes-vs-target', {
                type: 'bar',
                data: {
                    labels: grpNames.map(g => g.length > 18 ? g.substring(0,16) + '…' : g),
                    datasets: [
                        { label: 'Ropes Installed', data: grpNames.map(g => grpAgg[g].ropesTotal), backgroundColor: '#00897B' },
                        { label: 'Target Ropes', data: grpNames.map(g => grpAgg[g].target), backgroundColor: '#90CAF9' }
                    ]
                },
                options: {
                    responsive: true, maintainAspectRatio: false,
                    plugins: { legend: { position: 'top' }, datalabels: { display: true, anchor: 'end', align: 'top', font: { size: 10, weight: 'bold' } } },
                    scales: { y: { beginAtZero: true, title: { display: true, text: 'Ropes' } } }
                }
            });

            // Production Share Pie
            sfdChart('sfd-chart-prod-share', {
                type: 'doughnut',
                data: {
                    labels: grpNames.map(g => g.length > 20 ? g.substring(0,18) + '…' : g),
                    datasets: [{ data: grpNames.map(g => grpAgg[g].total), backgroundColor: grpColorArr, borderWidth: 2 }]
                },
                options: {
                    responsive: true, maintainAspectRatio: false,
                    plugins: {
                        legend: { position: 'right', labels: { font: { size: 11 } } },
                        datalabels: { display: true, font: { size: 12, weight: 'bold' }, color: '#fff', formatter: (v, ctx) => { const t = ctx.dataset.data.reduce((a,b)=>a+b,0); return t>0 ? Math.round(v/t*100)+'%' : ''; } }
                    }
                }
            });

            // Top 10 Table
            const sorted = [...data].sort((a,b) => b.Total_KG - a.Total_KG).slice(0, 10);
            const tbody1 = document.querySelector('#sfd-top10-table tbody');
            if (tbody1) {
                tbody1.innerHTML = sorted.map((f,i) => '<tr><td>'+(i+1)+'</td><td>'+f.Group+'</td><td>'+f.Member+'</td><td>'+f.Ropes_Total+'</td><td>'+f.Target_Ropes+'</td><td>'+f.Gap+'</td><td><strong>'+f.Total_KG+'</strong></td></tr>').join('');
            }

            // ===== PAGE 2: PRODUCTION =====
            const grpTotals = grpNames.map(g => ({ name: g, total: grpAgg[g].total }));
            grpTotals.sort((a,b) => b.total - a.total);
            if (el('sfd-best-group')) el('sfd-best-group').textContent = grpTotals[0] ? grpTotals[0].name : '—';
            if (el('sfd-best-group-kg')) el('sfd-best-group-kg').textContent = grpTotals[0] ? grpTotals[0].total.toLocaleString() + ' KG' : '';
            const worst = grpTotals[grpTotals.length-1];
            if (el('sfd-worst-group')) el('sfd-worst-group').textContent = worst ? worst.name : '—';
            if (el('sfd-worst-group-kg')) el('sfd-worst-group-kg').textContent = worst ? worst.total.toLocaleString() + ' KG' : '';
            if (el('sfd-total-farmers')) el('sfd-total-farmers').textContent = data.length;
            if (el('sfd-avg-prod')) el('sfd-avg-prod').textContent = data.length > 0 ? (totals.total / data.length).toFixed(1) : '0';

            // Production by Group (multi-series)
            sfdChart('sfd-chart-prod-by-group', {
                type: 'bar',
                data: {
                    labels: grpNames.map(g => g.length > 18 ? g.substring(0,16) + '…' : g),
                    datasets: [
                        { label: 'Wet KG', data: grpNames.map(g => grpAgg[g].wet), backgroundColor: '#4DB6AC' },
                        { label: 'Dried KG', data: grpNames.map(g => grpAgg[g].dried), backgroundColor: '#00695C' },
                        { label: 'Total KG', data: grpNames.map(g => grpAgg[g].total), backgroundColor: '#004D40' }
                    ]
                },
                options: {
                    responsive: true, maintainAspectRatio: false,
                    plugins: { legend: { position: 'top' }, datalabels: { display: false } },
                    scales: { y: { beginAtZero: true, title: { display: true, text: 'KG' } } }
                }
            });

            // Avg Ropes per Farmer
            sfdChart('sfd-chart-avg-ropes', {
                type: 'bar',
                data: {
                    labels: grpNames.map(g => g.length > 18 ? g.substring(0,16) + '…' : g),
                    datasets: [{ label: 'Avg Ropes/Farmer', data: grpNames.map(g => grpAgg[g].count > 0 ? Math.round(grpAgg[g].ropesTotal / grpAgg[g].count) : 0), backgroundColor: grpColorArr }]
                },
                options: {
                    responsive: true, maintainAspectRatio: false,
                    plugins: { legend: { display: false }, datalabels: { display: true, anchor: 'end', align: 'top', font: { size: 12, weight: 'bold' } } },
                    scales: { y: { beginAtZero: true, title: { display: true, text: 'Avg Ropes' } } }
                }
            });

            // Production Histogram
            const bins = [0,50,100,200,300,500,750,1000];
            const histData = new Array(bins.length).fill(0);
            data.forEach(f => {
                for (let i = bins.length - 1; i >= 0; i--) {
                    if (f.Total_KG >= bins[i]) { histData[i]++; break; }
                }
            });
            const histLabels = bins.map((b,i) => i < bins.length-1 ? b + '–' + (bins[i+1]-1) : b + '+');
            sfdChart('sfd-chart-prod-histogram', {
                type: 'bar',
                data: {
                    labels: histLabels,
                    datasets: [{ label: 'Farmers', data: histData, backgroundColor: '#00897B' }]
                },
                options: {
                    responsive: true, maintainAspectRatio: false,
                    plugins: { legend: { display: false }, datalabels: { display: true, anchor: 'end', align: 'top', font: { size: 12, weight: 'bold' } } },
                    scales: { y: { beginAtZero: true, title: { display: true, text: 'Farmers' } }, x: { title: { display: true, text: 'Total KG Range' } } }
                }
            });

            // ===== PAGE 3: ROPE MONITORING =====
            if (el('sfd-rope-gap-kpi')) el('sfd-rope-gap-kpi').textContent = totals.gap.toLocaleString();
            if (el('sfd-ropes-ocean')) el('sfd-ropes-ocean').textContent = totals.ropesOcean.toLocaleString();
            if (el('sfd-ropes-home')) el('sfd-ropes-home').textContent = totals.ropesHome.toLocaleString();
            if (el('sfd-rope-pct')) el('sfd-rope-pct').textContent = pctTarget + '%';

            // Gap by Group
            sfdChart('sfd-chart-gap-by-group', {
                type: 'bar',
                data: {
                    labels: grpNames.map(g => g.length > 18 ? g.substring(0,16) + '…' : g),
                    datasets: [{ label: 'Rope Gap', data: grpNames.map(g => grpAgg[g].gap), backgroundColor: '#C62828' }]
                },
                options: {
                    responsive: true, maintainAspectRatio: false,
                    plugins: { legend: { display: false }, datalabels: { display: true, anchor: 'end', align: 'top', font: { size: 12, weight: 'bold' } } },
                    scales: { y: { beginAtZero: true, title: { display: true, text: 'Rope Gap' } } }
                }
            });

            // Scatter: Target vs Actual
            const scatterDatasets = grpNames.map(g => ({
                label: g.length > 20 ? g.substring(0,18) + '…' : g,
                data: data.filter(f => f.Group === g).map(f => ({ x: f.Target_Ropes, y: f.Ropes_Total, member: f.Member, gap: f.Gap, kg: f.Total_KG })),
                backgroundColor: sfdGroupColors[g] || '#666',
                pointRadius: 7, pointHoverRadius: 10
            }));
            sfdChart('sfd-chart-scatter-ropes', {
                type: 'scatter',
                data: { datasets: scatterDatasets },
                options: {
                    responsive: true, maintainAspectRatio: false,
                    plugins: {
                        legend: { position: 'top', labels: { font: { size: 10 } } },
                        datalabels: { display: false },
                        tooltip: {
                            callbacks: {
                                label: ctx => {
                                    const p = ctx.raw;
                                    return [ctx.dataset.label, p.member || '', 'Target: '+p.x+', Actual: '+p.y, 'Gap: '+p.gap+', KG: '+p.kg];
                                }
                            }
                        }
                    },
                    scales: {
                        x: { title: { display: true, text: 'Target Ropes' }, beginAtZero: true },
                        y: { title: { display: true, text: 'Actual Ropes' }, beginAtZero: true }
                    }
                }
            });

            // % Target by Group
            sfdChart('sfd-chart-pct-by-group', {
                type: 'bar',
                data: {
                    labels: grpNames.map(g => g.length > 18 ? g.substring(0,16) + '…' : g),
                    datasets: [{
                        label: '% Target Achieved',
                        data: grpNames.map(g => grpAgg[g].target > 0 ? Math.round(grpAgg[g].ropesTotal / grpAgg[g].target * 100) : 0),
                        backgroundColor: grpNames.map(g => {
                            const pct = grpAgg[g].target > 0 ? grpAgg[g].ropesTotal / grpAgg[g].target * 100 : 0;
                            return pct >= 80 ? '#2E7D32' : pct >= 50 ? '#EF6C00' : '#C62828';
                        })
                    }]
                },
                options: {
                    responsive: true, maintainAspectRatio: false,
                    plugins: { legend: { display: false }, datalabels: { display: true, anchor: 'end', align: 'top', font: { size: 13, weight: 'bold' }, formatter: v => v + '%' } },
                    scales: { y: { beginAtZero: true, max: 110, title: { display: true, text: '%' } } }
                }
            });

            // Gap Table (Top 20)
            const gapSorted = [...data].sort((a,b) => b.Gap - a.Gap).slice(0, 20);
            const gapTbody = document.querySelector('#sfd-gap-table tbody');
            if (gapTbody) {
                gapTbody.innerHTML = gapSorted.map((f,i) => '<tr' + (f.Gap > 80 ? ' style="background:#ffebee;"' : '') + '><td>'+(i+1)+'</td><td>'+f.Group+'</td><td>'+f.Member+'</td><td>'+f.Target_Ropes+'</td><td>'+f.Ropes_Total+'</td><td><strong style="color:#C62828;">'+f.Gap+'</strong></td><td>'+f.Total_KG+'</td></tr>').join('');
            }

            // ===== PAGE 4: CHALLENGES =====
            if (el('sfd-pct-challenges')) el('sfd-pct-challenges').textContent = pctChallenges + '%';
            if (el('sfd-num-challenges')) el('sfd-num-challenges').textContent = totals.withChallenges;

            // Challenge categorization
            const catCounts = {};
            data.forEach(f => {
                const cats = categorizeChallenges(f.Challenges);
                cats.forEach(c => { catCounts[c] = (catCounts[c] || 0) + 1; });
            });
            const catNames = Object.keys(catCounts).sort((a,b) => catCounts[b] - catCounts[a]);
            const catVals = catNames.map(c => catCounts[c]);
            const topCat = catNames[0] || '—';
            if (el('sfd-top-challenge')) el('sfd-top-challenge').textContent = topCat;
            if (el('sfd-top-challenge-n')) el('sfd-top-challenge-n').textContent = catVals[0] ? catVals[0] + ' farmers' : '';

            // Challenge category bar chart
            const catColors = ['#C62828','#EF6C00','#FF8F00','#F9A825','#00695C','#1565C0','#6A1B9A','#AD1457','#00897B','#2E7D32','#4527A0','#004D40'];
            sfdChart('sfd-chart-challenge-cats', {
                type: 'bar',
                indexAxis: 'y',
                data: {
                    labels: catNames,
                    datasets: [{ label: 'Farmers', data: catVals, backgroundColor: catNames.map((c,i) => catColors[i % catColors.length]) }]
                },
                options: {
                    responsive: true, maintainAspectRatio: false,
                    plugins: { legend: { display: false }, datalabels: { display: true, anchor: 'end', align: 'right', font: { size: 12, weight: 'bold' } } },
                    scales: { x: { beginAtZero: true, title: { display: true, text: 'Number of Farmers' } } }
                }
            });

            // Challenge prevalence by group
            sfdChart('sfd-chart-challenge-by-group', {
                type: 'bar',
                data: {
                    labels: grpNames.map(g => g.length > 18 ? g.substring(0,16) + '…' : g),
                    datasets: [{
                        label: '% Reporting Challenges',
                        data: grpNames.map(g => grpAgg[g].count > 0 ? Math.round(grpAgg[g].hasChallenges / grpAgg[g].count * 100) : 0),
                        backgroundColor: grpColorArr
                    }]
                },
                options: {
                    responsive: true, maintainAspectRatio: false,
                    plugins: { legend: { display: false }, datalabels: { display: true, anchor: 'end', align: 'top', font: { size: 12, weight: 'bold' }, formatter: v => v + '%' } },
                    scales: { y: { beginAtZero: true, max: 110, title: { display: true, text: '%' } } }
                }
            });

            // Challenges Detail Table
            const challTbody = document.querySelector('#sfd-challenges-table tbody');
            if (challTbody) {
                const challFarmers = data.filter(f => f.Challenges && f.Challenges.trim().toLowerCase() !== 'no');
                challTbody.innerHTML = challFarmers.map((f,i) => '<tr><td>'+(i+1)+'</td><td>'+f.Group+'</td><td>'+f.Member+'</td><td>'+f.Challenges+'</td><td>'+f.Total_KG+'</td></tr>').join('');
                if (challFarmers.length === 0) challTbody.innerHTML = '<tr><td colspan="5" style="text-align:center; color:#999;">No challenges reported in filtered data</td></tr>';
            }

            // ===== PAGE 5: MAP =====
            if (el('sfd-map-groups')) el('sfd-map-groups').textContent = grpNames.length;
            if (el('sfd-map-farmers')) el('sfd-map-farmers').textContent = data.length;
            if (el('sfd-map-production')) el('sfd-map-production').textContent = totals.total.toLocaleString() + ' kg';

            // Location Table
            const locTbody = document.querySelector('#sfd-location-table tbody');
            if (locTbody) {
                locTbody.innerHTML = data.map((f,i) => '<tr><td>'+(i+1)+'</td><td>'+f.Group+'</td><td>'+f.Member+'</td><td>'+f.y.toFixed(4)+'</td><td>'+f.x.toFixed(4)+'</td><td>'+f.Total_KG+'</td><td>'+f.Ropes_Total+'</td></tr>').join('');
            }

            // Map legend
            const legend = document.getElementById('sfd-map-legend');
            if (legend) {
                legend.innerHTML = grpNames.map(g => '<span style="display:inline-flex;align-items:center;gap:5px;"><span style="width:14px;height:14px;border-radius:50%;background:'+(sfdGroupColors[g]||'#666')+';display:inline-block;"></span><span style="font-size:0.85em;">'+g+'</span></span>').join('');
            }

            // Render map if visible
            const mapPage = document.getElementById('sfd-page-map');
            if (mapPage && mapPage.style.display !== 'none') renderFarmerMap();

            // ===== PAGE 6: FARMER PROFILING & CATEGORIZATION =====
            const profCategories = [
                { key: 'Large Scale', min: 300, max: Infinity, color: '#1565C0', range: '300+', support: 'Confidence to support — meets target' },
                { key: 'Upper Medium', min: 200, max: 299, color: '#1976D2', range: '200–299', support: 'Given as requested — meets ≥350 target' },
                { key: 'Lower Medium', min: 100, max: 199, color: '#2E7D32', range: '100–199', support: 'To reach 350 — move home ropes to ocean' },
                { key: 'Upper Small', min: 50, max: 99, color: '#F9A825', range: '50–99', support: 'To reach 150 — move home ropes to ocean' },
                { key: 'Lower Small', min: 0, max: 49, color: '#E65100', range: '<50', support: 'Move from home to ocean — reach 50 ropes' }
            ];

            function categorizeFarmer(ropesOcean) {
                for (const cat of profCategories) {
                    if (ropesOcean >= cat.min && ropesOcean <= cat.max) return cat;
                }
                return profCategories[profCategories.length - 1];
            }

            // Classify all farmers
            const profAgg = {};
            profCategories.forEach(c => { profAgg[c.key] = { count: 0, ropesOcean: 0, ropesHome: 0, ropesTotal: 0, target: 0, gap: 0, totalKG: 0, farmers: [] }; });
            data.forEach(f => {
                const cat = categorizeFarmer(f.Ropes_Ocean);
                const a = profAgg[cat.key];
                a.count++; a.ropesOcean += f.Ropes_Ocean; a.ropesHome += f.Ropes_Home; a.ropesTotal += f.Ropes_Total;
                a.target += f.Target_Ropes; a.gap += f.Gap; a.totalKG += f.Total_KG;
                a.farmers.push(f);
            });

            const profLabels = profCategories.map(c => c.key);
            const profColors = profCategories.map(c => c.color);
            const profCounts = profLabels.map(l => profAgg[l].count);
            const profGaps = profLabels.map(l => profAgg[l].gap);
            const totalFarmers = data.length;

            // KPIs
            profCategories.forEach((c, i) => {
                const ids = ['sfd-prof-large','sfd-prof-uppmed','sfd-prof-lowmed','sfd-prof-uppsml','sfd-prof-lowsml'];
                if (el(ids[i])) el(ids[i]).textContent = profAgg[c.key].count + ' (' + (totalFarmers > 0 ? Math.round(profAgg[c.key].count / totalFarmers * 100) : 0) + '%)';
            });

            // Chart: Farmers by Category (bar)
            sfdChart('sfd-chart-prof-dist', {
                type: 'bar',
                data: { labels: profLabels, datasets: [{ label: 'Farmers', data: profCounts, backgroundColor: profColors }] },
                options: { responsive: true, maintainAspectRatio: false, plugins: { legend: { display: false }, datalabels: { display: true, anchor: 'end', align: 'top', font: { size: 13, weight: 'bold' }, color: '#333' } }, scales: { y: { beginAtZero: true, title: { display: true, text: 'Number of Farmers' } } } }
            });

            // Chart: Ropes Required by Category (bar)
            sfdChart('sfd-chart-prof-ropes', {
                type: 'bar',
                data: { labels: profLabels, datasets: [{ label: 'Ropes Required (Gap)', data: profGaps, backgroundColor: profColors }] },
                options: { responsive: true, maintainAspectRatio: false, plugins: { legend: { display: false }, datalabels: { display: true, anchor: 'end', align: 'top', font: { size: 12, weight: 'bold' }, formatter: v => v.toLocaleString() } }, scales: { y: { beginAtZero: true, title: { display: true, text: 'Ropes Required' }, ticks: { callback: v => (v/1000).toFixed(0)+'k' } } } }
            });

            // Chart: Category Distribution Pie
            sfdChart('sfd-chart-prof-pie', {
                type: 'doughnut',
                data: { labels: profLabels, datasets: [{ data: profCounts, backgroundColor: profColors, borderWidth: 2 }] },
                options: { responsive: true, maintainAspectRatio: false, plugins: { legend: { position: 'right', labels: { font: { size: 12 } } }, datalabels: { display: true, font: { size: 13, weight: 'bold' }, color: '#fff', formatter: (v, ctx) => { const t = ctx.dataset.data.reduce((a,b)=>a+b,0); return t>0 ? Math.round(v/t*100)+'%' : ''; } } } }
            });

            // Chart: Avg Production by Category
            const profAvgProd = profLabels.map(l => profAgg[l].count > 0 ? Math.round(profAgg[l].totalKG / profAgg[l].count) : 0);
            sfdChart('sfd-chart-prof-production', {
                type: 'bar',
                data: { labels: profLabels, datasets: [{ label: 'Avg Production (KG)', data: profAvgProd, backgroundColor: profColors }] },
                options: { responsive: true, maintainAspectRatio: false, plugins: { legend: { display: false }, datalabels: { display: true, anchor: 'end', align: 'top', font: { size: 12, weight: 'bold' }, formatter: v => v.toLocaleString() } }, scales: { y: { beginAtZero: true, title: { display: true, text: 'Avg KG per Farmer' } } } }
            });

            // Summary Table
            const profTbody = document.querySelector('#sfd-profiling-table tbody');
            if (profTbody) {
                profTbody.innerHTML = profCategories.map(c => {
                    const a = profAgg[c.key];
                    const pct = totalFarmers > 0 ? (a.count / totalFarmers * 100).toFixed(1) : '0';
                    const avgProd = a.count > 0 ? Math.round(a.totalKG / a.count).toLocaleString() : '0';
                    return '<tr><td><span style="display:inline-block;width:12px;height:12px;border-radius:3px;background:'+c.color+';margin-right:6px;vertical-align:middle;"></span><strong>'+c.key+'</strong></td><td>'+c.range+'</td><td>'+a.count+'</td><td>'+pct+'%</td><td>'+a.ropesOcean.toLocaleString()+'</td><td>'+a.ropesHome.toLocaleString()+'</td><td>'+a.ropesTotal.toLocaleString()+'</td><td>'+a.target.toLocaleString()+'</td><td><strong>'+a.gap.toLocaleString()+'</strong></td><td>'+avgProd+'</td><td style="font-size:0.85em;">'+c.support+'</td></tr>';
                }).join('') + '<tr style="background:#f0f0f0;font-weight:bold;"><td>Grand Total</td><td></td><td>'+totalFarmers+'</td><td>100%</td><td>'+totals.ropesOcean.toLocaleString()+'</td><td>'+totals.ropesHome.toLocaleString()+'</td><td>'+totals.ropesTotal.toLocaleString()+'</td><td>'+totals.target.toLocaleString()+'</td><td><strong>'+totals.gap.toLocaleString()+'</strong></td><td>'+(totalFarmers > 0 ? Math.round(totals.total / totalFarmers).toLocaleString() : '0')+'</td><td></td></tr>';
            }

            // Detailed Farmer Table
            const profDetailTbody = document.querySelector('#sfd-profiling-detail-table tbody');
            if (profDetailTbody) {
                const sortedFarmers = [...data].sort((a,b) => b.Ropes_Ocean - a.Ropes_Ocean);
                profDetailTbody.innerHTML = sortedFarmers.map((f, i) => {
                    const cat = categorizeFarmer(f.Ropes_Ocean);
                    return '<tr><td>'+(i+1)+'</td><td>'+f.Group+'</td><td>'+f.Member+'</td><td>'+f.Ropes_Ocean+'</td><td>'+f.Ropes_Home+'</td><td>'+f.Ropes_Total+'</td><td>'+f.Target_Ropes+'</td><td>'+f.Gap+'</td><td>'+f.Total_KG+'</td><td><span style="padding:2px 8px;border-radius:4px;background:'+cat.color+';color:#fff;font-size:0.85em;font-weight:600;">'+cat.key+'</span></td></tr>';
                }).join('');
            }
        }

        // --- Canvas-based Farmer Map ---
        function renderFarmerMap() {
            const canvas = document.getElementById('sfd-map-canvas');
            if (!canvas) return;
            const container = document.getElementById('sfd-map-container');
            const rect = container.getBoundingClientRect();
            canvas.width = rect.width;
            canvas.height = rect.height;
            const ctx = canvas.getContext('2d');
            ctx.clearRect(0, 0, canvas.width, canvas.height);

            const data = sfdFilteredData.filter(f => f.x && f.y);
            if (data.length === 0) {
                ctx.fillStyle = '#999'; ctx.font = '16px sans-serif'; ctx.textAlign = 'center';
                ctx.fillText('No geo-located farmers in filtered data', canvas.width/2, canvas.height/2);
                return;
            }

            // Draw background
            ctx.fillStyle = '#e0f2f1'; ctx.fillRect(0, 0, canvas.width, canvas.height);

            // Calculate bounds with padding
            const lons = data.map(f => f.x), lats = data.map(f => f.y);
            const minLon = Math.min(...lons), maxLon = Math.max(...lons);
            const minLat = Math.min(...lats), maxLat = Math.max(...lats);
            const pad = 40;
            const lonRange = maxLon - minLon || 0.01;
            const latRange = maxLat - minLat || 0.01;

            function toXY(lon, lat) {
                const px = pad + (lon - minLon) / lonRange * (canvas.width - 2*pad);
                const py = pad + (maxLat - lat) / latRange * (canvas.height - 2*pad); // invert Y
                return [px, py];
            }

            // Max production for sizing
            const maxKg = Math.max(...data.map(f => f.Total_KG), 1);

            // Draw grid lines
            ctx.strokeStyle = '#b2dfdb'; ctx.lineWidth = 0.5;
            for (let i = 0; i <= 4; i++) {
                const x = pad + i * (canvas.width - 2*pad) / 4;
                ctx.beginPath(); ctx.moveTo(x, pad); ctx.lineTo(x, canvas.height - pad); ctx.stroke();
                const lon = minLon + i * lonRange / 4;
                ctx.fillStyle = '#666'; ctx.font = '10px sans-serif'; ctx.textAlign = 'center';
                ctx.fillText(lon.toFixed(3), x, canvas.height - pad + 15);
            }
            for (let i = 0; i <= 4; i++) {
                const y = pad + i * (canvas.height - 2*pad) / 4;
                ctx.beginPath(); ctx.moveTo(pad, y); ctx.lineTo(canvas.width - pad, y); ctx.stroke();
                const lat = maxLat - i * latRange / 4;
                ctx.fillStyle = '#666'; ctx.font = '10px sans-serif'; ctx.textAlign = 'right';
                ctx.fillText(lat.toFixed(3), pad - 5, y + 4);
            }

            // Draw coast line suggestion
            ctx.fillStyle = '#80cbc4'; ctx.globalAlpha = 0.2;
            ctx.fillRect(0, 0, pad, canvas.height); // left border as "land"
            ctx.globalAlpha = 1;

            // Axis labels
            ctx.fillStyle = '#004D40'; ctx.font = 'bold 11px sans-serif'; ctx.textAlign = 'center';
            ctx.fillText('Longitude', canvas.width/2, canvas.height - 5);
            ctx.save(); ctx.translate(12, canvas.height/2); ctx.rotate(-Math.PI/2);
            ctx.fillText('Latitude', 0, 0); ctx.restore();

            // Draw points
            data.forEach(f => {
                const [px, py] = toXY(f.x, f.y);
                const r = 6 + (f.Total_KG / maxKg) * 18;
                const color = sfdGroupColors[f.Group] || '#666';
                ctx.beginPath(); ctx.arc(px, py, r, 0, Math.PI*2);
                ctx.fillStyle = color; ctx.globalAlpha = 0.7; ctx.fill();
                ctx.globalAlpha = 1; ctx.strokeStyle = '#fff'; ctx.lineWidth = 2; ctx.stroke();
            });

            // Title
            ctx.fillStyle = '#004D40'; ctx.font = 'bold 14px sans-serif'; ctx.textAlign = 'left';
            ctx.fillText('Seaweed Farm Locations — Kwale County', pad + 5, pad - 10);

            // Tooltip interaction
            const tooltip = document.getElementById('sfd-map-tooltip');
            canvas.onmousemove = function(e) {
                const crect = canvas.getBoundingClientRect();
                const mx = e.clientX - crect.left, my = e.clientY - crect.top;
                let found = null;
                for (const f of data) {
                    const [px, py] = toXY(f.x, f.y);
                    const r = 6 + (f.Total_KG / maxKg) * 18;
                    if (Math.hypot(mx-px, my-py) <= r) { found = f; break; }
                }
                if (found && tooltip) {
                    tooltip.style.display = 'block';
                    tooltip.style.left = (mx + 15) + 'px'; tooltip.style.top = (my - 10) + 'px';
                    tooltip.innerHTML = '<strong>'+found.Member+'</strong><br>'+found.Group+'<br>Ropes: '+found.Ropes_Total+' / '+found.Target_Ropes+'<br>Production: '+found.Total_KG+' KG<br>Gap: '+found.Gap+(found.Challenges && found.Challenges.toLowerCase()!=='no' ? '<br>Challenges: '+found.Challenges : '');
                } else if (tooltip) { tooltip.style.display = 'none'; }
            };
            canvas.onmouseleave = function() { if (tooltip) tooltip.style.display = 'none'; };
        }

        // --- Initialize Farmer Dashboard on Seaweed Tab Switch ---
        const origShowSeaweedTab = showSeaweedTab;
        showSeaweedTab = function(evt, tabName) {
            origShowSeaweedTab(evt, tabName);
            if (tabName === 'swtab-farmer-dashboard') {
                initFarmerFilters();
                sfdFilteredData = [...seaweedFarmerData];
                document.getElementById('sfd-farmer-count').textContent = sfdFilteredData.length + ' of ' + seaweedFarmerData.length + ' farmers';
                renderFarmerDashboard();
            }
        };

        // ====================================================================
        // ========== VSLA MONITORING DASHBOARD — DATA & CHARTS ===============
        // ====================================================================

        const vslaData = [
            {name:'Agape self help group',county:'Kilifi',village:'Mavueni',cycle:'Cycle_1',quarter:'Q2',cbt:'Ethel zobe',femaleReg:17,maleReg:3,totalReg:20,femaleLeft:5,maleLeft:0,totalLeft:5,meetFreq:'Always',attendHigh:0,attendMod:1,attendLow:0,activeSavingF:17,activeSavingM:3,activeSavingT:20,savingsSum:12700.0,savingsAvg:12700.0,savingsMax:12700.0,savingsMin:12700.0,loansDisbursed:5000.0,loansRepaid:4000.0,repayProportion:0.8,repaymentValue:4000.0,interestEarned:400.0,loansDisbursedCount:5,loansRepaidCount:4,socialFundYes:true,socialFundValue:3000.0,failedLoan:false,loanUse:{business:0.25,schoolFees:0.25,food:0.25,clothing:0,shelter:0,household:0.25}},
            {name:'Amani Dzibwage Widows group',county:'Kwale',village:'Dzibwage Fingirika',cycle:'Cycle_1',quarter:'Q2',cbt:'TOT Amina Hassan Mwafrika CBT Mwanamkuu Tambwe',femaleReg:25,maleReg:0,totalReg:25,femaleLeft:1,maleLeft:0,totalLeft:1,meetFreq:'Always',attendHigh:1,attendMod:0,attendLow:0,activeSavingF:25,activeSavingM:0,activeSavingT:25,savingsSum:84595.0,savingsAvg:84595.0,savingsMax:84595.0,savingsMin:84595.0,loansDisbursed:62600.0,loansRepaid:9.0,repayProportion:0.0,repaymentValue:9.0,interestEarned:2200.0,loansDisbursedCount:23,loansRepaidCount:21995,socialFundYes:true,socialFundValue:15500.0,failedLoan:true,loanUse:{business:0.25,schoolFees:0.25,food:0,clothing:0.25,shelter:0,household:0.25}},
            {name:'Amani Dzibwage Widows group',county:'Kwale',village:'Fingirika',cycle:'Cycle_2',quarter:'Q3',cbt:'Mwanamkuu Hassan Tambwe CBT',femaleReg:25,maleReg:0,totalReg:25,femaleLeft:2,maleLeft:0,totalLeft:2,meetFreq:'Always',attendHigh:1,attendMod:0,attendLow:0,activeSavingF:25,activeSavingM:0,activeSavingT:25,savingsSum:100000.0,savingsAvg:100000.0,savingsMax:100000.0,savingsMin:100000.0,loansDisbursed:67950.0,loansRepaid:43050.0,repayProportion:0.63,repaymentValue:43050.0,interestEarned:4305.0,loansDisbursedCount:20,loansRepaidCount:13,socialFundYes:true,socialFundValue:24900.0,failedLoan:false,loanUse:{business:0.33,schoolFees:0.33,food:0,clothing:0,shelter:0,household:0.33}},
            {name:'Amani River Ramisi VSLA',county:'Kwale',village:'Darigube',cycle:'Cycle_1',quarter:'Q3',cbt:'Abdallah Halfani Hassan',femaleReg:14,maleReg:10,totalReg:24,femaleLeft:14,maleLeft:9,totalLeft:23,meetFreq:'Always',attendHigh:0,attendMod:1,attendLow:0,activeSavingF:13,activeSavingM:10,activeSavingT:23,savingsSum:361745.0,savingsAvg:361745.0,savingsMax:361745.0,savingsMin:361745.0,loansDisbursed:568800.0,loansRepaid:398635.0,repayProportion:0.7,repaymentValue:398635.0,interestEarned:34980.0,loansDisbursedCount:67,loansRepaidCount:50,socialFundYes:true,socialFundValue:17710.0,failedLoan:false,loanUse:{business:0.17,schoolFees:0.17,food:0.17,clothing:0.17,shelter:0.17,household:0.17}},
            {name:'Amani River Ramisi VSLA',county:'Kwale',village:'Darigube',cycle:'Cycle_1',quarter:'Q2',cbt:'Abdalla Halfani Hassan',femaleReg:14,maleReg:10,totalReg:24,femaleLeft:0,maleLeft:1,totalLeft:1,meetFreq:'Always',attendHigh:0,attendMod:1,attendLow:0,activeSavingF:13,activeSavingM:10,activeSavingT:23,savingsSum:193540.0,savingsAvg:193540.0,savingsMax:193540.0,savingsMin:193540.0,loansDisbursed:508700.0,loansRepaid:313245.0,repayProportion:0.62,repaymentValue:313245.0,interestEarned:20130.0,loansDisbursedCount:56,loansRepaidCount:39,socialFundYes:true,socialFundValue:13920.0,failedLoan:false,loanUse:{business:0.17,schoolFees:0.17,food:0.17,clothing:0.17,shelter:0.17,household:0.17}},
            {name:'Amka utsamba vsla',county:'Kwale',village:'Utsamba',cycle:'Cycle_2',quarter:'Q2',cbt:'Marinda said',femaleReg:22,maleReg:7,totalReg:29,femaleLeft:1,maleLeft:0,totalLeft:1,meetFreq:'Always',attendHigh:1,attendMod:0,attendLow:0,activeSavingF:21,activeSavingM:7,activeSavingT:28,savingsSum:234775.0,savingsAvg:234775.0,savingsMax:234775.0,savingsMin:234775.0,loansDisbursed:219000.0,loansRepaid:172000.0,repayProportion:0.79,repaymentValue:172000.0,interestEarned:21900.0,loansDisbursedCount:28,loansRepaidCount:10,socialFundYes:true,socialFundValue:62400.0,failedLoan:false,loanUse:{business:0.25,schoolFees:0.25,food:0,clothing:0,shelter:0.25,household:0.25}},
            {name:'Bariki Self help group',county:'Kilifi',village:'Kanyumbuni',cycle:'Cycle_1',quarter:'Q2',cbt:'Riziki Karisa Wanje',femaleReg:27,maleReg:0,totalReg:27,femaleLeft:3,maleLeft:0,totalLeft:3,meetFreq:'Always',attendHigh:0,attendMod:0,attendLow:1,activeSavingF:27,activeSavingM:0,activeSavingT:27,savingsSum:43350.0,savingsAvg:43350.0,savingsMax:43350.0,savingsMin:43350.0,loansDisbursed:52200.0,loansRepaid:42000.0,repayProportion:0.8,repaymentValue:42000.0,interestEarned:4200.0,loansDisbursedCount:24,loansRepaidCount:21,socialFundYes:true,socialFundValue:750.0,failedLoan:true,loanUse:{business:0.25,schoolFees:0.25,food:0.25,clothing:0,shelter:0.25,household:0}},
            {name:'Bariki SHG',county:'Kilifi',village:'Kanyumbuni',cycle:'Cycle_3',quarter:'Q3',cbt:'Esther Munga  Chuka',femaleReg:27,maleReg:0,totalReg:27,femaleLeft:1,maleLeft:0,totalLeft:1,meetFreq:'Always',attendHigh:0,attendMod:1,attendLow:0,activeSavingF:23,activeSavingM:0,activeSavingT:23,savingsSum:24600.0,savingsAvg:24600.0,savingsMax:24600.0,savingsMin:24600.0,loansDisbursed:21000.0,loansRepaid:18000.0,repayProportion:0.86,repaymentValue:18000.0,interestEarned:1800.0,loansDisbursedCount:8,loansRepaidCount:5,socialFundYes:true,socialFundValue:8500.0,failedLoan:true,loanUse:{business:0,schoolFees:0.33,food:0.33,clothing:0,shelter:0,household:0.33}},
            {name:'Bati seaweed farmers vsla A',county:'Kwale',village:'Bati',cycle:'Cycle_2',quarter:'Q3',cbt:'Fatuma Masudi',femaleReg:17,maleReg:0,totalReg:17,femaleLeft:0,maleLeft:0,totalLeft:0,meetFreq:'Always',attendHigh:0,attendMod:1,attendLow:0,activeSavingF:17,activeSavingM:0,activeSavingT:17,savingsSum:71970.0,savingsAvg:71970.0,savingsMax:71970.0,savingsMin:71970.0,loansDisbursed:48400.0,loansRepaid:5600.0,repayProportion:0.12,repaymentValue:5600.0,interestEarned:4840.0,loansDisbursedCount:13,loansRepaidCount:0,socialFundYes:true,socialFundValue:12750.0,failedLoan:false,loanUse:{business:0.2,schoolFees:0.2,food:0.2,clothing:0,shelter:0.2,household:0.2}},
            {name:'Bati seaweed farmers vsla B',county:'Kwale',village:'bati',cycle:'Cycle_1',quarter:'Q3',cbt:'fatuma juma',femaleReg:15,maleReg:6,totalReg:21,femaleLeft:1,maleLeft:3,totalLeft:4,meetFreq:'Always',attendHigh:1,attendMod:0,attendLow:0,activeSavingF:12,activeSavingM:5,activeSavingT:17,savingsSum:64730.0,savingsAvg:64730.0,savingsMax:64730.0,savingsMin:64730.0,loansDisbursed:17500.0,loansRepaid:1600.0,repayProportion:0.09,repaymentValue:1600.0,interestEarned:1600.0,loansDisbursedCount:7,loansRepaidCount:0,socialFundYes:true,socialFundValue:23350.0,failedLoan:false,loanUse:{business:0.25,schoolFees:0.25,food:0,clothing:0,shelter:0.25,household:0.25}},
            {name:'Bati seaweed vsla A',county:'Kwale',village:'Bati',cycle:'Cycle_2',quarter:'Q3',cbt:'Fatuma masudi',femaleReg:17,maleReg:0,totalReg:17,femaleLeft:0,maleLeft:0,totalLeft:0,meetFreq:'Always',attendHigh:1,attendMod:0,attendLow:0,activeSavingF:17,activeSavingM:0,activeSavingT:17,savingsSum:71970.0,savingsAvg:71970.0,savingsMax:71970.0,savingsMin:71970.0,loansDisbursed:48400.0,loansRepaid:5600.0,repayProportion:0.12,repaymentValue:5600.0,interestEarned:4840.0,loansDisbursedCount:13,loansRepaidCount:0,socialFundYes:true,socialFundValue:12750.0,failedLoan:false,loanUse:{business:0.25,schoolFees:0.25,food:0.25,clothing:0,shelter:0,household:0.25}},
            {name:'Bati seaweed Vsla A',county:'Kwale',village:'Bati',cycle:'Cycle_2',quarter:'Q2',cbt:'Fatuma masudi',femaleReg:17,maleReg:0,totalReg:17,femaleLeft:2,maleLeft:0,totalLeft:2,meetFreq:'Always',attendHigh:1,attendMod:0,attendLow:0,activeSavingF:17,activeSavingM:0,activeSavingT:17,savingsSum:9200.0,savingsAvg:9200.0,savingsMax:9200.0,savingsMin:9200.0,loansDisbursed:0.0,loansRepaid:0.0,repayProportion:0,repaymentValue:0.0,interestEarned:0.0,loansDisbursedCount:0,loansRepaidCount:0,socialFundYes:true,socialFundValue:7300.0,failedLoan:false,loanUse:{business:0.33,schoolFees:0.33,food:0,clothing:0,shelter:0,household:0.33}},
            {name:'Bati seaweed Vsla B',county:'Kwale',village:'Bati',cycle:'Cycle_1',quarter:'Q2',cbt:'Fatuma juma',femaleReg:5,maleReg:16,totalReg:21,femaleLeft:1,maleLeft:0,totalLeft:1,meetFreq:'Always',attendHigh:0,attendMod:1,attendLow:0,activeSavingF:4,activeSavingM:12,activeSavingT:16,savingsSum:23300.0,savingsAvg:23300.0,savingsMax:23300.0,savingsMin:23300.0,loansDisbursed:0.0,loansRepaid:0.0,repayProportion:0,repaymentValue:0.0,interestEarned:0.0,loansDisbursedCount:0,loansRepaidCount:0,socialFundYes:true,socialFundValue:14900.0,failedLoan:false,loanUse:{business:0.25,schoolFees:0.25,food:0,clothing:0,shelter:0.25,household:0.25}},
            {name:'Chete Cha kale VSLA 1',county:'Kwale',village:'Majoreni',cycle:'Cycle_2',quarter:'Q3',cbt:'Fatuma mwasoza',femaleReg:19,maleReg:5,totalReg:24,femaleLeft:0,maleLeft:0,totalLeft:0,meetFreq:'Always',attendHigh:0,attendMod:1,attendLow:0,activeSavingF:19,activeSavingM:5,activeSavingT:24,savingsSum:250480.0,savingsAvg:250480.0,savingsMax:250480.0,savingsMin:250480.0,loansDisbursed:178000.0,loansRepaid:118500.0,repayProportion:0.67,repaymentValue:118500.0,interestEarned:11850.0,loansDisbursedCount:31,loansRepaidCount:13,socialFundYes:true,socialFundValue:20080.0,failedLoan:true,loanUse:{business:0.2,schoolFees:0.2,food:0.2,clothing:0.2,shelter:0.2,household:0}},
            {name:'Chete Cha Kale VSLA 1',county:'Kwale',village:'Majoreni',cycle:'Cycle_2',quarter:'Q2',cbt:'Fatuma Hassan Mwasoza',femaleReg:19,maleReg:5,totalReg:24,femaleLeft:0,maleLeft:0,totalLeft:0,meetFreq:'Always',attendHigh:0,attendMod:1,attendLow:0,activeSavingF:19,activeSavingM:5,activeSavingT:24,savingsSum:143480.0,savingsAvg:143480.0,savingsMax:143480.0,savingsMin:143480.0,loansDisbursed:115500.0,loansRepaid:32000.0,repayProportion:0.28,repaymentValue:32000.0,interestEarned:3200.0,loansDisbursedCount:22,loansRepaidCount:6,socialFundYes:true,socialFundValue:28600.0,failedLoan:false,loanUse:{business:0.33,schoolFees:0.33,food:0,clothing:0,shelter:0,household:0.33}},
            {name:'Chete Cha Kale VSLA 2',county:'Kwale',village:'Majoreni',cycle:'Cycle_1',quarter:'Q2',cbt:'MWANAMKASI OMAR BAKARI',femaleReg:15,maleReg:8,totalReg:23,femaleLeft:0,maleLeft:0,totalLeft:0,meetFreq:'Always',attendHigh:0,attendMod:1,attendLow:0,activeSavingF:8,activeSavingM:4,activeSavingT:12,savingsSum:54100.0,savingsAvg:54100.0,savingsMax:54100.0,savingsMin:54100.0,loansDisbursed:22700.0,loansRepaid:0.0,repayProportion:0.0,repaymentValue:0.0,interestEarned:2200.0,loansDisbursedCount:7,loansRepaidCount:0,socialFundYes:true,socialFundValue:17100.0,failedLoan:false,loanUse:{business:0.33,schoolFees:0.33,food:0,clothing:0,shelter:0,household:0.33}},
            {name:'Chete Cha kale VSLA 2',county:'Kwale',village:'Majoreni',cycle:'Cycle_1',quarter:'Q3',cbt:'Mwanamkasi Omar bakari',femaleReg:14,maleReg:8,totalReg:22,femaleLeft:0,maleLeft:1,totalLeft:1,meetFreq:'Always',attendHigh:0,attendMod:1,attendLow:0,activeSavingF:14,activeSavingM:8,activeSavingT:22,savingsSum:61700.0,savingsAvg:61700.0,savingsMax:61700.0,savingsMin:61700.0,loansDisbursed:11.0,loansRepaid:0.0,repayProportion:0.0,repaymentValue:0.0,interestEarned:0.0,loansDisbursedCount:22,loansRepaidCount:26850,socialFundYes:true,socialFundValue:17600.0,failedLoan:true,loanUse:{business:0.17,schoolFees:0.17,food:0.17,clothing:0.17,shelter:0.17,household:0.17}},
            {name:'Chiromo seaweed - siajabu vsla',county:'Kwale',village:'Chiromo',cycle:'Cycle_1',quarter:'Q2',cbt:'Stara kassim salim',femaleReg:18,maleReg:12,totalReg:30,femaleLeft:0,maleLeft:0,totalLeft:0,meetFreq:'Always',attendHigh:1,attendMod:0,attendLow:0,activeSavingF:18,activeSavingM:12,activeSavingT:30,savingsSum:200000.0,savingsAvg:200000.0,savingsMax:200000.0,savingsMin:200000.0,loansDisbursed:70000.0,loansRepaid:50000.0,repayProportion:0.71,repaymentValue:50000.0,interestEarned:9000.0,loansDisbursedCount:30,loansRepaidCount:2,socialFundYes:true,socialFundValue:78500.0,failedLoan:true,loanUse:{business:0.25,schoolFees:0.25,food:0.25,clothing:0,shelter:0.25,household:0}},
            {name:'Chiromo seaweed - Tikisa vsla',county:'Kwale',village:'Chiromo',cycle:'Cycle_2',quarter:'Q2',cbt:'Twahiri Musa mwasupi',femaleReg:18,maleReg:11,totalReg:29,femaleLeft:0,maleLeft:0,totalLeft:0,meetFreq:'Always',attendHigh:1,attendMod:0,attendLow:0,activeSavingF:18,activeSavingM:11,activeSavingT:29,savingsSum:18670.0,savingsAvg:18670.0,savingsMax:18670.0,savingsMin:18670.0,loansDisbursed:0.0,loansRepaid:0.0,repayProportion:0,repaymentValue:0.0,interestEarned:0.0,loansDisbursedCount:0,loansRepaidCount:0,socialFundYes:true,socialFundValue:10700.0,failedLoan:false,loanUse:{business:0.25,schoolFees:0.25,food:0.25,clothing:0,shelter:0.25,household:0}},
            {name:'CHIROMO SEAWEED FARMERS- TIKISA VSLA',county:'Kwale',village:'CHIROMO',cycle:'Cycle_2',quarter:'Q3',cbt:'TWAHIRI  MUSA',femaleReg:18,maleReg:11,totalReg:29,femaleLeft:0,maleLeft:3,totalLeft:3,meetFreq:'Always',attendHigh:1,attendMod:0,attendLow:0,activeSavingF:16,activeSavingM:10,activeSavingT:26,savingsSum:27800.0,savingsAvg:27800.0,savingsMax:27800.0,savingsMin:27800.0,loansDisbursed:0.0,loansRepaid:0.0,repayProportion:0,repaymentValue:0.0,interestEarned:0.0,loansDisbursedCount:0,loansRepaidCount:0,socialFundYes:true,socialFundValue:21250.0,failedLoan:false,loanUse:{business:0.25,schoolFees:0.25,food:0,clothing:0,shelter:0.25,household:0.25}},
            {name:'Chiromo Seaweed Farmers-Siajabu Vsla',county:'Kwale',village:'chiromo',cycle:'Cycle_1',quarter:'Q3',cbt:'Stara Kassim',femaleReg:23,maleReg:7,totalReg:30,femaleLeft:0,maleLeft:0,totalLeft:0,meetFreq:'Always',attendHigh:1,attendMod:0,attendLow:0,activeSavingF:23,activeSavingM:7,activeSavingT:30,savingsSum:340000.0,savingsAvg:340000.0,savingsMax:340000.0,savingsMin:340000.0,loansDisbursed:70000.0,loansRepaid:65000.0,repayProportion:0.93,repaymentValue:65000.0,interestEarned:6500.0,loansDisbursedCount:30,loansRepaidCount:28,socialFundYes:true,socialFundValue:96500.0,failedLoan:true,loanUse:{business:0.2,schoolFees:0.2,food:0.2,clothing:0,shelter:0.2,household:0.2}},
            {name:'Daima vsla',county:'Kwale',village:'Mtibwa',cycle:'Cycle_2',quarter:'Q2',cbt:'Tima mwadau',femaleReg:20,maleReg:5,totalReg:25,femaleLeft:0,maleLeft:1,totalLeft:1,meetFreq:'Always',attendHigh:1,attendMod:0,attendLow:0,activeSavingF:19,activeSavingM:5,activeSavingT:24,savingsSum:222880.0,savingsAvg:222880.0,savingsMax:222880.0,savingsMin:222880.0,loansDisbursed:111000.0,loansRepaid:90000.0,repayProportion:0.81,repaymentValue:90000.0,interestEarned:1110.0,loansDisbursedCount:9,loansRepaidCount:8,socialFundYes:true,socialFundValue:108750.0,failedLoan:false,loanUse:{business:0.25,schoolFees:0.25,food:0,clothing:0,shelter:0.25,household:0.25}},
            {name:'Dinani SHG',county:'Kilifi',village:'Maweni',cycle:'Cycle_1',quarter:'Q2',cbt:'Husna Zawadi',femaleReg:19,maleReg:13,totalReg:32,femaleLeft:2,maleLeft:0,totalLeft:2,meetFreq:'Always',attendHigh:1,attendMod:0,attendLow:0,activeSavingF:18,activeSavingM:12,activeSavingT:30,savingsSum:61280.0,savingsAvg:61280.0,savingsMax:61280.0,savingsMin:61280.0,loansDisbursed:36300.0,loansRepaid:28000.0,repayProportion:0.77,repaymentValue:28000.0,interestEarned:2800.0,loansDisbursedCount:20,loansRepaidCount:15,socialFundYes:true,socialFundValue:9000.0,failedLoan:true,loanUse:{business:0.33,schoolFees:0.33,food:0,clothing:0,shelter:0.33,household:0}},
            {name:'Dinani SHG',county:'Kilifi',village:'Maweni/Takaungu',cycle:'Cycle_3',quarter:'Q3',cbt:'Husna Zawadi Mohamed',femaleReg:17,maleReg:12,totalReg:29,femaleLeft:0,maleLeft:4,totalLeft:4,meetFreq:'Always',attendHigh:1,attendMod:0,attendLow:0,activeSavingF:3,activeSavingM:2,activeSavingT:5,savingsSum:120280.0,savingsAvg:120280.0,savingsMax:120280.0,savingsMin:120280.0,loansDisbursed:34900.0,loansRepaid:25000.0,repayProportion:0.72,repaymentValue:25000.0,interestEarned:2500.0,loansDisbursedCount:10,loansRepaidCount:6,socialFundYes:true,socialFundValue:25500.0,failedLoan:false,loanUse:{business:0.33,schoolFees:0.33,food:0.33,clothing:0,shelter:0,household:0}},
            {name:'Dzikunze Binti CBO',county:'Kilifi',village:'Dzikunze trading centre',cycle:'Cycle_1',quarter:'Q2',cbt:'REHEMA JUMWA KATANA',femaleReg:23,maleReg:0,totalReg:23,femaleLeft:3,maleLeft:0,totalLeft:3,meetFreq:'Always',attendHigh:1,attendMod:0,attendLow:0,activeSavingF:17,activeSavingM:0,activeSavingT:17,savingsSum:64930.0,savingsAvg:64930.0,savingsMax:64930.0,savingsMin:64930.0,loansDisbursed:195900.0,loansRepaid:215490.0,repayProportion:1.1,repaymentValue:215490.0,interestEarned:19590.0,loansDisbursedCount:60,loansRepaidCount:46,socialFundYes:true,socialFundValue:6710.0,failedLoan:true,loanUse:{business:0.2,schoolFees:0.2,food:0.2,clothing:0.2,shelter:0,household:0.2}},
            {name:'Dzikunze leaders',county:'Kilifi',village:'Dzikunze',cycle:'Cycle_1',quarter:'Q2',cbt:'Melania mapenzi kazungu',femaleReg:7,maleReg:24,totalReg:31,femaleLeft:0,maleLeft:1,totalLeft:1,meetFreq:'Always',attendHigh:1,attendMod:0,attendLow:0,activeSavingF:7,activeSavingM:23,activeSavingT:30,savingsSum:43700.0,savingsAvg:43700.0,savingsMax:43700.0,savingsMin:43700.0,loansDisbursed:108000.0,loansRepaid:80000.0,repayProportion:0.74,repaymentValue:80000.0,interestEarned:8000.0,loansDisbursedCount:27,loansRepaidCount:20,socialFundYes:true,socialFundValue:7610.0,failedLoan:false,loanUse:{business:0,schoolFees:0.25,food:0.25,clothing:0.25,shelter:0.25,household:0}},
            {name:'Dzikunze leaders',county:'Kilifi',village:'Borasalama',cycle:'Cycle_2',quarter:'Q4',cbt:'Melania mapenzi kazungu',femaleReg:24,maleReg:7,totalReg:31,femaleLeft:0,maleLeft:0,totalLeft:0,meetFreq:'Often',attendHigh:0,attendMod:1,attendLow:0,activeSavingF:24,activeSavingM:7,activeSavingT:31,savingsSum:108155.0,savingsAvg:108155.0,savingsMax:108155.0,savingsMin:108155.0,loansDisbursed:96230.0,loansRepaid:65500.0,repayProportion:0.68,repaymentValue:65500.0,interestEarned:20135.0,loansDisbursedCount:20,loansRepaidCount:15,socialFundYes:true,socialFundValue:4000.0,failedLoan:false,loanUse:{business:0,schoolFees:0,food:0.25,clothing:0.25,shelter:0.25,household:0.25}},
            {name:'DZIKUNZE WAMAMA CBO',county:'Kilifi',village:'DZIKUNZE TRADING CENTRE',cycle:'Cycle_1',quarter:'Q2',cbt:'MERCYLINE ZAWADI NYANJE',femaleReg:18,maleReg:0,totalReg:18,femaleLeft:0,maleLeft:0,totalLeft:0,meetFreq:'Always',attendHigh:1,attendMod:0,attendLow:0,activeSavingF:18,activeSavingM:0,activeSavingT:18,savingsSum:45200.0,savingsAvg:45200.0,savingsMax:45200.0,savingsMin:45200.0,loansDisbursed:112310.0,loansRepaid:64930.0,repayProportion:0.58,repaymentValue:64930.0,interestEarned:8280.0,loansDisbursedCount:45,loansRepaidCount:18,socialFundYes:true,socialFundValue:2730.0,failedLoan:false,loanUse:{business:0.25,schoolFees:0.25,food:0.25,clothing:0,shelter:0,household:0.25}},
            {name:'FIRDAUS VSLA',county:'Kwale',village:'Kidimu',cycle:'Cycle_1',quarter:'Q2',cbt:'Kopesha Hamisi Nassoro',femaleReg:14,maleReg:6,totalReg:20,femaleLeft:0,maleLeft:1,totalLeft:1,meetFreq:'Always',attendHigh:1,attendMod:0,attendLow:0,activeSavingF:14,activeSavingM:6,activeSavingT:20,savingsSum:105670.0,savingsAvg:105670.0,savingsMax:105670.0,savingsMin:105670.0,loansDisbursed:67000.0,loansRepaid:13300.0,repayProportion:0.2,repaymentValue:13300.0,interestEarned:1330.0,loansDisbursedCount:26,loansRepaidCount:7,socialFundYes:true,socialFundValue:9400.0,failedLoan:false,loanUse:{business:0.25,schoolFees:0.25,food:0,clothing:0,shelter:0.25,household:0.25}},
            {name:'FIRDAUS VSLA',county:'Kwale',village:'Kidimu',cycle:'Cycle_1',quarter:'Q3',cbt:'NASSORO KOPESHA',femaleReg:14,maleReg:7,totalReg:21,femaleLeft:2,maleLeft:2,totalLeft:4,meetFreq:'Always',attendHigh:1,attendMod:0,attendLow:0,activeSavingF:12,activeSavingM:6,activeSavingT:18,savingsSum:169400.0,savingsAvg:169400.0,savingsMax:169400.0,savingsMin:169400.0,loansDisbursed:85000.0,loansRepaid:50000.0,repayProportion:0.59,repaymentValue:50000.0,interestEarned:5000.0,loansDisbursedCount:30,loansRepaidCount:4,socialFundYes:true,socialFundValue:14400.0,failedLoan:false,loanUse:{business:0.17,schoolFees:0.17,food:0.17,clothing:0.17,shelter:0.17,household:0.17}},
            {name:'Furaha Bazo widows Group',county:'Kwale',village:'Vidungeni',cycle:'Cycle_1',quarter:'Q2',cbt:'Tot Amani Muuo Kyuma,  Cbt Mwanamisi bakari Ndaro',femaleReg:25,maleReg:0,totalReg:25,femaleLeft:0,maleLeft:0,totalLeft:0,meetFreq:'Always',attendHigh:1,attendMod:0,attendLow:0,activeSavingF:20,activeSavingM:0,activeSavingT:20,savingsSum:22930.0,savingsAvg:22930.0,savingsMax:22930.0,savingsMin:22930.0,loansDisbursed:6000.0,loansRepaid:500.0,repayProportion:0.08,repaymentValue:500.0,interestEarned:0.0,loansDisbursedCount:3,loansRepaidCount:0,socialFundYes:true,socialFundValue:850.0,failedLoan:false,loanUse:{business:0,schoolFees:0.5,food:0,clothing:0,shelter:0,household:0.5}},
            {name:'Furaha Bazo widows group',county:'Kwale',village:'Vidungeni',cycle:'Cycle_1',quarter:'Q3',cbt:'Mwanamisi Bakari Ndaro',femaleReg:25,maleReg:0,totalReg:25,femaleLeft:5,maleLeft:0,totalLeft:5,meetFreq:'Always',attendHigh:0,attendMod:1,attendLow:0,activeSavingF:20,activeSavingM:0,activeSavingT:20,savingsSum:37000.0,savingsAvg:37000.0,savingsMax:37000.0,savingsMin:37000.0,loansDisbursed:23000.0,loansRepaid:7000.0,repayProportion:0.3,repaymentValue:7000.0,interestEarned:0.0,loansDisbursedCount:6,loansRepaidCount:0,socialFundYes:true,socialFundValue:3200.0,failedLoan:false,loanUse:{business:0.5,schoolFees:0.5,food:0,clothing:0,shelter:0,household:0}},
            {name:'Furaha VSLA 1',county:'Kwale',village:'Funzi',cycle:'Cycle_1',quarter:'Q2',cbt:'Kulthum Said Mohamed',femaleReg:18,maleReg:1,totalReg:19,femaleLeft:0,maleLeft:0,totalLeft:0,meetFreq:'Always',attendHigh:0,attendMod:1,attendLow:0,activeSavingF:18,activeSavingM:1,activeSavingT:19,savingsSum:77800.0,savingsAvg:77800.0,savingsMax:77800.0,savingsMin:77800.0,loansDisbursed:35000.0,loansRepaid:16040.0,repayProportion:0.46,repaymentValue:16040.0,interestEarned:0.0,loansDisbursedCount:11,loansRepaidCount:0,socialFundYes:true,socialFundValue:7810.0,failedLoan:false,loanUse:{business:0.25,schoolFees:0.25,food:0.25,clothing:0,shelter:0,household:0.25}},
            {name:'Furaha VSLA 1',county:'Kwale',village:'Funzi',cycle:'Cycle_1',quarter:'Q3',cbt:'Kulthum Said Mohamed',femaleReg:18,maleReg:1,totalReg:19,femaleLeft:0,maleLeft:0,totalLeft:0,meetFreq:'Always',attendHigh:1,attendMod:0,attendLow:0,activeSavingF:18,activeSavingM:1,activeSavingT:19,savingsSum:142450.0,savingsAvg:142450.0,savingsMax:142450.0,savingsMin:142450.0,loansDisbursed:36000.0,loansRepaid:28980.0,repayProportion:0.81,repaymentValue:28980.0,interestEarned:900.0,loansDisbursedCount:12,loansRepaidCount:4,socialFundYes:true,socialFundValue:11890.0,failedLoan:false,loanUse:{business:0.17,schoolFees:0.17,food:0.17,clothing:0.17,shelter:0.17,household:0.17}},
            {name:'Furaha VSLA 2',county:'Kwale',village:'Funzi',cycle:'Cycle_1',quarter:'Q2',cbt:'Rukiya Pandu Vuyaa',femaleReg:19,maleReg:0,totalReg:19,femaleLeft:1,maleLeft:0,totalLeft:1,meetFreq:'Always',attendHigh:1,attendMod:0,attendLow:0,activeSavingF:18,activeSavingM:0,activeSavingT:18,savingsSum:104300.0,savingsAvg:104300.0,savingsMax:104300.0,savingsMin:104300.0,loansDisbursed:72300.0,loansRepaid:43000.0,repayProportion:0.59,repaymentValue:43000.0,interestEarned:1750.0,loansDisbursedCount:17,loansRepaidCount:5,socialFundYes:true,socialFundValue:7690.0,failedLoan:false,loanUse:{business:0.25,schoolFees:0.25,food:0.25,clothing:0,shelter:0,household:0.25}},
            {name:'Furaha VSLA 2',county:'Kwale',village:'Funzi',cycle:'Cycle_1',quarter:'Q3',cbt:'Rukia Pandu Vuyaa',femaleReg:19,maleReg:0,totalReg:19,femaleLeft:0,maleLeft:0,totalLeft:0,meetFreq:'Always',attendHigh:1,attendMod:0,attendLow:0,activeSavingF:19,activeSavingM:0,activeSavingT:19,savingsSum:165900.0,savingsAvg:165900.0,savingsMax:165900.0,savingsMin:165900.0,loansDisbursed:67000.0,loansRepaid:48450.0,repayProportion:0.72,repaymentValue:48450.0,interestEarned:1750.0,loansDisbursedCount:16,loansRepaidCount:6,socialFundYes:true,socialFundValue:11840.0,failedLoan:false,loanUse:{business:0.2,schoolFees:0.2,food:0.2,clothing:0.2,shelter:0,household:0.2}},
            {name:'Heri SHG',county:'Kilifi',village:'Bondeni',cycle:'Cycle_2',quarter:'Q3',cbt:'Lennax Mwachiru Kai',femaleReg:29,maleReg:4,totalReg:33,femaleLeft:0,maleLeft:0,totalLeft:0,meetFreq:'Always',attendHigh:0,attendMod:1,attendLow:0,activeSavingF:18,activeSavingM:2,activeSavingT:20,savingsSum:129200.0,savingsAvg:129200.0,savingsMax:129200.0,savingsMin:129200.0,loansDisbursed:93900.0,loansRepaid:42600.0,repayProportion:0.45,repaymentValue:42600.0,interestEarned:9390.0,loansDisbursedCount:28,loansRepaidCount:14,socialFundYes:true,socialFundValue:9300.0,failedLoan:false,loanUse:{business:0.25,schoolFees:0.25,food:0,clothing:0,shelter:0.25,household:0.25}},
            {name:'Heri VSLA',county:'Kilifi',village:'Bondeni',cycle:'Cycle_1',quarter:'Q2',cbt:'Lennax Mwachiru Kai',femaleReg:29,maleReg:4,totalReg:33,femaleLeft:0,maleLeft:0,totalLeft:0,meetFreq:'Always',attendHigh:0,attendMod:1,attendLow:0,activeSavingF:20,activeSavingM:3,activeSavingT:23,savingsSum:85600.0,savingsAvg:85600.0,savingsMax:85600.0,savingsMin:85600.0,loansDisbursed:42500.0,loansRepaid:15800.0,repayProportion:0.37,repaymentValue:15800.0,interestEarned:4250.0,loansDisbursedCount:20,loansRepaidCount:6,socialFundYes:true,socialFundValue:6400.0,failedLoan:false,loanUse:{business:0,schoolFees:0.33,food:0.33,clothing:0,shelter:0,household:0.33}},
            {name:'Imani Moja self help group',county:'Kwale',village:'Mafisini',cycle:'Cycle_1',quarter:'Q2',cbt:'TOT Amina Hassan Mwafrika  CBT Faith Mutuku',femaleReg:17,maleReg:12,totalReg:29,femaleLeft:0,maleLeft:0,totalLeft:0,meetFreq:'Always',attendHigh:1,attendMod:0,attendLow:0,activeSavingF:17,activeSavingM:12,activeSavingT:29,savingsSum:146100.0,savingsAvg:146100.0,savingsMax:146100.0,savingsMin:146100.0,loansDisbursed:86500.0,loansRepaid:38925.0,repayProportion:0.45,repaymentValue:38925.0,interestEarned:3893.0,loansDisbursedCount:26,loansRepaidCount:25,socialFundYes:true,socialFundValue:8780.0,failedLoan:false,loanUse:{business:0.33,schoolFees:0.33,food:0,clothing:0,shelter:0,household:0.33}},
            {name:'Imani Moja Self help group',county:'Kwale',village:'Mafisini Kibaoni',cycle:'Cycle_1',quarter:'Q3',cbt:'Faith Mutuku',femaleReg:19,maleReg:10,totalReg:29,femaleLeft:0,maleLeft:0,totalLeft:0,meetFreq:'Always',attendHigh:1,attendMod:0,attendLow:0,activeSavingF:19,activeSavingM:10,activeSavingT:29,savingsSum:177200.0,savingsAvg:177200.0,savingsMax:177200.0,savingsMin:177200.0,loansDisbursed:200630.0,loansRepaid:5400.0,repayProportion:0.03,repaymentValue:5400.0,interestEarned:600.0,loansDisbursedCount:29,loansRepaidCount:3,socialFundYes:true,socialFundValue:11200.0,failedLoan:false,loanUse:{business:0.33,schoolFees:0.33,food:0,clothing:0,shelter:0,household:0.33}},
            {name:'Imani Seaweed Farmers Gazi VSLA',county:'Kwale',village:'Gazi',cycle:'Cycle_1',quarter:'Q2',cbt:'Mwanasha Mohamed lewe',femaleReg:24,maleReg:4,totalReg:28,femaleLeft:0,maleLeft:0,totalLeft:0,meetFreq:'Always',attendHigh:1,attendMod:0,attendLow:0,activeSavingF:24,activeSavingM:4,activeSavingT:28,savingsSum:255000.0,savingsAvg:255000.0,savingsMax:255000.0,savingsMin:255000.0,loansDisbursed:45000.0,loansRepaid:35000.0,repayProportion:0.78,repaymentValue:35000.0,interestEarned:0.0,loansDisbursedCount:28,loansRepaidCount:15,socialFundYes:true,socialFundValue:14120.0,failedLoan:false,loanUse:{business:0.2,schoolFees:0.2,food:0.2,clothing:0.2,shelter:0.2,household:0}},
            {name:'Imani Seaweed Farmers Gazi VSLA',county:'Kwale',village:'Gazi',cycle:'Cycle_1',quarter:'Q3',cbt:'Mwanasha Mohamed lewe',femaleReg:24,maleReg:4,totalReg:28,femaleLeft:0,maleLeft:0,totalLeft:0,meetFreq:'Always',attendHigh:1,attendMod:0,attendLow:0,activeSavingF:22,activeSavingM:4,activeSavingT:26,savingsSum:360000.0,savingsAvg:360000.0,savingsMax:360000.0,savingsMin:360000.0,loansDisbursed:70000.0,loansRepaid:55000.0,repayProportion:0.79,repaymentValue:55000.0,interestEarned:0.0,loansDisbursedCount:33,loansRepaidCount:24,socialFundYes:true,socialFundValue:17160.0,failedLoan:false,loanUse:{business:0.2,schoolFees:0.2,food:0.2,clothing:0.2,shelter:0.2,household:0}},
            {name:'Jeza group',county:'Kilifi',village:'Ndugumnani',cycle:'Cycle_1',quarter:'Q2',cbt:'Thomas jimba kitsao',femaleReg:26,maleReg:9,totalReg:35,femaleLeft:1,maleLeft:0,totalLeft:1,meetFreq:'Always',attendHigh:1,attendMod:0,attendLow:0,activeSavingF:26,activeSavingM:9,activeSavingT:35,savingsSum:140000.0,savingsAvg:140000.0,savingsMax:140000.0,savingsMin:140000.0,loansDisbursed:116000.0,loansRepaid:80000.0,repayProportion:0.69,repaymentValue:80000.0,interestEarned:8000.0,loansDisbursedCount:29,loansRepaidCount:20,socialFundYes:true,socialFundValue:700.0,failedLoan:false,loanUse:{business:0,schoolFees:0.25,food:0.25,clothing:0.25,shelter:0.25,household:0}},
            {name:'JIPE MOYO CONSERVATION GROUP',county:'Kwale',village:'Mvumoni B',cycle:'Cycle_1',quarter:'Q2',cbt:'David Dawa Ngoa',femaleReg:16,maleReg:7,totalReg:23,femaleLeft:0,maleLeft:0,totalLeft:0,meetFreq:'Always',attendHigh:0,attendMod:1,attendLow:0,activeSavingF:16,activeSavingM:7,activeSavingT:23,savingsSum:32960.0,savingsAvg:32960.0,savingsMax:32960.0,savingsMin:32960.0,loansDisbursed:51000.0,loansRepaid:7100.0,repayProportion:0.14,repaymentValue:7100.0,interestEarned:710.0,loansDisbursedCount:15,loansRepaidCount:0,socialFundYes:true,socialFundValue:5000.0,failedLoan:false,loanUse:{business:0.33,schoolFees:0.33,food:0,clothing:0,shelter:0,household:0.33}},
            {name:'Jitahidi shg',county:'Kilifi',village:'Mkwajuni',cycle:'Cycle_1',quarter:'Q2',cbt:'Zawadi  Charo  kazungu',femaleReg:11,maleReg:2,totalReg:13,femaleLeft:5,maleLeft:6,totalLeft:11,meetFreq:'Always',attendHigh:0,attendMod:1,attendLow:0,activeSavingF:11,activeSavingM:2,activeSavingT:13,savingsSum:10910.0,savingsAvg:10910.0,savingsMax:10910.0,savingsMin:10910.0,loansDisbursed:0.0,loansRepaid:0.0,repayProportion:0,repaymentValue:0.0,interestEarned:0.0,loansDisbursedCount:0,loansRepaidCount:0,socialFundYes:false,socialFundValue:600.0,failedLoan:false,loanUse:{business:0.25,schoolFees:0.25,food:0.25,clothing:0.25,shelter:0,household:0}},
            {name:'Jitahidi shg',county:'Kilifi',village:'Mkwajuni',cycle:'Cycle_3',quarter:'Q4',cbt:'Zawadi  charo',femaleReg:22,maleReg:3,totalReg:25,femaleLeft:2,maleLeft:0,totalLeft:2,meetFreq:'Always',attendHigh:0,attendMod:1,attendLow:0,activeSavingF:20,activeSavingM:3,activeSavingT:23,savingsSum:45000.0,savingsAvg:45000.0,savingsMax:45000.0,savingsMin:45000.0,loansDisbursed:40000.0,loansRepaid:15000.0,repayProportion:0.38,repaymentValue:15000.0,interestEarned:1500.0,loansDisbursedCount:25,loansRepaidCount:0,socialFundYes:true,socialFundValue:3000.0,failedLoan:false,loanUse:{business:0.33,schoolFees:0.33,food:0,clothing:0,shelter:0,household:0.33}},
            {name:'JITIHADA',county:'Kwale',village:'Aleni',cycle:'Cycle_2',quarter:'Q3',cbt:'Fatuma Mohamed Mtwana',femaleReg:18,maleReg:15,totalReg:33,femaleLeft:3,maleLeft:6,totalLeft:9,meetFreq:'Always',attendHigh:1,attendMod:0,attendLow:0,activeSavingF:8,activeSavingM:7,activeSavingT:15,savingsSum:64200.0,savingsAvg:64200.0,savingsMax:64200.0,savingsMin:64200.0,loansDisbursed:63000.0,loansRepaid:40000.0,repayProportion:0.63,repaymentValue:40000.0,interestEarned:9900.0,loansDisbursedCount:15,loansRepaidCount:17500,socialFundYes:true,socialFundValue:10950.0,failedLoan:false,loanUse:{business:0.5,schoolFees:0.5,food:0,clothing:0,shelter:0,household:0}},
            {name:'JITIHADA GRSG',county:'Kwale',village:'Aleni',cycle:'Cycle_2',quarter:'Q2',cbt:'Fatuma MOHAMED Mtwana',femaleReg:16,maleReg:16,totalReg:32,femaleLeft:2,maleLeft:9,totalLeft:11,meetFreq:'Always',attendHigh:1,attendMod:0,attendLow:0,activeSavingF:10,activeSavingM:10,activeSavingT:20,savingsSum:55100.0,savingsAvg:55100.0,savingsMax:55100.0,savingsMin:55100.0,loansDisbursed:49000.0,loansRepaid:121400.0,repayProportion:2.48,repaymentValue:121400.0,interestEarned:8000.0,loansDisbursedCount:26,loansRepaidCount:0,socialFundYes:true,socialFundValue:11440.0,failedLoan:false,loanUse:{business:0.5,schoolFees:0.5,food:0,clothing:0,shelter:0,household:0}},
            {name:'Jitume A',county:'Kilifi',village:'Kizingo maguniani',cycle:'Cycle_1',quarter:'Q3',cbt:'Charles kiti tembo',femaleReg:14,maleReg:9,totalReg:23,femaleLeft:2,maleLeft:2,totalLeft:4,meetFreq:'Always',attendHigh:1,attendMod:0,attendLow:0,activeSavingF:11,activeSavingM:7,activeSavingT:18,savingsSum:187540.0,savingsAvg:187540.0,savingsMax:187540.0,savingsMin:187540.0,loansDisbursed:168000.0,loansRepaid:140000.0,repayProportion:0.83,repaymentValue:140000.0,interestEarned:40000.0,loansDisbursedCount:31,loansRepaidCount:20,socialFundYes:true,socialFundValue:15200.0,failedLoan:false,loanUse:{business:0.33,schoolFees:0.33,food:0,clothing:0,shelter:0.33,household:0}},
            {name:'Jitume B',county:'Kilifi',village:'Kizingo maguniani',cycle:'Cycle_1',quarter:'Q3',cbt:'Peninah uchi deche',femaleReg:15,maleReg:9,totalReg:24,femaleLeft:1,maleLeft:3,totalLeft:4,meetFreq:'Always',attendHigh:1,attendMod:0,attendLow:0,activeSavingF:12,activeSavingM:8,activeSavingT:20,savingsSum:192000.0,savingsAvg:192000.0,savingsMax:192000.0,savingsMin:192000.0,loansDisbursed:189700.0,loansRepaid:159000.0,repayProportion:0.84,repaymentValue:159000.0,interestEarned:45000.0,loansDisbursedCount:30,loansRepaidCount:23,socialFundYes:true,socialFundValue:12000.0,failedLoan:false,loanUse:{business:0.33,schoolFees:0.33,food:0,clothing:0,shelter:0.33,household:0}},
            {name:'Juhudi women group',county:'Kilifi',village:'Ndugumnani',cycle:'Cycle_1',quarter:'Q2',cbt:'Halima mwamure',femaleReg:41,maleReg:1,totalReg:42,femaleLeft:0,maleLeft:0,totalLeft:0,meetFreq:'Always',attendHigh:1,attendMod:0,attendLow:0,activeSavingF:40,activeSavingM:1,activeSavingT:41,savingsSum:168000.0,savingsAvg:168000.0,savingsMax:168000.0,savingsMin:168000.0,loansDisbursed:156000.0,loansRepaid:120000.0,repayProportion:0.77,repaymentValue:120000.0,interestEarned:16000.0,loansDisbursedCount:39,loansRepaidCount:30,socialFundYes:true,socialFundValue:820.0,failedLoan:false,loanUse:{business:0,schoolFees:0.25,food:0.25,clothing:0.25,shelter:0.25,household:0}},
            {name:'Juhudi women group',county:'Kilifi',village:'Ndugumnani',cycle:'Cycle_2',quarter:'Q4',cbt:'Halima mwamure',femaleReg:39,maleReg:2,totalReg:41,femaleLeft:0,maleLeft:0,totalLeft:0,meetFreq:'Often',attendHigh:0,attendMod:1,attendLow:0,activeSavingF:38,activeSavingM:2,activeSavingT:40,savingsSum:301650.0,savingsAvg:301650.0,savingsMax:301650.0,savingsMin:301650.0,loansDisbursed:498550.0,loansRepaid:254250.0,repayProportion:0.51,repaymentValue:254250.0,interestEarned:51055.0,loansDisbursedCount:20,loansRepaidCount:15,socialFundYes:true,socialFundValue:4500.0,failedLoan:false,loanUse:{business:0,schoolFees:0.25,food:0.25,clothing:0.25,shelter:0,household:0.25}},
            {name:'Juhudi women group',county:'Kilifi',village:'Ndugumnani',cycle:'Cycle_2',quarter:'Q4',cbt:'Halima mwamuye',femaleReg:39,maleReg:2,totalReg:41,femaleLeft:0,maleLeft:0,totalLeft:0,meetFreq:'Sometimes',attendHigh:0,attendMod:1,attendLow:0,activeSavingF:38,activeSavingM:2,activeSavingT:40,savingsSum:301650.0,savingsAvg:301650.0,savingsMax:301650.0,savingsMin:301650.0,loansDisbursed:498550.0,loansRepaid:254250.0,repayProportion:0.51,repaymentValue:254250.0,interestEarned:51055.0,loansDisbursedCount:20,loansRepaidCount:15,socialFundYes:true,socialFundValue:4500.0,failedLoan:false,loanUse:{business:0,schoolFees:0.25,food:0.25,clothing:0,shelter:0.25,household:0.25}},
            {name:'Kaya Chonyi Conservation',county:'Kilifi',village:'Vwevwesi',cycle:'Cycle_1',quarter:'Q2',cbt:'Christine Salama Kazungu',femaleReg:19,maleReg:10,totalReg:29,femaleLeft:0,maleLeft:0,totalLeft:0,meetFreq:'Always',attendHigh:0,attendMod:1,attendLow:0,activeSavingF:9,activeSavingM:4,activeSavingT:13,savingsSum:27900.0,savingsAvg:27900.0,savingsMax:27900.0,savingsMin:27900.0,loansDisbursed:20200.0,loansRepaid:8450.0,repayProportion:0.42,repaymentValue:8450.0,interestEarned:2020.0,loansDisbursedCount:17,loansRepaidCount:6,socialFundYes:true,socialFundValue:4220.0,failedLoan:true,loanUse:{business:0,schoolFees:0.33,food:0.33,clothing:0,shelter:0,household:0.33}},
            {name:'Kaya Chonyi Conservation',county:'Kilifi',village:'Vwevwesi',cycle:'Cycle_2',quarter:'Q3',cbt:'Christine Salama Kazungu',femaleReg:19,maleReg:10,totalReg:29,femaleLeft:0,maleLeft:0,totalLeft:0,meetFreq:'Always',attendHigh:0,attendMod:1,attendLow:0,activeSavingF:9,activeSavingM:4,activeSavingT:13,savingsSum:36800.0,savingsAvg:36800.0,savingsMax:36800.0,savingsMin:36800.0,loansDisbursed:33600.0,loansRepaid:16600.0,repayProportion:0.49,repaymentValue:16600.0,interestEarned:3360.0,loansDisbursedCount:22,loansRepaidCount:13,socialFundYes:true,socialFundValue:6400.0,failedLoan:true,loanUse:{business:0.25,schoolFees:0.25,food:0,clothing:0,shelter:0.25,household:0.25}},
            {name:'KIBUYUNI SEAWEED GROUP A',county:'Kwale',village:'Kibuyuni',cycle:'Cycle_1',quarter:'Q2',cbt:'Tima jasho',femaleReg:37,maleReg:3,totalReg:40,femaleLeft:10,maleLeft:0,totalLeft:10,meetFreq:'Always',attendHigh:1,attendMod:0,attendLow:0,activeSavingF:37,activeSavingM:3,activeSavingT:40,savingsSum:172610.0,savingsAvg:172610.0,savingsMax:172610.0,savingsMin:172610.0,loansDisbursed:104000.0,loansRepaid:46200.0,repayProportion:0.44,repaymentValue:46200.0,interestEarned:27600.0,loansDisbursedCount:33,loansRepaidCount:10,socialFundYes:true,socialFundValue:34640.0,failedLoan:false,loanUse:{business:0.2,schoolFees:0.2,food:0.2,clothing:0.2,shelter:0.2,household:0}},
            {name:'KIBUYUNI SEAWEED GROUP B',county:'Kwale',village:'Kibuyuni',cycle:'Cycle_1',quarter:'Q2',cbt:'Mariam ali',femaleReg:22,maleReg:7,totalReg:29,femaleLeft:4,maleLeft:0,totalLeft:4,meetFreq:'Always',attendHigh:1,attendMod:0,attendLow:0,activeSavingF:22,activeSavingM:7,activeSavingT:29,savingsSum:33300.0,savingsAvg:33300.0,savingsMax:33300.0,savingsMin:33300.0,loansDisbursed:26000.0,loansRepaid:7700.0,repayProportion:0.3,repaymentValue:7700.0,interestEarned:700.0,loansDisbursedCount:25,loansRepaidCount:7,socialFundYes:true,socialFundValue:12750.0,failedLoan:false,loanUse:{business:0.2,schoolFees:0.2,food:0.2,clothing:0.2,shelter:0.2,household:0}},
            {name:'KIJIWENI SELF HELP GROUP',county:'Kwale',village:'Kijiweni',cycle:'Cycle_1',quarter:'Q2',cbt:'MWANAIDI RAMA ABDALLAH',femaleReg:14,maleReg:13,totalReg:27,femaleLeft:0,maleLeft:0,totalLeft:0,meetFreq:'Always',attendHigh:0,attendMod:1,attendLow:0,activeSavingF:14,activeSavingM:13,activeSavingT:27,savingsSum:47830.0,savingsAvg:47830.0,savingsMax:47830.0,savingsMin:47830.0,loansDisbursed:0.0,loansRepaid:72000.0,repayProportion:0,repaymentValue:72000.0,interestEarned:7200.0,loansDisbursedCount:0,loansRepaidCount:24,socialFundYes:true,socialFundValue:1130.0,failedLoan:false,loanUse:{business:0.25,schoolFees:0.25,food:0.25,clothing:0,shelter:0.25,household:0}},
            {name:'KIJIWENI SELF HELP GROUP',county:'Kwale',village:'Kijiweni',cycle:'Cycle_1',quarter:'Q2',cbt:'Mwanaidi Rama  Abdallah',femaleReg:14,maleReg:13,totalReg:27,femaleLeft:0,maleLeft:0,totalLeft:0,meetFreq:'Always',attendHigh:1,attendMod:0,attendLow:0,activeSavingF:14,activeSavingM:13,activeSavingT:27,savingsSum:47830.0,savingsAvg:47830.0,savingsMax:47830.0,savingsMin:47830.0,loansDisbursed:33000.0,loansRepaid:33000.0,repayProportion:1.0,repaymentValue:33000.0,interestEarned:7200.0,loansDisbursedCount:27,loansRepaidCount:24,socialFundYes:true,socialFundValue:1130.0,failedLoan:true,loanUse:{business:0.2,schoolFees:0.2,food:0.2,clothing:0.2,shelter:0.2,household:0}},
            {name:'KIJIWENI SELF HELP GROUP',county:'Kwale',village:'KIJIWENI',cycle:'Cycle_1',quarter:'Q3',cbt:'MWANAIDI RAMA',femaleReg:14,maleReg:13,totalReg:27,femaleLeft:0,maleLeft:0,totalLeft:0,meetFreq:'Always',attendHigh:1,attendMod:0,attendLow:0,activeSavingF:14,activeSavingM:13,activeSavingT:27,savingsSum:2051500.0,savingsAvg:2051500.0,savingsMax:2051500.0,savingsMin:2051500.0,loansDisbursed:200600.0,loansRepaid:33000.0,repayProportion:0.16,repaymentValue:33000.0,interestEarned:23710.0,loansDisbursedCount:17,loansRepaidCount:6,socialFundYes:true,socialFundValue:19200.0,failedLoan:false,loanUse:{business:0.17,schoolFees:0.17,food:0.17,clothing:0.17,shelter:0.17,household:0.17}},
            {name:'Kivurini mangrove',county:'Kilifi',village:'Kaurangwa',cycle:'Cycle_1',quarter:'Q2',cbt:'Phidelis Bakari  Kalama',femaleReg:7,maleReg:9,totalReg:16,femaleLeft:1,maleLeft:0,totalLeft:1,meetFreq:'Always',attendHigh:1,attendMod:0,attendLow:0,activeSavingF:7,activeSavingM:9,activeSavingT:16,savingsSum:162000.0,savingsAvg:162000.0,savingsMax:162000.0,savingsMin:162000.0,loansDisbursed:360500.0,loansRepaid:140000.0,repayProportion:0.39,repaymentValue:140000.0,interestEarned:28085.0,loansDisbursedCount:14,loansRepaidCount:14,socialFundYes:true,socialFundValue:20000.0,failedLoan:false,loanUse:{business:0.25,schoolFees:0.25,food:0.25,clothing:0,shelter:0,household:0.25}},
            {name:'KIWAMBALE CONSERVATION',county:'Kwale',village:'KIWAMBALE',cycle:'Cycle_1',quarter:'Q2',cbt:'MWANFATIME DIWANI',femaleReg:19,maleReg:11,totalReg:30,femaleLeft:0,maleLeft:0,totalLeft:0,meetFreq:'Always',attendHigh:1,attendMod:0,attendLow:0,activeSavingF:19,activeSavingM:11,activeSavingT:30,savingsSum:115000.0,savingsAvg:115000.0,savingsMax:115000.0,savingsMin:115000.0,loansDisbursed:203100.0,loansRepaid:192500.0,repayProportion:0.95,repaymentValue:192500.0,interestEarned:9910.0,loansDisbursedCount:21,loansRepaidCount:21,socialFundYes:true,socialFundValue:7120.0,failedLoan:false,loanUse:{business:0.33,schoolFees:0.33,food:0,clothing:0,shelter:0,household:0.33}},
            {name:'Kumekucha mwaembe',county:'Kwale',village:'Mwagundu',cycle:'Cycle_1',quarter:'Q3',cbt:'Mwanakombo Musa Reje',femaleReg:31,maleReg:0,totalReg:31,femaleLeft:7,maleLeft:0,totalLeft:7,meetFreq:'Always',attendHigh:1,attendMod:0,attendLow:0,activeSavingF:25,activeSavingM:0,activeSavingT:25,savingsSum:104210.0,savingsAvg:104210.0,savingsMax:104210.0,savingsMin:104210.0,loansDisbursed:158700.0,loansRepaid:79600.0,repayProportion:0.5,repaymentValue:79600.0,interestEarned:0.0,loansDisbursedCount:50,loansRepaidCount:24,socialFundYes:true,socialFundValue:8800.0,failedLoan:false,loanUse:{business:0.25,schoolFees:0.25,food:0.25,clothing:0,shelter:0,household:0.25}},
            {name:'Kuna Nuru angani',county:'Kilifi',village:'Silala kakinda',cycle:'Cycle_1',quarter:'Q3',cbt:'Amina sidi samuel',femaleReg:20,maleReg:7,totalReg:27,femaleLeft:0,maleLeft:0,totalLeft:0,meetFreq:'Always',attendHigh:1,attendMod:0,attendLow:0,activeSavingF:20,activeSavingM:7,activeSavingT:27,savingsSum:131700.0,savingsAvg:131700.0,savingsMax:131700.0,savingsMin:131700.0,loansDisbursed:80000.0,loansRepaid:4000.0,repayProportion:0.05,repaymentValue:4000.0,interestEarned:22150.0,loansDisbursedCount:40,loansRepaidCount:10,socialFundYes:true,socialFundValue:18360.0,failedLoan:false,loanUse:{business:0.33,schoolFees:0.33,food:0,clothing:0,shelter:0.33,household:0}},
            {name:'Kuna Nuru Shambani',county:'Kilifi',village:'Mwembekati',cycle:'Cycle_1',quarter:'Q2',cbt:'Christopher Gambo',femaleReg:14,maleReg:10,totalReg:24,femaleLeft:0,maleLeft:0,totalLeft:0,meetFreq:'Always',attendHigh:0,attendMod:0,attendLow:1,activeSavingF:9,activeSavingM:7,activeSavingT:16,savingsSum:31750.0,savingsAvg:31750.0,savingsMax:31750.0,savingsMin:31750.0,loansDisbursed:23000.0,loansRepaid:15000.0,repayProportion:0.65,repaymentValue:15000.0,interestEarned:2300.0,loansDisbursedCount:17,loansRepaidCount:10,socialFundYes:true,socialFundValue:3920.0,failedLoan:false,loanUse:{business:0.33,schoolFees:0.33,food:0,clothing:0,shelter:0,household:0.33}},
            {name:'Kuna Nuru Shambani',county:'Kilifi',village:'Mwembekati',cycle:'Cycle_2',quarter:'Q3',cbt:'Christopher Gambo',femaleReg:14,maleReg:10,totalReg:24,femaleLeft:0,maleLeft:0,totalLeft:0,meetFreq:'Often',attendHigh:0,attendMod:0,attendLow:1,activeSavingF:9,activeSavingM:7,activeSavingT:16,savingsSum:39850.0,savingsAvg:39850.0,savingsMax:39850.0,savingsMin:39850.0,loansDisbursed:33000.0,loansRepaid:21000.0,repayProportion:0.64,repaymentValue:21000.0,interestEarned:3300.0,loansDisbursedCount:22,loansRepaidCount:14,socialFundYes:true,socialFundValue:5920.0,failedLoan:false,loanUse:{business:0.25,schoolFees:0.25,food:0,clothing:0,shelter:0.25,household:0.25}},
            {name:'Kwale Environmental Conservation',county:'Kwale',village:'Mafisini',cycle:'Cycle_1',quarter:'Q2',cbt:'TOT Amina Hassan Mwafrika  CBT Mary Mbithe Makau',femaleReg:18,maleReg:12,totalReg:30,femaleLeft:1,maleLeft:1,totalLeft:2,meetFreq:'Always',attendHigh:0,attendMod:1,attendLow:0,activeSavingF:16,activeSavingM:11,activeSavingT:27,savingsSum:50630.0,savingsAvg:50630.0,savingsMax:50630.0,savingsMin:50630.0,loansDisbursed:47500.0,loansRepaid:36800.0,repayProportion:0.77,repaymentValue:36800.0,interestEarned:3680.0,loansDisbursedCount:27,loansRepaidCount:15,socialFundYes:true,socialFundValue:12930.0,failedLoan:true,loanUse:{business:0.33,schoolFees:0.33,food:0,clothing:0,shelter:0,household:0.33}},
            {name:'Kwale Environmental Conservation group',county:'Kwale',village:'Kibaoni mafisini',cycle:'Cycle_1',quarter:'Q3',cbt:'Mary mither mbithe makau',femaleReg:21,maleReg:7,totalReg:28,femaleLeft:2,maleLeft:2,totalLeft:4,meetFreq:'Always',attendHigh:1,attendMod:0,attendLow:0,activeSavingF:21,activeSavingM:7,activeSavingT:28,savingsSum:108050.0,savingsAvg:108050.0,savingsMax:108050.0,savingsMin:108050.0,loansDisbursed:86110.0,loansRepaid:61660.0,repayProportion:0.72,repaymentValue:61660.0,interestEarned:6166.0,loansDisbursedCount:28,loansRepaidCount:28,socialFundYes:true,socialFundValue:22040.0,failedLoan:true,loanUse:{business:0.25,schoolFees:0.25,food:0.25,clothing:0,shelter:0,household:0.25}},
            {name:'Langoni SHG',county:'Kilifi',village:'Takaungu/Mwangatini',cycle:'Cycle_1',quarter:'Q2',cbt:'Ali Kazungu',femaleReg:16,maleReg:5,totalReg:21,femaleLeft:0,maleLeft:1,totalLeft:1,meetFreq:'Always',attendHigh:1,attendMod:0,attendLow:0,activeSavingF:21,activeSavingM:6,activeSavingT:27,savingsSum:75445.0,savingsAvg:75445.0,savingsMax:75445.0,savingsMin:75445.0,loansDisbursed:23000.0,loansRepaid:10000.0,repayProportion:0.43,repaymentValue:10000.0,interestEarned:1000.0,loansDisbursedCount:16,loansRepaidCount:7,socialFundYes:true,socialFundValue:2460.0,failedLoan:true,loanUse:{business:0.33,schoolFees:0.33,food:0,clothing:0,shelter:0,household:0.33}},
            {name:'Langoni SHG',county:'Kilifi',village:'Mwangatini/Takaungu',cycle:'Cycle_3',quarter:'Q3',cbt:'Ali Kazungu Khamisi',femaleReg:21,maleReg:7,totalReg:28,femaleLeft:0,maleLeft:1,totalLeft:1,meetFreq:'Always',attendHigh:1,attendMod:0,attendLow:0,activeSavingF:3,activeSavingM:1,activeSavingT:4,savingsSum:35000.0,savingsAvg:35000.0,savingsMax:35000.0,savingsMin:35000.0,loansDisbursed:28000.0,loansRepaid:21000.0,repayProportion:0.75,repaymentValue:21000.0,interestEarned:2100.0,loansDisbursedCount:8,loansRepaidCount:6,socialFundYes:true,socialFundValue:18000.0,failedLoan:false,loanUse:{business:0.33,schoolFees:0.33,food:0,clothing:0,shelter:0,household:0.33}},
            {name:'Lulwamwe CBo',county:'Kilifi',village:'Vijiweni  kwa mca',cycle:'Cycle_1',quarter:'Q2',cbt:'Lilian mbui/mohamedAli',femaleReg:63,maleReg:39,totalReg:102,femaleLeft:12,maleLeft:8,totalLeft:20,meetFreq:'Always',attendHigh:0,attendMod:1,attendLow:0,activeSavingF:31,activeSavingM:19,activeSavingT:50,savingsSum:31500.0,savingsAvg:31500.0,savingsMax:31500.0,savingsMin:31500.0,loansDisbursed:20000.0,loansRepaid:19000.0,repayProportion:0.95,repaymentValue:19000.0,interestEarned:100.0,loansDisbursedCount:10,loansRepaidCount:2,socialFundYes:true,socialFundValue:6510.0,failedLoan:false,loanUse:{business:0.25,schoolFees:0.25,food:0.25,clothing:0.25,shelter:0,household:0}},
            {name:'Lulwamwe CBo',county:'Kilifi',village:'Vijiweni/Takaungu',cycle:'Cycle_2',quarter:'Q4',cbt:'Lilian nyadzua  mbui',femaleReg:71,maleReg:9,totalReg:80,femaleLeft:6,maleLeft:0,totalLeft:6,meetFreq:'Always',attendHigh:0,attendMod:1,attendLow:0,activeSavingF:41,activeSavingM:5,activeSavingT:46,savingsSum:69765.0,savingsAvg:69765.0,savingsMax:69765.0,savingsMin:69765.0,loansDisbursed:29230.0,loansRepaid:18100.0,repayProportion:0.62,repaymentValue:18100.0,interestEarned:6410.0,loansDisbursedCount:15,loansRepaidCount:9,socialFundYes:true,socialFundValue:13640.0,failedLoan:true,loanUse:{business:0.25,schoolFees:0.25,food:0.25,clothing:0,shelter:0,household:0.25}},
            {name:'Mabadiliko Vidungeni',county:'Kwale',village:'Vidungeni',cycle:'Cycle_1',quarter:'Q2',cbt:'Asha Shauri',femaleReg:27,maleReg:0,totalReg:27,femaleLeft:0,maleLeft:0,totalLeft:0,meetFreq:'Always',attendHigh:1,attendMod:0,attendLow:0,activeSavingF:27,activeSavingM:0,activeSavingT:27,savingsSum:129200.0,savingsAvg:129200.0,savingsMax:129200.0,savingsMin:129200.0,loansDisbursed:151500.0,loansRepaid:58850.0,repayProportion:0.39,repaymentValue:58850.0,interestEarned:4250.0,loansDisbursedCount:45,loansRepaidCount:25,socialFundYes:true,socialFundValue:13800.0,failedLoan:false,loanUse:{business:0.17,schoolFees:0.17,food:0.17,clothing:0.17,shelter:0.17,household:0.17}},
            {name:'Mabadiliko Vidungeni VSLA',county:'Kwale',village:'Vidungeni',cycle:'Cycle_1',quarter:'Q3',cbt:'Asha Suleiman Shauri',femaleReg:27,maleReg:0,totalReg:27,femaleLeft:0,maleLeft:0,totalLeft:0,meetFreq:'Always',attendHigh:0,attendMod:1,attendLow:0,activeSavingF:27,activeSavingM:0,activeSavingT:27,savingsSum:183700.0,savingsAvg:183700.0,savingsMax:183700.0,savingsMin:183700.0,loansDisbursed:223000.0,loansRepaid:152600.0,repayProportion:0.68,repaymentValue:152600.0,interestEarned:8650.0,loansDisbursedCount:48,loansRepaidCount:30,socialFundYes:true,socialFundValue:20750.0,failedLoan:true,loanUse:{business:0.17,schoolFees:0.17,food:0.17,clothing:0.17,shelter:0.17,household:0.17}},
            {name:'Maendeleo s h g group',county:'Kilifi',village:'Dzikunze',cycle:'Cycle_1',quarter:'Q2',cbt:'Sikubali charo',femaleReg:25,maleReg:0,totalReg:25,femaleLeft:0,maleLeft:0,totalLeft:0,meetFreq:'Always',attendHigh:1,attendMod:0,attendLow:0,activeSavingF:25,activeSavingM:0,activeSavingT:25,savingsSum:100000.0,savingsAvg:100000.0,savingsMax:100000.0,savingsMin:100000.0,loansDisbursed:80000.0,loansRepaid:76000.0,repayProportion:0.95,repaymentValue:76000.0,interestEarned:10000.0,loansDisbursedCount:20,loansRepaidCount:19,socialFundYes:true,socialFundValue:500.0,failedLoan:false,loanUse:{business:0.2,schoolFees:0.2,food:0.2,clothing:0.2,shelter:0.2,household:0}},
            {name:'Mafanikio VSLA',county:'Kwale',village:'Munje',cycle:'Cycle_1',quarter:'Q3',cbt:'Mwanasiri Mohamed',femaleReg:24,maleReg:2,totalReg:26,femaleLeft:7,maleLeft:2,totalLeft:9,meetFreq:'Always',attendHigh:0,attendMod:1,attendLow:0,activeSavingF:15,activeSavingM:1,activeSavingT:16,savingsSum:43100.0,savingsAvg:43100.0,savingsMax:43100.0,savingsMin:43100.0,loansDisbursed:58500.0,loansRepaid:24300.0,repayProportion:0.42,repaymentValue:24300.0,interestEarned:100.0,loansDisbursedCount:14,loansRepaidCount:1,socialFundYes:true,socialFundValue:9500.0,failedLoan:true,loanUse:{business:0.17,schoolFees:0.17,food:0.17,clothing:0.17,shelter:0.17,household:0.17}},
            {name:'Mafinikio Women Group',county:'Kwale',village:'Munje',cycle:'Cycle_1',quarter:'Q2',cbt:'Mwanasiti Abdalla Boga',femaleReg:24,maleReg:2,totalReg:26,femaleLeft:2,maleLeft:1,totalLeft:3,meetFreq:'Always',attendHigh:0,attendMod:1,attendLow:0,activeSavingF:21,activeSavingM:2,activeSavingT:23,savingsSum:64870.0,savingsAvg:64870.0,savingsMax:64870.0,savingsMin:64870.0,loansDisbursed:67500.0,loansRepaid:21450.0,repayProportion:0.32,repaymentValue:21450.0,interestEarned:100.0,loansDisbursedCount:17,loansRepaidCount:1,socialFundYes:true,socialFundValue:7840.0,failedLoan:true,loanUse:{business:0.25,schoolFees:0.25,food:0.25,clothing:0,shelter:0,household:0.25}},
            {name:'MAJORENI BMU CONSERVATION',county:'Kwale',village:'ALENI',cycle:'Cycle_2',quarter:'Q2',cbt:'SAUMU MBARUKU',femaleReg:18,maleReg:2,totalReg:20,femaleLeft:0,maleLeft:0,totalLeft:0,meetFreq:'Always',attendHigh:1,attendMod:0,attendLow:0,activeSavingF:18,activeSavingM:2,activeSavingT:20,savingsSum:57300.0,savingsAvg:57300.0,savingsMax:57300.0,savingsMin:57300.0,loansDisbursed:55500.0,loansRepaid:17200.0,repayProportion:0.31,repaymentValue:17200.0,interestEarned:7210.0,loansDisbursedCount:20,loansRepaidCount:0,socialFundYes:true,socialFundValue:8370.0,failedLoan:false,loanUse:{business:0.33,schoolFees:0.33,food:0,clothing:0,shelter:0,household:0.33}},
            {name:'MAJORENI BMU CONSERVATION A',county:'Kwale',village:'Aleni',cycle:'Cycle_2',quarter:'Q3',cbt:'Siaba Bakari Lulu',femaleReg:23,maleReg:2,totalReg:25,femaleLeft:1,maleLeft:2,totalLeft:3,meetFreq:'Always',attendHigh:1,attendMod:0,attendLow:0,activeSavingF:21,activeSavingM:2,activeSavingT:23,savingsSum:91300.0,savingsAvg:91300.0,savingsMax:91300.0,savingsMin:91300.0,loansDisbursed:50950.0,loansRepaid:14650.0,repayProportion:0.29,repaymentValue:14650.0,interestEarned:5100.0,loansDisbursedCount:16,loansRepaidCount:0,socialFundYes:true,socialFundValue:23080.0,failedLoan:false,loanUse:{business:0.33,schoolFees:0.33,food:0,clothing:0,shelter:0,household:0.33}},
            {name:'MAJORENI BMU CONSERVATION B',county:'Kwale',village:'Aleni',cycle:'Cycle_2',quarter:'Q3',cbt:'Saumu  Mbaruku  Nanga',femaleReg:18,maleReg:2,totalReg:20,femaleLeft:1,maleLeft:0,totalLeft:1,meetFreq:'Always',attendHigh:1,attendMod:0,attendLow:0,activeSavingF:18,activeSavingM:2,activeSavingT:20,savingsSum:105370.0,savingsAvg:105370.0,savingsMax:105370.0,savingsMin:105370.0,loansDisbursed:44630.0,loansRepaid:44070.0,repayProportion:0.99,repaymentValue:44070.0,interestEarned:5750.0,loansDisbursedCount:17,loansRepaidCount:0,socialFundYes:true,socialFundValue:8650.0,failedLoan:false,loanUse:{business:0.5,schoolFees:0.5,food:0,clothing:0,shelter:0,household:0}},
            {name:'Matumaini SHG',county:'Kilifi',village:'Kanyumbuni',cycle:'Cycle_1',quarter:'Q2',cbt:'Mary Katana Ruwa',femaleReg:11,maleReg:8,totalReg:19,femaleLeft:2,maleLeft:2,totalLeft:4,meetFreq:'Always',attendHigh:0,attendMod:1,attendLow:0,activeSavingF:8,activeSavingM:6,activeSavingT:14,savingsSum:8000.0,savingsAvg:8000.0,savingsMax:8000.0,savingsMin:8000.0,loansDisbursed:6000.0,loansRepaid:5200.0,repayProportion:0.87,repaymentValue:5200.0,interestEarned:520.0,loansDisbursedCount:4,loansRepaidCount:3,socialFundYes:true,socialFundValue:1500.0,failedLoan:true,loanUse:{business:0,schoolFees:0.5,food:0,clothing:0,shelter:0,household:0.5}},
            {name:'Matumaini SHG',county:'Kilifi',village:'Kanyumbuni',cycle:'Cycle_3',quarter:'Q3',cbt:'Mary Katana Ruwa',femaleReg:14,maleReg:6,totalReg:20,femaleLeft:3,maleLeft:1,totalLeft:4,meetFreq:'Always',attendHigh:0,attendMod:1,attendLow:0,activeSavingF:8,activeSavingM:4,activeSavingT:12,savingsSum:15000.0,savingsAvg:15000.0,savingsMax:15000.0,savingsMin:15000.0,loansDisbursed:8000.0,loansRepaid:6000.0,repayProportion:0.75,repaymentValue:6000.0,interestEarned:600.0,loansDisbursedCount:4,loansRepaidCount:3,socialFundYes:true,socialFundValue:4000.0,failedLoan:false,loanUse:{business:0,schoolFees:1.0,food:0,clothing:0,shelter:0,household:0}},
            {name:'Mbweni',county:'Kwale',village:'Aleni',cycle:'Cycle_2',quarter:'Q3',cbt:'Ali Mwatambee',femaleReg:11,maleReg:11,totalReg:22,femaleLeft:2,maleLeft:1,totalLeft:3,meetFreq:'Always',attendHigh:1,attendMod:0,attendLow:0,activeSavingF:11,activeSavingM:11,activeSavingT:22,savingsSum:62400.0,savingsAvg:62400.0,savingsMax:62400.0,savingsMin:62400.0,loansDisbursed:78000.0,loansRepaid:30700.0,repayProportion:0.39,repaymentValue:30700.0,interestEarned:2370.0,loansDisbursedCount:20,loansRepaidCount:0,socialFundYes:true,socialFundValue:10850.0,failedLoan:false,loanUse:{business:0.33,schoolFees:0.33,food:0,clothing:0,shelter:0,household:0.33}},
            {name:'Mbweni bee keeping GRSG',county:'Kwale',village:'Aleni',cycle:'Cycle_2',quarter:'Q2',cbt:'ALI MWATAMBEE',femaleReg:9,maleReg:13,totalReg:22,femaleLeft:1,maleLeft:1,totalLeft:2,meetFreq:'Always',attendHigh:1,attendMod:0,attendLow:0,activeSavingF:8,activeSavingM:12,activeSavingT:20,savingsSum:43200.0,savingsAvg:43200.0,savingsMax:43200.0,savingsMin:43200.0,loansDisbursed:51000.0,loansRepaid:22900.0,repayProportion:0.45,repaymentValue:22900.0,interestEarned:5200.0,loansDisbursedCount:14,loansRepaidCount:0,socialFundYes:true,socialFundValue:8250.0,failedLoan:false,loanUse:{business:0.33,schoolFees:0.33,food:0,clothing:0,shelter:0,household:0.33}},
            {name:'Mijiweni self help group',county:'Kilifi',village:'Kanyumbuni',cycle:'Cycle_1',quarter:'Q2',cbt:'Zulekha Abdhala',femaleReg:26,maleReg:4,totalReg:30,femaleLeft:2,maleLeft:0,totalLeft:2,meetFreq:'Always',attendHigh:1,attendMod:0,attendLow:0,activeSavingF:9,activeSavingM:1,activeSavingT:10,savingsSum:3500.0,savingsAvg:3500.0,savingsMax:3500.0,savingsMin:3500.0,loansDisbursed:0.0,loansRepaid:0.0,repayProportion:0,repaymentValue:0.0,interestEarned:0.0,loansDisbursedCount:0,loansRepaidCount:0,socialFundYes:true,socialFundValue:1300.0,failedLoan:false,loanUse:{business:0.25,schoolFees:0.25,food:0.25,clothing:0,shelter:0,household:0.25}},
            {name:'Miwani self help group',county:'Kilifi',village:'Miwani',cycle:'Cycle_2',quarter:'Q2',cbt:'Celestine nguwa',femaleReg:25,maleReg:1,totalReg:26,femaleLeft:6,maleLeft:0,totalLeft:6,meetFreq:'Always',attendHigh:0,attendMod:1,attendLow:0,activeSavingF:6,activeSavingM:0,activeSavingT:6,savingsSum:20400.0,savingsAvg:20400.0,savingsMax:20400.0,savingsMin:20400.0,loansDisbursed:21700.0,loansRepaid:12025.0,repayProportion:0.55,repaymentValue:12025.0,interestEarned:945.0,loansDisbursedCount:11,loansRepaidCount:10,socialFundYes:true,socialFundValue:9800.0,failedLoan:false,loanUse:{business:0.33,schoolFees:0.33,food:0.33,clothing:0,shelter:0,household:0}},
            {name:'Miwani self help group',county:'Kilifi',village:'Takaungu  miwani',cycle:'Cycle_3',quarter:'Q2',cbt:'Celestine Nguwa',femaleReg:18,maleReg:0,totalReg:18,femaleLeft:3,maleLeft:0,totalLeft:3,meetFreq:'Always',attendHigh:0,attendMod:1,attendLow:0,activeSavingF:16,activeSavingM:0,activeSavingT:16,savingsSum:25750.0,savingsAvg:25750.0,savingsMax:25750.0,savingsMin:25750.0,loansDisbursed:19900.0,loansRepaid:7700.0,repayProportion:0.39,repaymentValue:7700.0,interestEarned:3635.0,loansDisbursedCount:12,loansRepaidCount:7,socialFundYes:true,socialFundValue:9710.0,failedLoan:false,loanUse:{business:0.25,schoolFees:0.25,food:0.25,clothing:0,shelter:0,household:0.25}},
            {name:'Mkwajuni young mothers',county:'Kilifi',village:'Takaungu kibaoni',cycle:'Cycle_2',quarter:'Q2',cbt:'Silvia Blandina',femaleReg:26,maleReg:5,totalReg:31,femaleLeft:0,maleLeft:0,totalLeft:0,meetFreq:'Always',attendHigh:1,attendMod:0,attendLow:0,activeSavingF:25,activeSavingM:5,activeSavingT:30,savingsSum:28150.0,savingsAvg:28150.0,savingsMax:28150.0,savingsMin:28150.0,loansDisbursed:1000.0,loansRepaid:1000.0,repayProportion:1.0,repaymentValue:1000.0,interestEarned:100.0,loansDisbursedCount:4,loansRepaidCount:1,socialFundYes:true,socialFundValue:10009.0,failedLoan:true,loanUse:{business:0.2,schoolFees:0.2,food:0.2,clothing:0.2,shelter:0,household:0.2}},
            {name:'MKWIRO SEAWEED DEVELOPMENT GROUP A',county:'Kwale',village:'Mkwiro',cycle:'Cycle_1',quarter:'Q2',cbt:'Mwanamkuu Bakari Mohammed',femaleReg:26,maleReg:4,totalReg:30,femaleLeft:0,maleLeft:0,totalLeft:0,meetFreq:'Always',attendHigh:1,attendMod:0,attendLow:0,activeSavingF:26,activeSavingM:4,activeSavingT:30,savingsSum:164200.0,savingsAvg:164200.0,savingsMax:164200.0,savingsMin:164200.0,loansDisbursed:129500.0,loansRepaid:129500.0,repayProportion:1.0,repaymentValue:129500.0,interestEarned:99300.0,loansDisbursedCount:30,loansRepaidCount:30,socialFundYes:true,socialFundValue:15480.0,failedLoan:false,loanUse:{business:0.2,schoolFees:0.2,food:0.2,clothing:0.2,shelter:0.2,household:0}},
            {name:'MKWIRO SEAWEED DEVELOPMENT GROUP A',county:'Kwale',village:'MKWIRO',cycle:'Cycle_1',quarter:'Q3',cbt:'MWANAMKUU BAKARI MOHAMED',femaleReg:26,maleReg:4,totalReg:30,femaleLeft:0,maleLeft:2,totalLeft:2,meetFreq:'Always',attendHigh:1,attendMod:0,attendLow:0,activeSavingF:23,activeSavingM:3,activeSavingT:26,savingsSum:212450.0,savingsAvg:212450.0,savingsMax:212450.0,savingsMin:212450.0,loansDisbursed:99000.0,loansRepaid:52000.0,repayProportion:0.53,repaymentValue:52000.0,interestEarned:18600.0,loansDisbursedCount:13,loansRepaidCount:7,socialFundYes:true,socialFundValue:8980.0,failedLoan:false,loanUse:{business:0.2,schoolFees:0.2,food:0.2,clothing:0.2,shelter:0.2,household:0}},
            {name:'MKWIRO SEAWEED DEVELOPMENT GROUP B',county:'Kwale',village:'Mkwiro',cycle:'Cycle_1',quarter:'Q2',cbt:'Nuru Alpha Famau',femaleReg:23,maleReg:3,totalReg:26,femaleLeft:0,maleLeft:0,totalLeft:0,meetFreq:'Always',attendHigh:1,attendMod:0,attendLow:0,activeSavingF:27,activeSavingM:3,activeSavingT:30,savingsSum:142630.0,savingsAvg:142630.0,savingsMax:142630.0,savingsMin:142630.0,loansDisbursed:169400.0,loansRepaid:169400.0,repayProportion:1.0,repaymentValue:169400.0,interestEarned:24750.0,loansDisbursedCount:30,loansRepaidCount:30,socialFundYes:true,socialFundValue:29780.0,failedLoan:false,loanUse:{business:0.2,schoolFees:0.2,food:0.2,clothing:0.2,shelter:0.2,household:0}},
            {name:'MKWIRO SEAWEED DEVELOPMENT GROUP B',county:'Kwale',village:'Mkwiro',cycle:'Cycle_1',quarter:'Q3',cbt:'NURU ALPHA',femaleReg:27,maleReg:3,totalReg:30,femaleLeft:0,maleLeft:0,totalLeft:0,meetFreq:'Always',attendHigh:1,attendMod:0,attendLow:0,activeSavingF:27,activeSavingM:3,activeSavingT:30,savingsSum:213650.0,savingsAvg:213650.0,savingsMax:213650.0,savingsMin:213650.0,loansDisbursed:156500.0,loansRepaid:98700.0,repayProportion:0.63,repaymentValue:98700.0,interestEarned:23300.0,loansDisbursedCount:22,loansRepaidCount:13,socialFundYes:true,socialFundValue:38245.0,failedLoan:false,loanUse:{business:0.17,schoolFees:0.17,food:0.17,clothing:0.17,shelter:0.17,household:0.17}},
            {name:'MKWIRO SEAWEED DEVELOPMENT GROUP C',county:'Kwale',village:'MKWIRO',cycle:'Cycle_1',quarter:'Q3',cbt:'MWASHIDA MZINGO',femaleReg:26,maleReg:3,totalReg:29,femaleLeft:0,maleLeft:1,totalLeft:1,meetFreq:'Always',attendHigh:1,attendMod:0,attendLow:0,activeSavingF:26,activeSavingM:3,activeSavingT:29,savingsSum:209800.0,savingsAvg:209800.0,savingsMax:209800.0,savingsMin:209800.0,loansDisbursed:87000.0,loansRepaid:50600.0,repayProportion:0.58,repaymentValue:50600.0,interestEarned:17300.0,loansDisbursedCount:17,loansRepaidCount:7,socialFundYes:true,socialFundValue:9485.0,failedLoan:false,loanUse:{business:0.2,schoolFees:0.2,food:0.2,clothing:0.2,shelter:0.2,household:0}},
            {name:'Mkwiro seaweed group A',county:'Kwale',village:'Mkwiro',cycle:'Cycle_1',quarter:'Q2',cbt:'MWANAMKUU BAKARI MOHAMMED',femaleReg:26,maleReg:4,totalReg:30,femaleLeft:0,maleLeft:0,totalLeft:0,meetFreq:'Always',attendHigh:1,attendMod:0,attendLow:0,activeSavingF:26,activeSavingM:4,activeSavingT:30,savingsSum:164200.0,savingsAvg:164200.0,savingsMax:164200.0,savingsMin:164200.0,loansDisbursed:0.0,loansRepaid:129500.0,repayProportion:0,repaymentValue:129500.0,interestEarned:99300.0,loansDisbursedCount:0,loansRepaidCount:30,socialFundYes:true,socialFundValue:15480.0,failedLoan:true,loanUse:{business:0.2,schoolFees:0.2,food:0.2,clothing:0.2,shelter:0.2,household:0}},
            {name:'Mkwiro seaweed group B',county:'Kwale',village:'Mkwiro',cycle:'Cycle_1',quarter:'Q2',cbt:'NURU ALPHA FAMAU',femaleReg:27,maleReg:3,totalReg:30,femaleLeft:0,maleLeft:0,totalLeft:0,meetFreq:'Always',attendHigh:1,attendMod:0,attendLow:0,activeSavingF:27,activeSavingM:3,activeSavingT:30,savingsSum:142630.0,savingsAvg:142630.0,savingsMax:142630.0,savingsMin:142630.0,loansDisbursed:0.0,loansRepaid:169400.0,repayProportion:0,repaymentValue:169400.0,interestEarned:25750.0,loansDisbursedCount:0,loansRepaidCount:30,socialFundYes:true,socialFundValue:29780.0,failedLoan:false,loanUse:{business:0.2,schoolFees:0.2,food:0.2,clothing:0.2,shelter:0.2,household:0}},
            {name:'Mkwiro seaweed group C',county:'Kwale',village:'Mkwiro',cycle:'Cycle_1',quarter:'Q2',cbt:'Mwashida mzingo',femaleReg:26,maleReg:3,totalReg:29,femaleLeft:0,maleLeft:0,totalLeft:0,meetFreq:'Always',attendHigh:1,attendMod:0,attendLow:0,activeSavingF:26,activeSavingM:3,activeSavingT:29,savingsSum:157400.0,savingsAvg:157400.0,savingsMax:157400.0,savingsMin:157400.0,loansDisbursed:89700.0,loansRepaid:89700.0,repayProportion:1.0,repaymentValue:89700.0,interestEarned:8600.0,loansDisbursedCount:29,loansRepaidCount:29,socialFundYes:true,socialFundValue:22100.0,failedLoan:false,loanUse:{business:0.2,schoolFees:0.2,food:0.2,clothing:0.2,shelter:0.2,household:0}},
            {name:'Mkwiro seaweed group C',county:'Kwale',village:'Mkwiro',cycle:'Cycle_1',quarter:'Q2',cbt:'Mwashida mzingo',femaleReg:26,maleReg:3,totalReg:29,femaleLeft:0,maleLeft:1,totalLeft:1,meetFreq:'Always',attendHigh:1,attendMod:0,attendLow:0,activeSavingF:26,activeSavingM:3,activeSavingT:29,savingsSum:157400.0,savingsAvg:157400.0,savingsMax:157400.0,savingsMin:157400.0,loansDisbursed:0.0,loansRepaid:89700.0,repayProportion:0,repaymentValue:89700.0,interestEarned:8600.0,loansDisbursedCount:0,loansRepaidCount:27,socialFundYes:true,socialFundValue:22100.0,failedLoan:false,loanUse:{business:0.2,schoolFees:0.2,food:0.2,clothing:0.2,shelter:0.2,household:0}},
            {name:'Mkwiro seaweed group C',county:'Kwale',village:'Mkwiro',cycle:'Cycle_1',quarter:'Q2',cbt:'Mwashida mzingo',femaleReg:26,maleReg:3,totalReg:29,femaleLeft:0,maleLeft:0,totalLeft:0,meetFreq:'Always',attendHigh:1,attendMod:0,attendLow:0,activeSavingF:26,activeSavingM:3,activeSavingT:29,savingsSum:157400.0,savingsAvg:157400.0,savingsMax:157400.0,savingsMin:157400.0,loansDisbursed:0.0,loansRepaid:89700.0,repayProportion:0,repaymentValue:89700.0,interestEarned:8600.0,loansDisbursedCount:0,loansRepaidCount:27,socialFundYes:true,socialFundValue:22000.0,failedLoan:false,loanUse:{business:0.2,schoolFees:0.2,food:0.2,clothing:0.2,shelter:0.2,household:0}},
            {name:'Moriani  CBO',county:'Kilifi',village:'Boyani',cycle:'Cycle_2',quarter:'Q4',cbt:'Shingila  harry.kitole',femaleReg:45,maleReg:9,totalReg:54,femaleLeft:4,maleLeft:1,totalLeft:5,meetFreq:'Always',attendHigh:1,attendMod:0,attendLow:0,activeSavingF:33,activeSavingM:7,activeSavingT:40,savingsSum:70000.0,savingsAvg:70000.0,savingsMax:70000.0,savingsMin:70000.0,loansDisbursed:33000.0,loansRepaid:33000.0,repayProportion:1.0,repaymentValue:33000.0,interestEarned:3300.0,loansDisbursedCount:3,loansRepaidCount:3,socialFundYes:true,socialFundValue:10000.0,failedLoan:true,loanUse:{business:0.25,schoolFees:0.25,food:0,clothing:0,shelter:0.25,household:0.25}},
            {name:'Moriani CBO',county:'Kilifi',village:'Boyani',cycle:'Cycle_1',quarter:'Q2',cbt:'Shingila  Harry  kitole',femaleReg:47,maleReg:13,totalReg:60,femaleLeft:5,maleLeft:4,totalLeft:9,meetFreq:'Always',attendHigh:0,attendMod:1,attendLow:0,activeSavingF:16,activeSavingM:4,activeSavingT:20,savingsSum:10000.0,savingsAvg:10000.0,savingsMax:10000.0,savingsMin:10000.0,loansDisbursed:0.0,loansRepaid:0.0,repayProportion:0,repaymentValue:0.0,interestEarned:0.0,loansDisbursedCount:0,loansRepaidCount:0,socialFundYes:true,socialFundValue:3000.0,failedLoan:false,loanUse:{business:0,schoolFees:0,food:0,clothing:0,shelter:0,household:1.0}},
            {name:'Msahau Mila Bundika',county:'Kilifi',village:'Silala',cycle:'Cycle_1',quarter:'Q2',cbt:'Mwakalu Nyale Ngala',femaleReg:14,maleReg:14,totalReg:28,femaleLeft:2,maleLeft:1,totalLeft:3,meetFreq:'Always',attendHigh:0,attendMod:1,attendLow:0,activeSavingF:14,activeSavingM:14,activeSavingT:28,savingsSum:74655.0,savingsAvg:74655.0,savingsMax:74655.0,savingsMin:74655.0,loansDisbursed:58650.0,loansRepaid:23500.0,repayProportion:0.4,repaymentValue:23500.0,interestEarned:5865.0,loansDisbursedCount:19,loansRepaidCount:6,socialFundYes:true,socialFundValue:10040.0,failedLoan:false,loanUse:{business:0,schoolFees:0.25,food:0,clothing:0.25,shelter:0.25,household:0.25}},
            {name:'Msahau Mila Bundika',county:'Kilifi',village:'Kizingo',cycle:'Cycle_2',quarter:'Q3',cbt:'Mwakalu Nyale Ngala',femaleReg:14,maleReg:14,totalReg:28,femaleLeft:3,maleLeft:1,totalLeft:4,meetFreq:'Always',attendHigh:0,attendMod:1,attendLow:0,activeSavingF:14,activeSavingM:14,activeSavingT:28,savingsSum:98655.0,savingsAvg:98655.0,savingsMax:98655.0,savingsMin:98655.0,loansDisbursed:72850.0,loansRepaid:38400.0,repayProportion:0.53,repaymentValue:38400.0,interestEarned:7285.0,loansDisbursedCount:28,loansRepaidCount:14,socialFundYes:true,socialFundValue:15020.0,failedLoan:false,loanUse:{business:0.25,schoolFees:0.25,food:0,clothing:0,shelter:0.25,household:0.25}},
            {name:'Mta Wa Saba A',county:'Kilifi',village:'Bondeni',cycle:'Cycle_1',quarter:'Q2',cbt:'Tsuma Charo Lwembe',femaleReg:15,maleReg:6,totalReg:21,femaleLeft:0,maleLeft:0,totalLeft:0,meetFreq:'Always',attendHigh:0,attendMod:1,attendLow:0,activeSavingF:13,activeSavingM:5,activeSavingT:18,savingsSum:37500.0,savingsAvg:37500.0,savingsMax:37500.0,savingsMin:37500.0,loansDisbursed:37500.0,loansRepaid:19500.0,repayProportion:0.52,repaymentValue:19500.0,interestEarned:3720.0,loansDisbursedCount:23,loansRepaidCount:9,socialFundYes:true,socialFundValue:13590.0,failedLoan:false,loanUse:{business:0,schoolFees:0.25,food:0.25,clothing:0.25,shelter:0,household:0.25}},
            {name:'Mta Wa Saba B',county:'Kilifi',village:'Bondeni',cycle:'Cycle_2',quarter:'Q2',cbt:'Claris Kwekwe Sanga',femaleReg:13,maleReg:9,totalReg:22,femaleLeft:0,maleLeft:0,totalLeft:0,meetFreq:'Always',attendHigh:0,attendMod:1,attendLow:0,activeSavingF:11,activeSavingM:8,activeSavingT:19,savingsSum:45600.0,savingsAvg:45600.0,savingsMax:45600.0,savingsMin:45600.0,loansDisbursed:42800.0,loansRepaid:20200.0,repayProportion:0.47,repaymentValue:20200.0,interestEarned:4280.0,loansDisbursedCount:20,loansRepaidCount:6,socialFundYes:true,socialFundValue:12450.0,failedLoan:false,loanUse:{business:0.25,schoolFees:0.25,food:0.25,clothing:0,shelter:0,household:0.25}},
            {name:'Mta Wa Saba B',county:'Kilifi',village:'Bondeni',cycle:'Cycle_1',quarter:'Q2',cbt:'Claris Kwekwe Sanga',femaleReg:13,maleReg:9,totalReg:22,femaleLeft:0,maleLeft:0,totalLeft:0,meetFreq:'Always',attendHigh:0,attendMod:1,attendLow:0,activeSavingF:11,activeSavingM:8,activeSavingT:19,savingsSum:45600.0,savingsAvg:45600.0,savingsMax:45600.0,savingsMin:45600.0,loansDisbursed:112800.0,loansRepaid:40200.0,repayProportion:0.36,repaymentValue:40200.0,interestEarned:11450.0,loansDisbursedCount:20,loansRepaidCount:6,socialFundYes:true,socialFundValue:13590.0,failedLoan:false,loanUse:{business:0.25,schoolFees:0.25,food:0.25,clothing:0,shelter:0,household:0.25}},
            {name:'Mtaa Wa Saba A',county:'Kilifi',village:'Bondeni',cycle:'Cycle_2',quarter:'Q3',cbt:'Tsuma Charo Lwembe',femaleReg:15,maleReg:6,totalReg:21,femaleLeft:0,maleLeft:0,totalLeft:0,meetFreq:'Always',attendHigh:0,attendMod:1,attendLow:0,activeSavingF:13,activeSavingM:5,activeSavingT:18,savingsSum:48200.0,savingsAvg:48200.0,savingsMax:48200.0,savingsMin:48200.0,loansDisbursed:45000.0,loansRepaid:30400.0,repayProportion:0.68,repaymentValue:30400.0,interestEarned:4500.0,loansDisbursedCount:31,loansRepaidCount:15,socialFundYes:true,socialFundValue:18990.0,failedLoan:false,loanUse:{business:0.25,schoolFees:0.25,food:0,clothing:0,shelter:0.25,household:0.25}},
            {name:'Mtaa Wa Saba B',county:'Kilifi',village:'Bondeni',cycle:'Cycle_2',quarter:'Q3',cbt:'Claris Kwekwe Sanga',femaleReg:13,maleReg:9,totalReg:22,femaleLeft:0,maleLeft:0,totalLeft:0,meetFreq:'Always',attendHigh:0,attendMod:1,attendLow:0,activeSavingF:11,activeSavingM:8,activeSavingT:19,savingsSum:56300.0,savingsAvg:56300.0,savingsMax:56300.0,savingsMin:56300.0,loansDisbursed:53000.0,loansRepaid:32100.0,repayProportion:0.61,repaymentValue:32100.0,interestEarned:5300.0,loansDisbursedCount:28,loansRepaidCount:12,socialFundYes:true,socialFundValue:17850.0,failedLoan:false,loanUse:{business:0.25,schoolFees:0.25,food:0,clothing:0,shelter:0.25,household:0.25}},
            {name:'Mtimbwani seaweed - Mapatano Vsla',county:'Kwale',village:'Mtimbwani',cycle:'Cycle_2',quarter:'Q2',cbt:'Juma Mohamed hamisi',femaleReg:26,maleReg:9,totalReg:35,femaleLeft:0,maleLeft:0,totalLeft:0,meetFreq:'Always',attendHigh:1,attendMod:0,attendLow:0,activeSavingF:26,activeSavingM:9,activeSavingT:35,savingsSum:65400.0,savingsAvg:65400.0,savingsMax:65400.0,savingsMin:65400.0,loansDisbursed:23800.0,loansRepaid:2000.0,repayProportion:0.08,repaymentValue:2000.0,interestEarned:200.0,loansDisbursedCount:16,loansRepaidCount:1,socialFundYes:true,socialFundValue:13800.0,failedLoan:false,loanUse:{business:0.25,schoolFees:0.25,food:0,clothing:0,shelter:0.25,household:0.25}},
            {name:'MTIMBWANI VSLA',county:'Kwale',village:'MTIMBWANI',cycle:'Cycle_2',quarter:'Q3',cbt:'JUMA MOHAMED HAMISI',femaleReg:26,maleReg:9,totalReg:35,femaleLeft:0,maleLeft:0,totalLeft:0,meetFreq:'Always',attendHigh:1,attendMod:0,attendLow:0,activeSavingF:26,activeSavingM:9,activeSavingT:35,savingsSum:109900.0,savingsAvg:109900.0,savingsMax:109900.0,savingsMin:109900.0,loansDisbursed:40600.0,loansRepaid:10.0,repayProportion:0.0,repaymentValue:10.0,interestEarned:4060.0,loansDisbursedCount:25,loansRepaidCount:15700,socialFundYes:true,socialFundValue:12050.0,failedLoan:false,loanUse:{business:0.25,schoolFees:0.25,food:0,clothing:0,shelter:0.25,household:0.25}},
            {name:'Mwachande Disabled Group',county:'Kwale',village:'Mwachande',cycle:'Cycle_1',quarter:'Q2',cbt:'TOT Amina Hassan Mwafrika CBT Rukia Bakari Koja',femaleReg:23,maleReg:5,totalReg:28,femaleLeft:2,maleLeft:0,totalLeft:2,meetFreq:'Always',attendHigh:1,attendMod:0,attendLow:0,activeSavingF:21,activeSavingM:5,activeSavingT:26,savingsSum:50300.0,savingsAvg:50300.0,savingsMax:50300.0,savingsMin:50300.0,loansDisbursed:66490.0,loansRepaid:25000.0,repayProportion:0.38,repaymentValue:25000.0,interestEarned:2500.0,loansDisbursedCount:19,loansRepaidCount:7,socialFundYes:true,socialFundValue:24710.0,failedLoan:true,loanUse:{business:0.25,schoolFees:0.25,food:0.25,clothing:0,shelter:0,household:0.25}},
            {name:'Mwachande Disabled group',county:'Kwale',village:'Mwachande',cycle:'Cycle_1',quarter:'Q3',cbt:'Rukia Bakari',femaleReg:24,maleReg:3,totalReg:27,femaleLeft:3,maleLeft:1,totalLeft:4,meetFreq:'Always',attendHigh:1,attendMod:0,attendLow:0,activeSavingF:24,activeSavingM:3,activeSavingT:27,savingsSum:199500.0,savingsAvg:199500.0,savingsMax:199500.0,savingsMin:199500.0,loansDisbursed:170000.0,loansRepaid:45450.0,repayProportion:0.27,repaymentValue:45450.0,interestEarned:4545.0,loansDisbursedCount:27,loansRepaidCount:14,socialFundYes:true,socialFundValue:22000.0,failedLoan:false,loanUse:{business:0.33,schoolFees:0.33,food:0,clothing:0,shelter:0,household:0.33}},
            {name:'Mwahera Sub-location village elders self help group',county:'Kilifi',village:'Kang\'amboni North',cycle:'Cycle_1',quarter:'Q2',cbt:'Ferdinand Murabu Mwaguni',femaleReg:6,maleReg:10,totalReg:16,femaleLeft:2,maleLeft:0,totalLeft:2,meetFreq:'Always',attendHigh:1,attendMod:0,attendLow:0,activeSavingF:5,activeSavingM:8,activeSavingT:13,savingsSum:6420.0,savingsAvg:6420.0,savingsMax:6420.0,savingsMin:6420.0,loansDisbursed:35000.0,loansRepaid:22870.0,repayProportion:0.65,repaymentValue:22870.0,interestEarned:4000.0,loansDisbursedCount:8,loansRepaidCount:8,socialFundYes:true,socialFundValue:1100.0,failedLoan:true,loanUse:{business:0.25,schoolFees:0.25,food:0.25,clothing:0,shelter:0,household:0.25}},
            {name:'Mwakizi A',county:'Kilifi',village:'Kizingo chiefs office',cycle:'Cycle_1',quarter:'Q2',cbt:'Derric gambo gwabi',femaleReg:9,maleReg:13,totalReg:22,femaleLeft:0,maleLeft:0,totalLeft:0,meetFreq:'Always',attendHigh:1,attendMod:0,attendLow:0,activeSavingF:7,activeSavingM:11,activeSavingT:18,savingsSum:18850.0,savingsAvg:18850.0,savingsMax:18850.0,savingsMin:18850.0,loansDisbursed:19000.0,loansRepaid:3350.0,repayProportion:0.18,repaymentValue:3350.0,interestEarned:850.0,loansDisbursedCount:14,loansRepaidCount:7,socialFundYes:true,socialFundValue:450.0,failedLoan:false,loanUse:{business:0.5,schoolFees:0.5,food:0,clothing:0,shelter:0,household:0}},
            {name:'Mwakizi A',county:'Kilifi',village:'Kizingo chiefs office',cycle:'Cycle_1',quarter:'Q3',cbt:'Derric  gambo gwabi',femaleReg:8,maleReg:12,totalReg:20,femaleLeft:1,maleLeft:1,totalLeft:2,meetFreq:'Always',attendHigh:0,attendMod:1,attendLow:0,activeSavingF:8,activeSavingM:11,activeSavingT:19,savingsSum:25300.0,savingsAvg:25300.0,savingsMax:25300.0,savingsMin:25300.0,loansDisbursed:21250.0,loansRepaid:7150.0,repayProportion:0.34,repaymentValue:7150.0,interestEarned:8500.0,loansDisbursedCount:17,loansRepaidCount:5,socialFundYes:true,socialFundValue:6470.0,failedLoan:false,loanUse:{business:0,schoolFees:0.33,food:0.33,clothing:0.33,shelter:0,household:0}},
            {name:'Mwakizi B',county:'Kilifi',village:'Kizingo chiefs office',cycle:'Cycle_1',quarter:'Q2',cbt:'Lewa said',femaleReg:3,maleReg:11,totalReg:14,femaleLeft:0,maleLeft:0,totalLeft:0,meetFreq:'Always',attendHigh:1,attendMod:0,attendLow:0,activeSavingF:3,activeSavingM:11,activeSavingT:14,savingsSum:25190.0,savingsAvg:25190.0,savingsMax:25190.0,savingsMin:25190.0,loansDisbursed:25190.0,loansRepaid:22650.0,repayProportion:0.9,repaymentValue:22650.0,interestEarned:6800.0,loansDisbursedCount:13,loansRepaidCount:10,socialFundYes:true,socialFundValue:3840.0,failedLoan:false,loanUse:{business:0.33,schoolFees:0.33,food:0.33,clothing:0,shelter:0,household:0}},
            {name:'Mwakizi B',county:'Kilifi',village:'Kizingo chiefs office',cycle:'Cycle_1',quarter:'Q3',cbt:'Mbaga lewa said',femaleReg:3,maleReg:11,totalReg:14,femaleLeft:0,maleLeft:0,totalLeft:0,meetFreq:'Always',attendHigh:1,attendMod:0,attendLow:0,activeSavingF:3,activeSavingM:11,activeSavingT:14,savingsSum:40640.0,savingsAvg:40640.0,savingsMax:40640.0,savingsMin:40640.0,loansDisbursed:40310.0,loansRepaid:13040.0,repayProportion:0.32,repaymentValue:13040.0,interestEarned:8500.0,loansDisbursedCount:14,loansRepaidCount:10,socialFundYes:true,socialFundValue:6820.0,failedLoan:false,loanUse:{business:0.33,schoolFees:0.33,food:0.33,clothing:0,shelter:0,household:0}},
            {name:'Mwalungachumi  vsla',county:'Kwale',village:'Machandzuni',cycle:'Cycle_1',quarter:'Q3',cbt:'Hellen Masha',femaleReg:28,maleReg:2,totalReg:30,femaleLeft:0,maleLeft:0,totalLeft:0,meetFreq:'Always',attendHigh:0,attendMod:1,attendLow:0,activeSavingF:28,activeSavingM:2,activeSavingT:30,savingsSum:197200.0,savingsAvg:197200.0,savingsMax:197200.0,savingsMin:197200.0,loansDisbursed:151100.0,loansRepaid:117300.0,repayProportion:0.78,repaymentValue:117300.0,interestEarned:22200.0,loansDisbursedCount:30,loansRepaidCount:13,socialFundYes:true,socialFundValue:5600.0,failedLoan:false,loanUse:{business:0.2,schoolFees:0.2,food:0.2,clothing:0,shelter:0.2,household:0.2}},
            {name:'Mwalungachumi vsla',county:'Kwale',village:'Machandzuni',cycle:'Cycle_1',quarter:'Q2',cbt:'Hellen Masha',femaleReg:30,maleReg:2,totalReg:32,femaleLeft:0,maleLeft:0,totalLeft:0,meetFreq:'Always',attendHigh:1,attendMod:0,attendLow:0,activeSavingF:27,activeSavingM:2,activeSavingT:29,savingsSum:114300.0,savingsAvg:114300.0,savingsMax:114300.0,savingsMin:114300.0,loansDisbursed:149500.0,loansRepaid:74500.0,repayProportion:0.5,repaymentValue:74500.0,interestEarned:14950.0,loansDisbursedCount:24,loansRepaidCount:14,socialFundYes:false,socialFundValue:4450.0,failedLoan:false,loanUse:{business:0.2,schoolFees:0.2,food:0.2,clothing:0,shelter:0.2,household:0.2}},
            {name:'Mwambao mkuyuni youth VSLA',county:'Kwale',village:'Mwambao',cycle:'Cycle_2',quarter:'Q2',cbt:'Fatuma Idii',femaleReg:21,maleReg:7,totalReg:28,femaleLeft:3,maleLeft:3,totalLeft:6,meetFreq:'Always',attendHigh:0,attendMod:1,attendLow:0,activeSavingF:15,activeSavingM:5,activeSavingT:20,savingsSum:28600.0,savingsAvg:28600.0,savingsMax:28600.0,savingsMin:28600.0,loansDisbursed:27000.0,loansRepaid:0.0,repayProportion:0.0,repaymentValue:0.0,interestEarned:0.0,loansDisbursedCount:5,loansRepaidCount:0,socialFundYes:true,socialFundValue:15550.0,failedLoan:false,loanUse:{business:0.33,schoolFees:0.33,food:0,clothing:0,shelter:0,household:0.33}},
            {name:'Mwandzo Mpya GRSG',county:'Kwale',village:'YUNGI',cycle:'Cycle_2',quarter:'Q2',cbt:'MDIGO  BEJA  MANGALE',femaleReg:12,maleReg:6,totalReg:18,femaleLeft:0,maleLeft:0,totalLeft:0,meetFreq:'Always',attendHigh:1,attendMod:0,attendLow:0,activeSavingF:12,activeSavingM:6,activeSavingT:18,savingsSum:49300.0,savingsAvg:49300.0,savingsMax:49300.0,savingsMin:49300.0,loansDisbursed:17850.0,loansRepaid:0.0,repayProportion:0.0,repaymentValue:0.0,interestEarned:5740.0,loansDisbursedCount:18,loansRepaidCount:0,socialFundYes:true,socialFundValue:18730.0,failedLoan:false,loanUse:{business:0.33,schoolFees:0.33,food:0,clothing:0,shelter:0,household:0.33}},
            {name:'Mwandzo mpya yungi',county:'Kwale',village:'Yungi',cycle:'Cycle_2',quarter:'Q3',cbt:'Mdigo Beja  Mangale',femaleReg:18,maleReg:5,totalReg:23,femaleLeft:1,maleLeft:0,totalLeft:1,meetFreq:'Always',attendHigh:1,attendMod:0,attendLow:0,activeSavingF:20,activeSavingM:6,activeSavingT:26,savingsSum:12240.0,savingsAvg:12240.0,savingsMax:12240.0,savingsMin:12240.0,loansDisbursed:0.0,loansRepaid:0.0,repayProportion:0,repaymentValue:0.0,interestEarned:240.0,loansDisbursedCount:0,loansRepaidCount:0,socialFundYes:true,socialFundValue:12980.0,failedLoan:false,loanUse:{business:0.33,schoolFees:0.33,food:0,clothing:0,shelter:0,household:0.33}},
            {name:'Mwangaza Milalani Widows group',county:'Kwale',village:'Milalani',cycle:'Cycle_1',quarter:'Q2',cbt:'Tot Amani Muuo kyuma, cbt Hadija Abdi Cjembea',femaleReg:23,maleReg:0,totalReg:23,femaleLeft:0,maleLeft:0,totalLeft:0,meetFreq:'Always',attendHigh:1,attendMod:0,attendLow:0,activeSavingF:12,activeSavingM:0,activeSavingT:12,savingsSum:41300.0,savingsAvg:41300.0,savingsMax:41300.0,savingsMin:41300.0,loansDisbursed:24000.0,loansRepaid:17800.0,repayProportion:0.74,repaymentValue:17800.0,interestEarned:2400.0,loansDisbursedCount:7,loansRepaidCount:2,socialFundYes:true,socialFundValue:2300.0,failedLoan:false,loanUse:{business:0.33,schoolFees:0.33,food:0,clothing:0,shelter:0,household:0.33}},
            {name:'Mwangaza Milalani Widows group',county:'Kwale',village:'Milalani',cycle:'Cycle_1',quarter:'Q3',cbt:'Hadija Abdu Cjembea',femaleReg:23,maleReg:0,totalReg:23,femaleLeft:1,maleLeft:0,totalLeft:1,meetFreq:'Always',attendHigh:0,attendMod:1,attendLow:0,activeSavingF:17,activeSavingM:0,activeSavingT:17,savingsSum:47950.0,savingsAvg:47950.0,savingsMax:47950.0,savingsMin:47950.0,loansDisbursed:122000.0,loansRepaid:28000.0,repayProportion:0.23,repaymentValue:28000.0,interestEarned:2900.0,loansDisbursedCount:17,loansRepaidCount:6,socialFundYes:true,socialFundValue:600.0,failedLoan:false,loanUse:{business:0.33,schoolFees:0.33,food:0,clothing:0,shelter:0,household:0.33}},
            {name:'Mwazaro VSLA 1',county:'Kwale',village:'Mwazaro',cycle:'Cycle_2',quarter:'Q2',cbt:'Rehema zuberi',femaleReg:17,maleReg:15,totalReg:32,femaleLeft:0,maleLeft:0,totalLeft:0,meetFreq:'Always',attendHigh:0,attendMod:0,attendLow:1,activeSavingF:11,activeSavingM:9,activeSavingT:20,savingsSum:334345.0,savingsAvg:334345.0,savingsMax:334345.0,savingsMin:334345.0,loansDisbursed:257300.0,loansRepaid:77045.0,repayProportion:0.3,repaymentValue:77045.0,interestEarned:20650.0,loansDisbursedCount:45,loansRepaidCount:28,socialFundYes:true,socialFundValue:35265.0,failedLoan:true,loanUse:{business:0,schoolFees:0.5,food:0,clothing:0,shelter:0,household:0.5}},
            {name:'Mwazaro VSLA 2',county:'Kwale',village:'Mwazaro',cycle:'Cycle_2',quarter:'Q2',cbt:'Mwanasha mwakuro Alawi',femaleReg:17,maleReg:2,totalReg:19,femaleLeft:0,maleLeft:0,totalLeft:0,meetFreq:'Always',attendHigh:0,attendMod:1,attendLow:0,activeSavingF:17,activeSavingM:2,activeSavingT:19,savingsSum:253660.0,savingsAvg:253660.0,savingsMax:253660.0,savingsMin:253660.0,loansDisbursed:200000.0,loansRepaid:185150.0,repayProportion:0.93,repaymentValue:185150.0,interestEarned:15570.0,loansDisbursedCount:18,loansRepaidCount:14,socialFundYes:true,socialFundValue:52000.0,failedLoan:true,loanUse:{business:0.17,schoolFees:0.17,food:0.17,clothing:0.17,shelter:0.17,household:0.17}},
            {name:'Mzalendo cbo lungalunga',county:'Kwale',village:'Mwalago',cycle:'Cycle_1',quarter:'Q3',cbt:'Asha Hassan Abdallah',femaleReg:31,maleReg:10,totalReg:41,femaleLeft:21,maleLeft:0,totalLeft:21,meetFreq:'Always',attendHigh:1,attendMod:0,attendLow:0,activeSavingF:23,activeSavingM:8,activeSavingT:31,savingsSum:77600.0,savingsAvg:77600.0,savingsMax:77600.0,savingsMin:77600.0,loansDisbursed:72310.0,loansRepaid:41100.0,repayProportion:0.57,repaymentValue:41100.0,interestEarned:4200.0,loansDisbursedCount:31,loansRepaidCount:15,socialFundYes:true,socialFundValue:33400.0,failedLoan:false,loanUse:{business:0.17,schoolFees:0.17,food:0.17,clothing:0.17,shelter:0.17,household:0.17}},
            {name:'Mzalendo LungaLunga cbo VSLA',county:'Kwale',village:'Mwalago',cycle:'Cycle_1',quarter:'Q2',cbt:'Asha Hassan Abdallah',femaleReg:21,maleReg:10,totalReg:31,femaleLeft:1,maleLeft:0,totalLeft:1,meetFreq:'Always',attendHigh:1,attendMod:0,attendLow:0,activeSavingF:14,activeSavingM:7,activeSavingT:21,savingsSum:58000.0,savingsAvg:58000.0,savingsMax:58000.0,savingsMin:58000.0,loansDisbursed:38200.0,loansRepaid:21300.0,repayProportion:0.56,repaymentValue:21300.0,interestEarned:1700.0,loansDisbursedCount:15,loansRepaidCount:10,socialFundYes:true,socialFundValue:28500.0,failedLoan:true,loanUse:{business:0.17,schoolFees:0.17,food:0.17,clothing:0.17,shelter:0.17,household:0.17}},
            {name:'Mzalendo LungaLunga cbo VSLA',county:'Kwale',village:'Mwalago',cycle:'Cycle_1',quarter:'Q2',cbt:'Asha Hassan Abdallah',femaleReg:21,maleReg:10,totalReg:31,femaleLeft:1,maleLeft:0,totalLeft:1,meetFreq:'Always',attendHigh:1,attendMod:0,attendLow:0,activeSavingF:21,activeSavingM:10,activeSavingT:31,savingsSum:58000.0,savingsAvg:58000.0,savingsMax:58000.0,savingsMin:58000.0,loansDisbursed:38200.0,loansRepaid:21300.0,repayProportion:0.56,repaymentValue:21300.0,interestEarned:1700.0,loansDisbursedCount:15,loansRepaidCount:10,socialFundYes:true,socialFundValue:28500.0,failedLoan:false,loanUse:{business:0.17,schoolFees:0.17,food:0.17,clothing:0.17,shelter:0.17,household:0.17}},
            {name:'Nikumbuke VSLA A',county:'Kwale',village:'Tiwi juakali',cycle:'Cycle_2',quarter:'Q3',cbt:'Christine Nzilani',femaleReg:21,maleReg:0,totalReg:21,femaleLeft:0,maleLeft:0,totalLeft:0,meetFreq:'Always',attendHigh:0,attendMod:1,attendLow:0,activeSavingF:21,activeSavingM:0,activeSavingT:21,savingsSum:264370.0,savingsAvg:264370.0,savingsMax:264370.0,savingsMin:264370.0,loansDisbursed:249130.0,loansRepaid:123650.0,repayProportion:0.5,repaymentValue:123650.0,interestEarned:53580.0,loansDisbursedCount:21,loansRepaidCount:10,socialFundYes:true,socialFundValue:42350.0,failedLoan:false,loanUse:{business:0.17,schoolFees:0.17,food:0.17,clothing:0.17,shelter:0.17,household:0.17}},
            {name:'Nikumbuke vsla A',county:'Kwale',village:'Tiwi juakali',cycle:'Cycle_2',quarter:'Q2',cbt:'Christine Nzilani',femaleReg:21,maleReg:0,totalReg:21,femaleLeft:0,maleLeft:0,totalLeft:0,meetFreq:'Always',attendHigh:1,attendMod:0,attendLow:0,activeSavingF:21,activeSavingM:0,activeSavingT:21,savingsSum:201100.0,savingsAvg:201100.0,savingsMax:201100.0,savingsMin:201100.0,loansDisbursed:144000.0,loansRepaid:60150.0,repayProportion:0.42,repaymentValue:60150.0,interestEarned:29400.0,loansDisbursedCount:15,loansRepaidCount:10,socialFundYes:true,socialFundValue:27300.0,failedLoan:false,loanUse:{business:0.17,schoolFees:0.17,food:0.17,clothing:0.17,shelter:0.17,household:0.17}},
            {name:'Nikumbuke vsla B',county:'Kwale',village:'Tiwi juakali',cycle:'Cycle_1',quarter:'Q2',cbt:'Elizabeth kandi',femaleReg:23,maleReg:0,totalReg:23,femaleLeft:0,maleLeft:0,totalLeft:0,meetFreq:'Always',attendHigh:1,attendMod:0,attendLow:0,activeSavingF:23,activeSavingM:0,activeSavingT:23,savingsSum:81400.0,savingsAvg:81400.0,savingsMax:81400.0,savingsMin:81400.0,loansDisbursed:77500.0,loansRepaid:64000.0,repayProportion:0.83,repaymentValue:64000.0,interestEarned:10630.0,loansDisbursedCount:19,loansRepaidCount:14,socialFundYes:true,socialFundValue:9200.0,failedLoan:false,loanUse:{business:0.2,schoolFees:0.2,food:0.2,clothing:0,shelter:0.2,household:0.2}},
            {name:'Nikumbuke vsla B',county:'Kwale',village:'Tiwi juakali',cycle:'Cycle_2',quarter:'Q3',cbt:'Elizabeth kandi',femaleReg:23,maleReg:0,totalReg:23,femaleLeft:0,maleLeft:0,totalLeft:0,meetFreq:'Always',attendHigh:0,attendMod:1,attendLow:0,activeSavingF:23,activeSavingM:0,activeSavingT:23,savingsSum:123800.0,savingsAvg:123800.0,savingsMax:123800.0,savingsMin:123800.0,loansDisbursed:102000.0,loansRepaid:50500.0,repayProportion:0.5,repaymentValue:50500.0,interestEarned:14800.0,loansDisbursedCount:23,loansRepaidCount:11,socialFundYes:true,socialFundValue:14800.0,failedLoan:false,loanUse:{business:0.17,schoolFees:0.17,food:0.17,clothing:0.17,shelter:0.17,household:0.17}},
            {name:'Nuru Islamic',county:'Kwale',village:'Mtibwa',cycle:'Cycle_2',quarter:'Q2',cbt:'Mohamed nassoro',femaleReg:16,maleReg:15,totalReg:31,femaleLeft:0,maleLeft:0,totalLeft:0,meetFreq:'Always',attendHigh:1,attendMod:0,attendLow:0,activeSavingF:16,activeSavingM:15,activeSavingT:31,savingsSum:341200.0,savingsAvg:341200.0,savingsMax:341200.0,savingsMin:341200.0,loansDisbursed:0.0,loansRepaid:0.0,repayProportion:0,repaymentValue:0.0,interestEarned:0.0,loansDisbursedCount:0,loansRepaidCount:0,socialFundYes:true,socialFundValue:68200.0,failedLoan:false,loanUse:{business:0.2,schoolFees:0.2,food:0,clothing:0.2,shelter:0.2,household:0.2}},
            {name:'Nuru majani',county:'Kilifi',village:'Mavueni miwani',cycle:'Cycle_3',quarter:'Q2',cbt:'Julius chiriba',femaleReg:17,maleReg:0,totalReg:17,femaleLeft:4,maleLeft:0,totalLeft:4,meetFreq:'Always',attendHigh:1,attendMod:0,attendLow:0,activeSavingF:12,activeSavingM:0,activeSavingT:12,savingsSum:13050.0,savingsAvg:13050.0,savingsMax:13050.0,savingsMin:13050.0,loansDisbursed:7000.0,loansRepaid:0.0,repayProportion:0.0,repaymentValue:0.0,interestEarned:300.0,loansDisbursedCount:7,loansRepaidCount:0,socialFundYes:true,socialFundValue:2500.0,failedLoan:false,loanUse:{business:0.2,schoolFees:0.2,food:0.2,clothing:0.2,shelter:0,household:0.2}},
            {name:'Nuruangani',county:'Kilifi',village:'Kizingo kskinda',cycle:'Cycle_1',quarter:'Q2',cbt:'Hannington mbaga',femaleReg:20,maleReg:7,totalReg:27,femaleLeft:0,maleLeft:0,totalLeft:0,meetFreq:'Always',attendHigh:1,attendMod:0,attendLow:0,activeSavingF:20,activeSavingM:7,activeSavingT:27,savingsSum:85950.0,savingsAvg:85950.0,savingsMax:85950.0,savingsMin:85950.0,loansDisbursed:40000.0,loansRepaid:23000.0,repayProportion:0.57,repaymentValue:23000.0,interestEarned:11000.0,loansDisbursedCount:33,loansRepaidCount:12,socialFundYes:true,socialFundValue:11340.0,failedLoan:false,loanUse:{business:0.33,schoolFees:0.33,food:0.33,clothing:0,shelter:0,household:0}},
            {name:'OKOA BAHARI GRSG',county:'Kwale',village:'ALENI',cycle:'Cycle_2',quarter:'Q2',cbt:'HAMISI BAKARI MAKAME',femaleReg:21,maleReg:9,totalReg:30,femaleLeft:0,maleLeft:1,totalLeft:1,meetFreq:'Always',attendHigh:1,attendMod:0,attendLow:0,activeSavingF:20,activeSavingM:9,activeSavingT:29,savingsSum:60000.0,savingsAvg:60000.0,savingsMax:60000.0,savingsMin:60000.0,loansDisbursed:20000.0,loansRepaid:5000.0,repayProportion:0.25,repaymentValue:5000.0,interestEarned:10000.0,loansDisbursedCount:20000,loansRepaidCount:5000,socialFundYes:true,socialFundValue:15000.0,failedLoan:false,loanUse:{business:0.5,schoolFees:0.5,food:0,clothing:0,shelter:0,household:0}},
            {name:'Okoa Bakari',county:'Kwale',village:'Aleni',cycle:'Cycle_2',quarter:'Q3',cbt:'Hamisi Bakari Makame',femaleReg:21,maleReg:9,totalReg:30,femaleLeft:0,maleLeft:0,totalLeft:0,meetFreq:'Always',attendHigh:1,attendMod:0,attendLow:0,activeSavingF:21,activeSavingM:9,activeSavingT:30,savingsSum:78000.0,savingsAvg:78000.0,savingsMax:78000.0,savingsMin:78000.0,loansDisbursed:15000.0,loansRepaid:80000.0,repayProportion:5.33,repaymentValue:80000.0,interestEarned:0.0,loansDisbursedCount:25,loansRepaidCount:0,socialFundYes:true,socialFundValue:9000.0,failedLoan:false,loanUse:{business:0.5,schoolFees:0.5,food:0,clothing:0,shelter:0,household:0}},
            {name:'PATANISHO YOUTH GROUP',county:'Kilifi',village:'Vuma',cycle:'Cycle_1',quarter:'Q2',cbt:'GLADYS  MUENI',femaleReg:30,maleReg:7,totalReg:37,femaleLeft:2,maleLeft:3,totalLeft:5,meetFreq:'Always',attendHigh:0,attendMod:1,attendLow:0,activeSavingF:20,activeSavingM:5,activeSavingT:25,savingsSum:30000.0,savingsAvg:30000.0,savingsMax:30000.0,savingsMin:30000.0,loansDisbursed:30000.0,loansRepaid:15000.0,repayProportion:0.5,repaymentValue:15000.0,interestEarned:5000.0,loansDisbursedCount:34,loansRepaidCount:15,socialFundYes:true,socialFundValue:5000.0,failedLoan:false,loanUse:{business:0.25,schoolFees:0.25,food:0.25,clothing:0,shelter:0.25,household:0}},
            {name:'PATANISHO YOUTH GROUP',county:'Kilifi',village:'Vuma/Takaungu',cycle:'Cycle_3',quarter:'Q4',cbt:'Gladys   mueni',femaleReg:32,maleReg:5,totalReg:37,femaleLeft:3,maleLeft:0,totalLeft:3,meetFreq:'Always',attendHigh:0,attendMod:1,attendLow:0,activeSavingF:26,activeSavingM:4,activeSavingT:30,savingsSum:105000.0,savingsAvg:105000.0,savingsMax:105000.0,savingsMin:105000.0,loansDisbursed:80000.0,loansRepaid:65000.0,repayProportion:0.81,repaymentValue:65000.0,interestEarned:6500.0,loansDisbursedCount:15,loansRepaidCount:13,socialFundYes:true,socialFundValue:65000.0,failedLoan:false,loanUse:{business:0.25,schoolFees:0.25,food:0,clothing:0,shelter:0.25,household:0.25}},
            {name:'Rechael Furaha kazungu',county:'Kilifi',village:'Kanyumbuni',cycle:'Cycle_3',quarter:'Q3',cbt:'Upendo Women group',femaleReg:30,maleReg:0,totalReg:30,femaleLeft:3,maleLeft:0,totalLeft:3,meetFreq:'Always',attendHigh:1,attendMod:0,attendLow:0,activeSavingF:27,activeSavingM:0,activeSavingT:27,savingsSum:42000.0,savingsAvg:42000.0,savingsMax:42000.0,savingsMin:42000.0,loansDisbursed:27000.0,loansRepaid:23500.0,repayProportion:0.87,repaymentValue:23500.0,interestEarned:2350.0,loansDisbursedCount:8,loansRepaidCount:5,socialFundYes:true,socialFundValue:17000.0,failedLoan:false,loanUse:{business:0.33,schoolFees:0.33,food:0,clothing:0,shelter:0,household:0.33}},
            {name:'Shangani Amani Enterprises',county:'Kwale',village:'Nyumba Sita',cycle:'Cycle_3',quarter:'Q2',cbt:'Mwanasiti Ali Juba',femaleReg:23,maleReg:7,totalReg:30,femaleLeft:0,maleLeft:0,totalLeft:0,meetFreq:'Always',attendHigh:1,attendMod:0,attendLow:0,activeSavingF:19,activeSavingM:6,activeSavingT:25,savingsSum:3750.0,savingsAvg:3750.0,savingsMax:3750.0,savingsMin:3750.0,loansDisbursed:0.0,loansRepaid:0.0,repayProportion:0,repaymentValue:0.0,interestEarned:0.0,loansDisbursedCount:0,loansRepaidCount:0,socialFundYes:true,socialFundValue:40.0,failedLoan:false,loanUse:{business:0.25,schoolFees:0.25,food:0.25,clothing:0,shelter:0,household:0.25}},
            {name:'Shangani Amani Enterprises',county:'Kwale',village:'Nyumba Sita',cycle:'Cycle_3',quarter:'Q3',cbt:'Mwanasiti Ali Juba',femaleReg:23,maleReg:7,totalReg:30,femaleLeft:0,maleLeft:0,totalLeft:0,meetFreq:'Always',attendHigh:1,attendMod:0,attendLow:0,activeSavingF:19,activeSavingM:6,activeSavingT:25,savingsSum:30250.0,savingsAvg:30250.0,savingsMax:30250.0,savingsMin:30250.0,loansDisbursed:58000.0,loansRepaid:33100.0,repayProportion:0.57,repaymentValue:33100.0,interestEarned:5200.0,loansDisbursedCount:43,loansRepaidCount:10,socialFundYes:true,socialFundValue:80.0,failedLoan:false,loanUse:{business:0.25,schoolFees:0.25,food:0.25,clothing:0,shelter:0,household:0.25}},
            {name:'Siwema Jikaze',county:'Kwale',village:'Shirazi Pwani',cycle:'Cycle_2',quarter:'Q2',cbt:'Mwanasha Jecha Swaleh',femaleReg:30,maleReg:2,totalReg:32,femaleLeft:0,maleLeft:0,totalLeft:0,meetFreq:'Always',attendHigh:0,attendMod:1,attendLow:0,activeSavingF:30,activeSavingM:2,activeSavingT:32,savingsSum:170900.0,savingsAvg:170900.0,savingsMax:170900.0,savingsMin:170900.0,loansDisbursed:165000.0,loansRepaid:57585.0,repayProportion:0.35,repaymentValue:57585.0,interestEarned:3105.0,loansDisbursedCount:41,loansRepaidCount:12,socialFundYes:true,socialFundValue:29380.0,failedLoan:false,loanUse:{business:0.2,schoolFees:0.2,food:0.2,clothing:0.2,shelter:0,household:0.2}},
            {name:'Siwema Jikaze VSLA',county:'Kwale',village:'Shirazi',cycle:'Cycle_2',quarter:'Q3',cbt:'Mwanasha Jecha',femaleReg:30,maleReg:2,totalReg:32,femaleLeft:0,maleLeft:0,totalLeft:0,meetFreq:'Always',attendHigh:1,attendMod:0,attendLow:0,activeSavingF:30,activeSavingM:2,activeSavingT:32,savingsSum:411655.0,savingsAvg:411655.0,savingsMax:411655.0,savingsMin:411655.0,loansDisbursed:264000.0,loansRepaid:183185.0,repayProportion:0.69,repaymentValue:183185.0,interestEarned:14165.0,loansDisbursedCount:61,loansRepaidCount:30,socialFundYes:true,socialFundValue:49970.0,failedLoan:false,loanUse:{business:0.17,schoolFees:0.17,food:0.17,clothing:0.17,shelter:0.17,household:0.17}},
            {name:'Subira Vsla',county:'Kwale',village:'Kidimu',cycle:'Cycle_1',quarter:'Q3',cbt:'Saumu Hassan George',femaleReg:18,maleReg:4,totalReg:22,femaleLeft:2,maleLeft:0,totalLeft:2,meetFreq:'Always',attendHigh:0,attendMod:1,attendLow:0,activeSavingF:16,activeSavingM:3,activeSavingT:19,savingsSum:258700.0,savingsAvg:258700.0,savingsMax:258700.0,savingsMin:258700.0,loansDisbursed:348300.0,loansRepaid:265800.0,repayProportion:0.76,repaymentValue:265800.0,interestEarned:26580.0,loansDisbursedCount:42,loansRepaidCount:34,socialFundYes:true,socialFundValue:33400.0,failedLoan:true,loanUse:{business:0.17,schoolFees:0.17,food:0.17,clothing:0.17,shelter:0.17,household:0.17}},
            {name:'Subira women VSLA',county:'Kwale',village:'Kidimu',cycle:'Cycle_1',quarter:'Q2',cbt:'Saumu Hassan George',femaleReg:19,maleReg:3,totalReg:22,femaleLeft:2,maleLeft:0,totalLeft:2,meetFreq:'Always',attendHigh:1,attendMod:0,attendLow:0,activeSavingF:18,activeSavingM:3,activeSavingT:21,savingsSum:155300.0,savingsAvg:155300.0,savingsMax:155300.0,savingsMin:155300.0,loansDisbursed:91200.0,loansRepaid:44200.0,repayProportion:0.48,repaymentValue:44200.0,interestEarned:4420.0,loansDisbursedCount:29,loansRepaidCount:17,socialFundYes:true,socialFundValue:25750.0,failedLoan:true,loanUse:{business:0.33,schoolFees:0.33,food:0,clothing:0,shelter:0,household:0.33}},
            {name:'Takaungu Hongera Tree nursery',county:'Kilifi',village:'Kanyumbuni',cycle:'Cycle_2',quarter:'Q4',cbt:'Josephine salame  ziro',femaleReg:26,maleReg:10,totalReg:36,femaleLeft:4,maleLeft:5,totalLeft:9,meetFreq:'Always',attendHigh:1,attendMod:0,attendLow:0,activeSavingF:20,activeSavingM:7,activeSavingT:27,savingsSum:124660.0,savingsAvg:124660.0,savingsMax:124660.0,savingsMin:124660.0,loansDisbursed:60600.0,loansRepaid:27400.0,repayProportion:0.45,repaymentValue:27400.0,interestEarned:17000.0,loansDisbursedCount:25,loansRepaidCount:20,socialFundYes:true,socialFundValue:11750.0,failedLoan:false,loanUse:{business:0.33,schoolFees:0.33,food:0,clothing:0,shelter:0,household:0.33}},
            {name:'Takaungu Hongera Tree nursery shg',county:'Kilifi',village:'Kanyumbuni',cycle:'Cycle_1',quarter:'Q2',cbt:'Josephine   salaries  ziro',femaleReg:29,maleReg:7,totalReg:36,femaleLeft:1,maleLeft:4,totalLeft:5,meetFreq:'Always',attendHigh:0,attendMod:1,attendLow:0,activeSavingF:13,activeSavingM:3,activeSavingT:16,savingsSum:74280.0,savingsAvg:74280.0,savingsMax:74280.0,savingsMin:74280.0,loansDisbursed:80000.0,loansRepaid:9900.0,repayProportion:0.12,repaymentValue:9900.0,interestEarned:900.0,loansDisbursedCount:15,loansRepaidCount:3,socialFundYes:true,socialFundValue:10000.0,failedLoan:false,loanUse:{business:0.33,schoolFees:0.33,food:0,clothing:0,shelter:0,household:0.33}},
            {name:'Tawakal SHG',county:'Kilifi',village:'Takaungu',cycle:'Cycle_1',quarter:'Q2',cbt:'Michael chengo karisa',femaleReg:16,maleReg:5,totalReg:21,femaleLeft:2,maleLeft:1,totalLeft:3,meetFreq:'Always',attendHigh:0,attendMod:1,attendLow:0,activeSavingF:14,activeSavingM:4,activeSavingT:18,savingsSum:28650.0,savingsAvg:28650.0,savingsMax:28650.0,savingsMin:28650.0,loansDisbursed:22000.0,loansRepaid:19000.0,repayProportion:0.86,repaymentValue:19000.0,interestEarned:1900.0,loansDisbursedCount:10,loansRepaidCount:7,socialFundYes:true,socialFundValue:14550.0,failedLoan:true,loanUse:{business:0.25,schoolFees:0.25,food:0,clothing:0,shelter:0.25,household:0.25}},
            {name:'Tawakali SHG',county:'Kilifi',village:'Takaungu',cycle:'Cycle_3',quarter:'Q3',cbt:'Michael Chengo  Karisa',femaleReg:21,maleReg:7,totalReg:28,femaleLeft:2,maleLeft:2,totalLeft:4,meetFreq:'Always',attendHigh:0,attendMod:1,attendLow:0,activeSavingF:15,activeSavingM:5,activeSavingT:20,savingsSum:28500.0,savingsAvg:28500.0,savingsMax:28500.0,savingsMin:28500.0,loansDisbursed:22500.0,loansRepaid:19500.0,repayProportion:0.87,repaymentValue:19500.0,interestEarned:1950.0,loansDisbursedCount:6,loansRepaidCount:4,socialFundYes:true,socialFundValue:17.0,failedLoan:false,loanUse:{business:0,schoolFees:0.5,food:0,clothing:0,shelter:0,household:0.5}},
            {name:'Timboni Environment al',county:'Kilifi',village:'Timboni kisimani',cycle:'Cycle_2',quarter:'Q4',cbt:'Riziki  Adam  Salim',femaleReg:28,maleReg:15,totalReg:43,femaleLeft:0,maleLeft:0,totalLeft:0,meetFreq:'Always',attendHigh:0,attendMod:1,attendLow:0,activeSavingF:26,activeSavingM:14,activeSavingT:40,savingsSum:75400.0,savingsAvg:75400.0,savingsMax:75400.0,savingsMin:75400.0,loansDisbursed:16500.0,loansRepaid:17500.0,repayProportion:1.06,repaymentValue:17500.0,interestEarned:3050.0,loansDisbursedCount:15,loansRepaidCount:10,socialFundYes:true,socialFundValue:7040.0,failedLoan:false,loanUse:{business:0.25,schoolFees:0.25,food:0.25,clothing:0,shelter:0.25,household:0}},
            {name:'Timboni ENVIRONMENTAL',county:'Kilifi',village:'TIMBONI',cycle:'Cycle_1',quarter:'Q2',cbt:'RIZIKI ADAM SALIM',femaleReg:30,maleReg:15,totalReg:45,femaleLeft:2,maleLeft:6,totalLeft:8,meetFreq:'Always',attendHigh:0,attendMod:1,attendLow:0,activeSavingF:21,activeSavingM:11,activeSavingT:32,savingsSum:44000.0,savingsAvg:44000.0,savingsMax:44000.0,savingsMin:44000.0,loansDisbursed:23850.0,loansRepaid:12800.0,repayProportion:0.54,repaymentValue:12800.0,interestEarned:1100.0,loansDisbursedCount:7,loansRepaidCount:2,socialFundYes:true,socialFundValue:11925.0,failedLoan:false,loanUse:{business:0.5,schoolFees:0.5,food:0,clothing:0,shelter:0,household:0}},
            {name:'TitumeB',county:'Kilifi',village:'Kizingo maguniani',cycle:'Cycle_1',quarter:'Q2',cbt:'Peninah uchi  deche',femaleReg:15,maleReg:9,totalReg:24,femaleLeft:4,maleLeft:16,totalLeft:20,meetFreq:'Always',attendHigh:1,attendMod:0,attendLow:0,activeSavingF:10,activeSavingM:6,activeSavingT:16,savingsSum:133000.0,savingsAvg:133000.0,savingsMax:133000.0,savingsMin:133000.0,loansDisbursed:154320.0,loansRepaid:45600.0,repayProportion:0.3,repaymentValue:45600.0,interestEarned:20000.0,loansDisbursedCount:21,loansRepaidCount:133000,socialFundYes:true,socialFundValue:15000.0,failedLoan:false,loanUse:{business:0.33,schoolFees:0.33,food:0,clothing:0,shelter:0.33,household:0}},
            {name:'TitumeB A',county:'Kilifi',village:'Kizingo maguniani',cycle:'Cycle_1',quarter:'Q2',cbt:'Charles kiti tembo',femaleReg:14,maleReg:9,totalReg:23,femaleLeft:4,maleLeft:15,totalLeft:19,meetFreq:'Always',attendHigh:1,attendMod:0,attendLow:0,activeSavingF:14,activeSavingM:9,activeSavingT:23,savingsSum:130500.0,savingsAvg:130500.0,savingsMax:130500.0,savingsMin:130500.0,loansDisbursed:120000.0,loansRepaid:60000.0,repayProportion:0.5,repaymentValue:60000.0,interestEarned:19500.0,loansDisbursedCount:15,loansRepaidCount:80000,socialFundYes:true,socialFundValue:44130.0,failedLoan:false,loanUse:{business:0.33,schoolFees:0.33,food:0,clothing:0,shelter:0.33,household:0}},
            {name:'Tsetsezani',county:'Kilifi',village:'Kadengodengoni',cycle:'Cycle_1',quarter:'Q2',cbt:'Santa kaingu mwadzombo',femaleReg:25,maleReg:2,totalReg:27,femaleLeft:4,maleLeft:3,totalLeft:7,meetFreq:'Always',attendHigh:1,attendMod:0,attendLow:0,activeSavingF:23,activeSavingM:2,activeSavingT:25,savingsSum:56900.0,savingsAvg:56900.0,savingsMax:56900.0,savingsMin:56900.0,loansDisbursed:56900.0,loansRepaid:17300.0,repayProportion:0.3,repaymentValue:17300.0,interestEarned:8000.0,loansDisbursedCount:27,loansRepaidCount:14,socialFundYes:true,socialFundValue:7200.0,failedLoan:false,loanUse:{business:0.5,schoolFees:0.5,food:0,clothing:0,shelter:0,household:0}},
            {name:'Tsetsezani',county:'Kilifi',village:'Kadengodengoni',cycle:'Cycle_1',quarter:'Q3',cbt:'Santa kaingu',femaleReg:25,maleReg:2,totalReg:27,femaleLeft:0,maleLeft:0,totalLeft:0,meetFreq:'Always',attendHigh:1,attendMod:0,attendLow:0,activeSavingF:23,activeSavingM:2,activeSavingT:25,savingsSum:51700.0,savingsAvg:51700.0,savingsMax:51700.0,savingsMin:51700.0,loansDisbursed:65500.0,loansRepaid:35500.0,repayProportion:0.54,repaymentValue:35500.0,interestEarned:28900.0,loansDisbursedCount:43,loansRepaidCount:25,socialFundYes:true,socialFundValue:16300.0,failedLoan:false,loanUse:{business:0.33,schoolFees:0.33,food:0,clothing:0,shelter:0.33,household:0}},
            {name:'Tuhenzane shg',county:'Kilifi',village:'Mkwajuni',cycle:'Cycle_1',quarter:'Q2',cbt:'ELIZABETH CHANGA  KIRAO',femaleReg:24,maleReg:0,totalReg:24,femaleLeft:13,maleLeft:2,totalLeft:15,meetFreq:'Always',attendHigh:0,attendMod:1,attendLow:0,activeSavingF:20,activeSavingM:0,activeSavingT:20,savingsSum:60000.0,savingsAvg:60000.0,savingsMax:60000.0,savingsMin:60000.0,loansDisbursed:42500.0,loansRepaid:25000.0,repayProportion:0.59,repaymentValue:25000.0,interestEarned:4250.0,loansDisbursedCount:15,loansRepaidCount:2,socialFundYes:true,socialFundValue:5000.0,failedLoan:false,loanUse:{business:0.25,schoolFees:0.25,food:0.25,clothing:0,shelter:0,household:0.25}},
            {name:'Tuhenzane shg',county:'Kilifi',village:'Mkwajuni  /Takaungu',cycle:'Cycle_3',quarter:'Q4',cbt:'Elizabeth changa kirao',femaleReg:24,maleReg:2,totalReg:26,femaleLeft:0,maleLeft:2,totalLeft:2,meetFreq:'Always',attendHigh:0,attendMod:1,attendLow:0,activeSavingF:16,activeSavingM:1,activeSavingT:17,savingsSum:74500.0,savingsAvg:74500.0,savingsMax:74500.0,savingsMin:74500.0,loansDisbursed:56000.0,loansRepaid:24000.0,repayProportion:0.43,repaymentValue:24000.0,interestEarned:2400.0,loansDisbursedCount:17,loansRepaidCount:6,socialFundYes:true,socialFundValue:11520.0,failedLoan:false,loanUse:{business:0.25,schoolFees:0.25,food:0.25,clothing:0,shelter:0,household:0.25}},
            {name:'Tumaini kizingo',county:'Kilifi',village:'Kizingo buta',cycle:'Cycle_1',quarter:'Q2',cbt:'Lilian mwatsuma deche',femaleReg:28,maleReg:10,totalReg:38,femaleLeft:0,maleLeft:0,totalLeft:0,meetFreq:'Always',attendHigh:1,attendMod:0,attendLow:0,activeSavingF:22,activeSavingM:8,activeSavingT:30,savingsSum:77500.0,savingsAvg:77500.0,savingsMax:77500.0,savingsMin:77500.0,loansDisbursed:77500.0,loansRepaid:50150.0,repayProportion:0.65,repaymentValue:50150.0,interestEarned:12000.0,loansDisbursedCount:25,loansRepaidCount:7,socialFundYes:true,socialFundValue:16500.0,failedLoan:false,loanUse:{business:0.33,schoolFees:0.33,food:0,clothing:0.33,shelter:0,household:0}},
            {name:'Tumaini kizingo',county:'Kilifi',village:'Kizingo buta',cycle:'Cycle_1',quarter:'Q3',cbt:'Lilian mwatsuma deche',femaleReg:28,maleReg:10,totalReg:38,femaleLeft:2,maleLeft:6,totalLeft:8,meetFreq:'Always',attendHigh:1,attendMod:0,attendLow:0,activeSavingF:22,activeSavingM:8,activeSavingT:30,savingsSum:100200.0,savingsAvg:100200.0,savingsMax:100200.0,savingsMin:100200.0,loansDisbursed:128900.0,loansRepaid:74140.0,repayProportion:0.58,repaymentValue:74140.0,interestEarned:26000.0,loansDisbursedCount:37,loansRepaidCount:20,socialFundYes:true,socialFundValue:25820.0,failedLoan:false,loanUse:{business:0.5,schoolFees:0.5,food:0,clothing:0,shelter:0,household:0}},
            {name:'Tumaini Ondoni A',county:'Kilifi',village:'Ondoni',cycle:'Cycle_1',quarter:'Q2',cbt:'Caroline Kiti Kuhe',femaleReg:23,maleReg:5,totalReg:28,femaleLeft:0,maleLeft:0,totalLeft:0,meetFreq:'Always',attendHigh:0,attendMod:1,attendLow:0,activeSavingF:21,activeSavingM:5,activeSavingT:26,savingsSum:39720.0,savingsAvg:39720.0,savingsMax:39720.0,savingsMin:39720.0,loansDisbursed:70840.0,loansRepaid:21500.0,repayProportion:0.3,repaymentValue:21500.0,interestEarned:7080.0,loansDisbursedCount:40,loansRepaidCount:15,socialFundYes:true,socialFundValue:5520.0,failedLoan:false,loanUse:{business:0.25,schoolFees:0.25,food:0.25,clothing:0,shelter:0.25,household:0}},
            {name:'Tumaini Ondoni A',county:'Kilifi',village:'Bondeni',cycle:'Cycle_2',quarter:'Q2',cbt:'Caroline Kiti Kuhe',femaleReg:23,maleReg:5,totalReg:28,femaleLeft:0,maleLeft:0,totalLeft:0,meetFreq:'Always',attendHigh:1,attendMod:0,attendLow:0,activeSavingF:21,activeSavingM:5,activeSavingT:26,savingsSum:58360.0,savingsAvg:58360.0,savingsMax:58360.0,savingsMin:58360.0,loansDisbursed:50800.0,loansRepaid:24300.0,repayProportion:0.48,repaymentValue:24300.0,interestEarned:5080.0,loansDisbursedCount:16,loansRepaidCount:9,socialFundYes:true,socialFundValue:5520.0,failedLoan:false,loanUse:{business:0,schoolFees:0.33,food:0.33,clothing:0,shelter:0,household:0.33}},
            {name:'Tumaini Ondoni A',county:'Kilifi',village:'Bondeni',cycle:'Cycle_2',quarter:'Q3',cbt:'Caroline Kiti Kuhe',femaleReg:23,maleReg:5,totalReg:28,femaleLeft:0,maleLeft:0,totalLeft:0,meetFreq:'Always',attendHigh:1,attendMod:0,attendLow:0,activeSavingF:21,activeSavingM:5,activeSavingT:26,savingsSum:79160.0,savingsAvg:79160.0,savingsMax:79160.0,savingsMin:79160.0,loansDisbursed:68400.0,loansRepaid:39200.0,repayProportion:0.57,repaymentValue:39200.0,interestEarned:6840.0,loansDisbursedCount:24,loansRepaidCount:14,socialFundYes:true,socialFundValue:8020.0,failedLoan:false,loanUse:{business:0.25,schoolFees:0.25,food:0,clothing:0,shelter:0.25,household:0.25}},
            {name:'Tumaini Ondoni B',county:'Kilifi',village:'Ondoni',cycle:'Cycle_1',quarter:'Q2',cbt:'Caroline Kiti Kuhe',femaleReg:24,maleReg:0,totalReg:24,femaleLeft:0,maleLeft:0,totalLeft:0,meetFreq:'Always',attendHigh:0,attendMod:1,attendLow:0,activeSavingF:19,activeSavingM:0,activeSavingT:19,savingsSum:12480.0,savingsAvg:12480.0,savingsMax:12480.0,savingsMin:12480.0,loansDisbursed:15500.0,loansRepaid:6500.0,repayProportion:0.42,repaymentValue:6500.0,interestEarned:1550.0,loansDisbursedCount:18,loansRepaidCount:9,socialFundYes:true,socialFundValue:3280.0,failedLoan:false,loanUse:{business:0.33,schoolFees:0.33,food:0.33,clothing:0,shelter:0,household:0}},
            {name:'Tumaini Ondoni B',county:'Kilifi',village:'Bondeni',cycle:'Cycle_2',quarter:'Q2',cbt:'Caroline Kiti Kuhe',femaleReg:24,maleReg:0,totalReg:24,femaleLeft:0,maleLeft:0,totalLeft:0,meetFreq:'Always',attendHigh:1,attendMod:0,attendLow:0,activeSavingF:19,activeSavingM:0,activeSavingT:19,savingsSum:22480.0,savingsAvg:22480.0,savingsMax:22480.0,savingsMin:22480.0,loansDisbursed:20000.0,loansRepaid:10600.0,repayProportion:0.53,repaymentValue:10600.0,interestEarned:2250.0,loansDisbursedCount:12,loansRepaidCount:6,socialFundYes:true,socialFundValue:3280.0,failedLoan:false,loanUse:{business:0.25,schoolFees:0.25,food:0.25,clothing:0,shelter:0,household:0.25}},
            {name:'Tumaini Ondoni B',county:'Kilifi',village:'Bondeni',cycle:'Cycle_2',quarter:'Q3',cbt:'Grace Banda',femaleReg:24,maleReg:0,totalReg:24,femaleLeft:0,maleLeft:0,totalLeft:0,meetFreq:'Always',attendHigh:1,attendMod:0,attendLow:0,activeSavingF:19,activeSavingM:0,activeSavingT:19,savingsSum:36240.0,savingsAvg:36240.0,savingsMax:36240.0,savingsMin:36240.0,loansDisbursed:29100.0,loansRepaid:16500.0,repayProportion:0.57,repaymentValue:16500.0,interestEarned:2910.0,loansDisbursedCount:18,loansRepaidCount:9,socialFundYes:true,socialFundValue:4780.0,failedLoan:false,loanUse:{business:0.25,schoolFees:0.25,food:0,clothing:0,shelter:0.25,household:0.25}},
            {name:'Tumaini self Help Group',county:'Kilifi',village:'Vijiweni',cycle:'Cycle_1',quarter:'Q2',cbt:'Abdulrazaq Kahindi',femaleReg:16,maleReg:4,totalReg:20,femaleLeft:0,maleLeft:0,totalLeft:0,meetFreq:'Always',attendHigh:0,attendMod:1,attendLow:0,activeSavingF:16,activeSavingM:4,activeSavingT:20,savingsSum:25000.0,savingsAvg:25000.0,savingsMax:25000.0,savingsMin:25000.0,loansDisbursed:18000.0,loansRepaid:7000.0,repayProportion:0.39,repaymentValue:7000.0,interestEarned:700.0,loansDisbursedCount:8,loansRepaidCount:3,socialFundYes:true,socialFundValue:25000.0,failedLoan:false,loanUse:{business:0.33,schoolFees:0.33,food:0,clothing:0,shelter:0,household:0.33}},
            {name:'Tumaini self help group',county:'Kilifi',village:'Vijiweni/Takaungu',cycle:'Cycle_3',quarter:'Q3',cbt:'ADULRAZAK KAHINDI',femaleReg:19,maleReg:3,totalReg:22,femaleLeft:8,maleLeft:0,totalLeft:8,meetFreq:'Always',attendHigh:0,attendMod:0,attendLow:1,activeSavingF:10,activeSavingM:2,activeSavingT:12,savingsSum:20000.0,savingsAvg:20000.0,savingsMax:20000.0,savingsMin:20000.0,loansDisbursed:9000.0,loansRepaid:5000.0,repayProportion:0.56,repaymentValue:5000.0,interestEarned:500.0,loansDisbursedCount:2,loansRepaidCount:1,socialFundYes:true,socialFundValue:12000.0,failedLoan:false,loanUse:{business:0.5,schoolFees:0.5,food:0,clothing:0,shelter:0,household:0}},
            {name:'Tumbe seaweed farmers',county:'Kwale',village:'Tumbe',cycle:'Cycle_2',quarter:'Q2',cbt:'Ashura shee boi',femaleReg:32,maleReg:10,totalReg:42,femaleLeft:0,maleLeft:0,totalLeft:0,meetFreq:'Always',attendHigh:1,attendMod:0,attendLow:0,activeSavingF:32,activeSavingM:10,activeSavingT:42,savingsSum:154700.0,savingsAvg:154700.0,savingsMax:154700.0,savingsMin:154700.0,loansDisbursed:100000.0,loansRepaid:75000.0,repayProportion:0.75,repaymentValue:75000.0,interestEarned:7500.0,loansDisbursedCount:66,loansRepaidCount:42,socialFundYes:true,socialFundValue:30000.0,failedLoan:false,loanUse:{business:0.5,schoolFees:0.5,food:0,clothing:0,shelter:0,household:0}},
            {name:'Tumbe Seaweed Farmers',county:'Kwale',village:'Tumbe',cycle:'Cycle_3',quarter:'Q3',cbt:'Ashura Shee Boi',femaleReg:33,maleReg:6,totalReg:39,femaleLeft:0,maleLeft:0,totalLeft:0,meetFreq:'Always',attendHigh:1,attendMod:0,attendLow:0,activeSavingF:28,activeSavingM:5,activeSavingT:33,savingsSum:42600.0,savingsAvg:42600.0,savingsMax:42600.0,savingsMin:42600.0,loansDisbursed:4.0,loansRepaid:11500.0,repayProportion:2875.0,repaymentValue:11500.0,interestEarned:1150.0,loansDisbursedCount:13,loansRepaidCount:0,socialFundYes:true,socialFundValue:5200.0,failedLoan:false,loanUse:{business:0.33,schoolFees:0.33,food:0,clothing:0,shelter:0,household:0.33}},
            {name:'Tunajaribumema',county:'Kilifi',village:'Kizingo mugunya',cycle:'Cycle_1',quarter:'Q2',cbt:'Beatrice chizi joseph',femaleReg:30,maleReg:6,totalReg:36,femaleLeft:0,maleLeft:0,totalLeft:0,meetFreq:'Always',attendHigh:1,attendMod:0,attendLow:0,activeSavingF:30,activeSavingM:6,activeSavingT:36,savingsSum:89200.0,savingsAvg:89200.0,savingsMax:89200.0,savingsMin:89200.0,loansDisbursed:120000.0,loansRepaid:65000.0,repayProportion:0.54,repaymentValue:65000.0,interestEarned:7500.0,loansDisbursedCount:32,loansRepaidCount:5,socialFundYes:true,socialFundValue:16380.0,failedLoan:false,loanUse:{business:0.33,schoolFees:0.33,food:0,clothing:0,shelter:0.33,household:0}},
            {name:'Tunajaribumema',county:'Kilifi',village:'Kizingo mugunya',cycle:'Cycle_1',quarter:'Q3',cbt:'Beatrice chizi joseph',femaleReg:30,maleReg:6,totalReg:36,femaleLeft:0,maleLeft:0,totalLeft:0,meetFreq:'Always',attendHigh:1,attendMod:0,attendLow:0,activeSavingF:30,activeSavingM:6,activeSavingT:36,savingsSum:220000.0,savingsAvg:220000.0,savingsMax:220000.0,savingsMin:220000.0,loansDisbursed:218950.0,loansRepaid:131660.0,repayProportion:0.6,repaymentValue:131660.0,interestEarned:48200.0,loansDisbursedCount:36,loansRepaidCount:20,socialFundYes:true,socialFundValue:11200.0,failedLoan:false,loanUse:{business:0.5,schoolFees:0.5,food:0,clothing:0,shelter:0,household:0}},
            {name:'Tunusuru',county:'Kwale',village:'Munje',cycle:'Cycle_1',quarter:'Q2',cbt:'Mariam Mwalimu',femaleReg:23,maleReg:0,totalReg:23,femaleLeft:0,maleLeft:0,totalLeft:0,meetFreq:'Always',attendHigh:1,attendMod:0,attendLow:0,activeSavingF:23,activeSavingM:0,activeSavingT:23,savingsSum:148520.0,savingsAvg:148520.0,savingsMax:148520.0,savingsMin:148520.0,loansDisbursed:193000.0,loansRepaid:45400.0,repayProportion:0.24,repaymentValue:45400.0,interestEarned:1800.0,loansDisbursedCount:27,loansRepaidCount:6,socialFundYes:true,socialFundValue:8600.0,failedLoan:false,loanUse:{business:0.2,schoolFees:0.2,food:0.2,clothing:0.2,shelter:0.2,household:0}},
            {name:'Tunusuru VSLA',county:'Kwale',village:'Munje',cycle:'Cycle_1',quarter:'Q3',cbt:'Mariam Hamisi Mwalimu',femaleReg:23,maleReg:0,totalReg:23,femaleLeft:23,maleLeft:0,totalLeft:23,meetFreq:'Always',attendHigh:1,attendMod:0,attendLow:0,activeSavingF:23,activeSavingM:0,activeSavingT:23,savingsSum:265220.0,savingsAvg:265220.0,savingsMax:265220.0,savingsMin:265220.0,loansDisbursed:210500.0,loansRepaid:51400.0,repayProportion:0.24,repaymentValue:51400.0,interestEarned:3600.0,loansDisbursedCount:33,loansRepaidCount:12,socialFundYes:true,socialFundValue:14380.0,failedLoan:false,loanUse:{business:0.17,schoolFees:0.17,food:0.17,clothing:0.17,shelter:0.17,household:0.17}},
            {name:'Tupendane Kang\'amboni',county:'Kilifi',village:'Kang\'amboni North',cycle:'Cycle_1',quarter:'Q2',cbt:'Faida Patrick Katana',femaleReg:44,maleReg:0,totalReg:44,femaleLeft:5,maleLeft:0,totalLeft:5,meetFreq:'Always',attendHigh:1,attendMod:0,attendLow:0,activeSavingF:42,activeSavingM:0,activeSavingT:42,savingsSum:15950.0,savingsAvg:15950.0,savingsMax:15950.0,savingsMin:15950.0,loansDisbursed:163600.0,loansRepaid:69900.0,repayProportion:0.43,repaymentValue:69900.0,interestEarned:9440.0,loansDisbursedCount:79,loansRepaidCount:45,socialFundYes:true,socialFundValue:14380.0,failedLoan:true,loanUse:{business:0.25,schoolFees:0.25,food:0.25,clothing:0,shelter:0,household:0.25}},
            {name:'Tushirikiane conservation women Bodo',county:'Kwale',village:'Bodo',cycle:'Cycle_1',quarter:'Q2',cbt:'TOT Amina Hassan Mwafrika  CBT Matogo Mzingo',femaleReg:50,maleReg:7,totalReg:57,femaleLeft:43,maleLeft:0,totalLeft:43,meetFreq:'Always',attendHigh:1,attendMod:0,attendLow:0,activeSavingF:44,activeSavingM:6,activeSavingT:50,savingsSum:131500.0,savingsAvg:131500.0,savingsMax:131500.0,savingsMin:131500.0,loansDisbursed:136000.0,loansRepaid:99130.0,repayProportion:0.73,repaymentValue:99130.0,interestEarned:9913.0,loansDisbursedCount:32,loansRepaidCount:13,socialFundYes:true,socialFundValue:14390.0,failedLoan:false,loanUse:{business:0.25,schoolFees:0.25,food:0,clothing:0,shelter:0.25,household:0.25}},
            {name:'Tushirikiane conservation women group',county:'Kwale',village:'Bodo',cycle:'Cycle_1',quarter:'Q3',cbt:'Mwatogo Mzingo Juma',femaleReg:42,maleReg:8,totalReg:50,femaleLeft:0,maleLeft:0,totalLeft:0,meetFreq:'Always',attendHigh:1,attendMod:0,attendLow:0,activeSavingF:42,activeSavingM:8,activeSavingT:50,savingsSum:184700.0,savingsAvg:184700.0,savingsMax:184700.0,savingsMin:184700.0,loansDisbursed:182600.0,loansRepaid:161680.0,repayProportion:0.89,repaymentValue:161680.0,interestEarned:16168.0,loansDisbursedCount:46,loansRepaidCount:39,socialFundYes:true,socialFundValue:23020.0,failedLoan:false,loanUse:{business:0.25,schoolFees:0.25,food:0,clothing:0,shelter:0.25,household:0.25}},
            {name:'Tusongembele',county:'Kilifi',village:'Kizingo kaduka',cycle:'Cycle_1',quarter:'Q2',cbt:'Furaha luvuno kiti',femaleReg:3,maleReg:22,totalReg:25,femaleLeft:0,maleLeft:0,totalLeft:0,meetFreq:'Always',attendHigh:1,attendMod:0,attendLow:0,activeSavingF:3,activeSavingM:22,activeSavingT:25,savingsSum:59200.0,savingsAvg:59200.0,savingsMax:59200.0,savingsMin:59200.0,loansDisbursed:39500.0,loansRepaid:20650.0,repayProportion:0.52,repaymentValue:20650.0,interestEarned:8000.0,loansDisbursedCount:18,loansRepaidCount:12,socialFundYes:true,socialFundValue:8970.0,failedLoan:false,loanUse:{business:0.33,schoolFees:0.33,food:0.33,clothing:0,shelter:0,household:0}},
            {name:'TUUNGANE SILC WOMEN GROUP',county:'Kilifi',village:'Mwele',cycle:'Cycle_1',quarter:'Q2',cbt:'Saumu Kazungu Mwambire',femaleReg:30,maleReg:0,totalReg:30,femaleLeft:0,maleLeft:0,totalLeft:0,meetFreq:'Always',attendHigh:1,attendMod:0,attendLow:0,activeSavingF:30,activeSavingM:0,activeSavingT:30,savingsSum:170250.0,savingsAvg:170250.0,savingsMax:170250.0,savingsMin:170250.0,loansDisbursed:264600.0,loansRepaid:250000.0,repayProportion:0.94,repaymentValue:250000.0,interestEarned:20910.0,loansDisbursedCount:104,loansRepaidCount:79,socialFundYes:true,socialFundValue:33550.0,failedLoan:true,loanUse:{business:0.33,schoolFees:0.33,food:0.33,clothing:0,shelter:0,household:0}},
            {name:'Twashukuru Nyumba sita group',county:'Kwale',village:'Nyumba Sita',cycle:'Cycle_1',quarter:'Q2',cbt:'TOT Amina Hassan Mwafrika CBT Fatuma Masudi Ganzori',femaleReg:21,maleReg:4,totalReg:25,femaleLeft:0,maleLeft:0,totalLeft:0,meetFreq:'Always',attendHigh:1,attendMod:0,attendLow:0,activeSavingF:17,activeSavingM:3,activeSavingT:20,savingsSum:26030.0,savingsAvg:26030.0,savingsMax:26030.0,savingsMin:26030.0,loansDisbursed:9500.0,loansRepaid:2000.0,repayProportion:0.21,repaymentValue:2000.0,interestEarned:200.0,loansDisbursedCount:4,loansRepaidCount:0,socialFundYes:true,socialFundValue:2800.0,failedLoan:true,loanUse:{business:0.25,schoolFees:0.25,food:0.25,clothing:0,shelter:0,household:0.25}},
            {name:'Twashukuru Nyumba sita Widows group',county:'Kwale',village:'Nyumba sita village',cycle:'Cycle_2',quarter:'Q3',cbt:'Fatuma Masudi Ganzori CBT',femaleReg:20,maleReg:4,totalReg:24,femaleLeft:1,maleLeft:0,totalLeft:1,meetFreq:'Always',attendHigh:1,attendMod:0,attendLow:0,activeSavingF:20,activeSavingM:4,activeSavingT:24,savingsSum:36570.0,savingsAvg:36570.0,savingsMax:36570.0,savingsMin:36570.0,loansDisbursed:20000.0,loansRepaid:8800.0,repayProportion:0.44,repaymentValue:8800.0,interestEarned:880.0,loansDisbursedCount:8,loansRepaidCount:3,socialFundYes:true,socialFundValue:9200.0,failedLoan:false,loanUse:{business:0.25,schoolFees:0.25,food:0.25,clothing:0,shelter:0,household:0.25}},
            {name:'Ufanisi ndugu mnani women',county:'Kilifi',village:'Ndugumnani',cycle:'Cycle_1',quarter:'Q2',cbt:'Silas safari',femaleReg:28,maleReg:7,totalReg:35,femaleLeft:0,maleLeft:0,totalLeft:0,meetFreq:'Always',attendHigh:1,attendMod:0,attendLow:0,activeSavingF:27,activeSavingM:7,activeSavingT:34,savingsSum:136000.0,savingsAvg:136000.0,savingsMax:136000.0,savingsMin:136000.0,loansDisbursed:100000.0,loansRepaid:60000.0,repayProportion:0.6,repaymentValue:60000.0,interestEarned:6000.0,loansDisbursedCount:25,loansRepaidCount:15,socialFundYes:true,socialFundValue:780.0,failedLoan:false,loanUse:{business:0,schoolFees:0.25,food:0.25,clothing:0.25,shelter:0.25,household:0}},
            {name:'Ufanisi women group',county:'Kilifi',village:'Ndugumnani',cycle:'Cycle_2',quarter:'Q4',cbt:'Silas safari',femaleReg:28,maleReg:7,totalReg:35,femaleLeft:0,maleLeft:0,totalLeft:0,meetFreq:'Often',attendHigh:0,attendMod:1,attendLow:0,activeSavingF:28,activeSavingM:7,activeSavingT:35,savingsSum:218600.0,savingsAvg:218600.0,savingsMax:218600.0,savingsMin:218600.0,loansDisbursed:160550.0,loansRepaid:16680.0,repayProportion:0.1,repaymentValue:16680.0,interestEarned:58050.0,loansDisbursedCount:15,loansRepaidCount:9,socialFundYes:true,socialFundValue:5000.0,failedLoan:false,loanUse:{business:0,schoolFees:0.33,food:0.33,clothing:0.33,shelter:0,household:0}},
            {name:'Upendo  Women group',county:'Kilifi',village:'Kanyumbuni',cycle:'Cycle_1',quarter:'Q2',cbt:'Rechael  Furaha kazungu',femaleReg:30,maleReg:4,totalReg:34,femaleLeft:26,maleLeft:0,totalLeft:26,meetFreq:'Always',attendHigh:1,attendMod:0,attendLow:0,activeSavingF:23,activeSavingM:3,activeSavingT:26,savingsSum:7900.0,savingsAvg:7900.0,savingsMax:7900.0,savingsMin:7900.0,loansDisbursed:27000.0,loansRepaid:15000.0,repayProportion:0.56,repaymentValue:15000.0,interestEarned:1500.0,loansDisbursedCount:17,loansRepaidCount:8,socialFundYes:true,socialFundValue:4250.0,failedLoan:true,loanUse:{business:0.33,schoolFees:0.33,food:0,clothing:0,shelter:0,household:0.33}},
            {name:'Upendo madzo',county:'Kilifi',village:'Kizingo bekitichonga',cycle:'Cycle_1',quarter:'Q2',cbt:'Mirium Pato shume',femaleReg:21,maleReg:27,totalReg:48,femaleLeft:1,maleLeft:1,totalLeft:2,meetFreq:'Always',attendHigh:1,attendMod:0,attendLow:0,activeSavingF:17,activeSavingM:22,activeSavingT:39,savingsSum:139810.0,savingsAvg:139810.0,savingsMax:139810.0,savingsMin:139810.0,loansDisbursed:135910.0,loansRepaid:30685.0,repayProportion:0.23,repaymentValue:30685.0,interestEarned:15800.0,loansDisbursedCount:30,loansRepaidCount:28,socialFundYes:true,socialFundValue:11040.0,failedLoan:false,loanUse:{business:0.33,schoolFees:0.33,food:0.33,clothing:0,shelter:0,household:0}},
            {name:'Usalama SHG',county:'Kilifi',village:'Kanyumbuni',cycle:'Cycle_1',quarter:'Q2',cbt:'Brayan Mwatua',femaleReg:25,maleReg:13,totalReg:38,femaleLeft:2,maleLeft:4,totalLeft:6,meetFreq:'Always',attendHigh:0,attendMod:1,attendLow:0,activeSavingF:15,activeSavingM:8,activeSavingT:23,savingsSum:22000.0,savingsAvg:22000.0,savingsMax:22000.0,savingsMin:22000.0,loansDisbursed:38000.0,loansRepaid:20000.0,repayProportion:0.53,repaymentValue:20000.0,interestEarned:2000.0,loansDisbursedCount:19,loansRepaidCount:10,socialFundYes:true,socialFundValue:6000.0,failedLoan:true,loanUse:{business:0.33,schoolFees:0.33,food:0,clothing:0,shelter:0.33,household:0}},
            {name:'Usalama SHG',county:'Kilifi',village:'Langoni/Takaungu',cycle:'Cycle_3',quarter:'Q3',cbt:'Mwatua  Brayan  Karisa',femaleReg:30,maleReg:6,totalReg:36,femaleLeft:2,maleLeft:1,totalLeft:3,meetFreq:'Always',attendHigh:1,attendMod:0,attendLow:0,activeSavingF:23,activeSavingM:5,activeSavingT:28,savingsSum:40000.0,savingsAvg:40000.0,savingsMax:40000.0,savingsMin:40000.0,loansDisbursed:25000.0,loansRepaid:15000.0,repayProportion:0.6,repaymentValue:15000.0,interestEarned:1500.0,loansDisbursedCount:15,loansRepaidCount:10,socialFundYes:true,socialFundValue:15000.0,failedLoan:true,loanUse:{business:0.5,schoolFees:0.5,food:0,clothing:0,shelter:0,household:0}},
            {name:'Ushindi women group',county:'Kilifi',village:'Takaungu maweni',cycle:'Cycle_1',quarter:'Q2',cbt:'Stephane mbithe',femaleReg:40,maleReg:0,totalReg:40,femaleLeft:10,maleLeft:0,totalLeft:10,meetFreq:'Always',attendHigh:1,attendMod:0,attendLow:0,activeSavingF:39,activeSavingM:0,activeSavingT:39,savingsSum:40090.0,savingsAvg:40090.0,savingsMax:40090.0,savingsMin:40090.0,loansDisbursed:20000.0,loansRepaid:10000.0,repayProportion:0.5,repaymentValue:10000.0,interestEarned:1000.0,loansDisbursedCount:10,loansRepaidCount:5,socialFundYes:true,socialFundValue:7400.0,failedLoan:true,loanUse:{business:0.2,schoolFees:0.2,food:0.2,clothing:0.2,shelter:0,household:0.2}},
            {name:'Vinahama',county:'Kilifi',village:'Vwevwesi',cycle:'Cycle_2',quarter:'Q3',cbt:'Christine Kadzo Katana',femaleReg:23,maleReg:0,totalReg:23,femaleLeft:0,maleLeft:0,totalLeft:0,meetFreq:'Always',attendHigh:0,attendMod:1,attendLow:0,activeSavingF:23,activeSavingM:0,activeSavingT:23,savingsSum:40170.0,savingsAvg:40170.0,savingsMax:40170.0,savingsMin:40170.0,loansDisbursed:38000.0,loansRepaid:26200.0,repayProportion:0.69,repaymentValue:26200.0,interestEarned:3800.0,loansDisbursedCount:40,loansRepaidCount:26,socialFundYes:true,socialFundValue:10505.0,failedLoan:false,loanUse:{business:0.25,schoolFees:0.25,food:0,clothing:0,shelter:0.25,household:0.25}},
            {name:'Vinahama',county:'Kilifi',village:'Vwevwesi',cycle:'Cycle_1',quarter:'Q2',cbt:'Christine Kadzo Katana',femaleReg:23,maleReg:0,totalReg:23,femaleLeft:0,maleLeft:0,totalLeft:0,meetFreq:'Always',attendHigh:1,attendMod:0,attendLow:0,activeSavingF:23,activeSavingM:0,activeSavingT:23,savingsSum:29250.0,savingsAvg:29250.0,savingsMax:29250.0,savingsMin:29250.0,loansDisbursed:117000.0,loansRepaid:65750.0,repayProportion:0.56,repaymentValue:65750.0,interestEarned:11700.0,loansDisbursedCount:32,loansRepaidCount:20,socialFundYes:true,socialFundValue:7885.0,failedLoan:false,loanUse:{business:0,schoolFees:0.33,food:0.33,clothing:0,shelter:0,household:0.33}},
            {name:'Vinahama',county:'Kilifi',village:'Vwevwesi',cycle:'Cycle_2',quarter:'Q3',cbt:'Christine Kadzo Katana',femaleReg:23,maleReg:0,totalReg:23,femaleLeft:0,maleLeft:0,totalLeft:0,meetFreq:'Always',attendHigh:0,attendMod:1,attendLow:0,activeSavingF:23,activeSavingM:0,activeSavingT:23,savingsSum:40170.0,savingsAvg:40170.0,savingsMax:40170.0,savingsMin:40170.0,loansDisbursed:38000.0,loansRepaid:26200.0,repayProportion:0.69,repaymentValue:26200.0,interestEarned:3800.0,loansDisbursedCount:40,loansRepaidCount:26,socialFundYes:true,socialFundValue:10505.0,failedLoan:false,loanUse:{business:0.25,schoolFees:0.25,food:0,clothing:0,shelter:0.25,household:0.25}},
            {name:'Vinahama VSLA',county:'Kilifi',village:'Vwevwesi',cycle:'Cycle_2',quarter:'Q2',cbt:'Christine Kadzo Katana',femaleReg:23,maleReg:0,totalReg:23,femaleLeft:0,maleLeft:0,totalLeft:0,meetFreq:'Always',attendHigh:1,attendMod:0,attendLow:0,activeSavingF:23,activeSavingM:0,activeSavingT:23,savingsSum:29270.0,savingsAvg:29270.0,savingsMax:29270.0,savingsMin:29270.0,loansDisbursed:27000.0,loansRepaid:16750.0,repayProportion:0.62,repaymentValue:16750.0,interestEarned:2700.0,loansDisbursedCount:32,loansRepaidCount:20,socialFundYes:true,socialFundValue:7885.0,failedLoan:false,loanUse:{business:0.25,schoolFees:0.25,food:0.25,clothing:0,shelter:0,household:0.25}},
            {name:'Vision',county:'Kwale',village:'Tiwi juakali',cycle:'Cycle_1',quarter:'Q3',cbt:'Ruth karanja',femaleReg:16,maleReg:8,totalReg:24,femaleLeft:0,maleLeft:0,totalLeft:0,meetFreq:'Always',attendHigh:1,attendMod:0,attendLow:0,activeSavingF:16,activeSavingM:8,activeSavingT:24,savingsSum:252100.0,savingsAvg:252100.0,savingsMax:252100.0,savingsMin:252100.0,loansDisbursed:199925.0,loansRepaid:139050.0,repayProportion:0.7,repaymentValue:139050.0,interestEarned:27140.0,loansDisbursedCount:22,loansRepaidCount:4,socialFundYes:true,socialFundValue:47560.0,failedLoan:false,loanUse:{business:0.2,schoolFees:0.2,food:0.2,clothing:0,shelter:0.2,household:0.2}},
            {name:'Vision VSLA',county:'Kwale',village:'Tiwi juakali',cycle:'Cycle_2',quarter:'Q2',cbt:'Ruth Karanja',femaleReg:16,maleReg:8,totalReg:24,femaleLeft:0,maleLeft:1,totalLeft:1,meetFreq:'Always',attendHigh:1,attendMod:0,attendLow:0,activeSavingF:15,activeSavingM:8,activeSavingT:23,savingsSum:196300.0,savingsAvg:196300.0,savingsMax:196300.0,savingsMin:196300.0,loansDisbursed:144400.0,loansRepaid:81000.0,repayProportion:0.56,repaymentValue:81000.0,interestEarned:27140.0,loansDisbursedCount:22,loansRepaidCount:17,socialFundYes:true,socialFundValue:34260.0,failedLoan:false,loanUse:{business:0.2,schoolFees:0.2,food:0.2,clothing:0,shelter:0.2,household:0.2}},
            {name:'VUMANI YOUTH GROUP',county:'Kilifi',village:'Vuma',cycle:'Cycle_1',quarter:'Q2',cbt:'Betty Charo masika',femaleReg:47,maleReg:13,totalReg:60,femaleLeft:6,maleLeft:3,totalLeft:9,meetFreq:'Always',attendHigh:1,attendMod:0,attendLow:0,activeSavingF:31,activeSavingM:9,activeSavingT:40,savingsSum:65000.0,savingsAvg:65000.0,savingsMax:65000.0,savingsMin:65000.0,loansDisbursed:93450.0,loansRepaid:28500.0,repayProportion:0.3,repaymentValue:28500.0,interestEarned:2850.0,loansDisbursedCount:35,loansRepaidCount:8,socialFundYes:true,socialFundValue:15900.0,failedLoan:false,loanUse:{business:0.33,schoolFees:0.33,food:0.33,clothing:0,shelter:0,household:0}},
            {name:'VUMANI YOUTH GROUP',county:'Kilifi',village:'Vuma/Takaungu',cycle:'Cycle_2',quarter:'Q4',cbt:'Bettymasika/Hammerton mwagona',femaleReg:42,maleReg:11,totalReg:53,femaleLeft:15,maleLeft:7,totalLeft:22,meetFreq:'Always',attendHigh:0,attendMod:1,attendLow:0,activeSavingF:24,activeSavingM:6,activeSavingT:30,savingsSum:158580.0,savingsAvg:158580.0,savingsMax:158580.0,savingsMin:158580.0,loansDisbursed:80765.0,loansRepaid:49235.0,repayProportion:0.61,repaymentValue:49235.0,interestEarned:13000.0,loansDisbursedCount:35,loansRepaidCount:10,socialFundYes:true,socialFundValue:38210.0,failedLoan:false,loanUse:{business:0.33,schoolFees:0.33,food:0,clothing:0,shelter:0,household:0.33}},
            {name:'WAGA COMMUNITY YOUTH GROUP',county:'Kwale',village:'Anzuani',cycle:'Cycle_1',quarter:'Q2',cbt:'MWASHASHA KASSIM',femaleReg:17,maleReg:15,totalReg:32,femaleLeft:1,maleLeft:0,totalLeft:1,meetFreq:'Always',attendHigh:0,attendMod:1,attendLow:0,activeSavingF:17,activeSavingM:15,activeSavingT:32,savingsSum:128500.0,savingsAvg:128500.0,savingsMax:128500.0,savingsMin:128500.0,loansDisbursed:49000.0,loansRepaid:22200.0,repayProportion:0.45,repaymentValue:22200.0,interestEarned:4900.0,loansDisbursedCount:8,loansRepaidCount:6,socialFundYes:true,socialFundValue:6260.0,failedLoan:false,loanUse:{business:0.2,schoolFees:0.2,food:0.2,clothing:0.2,shelter:0.2,household:0}},
            {name:'WAKIFUNDI YOUTH',county:'Kwale',village:'ANZUANI',cycle:'Cycle_1',quarter:'Q3',cbt:'UMMI HASSAN',femaleReg:19,maleReg:11,totalReg:30,femaleLeft:0,maleLeft:0,totalLeft:0,meetFreq:'Always',attendHigh:0,attendMod:1,attendLow:0,activeSavingF:16,activeSavingM:9,activeSavingT:25,savingsSum:67500.0,savingsAvg:67500.0,savingsMax:67500.0,savingsMin:67500.0,loansDisbursed:20600.0,loansRepaid:17500.0,repayProportion:0.85,repaymentValue:17500.0,interestEarned:5400.0,loansDisbursedCount:15,loansRepaidCount:9,socialFundYes:true,socialFundValue:5050.0,failedLoan:false,loanUse:{business:0.17,schoolFees:0.17,food:0.17,clothing:0.17,shelter:0.17,household:0.17}},
            {name:'Wakifundi youth group',county:'Kwale',village:'Anzuani',cycle:'Cycle_1',quarter:'Q2',cbt:'Ummi Hassan kitauro',femaleReg:19,maleReg:11,totalReg:30,femaleLeft:0,maleLeft:0,totalLeft:0,meetFreq:'Always',attendHigh:0,attendMod:1,attendLow:0,activeSavingF:19,activeSavingM:11,activeSavingT:30,savingsSum:51450.0,savingsAvg:51450.0,savingsMax:51450.0,savingsMin:51450.0,loansDisbursed:0.0,loansRepaid:5700.0,repayProportion:0,repaymentValue:5700.0,interestEarned:2400.0,loansDisbursedCount:0,loansRepaidCount:12000,socialFundYes:true,socialFundValue:5080.0,failedLoan:false,loanUse:{business:0.33,schoolFees:0.33,food:0.33,clothing:0,shelter:0,household:0}},
            {name:'WAKIFUNDI YOUTH GROUP',county:'Kwale',village:'Anzuani',cycle:'Cycle_1',quarter:'Q2',cbt:'Ummi Hassan kitauro',femaleReg:19,maleReg:11,totalReg:30,femaleLeft:0,maleLeft:0,totalLeft:0,meetFreq:'Always',attendHigh:0,attendMod:1,attendLow:0,activeSavingF:19,activeSavingM:11,activeSavingT:30,savingsSum:51450.0,savingsAvg:51450.0,savingsMax:51450.0,savingsMin:51450.0,loansDisbursed:12000.0,loansRepaid:5700.0,repayProportion:0.47,repaymentValue:5700.0,interestEarned:2400.0,loansDisbursedCount:15,loansRepaidCount:10,socialFundYes:true,socialFundValue:5080.0,failedLoan:false,loanUse:{business:0.2,schoolFees:0.2,food:0.2,clothing:0.2,shelter:0.2,household:0}},
            {name:'Wapendanao VSLA A',county:'Kwale',village:'Ngweneni',cycle:'Cycle_1',quarter:'Q2',cbt:'Salama Kama',femaleReg:32,maleReg:0,totalReg:32,femaleLeft:1,maleLeft:0,totalLeft:1,meetFreq:'Always',attendHigh:1,attendMod:0,attendLow:0,activeSavingF:32,activeSavingM:0,activeSavingT:32,savingsSum:17550.0,savingsAvg:17550.0,savingsMax:17550.0,savingsMin:17550.0,loansDisbursed:16950.0,loansRepaid:0.0,repayProportion:0.0,repaymentValue:0.0,interestEarned:0.0,loansDisbursedCount:9,loansRepaidCount:0,socialFundYes:true,socialFundValue:2520.0,failedLoan:false,loanUse:{business:0.2,schoolFees:0.2,food:0.2,clothing:0.2,shelter:0,household:0.2}},
            {name:'Wapendanao VSLA B',county:'Kwale',village:'Ngweneni',cycle:'Cycle_1',quarter:'Q2',cbt:'Mwanahuru omari',femaleReg:32,maleReg:0,totalReg:32,femaleLeft:1,maleLeft:0,totalLeft:1,meetFreq:'Always',attendHigh:1,attendMod:0,attendLow:0,activeSavingF:32,activeSavingM:0,activeSavingT:32,savingsSum:19350.0,savingsAvg:19350.0,savingsMax:19350.0,savingsMin:19350.0,loansDisbursed:13650.0,loansRepaid:0.0,repayProportion:0.0,repaymentValue:0.0,interestEarned:0.0,loansDisbursedCount:10,loansRepaidCount:0,socialFundYes:true,socialFundValue:2440.0,failedLoan:false,loanUse:{business:0.25,schoolFees:0.25,food:0.25,clothing:0.25,shelter:0,household:0}},
            {name:'Wapendanao women group A',county:'Kwale',village:'Ngweneni',cycle:'Cycle_1',quarter:'Q3',cbt:'Salama kama',femaleReg:33,maleReg:0,totalReg:33,femaleLeft:0,maleLeft:0,totalLeft:0,meetFreq:'Always',attendHigh:1,attendMod:0,attendLow:0,activeSavingF:33,activeSavingM:0,activeSavingT:33,savingsSum:90200.0,savingsAvg:90200.0,savingsMax:90200.0,savingsMin:90200.0,loansDisbursed:110450.0,loansRepaid:32260.0,repayProportion:0.29,repaymentValue:32260.0,interestEarned:2540.0,loansDisbursedCount:26,loansRepaidCount:7,socialFundYes:true,socialFundValue:13080.0,failedLoan:false,loanUse:{business:0.17,schoolFees:0.17,food:0.17,clothing:0.17,shelter:0.17,household:0.17}},
            {name:'Wapendanao women group Vsla B',county:'Kwale',village:'Ngweneni',cycle:'Cycle_1',quarter:'Q3',cbt:'Mwanahuru Omari',femaleReg:32,maleReg:0,totalReg:32,femaleLeft:0,maleLeft:0,totalLeft:0,meetFreq:'Always',attendHigh:1,attendMod:0,attendLow:0,activeSavingF:32,activeSavingM:0,activeSavingT:32,savingsSum:96270.0,savingsAvg:96270.0,savingsMax:96270.0,savingsMin:96270.0,loansDisbursed:121250.0,loansRepaid:31810.0,repayProportion:0.26,repaymentValue:31810.0,interestEarned:3640.0,loansDisbursedCount:36,loansRepaidCount:12,socialFundYes:true,socialFundValue:10680.0,failedLoan:false,loanUse:{business:0.17,schoolFees:0.17,food:0.17,clothing:0.17,shelter:0.17,household:0.17}},
            {name:'Wasini seaweed group A',county:'Kwale',village:'Wasini',cycle:'Cycle_1',quarter:'Q3',cbt:'Biasha abshir',femaleReg:28,maleReg:0,totalReg:28,femaleLeft:0,maleLeft:0,totalLeft:0,meetFreq:'Always',attendHigh:0,attendMod:1,attendLow:0,activeSavingF:16,activeSavingM:0,activeSavingT:16,savingsSum:30410.0,savingsAvg:30410.0,savingsMax:30410.0,savingsMin:30410.0,loansDisbursed:15000.0,loansRepaid:5000.0,repayProportion:0.33,repaymentValue:5000.0,interestEarned:0.0,loansDisbursedCount:3,loansRepaidCount:1,socialFundYes:true,socialFundValue:1640.0,failedLoan:false,loanUse:{business:0.17,schoolFees:0.17,food:0.17,clothing:0.17,shelter:0.17,household:0.17}},
            {name:'WASINI SEAWEED GROUP B',county:'Kwale',village:'Wasini',cycle:'Cycle_1',quarter:'Q2',cbt:'Fatuma shee',femaleReg:17,maleReg:0,totalReg:17,femaleLeft:3,maleLeft:0,totalLeft:3,meetFreq:'Always',attendHigh:0,attendMod:1,attendLow:0,activeSavingF:17,activeSavingM:0,activeSavingT:17,savingsSum:31000.0,savingsAvg:31000.0,savingsMax:31000.0,savingsMin:31000.0,loansDisbursed:0.0,loansRepaid:0.0,repayProportion:0,repaymentValue:0.0,interestEarned:0.0,loansDisbursedCount:0,loansRepaidCount:0,socialFundYes:true,socialFundValue:1250.0,failedLoan:false,loanUse:{business:0,schoolFees:0,food:0,clothing:0,shelter:0,household:1.0}},
            {name:'WASINI VSLA GROUP A',county:'Kwale',village:'Wasini',cycle:'Cycle_1',quarter:'Q2',cbt:'Sofia Ibrahim',femaleReg:24,maleReg:0,totalReg:24,femaleLeft:0,maleLeft:0,totalLeft:0,meetFreq:'Always',attendHigh:0,attendMod:1,attendLow:0,activeSavingF:24,activeSavingM:0,activeSavingT:24,savingsSum:18260.0,savingsAvg:18260.0,savingsMax:18260.0,savingsMin:18260.0,loansDisbursed:0.0,loansRepaid:0.0,repayProportion:0,repaymentValue:0.0,interestEarned:0.0,loansDisbursedCount:0,loansRepaidCount:0,socialFundYes:true,socialFundValue:1200.0,failedLoan:false,loanUse:{business:0,schoolFees:0,food:0,clothing:0,shelter:0,household:1.0}},
            {name:'YUNGI BEE FARMERS GRSG',county:'Kwale',village:'Yungi',cycle:'Cycle_2',quarter:'Q2',cbt:'Chari Dzombo',femaleReg:12,maleReg:10,totalReg:22,femaleLeft:1,maleLeft:1,totalLeft:2,meetFreq:'Always',attendHigh:1,attendMod:0,attendLow:0,activeSavingF:11,activeSavingM:10,activeSavingT:21,savingsSum:92260.0,savingsAvg:92260.0,savingsMax:92260.0,savingsMin:92260.0,loansDisbursed:20000.0,loansRepaid:0.0,repayProportion:0.0,repaymentValue:0.0,interestEarned:6000.0,loansDisbursedCount:14,loansRepaidCount:0,socialFundYes:true,socialFundValue:18000.0,failedLoan:false,loanUse:{business:0.33,schoolFees:0.33,food:0,clothing:0,shelter:0,household:0.33}},
            {name:'Yungi bee keeping',county:'Kwale',village:'Yungi',cycle:'Cycle_2',quarter:'Q3',cbt:'Chari Mangale',femaleReg:12,maleReg:9,totalReg:21,femaleLeft:0,maleLeft:1,totalLeft:1,meetFreq:'Always',attendHigh:1,attendMod:0,attendLow:0,activeSavingF:9,activeSavingM:7,activeSavingT:16,savingsSum:160985.0,savingsAvg:160985.0,savingsMax:160985.0,savingsMin:160985.0,loansDisbursed:17410.0,loansRepaid:0.0,repayProportion:0.0,repaymentValue:0.0,interestEarned:4800.0,loansDisbursedCount:12,loansRepaidCount:0,socialFundYes:true,socialFundValue:22050.0,failedLoan:false,loanUse:{business:0.5,schoolFees:0.5,food:0,clothing:0,shelter:0,household:0}},
            {name:'YUNGI MWENJENI VSLA',county:'Kwale',village:'MWENJENI',cycle:'Cycle_2',quarter:'Q2',cbt:'MWANAMKUU HASSAN  OMAR',femaleReg:28,maleReg:12,totalReg:40,femaleLeft:0,maleLeft:0,totalLeft:0,meetFreq:'Always',attendHigh:1,attendMod:0,attendLow:0,activeSavingF:28,activeSavingM:12,activeSavingT:40,savingsSum:92650.0,savingsAvg:92650.0,savingsMax:92650.0,savingsMin:92650.0,loansDisbursed:72000.0,loansRepaid:50000.0,repayProportion:0.69,repaymentValue:50000.0,interestEarned:5000.0,loansDisbursedCount:20,loansRepaidCount:50000,socialFundYes:true,socialFundValue:27000.0,failedLoan:false,loanUse:{business:0.33,schoolFees:0.33,food:0,clothing:0,shelter:0.33,household:0}},
            {name:'Yungi mwwnjeni',county:'Kwale',village:'Mwwnjeni',cycle:'Cycle_2',quarter:'Q3',cbt:'Mwanamkuu Hassan $ Alawe mwachombo',femaleReg:31,maleReg:13,totalReg:44,femaleLeft:0,maleLeft:0,totalLeft:0,meetFreq:'Always',attendHigh:1,attendMod:0,attendLow:0,activeSavingF:25,activeSavingM:11,activeSavingT:36,savingsSum:210850.0,savingsAvg:210850.0,savingsMax:210850.0,savingsMin:210850.0,loansDisbursed:142630.0,loansRepaid:169650.0,repayProportion:1.19,repaymentValue:169650.0,interestEarned:445030.0,loansDisbursedCount:25,loansRepaidCount:0,socialFundYes:true,socialFundValue:64200.0,failedLoan:false,loanUse:{business:0.5,schoolFees:0.5,food:0,clothing:0,shelter:0,household:0}}
        ];

        const vslaMonChartInstances = {};
        let vslaFilteredData = [...vslaData];

        function vslaChart(canvasId, config) {
            const canvas = document.getElementById(canvasId);
            if (!canvas) return null;
            const existing = Chart.getChart(canvas);
            if (existing) existing.destroy();
            const chart = new Chart(canvas, config);
            vslaMonChartInstances[canvasId] = chart;
            return chart;
        }

        // VSLA Theme Colors
        const VSLA_NAVY = '#0A2139';
        const VSLA_TEAL = '#008080';
        const VSLA_GOLD = '#C8A951';
        const VSLA_GREY = '#ECECEC';
        const VSLA_KILIFI = '#0A2139';
        const VSLA_KWALE = '#008080';

        function showVSLAPage(evt, pageId) {
            document.querySelectorAll('.vsla-page').forEach(p => { p.classList.remove('active'); p.style.display = 'none'; });
            const tabs = document.getElementById('vsla-page-tabs');
            if (tabs) tabs.querySelectorAll('.tab-button').forEach(b => { b.classList.remove('active'); b.style.background = ''; b.style.color = ''; });
            const target = document.getElementById(pageId);
            if (target) { target.classList.add('active'); target.style.display = 'block'; }
            if (evt && evt.currentTarget) { evt.currentTarget.classList.add('active'); evt.currentTarget.style.background = VSLA_NAVY; evt.currentTarget.style.color = VSLA_GOLD; }
            requestAnimationFrame(() => {
                if (target) target.querySelectorAll('canvas').forEach(c => { const ch = Chart.getChart(c); if (ch) ch.resize(); });
            });
        }

        // Populate VSLA group filter dropdown
        (function populateVSLAGroupFilter() {
            const sel = document.getElementById('vsla-filter-group');
            if (!sel) return;
            const groups = [...new Set(vslaData.map(v => v.name))].sort();
            groups.forEach(g => {
                const opt = document.createElement('option');
                opt.value = g; opt.textContent = g;
                sel.appendChild(opt);
            });
        })();

        function applyVSLAFilters() {
            const county = document.getElementById('vsla-filter-county').value;
            const cycle = document.getElementById('vsla-filter-cycle').value;
            const quarter = document.getElementById('vsla-filter-quarter').value;
            const group = document.getElementById('vsla-filter-group').value;
            vslaFilteredData = vslaData.filter(v => {
                const countyMatch = county === 'all' || v.county === county;
                const cycleMatch = cycle === 'all' || v.cycle === cycle;
                const quarterMatch = quarter === 'all' || v.quarter === quarter;
                const groupMatch = group === 'all' || v.name === group;
                return countyMatch && cycleMatch && quarterMatch && groupMatch;
            });
            const uniqueGroups = new Set(vslaFilteredData.map(v => v.name)).size;
            document.getElementById('vsla-filter-info').textContent = vslaFilteredData.length + ' assessments (' + uniqueGroups + ' groups) of ' + vslaData.length + ' total';
            renderVSLADashboard();
        }

        function resetVSLAFilters() {
            document.getElementById('vsla-filter-county').value = 'all';
            document.getElementById('vsla-filter-cycle').value = 'all';
            document.getElementById('vsla-filter-quarter').value = 'all';
            document.getElementById('vsla-filter-group').value = 'all';
            applyVSLAFilters();
        }

        // --- Aggregate by county ---
        function vslaCountyAgg(data) {
            const agg = {};
            data.forEach(v => {
                if (!agg[v.county]) agg[v.county] = {count:0,femaleReg:0,maleReg:0,totalReg:0,femaleLeft:0,maleLeft:0,totalLeft:0,activeSavingF:0,activeSavingM:0,activeSavingT:0,savings:0,loansDisbursed:0,loansRepaid:0,interest:0,socialFundCount:0,socialFundVal:0,attendH:0,attendM:0,attendL:0,always:0,often:0,sometimes:0,loanUse:{business:0,clothing:0,food:0,schoolFees:0,shelter:0,household:0},savingsArr:[]};
                const a = agg[v.county];
                a.count++; a.femaleReg += v.femaleReg; a.maleReg += v.maleReg; a.totalReg += v.totalReg;
                a.femaleLeft += v.femaleLeft; a.maleLeft += v.maleLeft; a.totalLeft += v.totalLeft;
                a.activeSavingF += v.activeSavingF; a.activeSavingM += v.activeSavingM; a.activeSavingT += v.activeSavingT;
                a.savings += v.savingsSum; a.savingsArr.push(v.savingsSum);
                a.loansDisbursed += v.loansDisbursed; a.loansRepaid += v.loansRepaid; a.interest += v.interestEarned;
                if (v.socialFundYes) { a.socialFundCount++; a.socialFundVal += v.socialFundValue; }
                a.attendH += v.attendHigh; a.attendM += v.attendMod; a.attendL += v.attendLow;
                if (v.meetFreq === 'Always') a.always++;
                else if (v.meetFreq === 'Often') a.often++;
                else a.sometimes++;
                for (const k in v.loanUse) a.loanUse[k] += v.loanUse[k];
            });
            return agg;
        }

        function renderVSLADashboard() {
            const data = vslaFilteredData;
            if (data.length === 0) return;

            const tot = data.reduce((a, v) => {
                a.count++; a.femaleReg += v.femaleReg; a.maleReg += v.maleReg; a.totalReg += v.totalReg;
                a.femaleLeft += v.femaleLeft; a.maleLeft += v.maleLeft; a.totalLeft += v.totalLeft;
                a.activeSavingF += v.activeSavingF; a.activeSavingM += v.activeSavingM; a.activeSavingT += v.activeSavingT;
                a.savings += v.savingsSum; a.savingsArr.push(v.savingsSum);
                a.loansDisbursed += v.loansDisbursed; a.loansRepaid += v.loansRepaid; a.interest += v.interestEarned;
                if (v.socialFundYes) { a.sfCount++; a.sfVal += v.socialFundValue; }
                a.always += v.meetFreq === 'Always' ? 1 : 0;
                a.often += v.meetFreq === 'Often' ? 1 : 0;
                a.sometimes += v.meetFreq === 'Sometimes' ? 1 : 0;
                return a;
            }, {count:0,femaleReg:0,maleReg:0,totalReg:0,femaleLeft:0,maleLeft:0,totalLeft:0,activeSavingF:0,activeSavingM:0,activeSavingT:0,savings:0,savingsArr:[],loansDisbursed:0,loansRepaid:0,interest:0,sfCount:0,sfVal:0,always:0,often:0,sometimes:0});

            const attrF = tot.femaleReg > 0 ? (tot.femaleLeft / tot.femaleReg * 100).toFixed(1) : '0';
            const attrM = tot.maleReg > 0 ? (tot.maleLeft / tot.maleReg * 100).toFixed(1) : '0';
            const attrAll = tot.totalReg > 0 ? (tot.totalLeft / tot.totalReg * 100).toFixed(1) : '0';
            const pctSavingF = tot.femaleReg > 0 ? (tot.activeSavingF / tot.femaleReg * 100).toFixed(1) : '0';
            const roi = tot.loansDisbursed > 0 ? (tot.interest / tot.loansDisbursed * 100).toFixed(1) : '0';
            const repayPct = tot.loansDisbursed > 0 ? (tot.loansRepaid / tot.loansDisbursed * 100).toFixed(1) : '0';
            const sfPct = tot.count > 0 ? (tot.sfCount / tot.count * 100).toFixed(1) : '0';
            const cAgg = vslaCountyAgg(data);
            const counties = Object.keys(cAgg).sort();
            const el = id => document.getElementById(id);

            // ===== PAGE 1: OVERVIEW =====
            if (el('vsla-kpi-total')) el('vsla-kpi-total').textContent = tot.count;
            if (el('vsla-kpi-female')) el('vsla-kpi-female').textContent = tot.femaleReg.toLocaleString();
            if (el('vsla-kpi-male')) el('vsla-kpi-male').textContent = tot.maleReg.toLocaleString();
            if (el('vsla-kpi-members')) el('vsla-kpi-members').textContent = tot.totalReg.toLocaleString();
            if (el('vsla-kpi-attr-f')) el('vsla-kpi-attr-f').textContent = attrF + '%';
            if (el('vsla-kpi-attr-m')) el('vsla-kpi-attr-m').textContent = attrM + '%';
            if (el('vsla-kpi-attr-all')) el('vsla-kpi-attr-all').textContent = attrAll + '%';
            if (el('vsla-kpi-1220a')) el('vsla-kpi-1220a').textContent = pctSavingF + '%';

            // VSLAs by county
            vslaChart('vsla-chart-by-county', {
                type: 'bar',
                data: { labels: counties, datasets: [{ label: 'VSLAs Assessed', data: counties.map(c => cAgg[c].count), backgroundColor: [VSLA_NAVY, VSLA_TEAL] }] },
                options: { responsive: true, maintainAspectRatio: false, plugins: { legend: { display: false }, datalabels: { display: true, anchor: 'end', align: 'top', font: { size: 14, weight: 'bold' }, color: VSLA_NAVY } }, scales: { y: { beginAtZero: true, title: { display: true, text: 'Number of VSLAs' } } } }
            });

            // Membership by sex
            vslaChart('vsla-chart-membership-sex', {
                type: 'doughnut',
                data: { labels: ['Female', 'Male'], datasets: [{ data: [tot.femaleReg, tot.maleReg], backgroundColor: [VSLA_TEAL, VSLA_GOLD], borderWidth: 2 }] },
                options: { responsive: true, maintainAspectRatio: false, plugins: { legend: { position: 'right' }, datalabels: { display: true, font: { size: 14, weight: 'bold' }, color: '#fff', formatter: (v, ctx) => { const t = ctx.dataset.data.reduce((a,b)=>a+b,0); return t>0 ? Math.round(v/t*100)+'%' : ''; } } } }
            });

            // Attrition by county & sex
            vslaChart('vsla-chart-attrition', {
                type: 'bar',
                data: {
                    labels: counties,
                    datasets: [
                        { label: 'Female Left', data: counties.map(c => cAgg[c].femaleLeft), backgroundColor: '#C62828' },
                        { label: 'Male Left', data: counties.map(c => cAgg[c].maleLeft), backgroundColor: '#EF6C00' }
                    ]
                },
                options: { responsive: true, maintainAspectRatio: false, plugins: { datalabels: { display: true, anchor: 'end', align: 'top', font: { size: 12, weight: 'bold' } } }, scales: { y: { beginAtZero: true, title: { display: true, text: 'Members Who Left' } } } }
            });

            // Summary table
            const tbody1 = document.querySelector('#vsla-summary-table tbody');
            if (tbody1) {
                const metrics = [
                    ['VSLAs Assessed', c => cAgg[c].count, tot.count],
                    ['Female Members', c => cAgg[c].femaleReg, tot.femaleReg],
                    ['Male Members', c => cAgg[c].maleReg, tot.maleReg],
                    ['Total Members', c => cAgg[c].totalReg, tot.totalReg],
                    ['Members Left', c => cAgg[c].totalLeft, tot.totalLeft],
                    ['Attrition Rate', c => cAgg[c].totalReg > 0 ? (cAgg[c].totalLeft/cAgg[c].totalReg*100).toFixed(1)+'%' : '0%', attrAll+'%'],
                    ['Actively Saving', c => cAgg[c].activeSavingT, tot.activeSavingT],
                    ['Total Savings (KES)', c => cAgg[c].savings.toLocaleString(), tot.savings.toLocaleString()],
                    ['Loans Disbursed (KES)', c => cAgg[c].loansDisbursed.toLocaleString(), tot.loansDisbursed.toLocaleString()],
                    ['Loans Repaid (KES)', c => cAgg[c].loansRepaid.toLocaleString(), tot.loansRepaid.toLocaleString()],
                    ['Interest Earned (KES)', c => cAgg[c].interest.toLocaleString(), tot.interest.toLocaleString()],
                    ['Social Fund (KES)', c => cAgg[c].socialFundVal.toLocaleString(), tot.sfVal.toLocaleString()]
                ];
                tbody1.innerHTML = metrics.map(([name, fn, total]) => {
                    const vals = counties.map(c => '<td>' + fn(c) + '</td>').join('');
                    return '<tr><td><strong>' + name + '</strong></td>' + vals + '<td><strong>' + total + '</strong></td></tr>';
                }).join('');
            }

            // ===== PAGE 2: PARTICIPATION =====
            const consistentPct = tot.count > 0 ? Math.round((tot.always + tot.often) / tot.count * 100) : 0;
            if (el('vsla-kpi-consistent')) el('vsla-kpi-consistent').textContent = consistentPct + '%';
            // Best governance county
            let bestGov = '—';
            if (counties.length > 0) {
                const govScores = counties.map(c => ({ c, score: (cAgg[c].always + cAgg[c].often) / cAgg[c].count }));
                govScores.sort((a,b) => b.score - a.score);
                bestGov = govScores[0].c;
            }
            if (el('vsla-kpi-gov-best')) el('vsla-kpi-gov-best').textContent = bestGov;

            // Meeting frequency
            vslaChart('vsla-chart-meeting-freq', {
                type: 'bar',
                data: {
                    labels: counties,
                    datasets: [
                        { label: 'Always', data: counties.map(c => cAgg[c].always), backgroundColor: '#2E7D32' },
                        { label: 'Often', data: counties.map(c => cAgg[c].often), backgroundColor: VSLA_GOLD },
                        { label: 'Sometimes', data: counties.map(c => cAgg[c].sometimes), backgroundColor: '#C62828' }
                    ]
                },
                options: { responsive: true, maintainAspectRatio: false, plugins: { datalabels: { display: true, font: { size: 12, weight: 'bold' } } }, scales: { y: { beginAtZero: true, title: { display: true, text: 'Number of VSLAs' } } } }
            });

            // Attendance levels stacked
            vslaChart('vsla-chart-attendance', {
                type: 'bar',
                data: {
                    labels: counties,
                    datasets: [
                        { label: 'High Attendance', data: counties.map(c => Math.round(cAgg[c].attendH / cAgg[c].count * 100)), backgroundColor: '#2E7D32' },
                        { label: 'Moderate', data: counties.map(c => Math.round(cAgg[c].attendM / cAgg[c].count * 100)), backgroundColor: VSLA_GOLD },
                        { label: 'Low', data: counties.map(c => Math.round(cAgg[c].attendL / cAgg[c].count * 100)), backgroundColor: '#C62828' }
                    ]
                },
                options: { responsive: true, maintainAspectRatio: false, plugins: { datalabels: { display: true, font: { size: 11, weight: 'bold' }, formatter: v => v + '%' } }, scales: { x: { stacked: true }, y: { stacked: true, beginAtZero: true, max: 100, title: { display: true, text: 'Average Attendance (%)' } } } }
            });

            // Attrition matrix table
            const matTbody = document.querySelector('#vsla-attrition-matrix tbody');
            if (matTbody) {
                matTbody.innerHTML = counties.map(c => {
                    const a = cAgg[c];
                    return '<tr><td><strong>'+c+'</strong></td><td>'+a.femaleLeft+'</td><td>'+a.maleLeft+'</td><td>'+a.totalLeft+'</td><td>'+(a.femaleReg>0?(a.femaleLeft/a.femaleReg*100).toFixed(1):'0')+'%</td><td>'+(a.maleReg>0?(a.maleLeft/a.maleReg*100).toFixed(1):'0')+'%</td><td>'+(a.totalReg>0?(a.totalLeft/a.totalReg*100).toFixed(1):'0')+'%</td></tr>';
                }).join('') + '<tr style="background:#f0f0f0; font-weight:bold;"><td>Total</td><td>'+tot.femaleLeft+'</td><td>'+tot.maleLeft+'</td><td>'+tot.totalLeft+'</td><td>'+attrF+'%</td><td>'+attrM+'%</td><td>'+attrAll+'%</td></tr>';
            }

            // ===== PAGE 3: SAVINGS =====
            if (el('vsla-kpi-savings-total')) el('vsla-kpi-savings-total').textContent = 'KES ' + tot.savings.toLocaleString();
            if (el('vsla-kpi-savings-avg')) el('vsla-kpi-savings-avg').textContent = 'KES ' + (tot.count > 0 ? Math.round(tot.savings / tot.count).toLocaleString() : '0');
            if (el('vsla-kpi-saving-members')) el('vsla-kpi-saving-members').textContent = tot.activeSavingT;

            // Saving members by county
            vslaChart('vsla-chart-saving-members', {
                type: 'bar',
                data: { labels: counties, datasets: [{ label: 'Actively Saving', data: counties.map(c => cAgg[c].activeSavingT), backgroundColor: [VSLA_NAVY, VSLA_TEAL] }] },
                options: { responsive: true, maintainAspectRatio: false, plugins: { legend: { display: false }, datalabels: { display: true, anchor: 'end', align: 'top', font: { size: 14, weight: 'bold' } } }, scales: { y: { beginAtZero: true, title: { display: true, text: 'Number of Members' } } } }
            });

            // Savings histogram
            const sBins = [0, 25000, 50000, 100000, 150000, 200000, 300000, 500000];
            const sHist = new Array(sBins.length).fill(0);
            data.forEach(v => { for (let i = sBins.length-1; i >= 0; i--) { if (v.savingsSum >= sBins[i]) { sHist[i]++; break; } } });
            vslaChart('vsla-chart-savings-hist', {
                type: 'bar',
                data: { labels: sBins.map((b,i) => i < sBins.length-1 ? (b/1000)+'k–'+(sBins[i+1]/1000)+'k' : (b/1000)+'k+'), datasets: [{ label: 'VSLAs', data: sHist, backgroundColor: VSLA_TEAL }] },
                options: { responsive: true, maintainAspectRatio: false, plugins: { legend: { display: false }, datalabels: { display: true, anchor: 'end', align: 'top', font: { size: 12, weight: 'bold' } } }, scales: { y: { beginAtZero: true, title: { display: true, text: 'Number of VSLAs' } }, x: { title: { display: true, text: 'Savings Range (KES)' } } } }
            });

            // Saving proportion bands
            const savBands = {'0–20%':0, '21–40%':0, '41–60%':0, '61–80%':0, '81–100%':0};
            data.forEach(v => {
                const p = v.totalReg > 0 ? v.activeSavingT / v.totalReg * 100 : 0;
                if (p <= 20) savBands['0–20%']++;
                else if (p <= 40) savBands['21–40%']++;
                else if (p <= 60) savBands['41–60%']++;
                else if (p <= 80) savBands['61–80%']++;
                else savBands['81–100%']++;
            });
            vslaChart('vsla-chart-saving-pct-bands', {
                type: 'pie',
                data: { labels: Object.keys(savBands), datasets: [{ data: Object.values(savBands), backgroundColor: ['#C62828','#EF6C00',VSLA_GOLD,VSLA_TEAL,'#2E7D32'], borderWidth: 2 }] },
                options: { responsive: true, maintainAspectRatio: false, plugins: { legend: { position: 'right' }, datalabels: { display: true, font: { size: 13, weight: 'bold' }, color: '#fff', formatter: (v, ctx) => { const t = ctx.dataset.data.reduce((a,b)=>a+b,0); return t>0 ? Math.round(v/t*100)+'%' : ''; } } } }
            });

            // Savings table
            const savTbody = document.querySelector('#vsla-savings-table tbody');
            if (savTbody) {
                savTbody.innerHTML = counties.map(c => {
                    const a = cAgg[c];
                    return '<tr><td><strong>'+c+'</strong></td><td>'+a.savings.toLocaleString()+'</td><td>'+(a.count>0?Math.round(a.savings/a.count).toLocaleString():'0')+'</td><td>'+Math.max(...a.savingsArr).toLocaleString()+'</td><td>'+Math.min(...a.savingsArr).toLocaleString()+'</td></tr>';
                }).join('') + '<tr style="background:#f0f0f0;font-weight:bold;"><td>Total</td><td>'+tot.savings.toLocaleString()+'</td><td>'+(tot.count>0?Math.round(tot.savings/tot.count).toLocaleString():'0')+'</td><td>'+Math.max(...tot.savingsArr).toLocaleString()+'</td><td>'+Math.min(...tot.savingsArr).toLocaleString()+'</td></tr>';
            }

            // ===== PAGE 4: LOANS =====
            if (el('vsla-kpi-loans-disbursed')) el('vsla-kpi-loans-disbursed').textContent = 'KES ' + tot.loansDisbursed.toLocaleString();
            if (el('vsla-kpi-loans-repaid')) el('vsla-kpi-loans-repaid').textContent = 'KES ' + tot.loansRepaid.toLocaleString();
            if (el('vsla-kpi-repay-pct')) el('vsla-kpi-repay-pct').textContent = repayPct + '%';
            if (el('vsla-kpi-interest')) el('vsla-kpi-interest').textContent = 'KES ' + tot.interest.toLocaleString();
            if (el('vsla-kpi-roi')) el('vsla-kpi-roi').textContent = roi + '%';

            // Disbursement by county
            vslaChart('vsla-chart-loans-disbursed', {
                type: 'bar',
                data: { labels: counties, datasets: [{ label: 'Loans Disbursed (KES)', data: counties.map(c => cAgg[c].loansDisbursed), backgroundColor: [VSLA_NAVY, VSLA_TEAL] }] },
                options: { responsive: true, maintainAspectRatio: false, plugins: { legend: { display: false }, datalabels: { display: true, anchor: 'end', align: 'top', font: { size: 12, weight: 'bold' }, formatter: v => (v/1000).toFixed(0)+'k' } }, scales: { y: { beginAtZero: true, title: { display: true, text: 'Amount (KES)' }, ticks: { callback: v => (v/1000)+'k' } } } }
            });

            // Repayment by county
            vslaChart('vsla-chart-loans-repaid', {
                type: 'bar',
                data: { labels: counties, datasets: [{ label: 'Loans Repaid (KES)', data: counties.map(c => cAgg[c].loansRepaid), backgroundColor: ['#2E7D32', VSLA_GOLD] }] },
                options: { responsive: true, maintainAspectRatio: false, plugins: { legend: { display: false }, datalabels: { display: true, anchor: 'end', align: 'top', font: { size: 12, weight: 'bold' }, formatter: v => (v/1000).toFixed(0)+'k' } }, scales: { y: { beginAtZero: true, title: { display: true, text: 'Amount (KES)' }, ticks: { callback: v => (v/1000)+'k' } } } }
            });

            // Repayment value ranges
            const rBins = [0,25000,50000,100000,150000,200000,300000,400000];
            const rHist = new Array(rBins.length).fill(0);
            data.forEach(v => { for (let i = rBins.length-1; i >= 0; i--) { if (v.repaymentValue >= rBins[i]) { rHist[i]++; break; } } });
            vslaChart('vsla-chart-repay-ranges', {
                type: 'bar',
                data: { labels: rBins.map((b,i) => i < rBins.length-1 ? (b/1000)+'k–'+(rBins[i+1]/1000)+'k' : (b/1000)+'k+'), datasets: [{ label: 'VSLAs', data: rHist, backgroundColor: VSLA_GOLD }] },
                options: { responsive: true, maintainAspectRatio: false, plugins: { legend: { display: false }, datalabels: { display: true, anchor: 'end', align: 'top', font: { size: 12, weight: 'bold' } } }, scales: { y: { beginAtZero: true, title: { display: true, text: 'Number of VSLAs' } }, x: { title: { display: true, text: 'Repayment Value (KES)' } } } }
            });

            // Bubble: disbursed vs repaid vs interest
            vslaChart('vsla-chart-loan-bubble', {
                type: 'bubble',
                data: {
                    datasets: data.map(v => ({
                        label: v.name,
                        data: [{ x: v.loansDisbursed / 1000, y: v.loansRepaid / 1000, r: Math.max(5, v.interestEarned / 2000) }],
                        backgroundColor: v.county === 'Kilifi' ? VSLA_NAVY + '99' : VSLA_TEAL + '99'
                    }))
                },
                options: {
                    responsive: true, maintainAspectRatio: false,
                    plugins: {
                        legend: { display: false },
                        datalabels: { display: false },
                        tooltip: { callbacks: { label: ctx => { const d = ctx.raw; return [ctx.dataset.label, 'Disbursed: '+d.x+'k', 'Repaid: '+d.y+'k', 'Interest: '+(d.r*2)+'k']; } } }
                    },
                    scales: { x: { title: { display: true, text: 'Amount Disbursed (KES \'000)' }, beginAtZero: true }, y: { title: { display: true, text: 'Amount Repaid (KES \'000)' }, beginAtZero: true } }
                }
            });

            // Loan table
            const loanTbody = document.querySelector('#vsla-loan-table tbody');
            if (loanTbody) {
                loanTbody.innerHTML = counties.map(c => {
                    const a = cAgg[c];
                    const rp = a.loansDisbursed > 0 ? (a.loansRepaid/a.loansDisbursed*100).toFixed(1) : '0';
                    const roiC = a.loansDisbursed > 0 ? (a.interest/a.loansDisbursed*100).toFixed(1) : '0';
                    return '<tr><td><strong>'+c+'</strong></td><td>'+a.loansDisbursed.toLocaleString()+'</td><td>'+a.loansRepaid.toLocaleString()+'</td><td>'+rp+'%</td><td>'+a.loansRepaid.toLocaleString()+'</td><td>'+a.interest.toLocaleString()+'</td><td>'+roiC+'%</td></tr>';
                }).join('') + '<tr style="background:#f0f0f0;font-weight:bold;"><td>Total</td><td>'+tot.loansDisbursed.toLocaleString()+'</td><td>'+tot.loansRepaid.toLocaleString()+'</td><td>'+repayPct+'%</td><td>'+tot.loansRepaid.toLocaleString()+'</td><td>'+tot.interest.toLocaleString()+'</td><td>'+roi+'%</td></tr>';
            }

            // ===== PAGE 5: SOCIAL FUND =====
            if (el('vsla-kpi-sf-pct')) el('vsla-kpi-sf-pct').textContent = sfPct + '%';
            if (el('vsla-kpi-sf-total')) el('vsla-kpi-sf-total').textContent = 'KES ' + tot.sfVal.toLocaleString();

            // Social fund ranges
            const sfBins = [0,5000,10000,20000,30000,50000,100000];
            const sfHist = new Array(sfBins.length).fill(0);
            data.filter(v => v.socialFundYes).forEach(v => { for (let i = sfBins.length-1; i >= 0; i--) { if (v.socialFundValue >= sfBins[i]) { sfHist[i]++; break; } } });
            vslaChart('vsla-chart-sf-ranges', {
                type: 'bar',
                data: { labels: sfBins.map((b,i) => i < sfBins.length-1 ? (b/1000)+'k–'+(sfBins[i+1]/1000)+'k' : (b/1000)+'k+'), datasets: [{ label: 'VSLAs', data: sfHist, backgroundColor: '#2E7D32' }] },
                options: { responsive: true, maintainAspectRatio: false, plugins: { legend: { display: false }, datalabels: { display: true, anchor: 'end', align: 'top', font: { size: 12, weight: 'bold' } } }, scales: { y: { beginAtZero: true, title: { display: true, text: 'Number of VSLAs' } }, x: { title: { display: true, text: 'Social Fund Range (KES)' } } } }
            });

            // Social fund table
            const sfTbody = document.querySelector('#vsla-sf-table tbody');
            if (sfTbody) {
                sfTbody.innerHTML = counties.map(c => {
                    const a = cAgg[c];
                    const sfArr = data.filter(v => v.county === c && v.socialFundYes).map(v => v.socialFundValue);
                    return '<tr><td><strong>'+c+'</strong></td><td>'+a.socialFundVal.toLocaleString()+'</td><td>'+(sfArr.length>0?Math.round(a.socialFundVal/sfArr.length).toLocaleString():'0')+'</td><td>'+(sfArr.length>0?Math.max(...sfArr).toLocaleString():'0')+'</td><td>'+(sfArr.length>0?Math.min(...sfArr).toLocaleString():'0')+'</td></tr>';
                }).join('');
                const allSF = data.filter(v => v.socialFundYes).map(v => v.socialFundValue);
                sfTbody.innerHTML += '<tr style="background:#f0f0f0;font-weight:bold;"><td>Total</td><td>'+tot.sfVal.toLocaleString()+'</td><td>'+(allSF.length>0?Math.round(tot.sfVal/allSF.length).toLocaleString():'0')+'</td><td>'+(allSF.length>0?Math.max(...allSF).toLocaleString():'0')+'</td><td>'+(allSF.length>0?Math.min(...allSF).toLocaleString():'0')+'</td></tr>';
            }

            // ===== PAGE 6: LOAN USE =====
            const loanCats = ['business','clothing','food','schoolFees','shelter','household'];
            const loanCatLabels = ['Business','Clothing','Food','School Fees','Shelter','Household Needs'];
            const avgUse = loanCats.map(k => data.length > 0 ? Math.round(data.reduce((s,v) => s + (v.loanUse[k] || 0), 0) / data.length * 100) : 0);
            const topUseIdx = avgUse.indexOf(Math.max(...avgUse));
            if (el('vsla-kpi-top-use')) el('vsla-kpi-top-use').textContent = loanCatLabels[topUseIdx] + ' (' + avgUse[topUseIdx] + '%)';

            // Horizontal bar
            vslaChart('vsla-chart-loan-use', {
                type: 'bar',
                indexAxis: 'y',
                data: { labels: loanCatLabels, datasets: [{ label: '% of Loans', data: avgUse, backgroundColor: [VSLA_NAVY, '#6A1B9A', '#C62828', VSLA_TEAL, VSLA_GOLD, '#EF6C00'] }] },
                options: { responsive: true, maintainAspectRatio: false, plugins: { legend: { display: false }, datalabels: { display: true, anchor: 'end', align: 'right', font: { size: 13, weight: 'bold' }, formatter: v => v + '%' } }, scales: { x: { beginAtZero: true, max: 60, title: { display: true, text: 'Average Loan Allocation (%)' } } } }
            });

            // Heatmap by county (rendered as grouped bar)
            const heatDatasets = counties.map((c, ci) => ({
                label: c,
                data: loanCats.map(k => {
                    const cData = data.filter(v => v.county === c);
                    return cData.length > 0 ? Math.round(cData.reduce((s,v) => s + (v.loanUse[k]||0), 0) / cData.length * 100) : 0;
                }),
                backgroundColor: ci === 0 ? VSLA_NAVY : VSLA_TEAL
            }));
            vslaChart('vsla-chart-loan-heatmap', {
                type: 'bar',
                data: { labels: loanCatLabels, datasets: heatDatasets },
                options: { responsive: true, maintainAspectRatio: false, plugins: { datalabels: { display: true, font: { size: 11, weight: 'bold' }, formatter: v => v + '%' } }, scales: { y: { beginAtZero: true, max: 60, title: { display: true, text: 'Average Loan Allocation (%)' } } } }
            });
        }

        // Helper to update shared sections (findings, KPIs, footnotes) without full switchSurvey
        function updateSharedSections(data, surveyKey) {
            if (!data) return;
            // Update title
            document.getElementById('survey-title').textContent = data.title;
            // Update footer
            const sampleText = {
                'prepost-forest': 'Pre-Test: 546 Participants | Post-Test: 909 Participants | Threshold: ≥70%',
                'prepost-mangrove': 'Mangrove Restoration Training | Kilifi & Kwale Counties | Data Quality: High'
            };
            const titleText = {
                'prepost-forest': 'Pre & Post Test — Forest Conservation Knowledge Assessment',
                'prepost-mangrove': 'Pre & Post Test — Mangrove Restoration Knowledge Assessment'
            };
            document.getElementById('footer-title').innerHTML = '<strong>' + (titleText[surveyKey] || '') + '</strong>';
            document.getElementById('footer-sample').textContent = sampleText[surveyKey] || '';
            // Update findings
            const findingsContainer = document.querySelector('.key-findings');
            findingsContainer.innerHTML = '';
            data.findings.forEach(finding => {
                const card = document.createElement('div');
                card.className = finding.badge === 'drop' ? 'finding-card negative' : 'finding-card';
                card.innerHTML = '<div class="finding-title">' + finding.title + '</div><div class="finding-metric">' + finding.metric + '</div><div class="finding-description">' + finding.description + '</div>';
                findingsContainer.appendChild(card);
            });
            // Update KPIs
            const kpiContainer = document.querySelector('.kpi-section');
            kpiContainer.innerHTML = '';
            data.kpis.forEach(kpi => {
                const card = document.createElement('div');
                card.className = 'kpi-card ' + kpi.trend;
                card.innerHTML = '<div class="kpi-label">' + kpi.label + '</div><div class="kpi-value">' + kpi.value + '</div><div class="kpi-change ' + kpi.trend + '">' + kpi.change + '</div>';
                kpiContainer.appendChild(card);
            });
            // Update Logframe Table and Highlight for sub-type switching
            if (data.logframe) {
                updateLogframeTable(data.logframe);
            }
            const sharedHighlightBox = document.getElementById('logframe-highlight');
            if (sharedHighlightBox && data.logframeHighlight) {
                sharedHighlightBox.innerHTML = data.logframeHighlight;
            }
        }

        // Pre & Post Test Charts Rendering
        function updatePrePostCharts() {
            const ppColors = { pre: colors.baseline, post: colors.midline };
            const ppDefaults = {
                responsive: true,
                maintainAspectRatio: false,
                plugins: {
                    legend: { position: 'top', labels: { font: { size: 12, weight: 'bold' } } },
                    datalabels: {
                        font: { size: 14, weight: 'bold' },
                        color: '#fff',
                        backgroundColor: '#333',
                        borderRadius: 6,
                        padding: 6,
                        formatter: (value) => value.toFixed(1) + '%',
                        display: true
                    }
                }
            };

            function ppChart(id, config) {
                const canvas = document.getElementById(id);
                if (!canvas) { console.warn('Canvas not found:', id); return; }
                const existing = Chart.getChart(canvas);
                if (existing) existing.destroy();
                const ctx = canvas.getContext('2d');
                return new Chart(ctx, config);
            }

            // Chart 1: Passing Thresholds
            ppChart('pp-chart-threshold', {
                type: 'bar',
                data: {
                    labels: ['≥50%', '≥60%', '≥70%', '≥80%'],
                    datasets: [
                        { label: 'Pre-Test', data: [76.4, 64.8, 50.0, 32.9], backgroundColor: ppColors.pre },
                        { label: 'Post-Test', data: [97.7, 96.6, 94.7, 85.7], backgroundColor: ppColors.post }
                    ]
                },
                options: { ...ppDefaults, scales: { y: { beginAtZero: true, max: 100, title: { display: true, text: '% of Participants Passing' } } } }
            });

            // Chart 2: Overall Scores
            ppChart('pp-chart-scores', {
                type: 'bar',
                data: {
                    labels: ['Average Score', 'Maximum Score', 'Minimum Score'],
                    datasets: [
                        { label: 'Pre-Test', data: [65.2, 100, 2.5], backgroundColor: ppColors.pre },
                        { label: 'Post-Test', data: [85.4, 100, 27.5], backgroundColor: ppColors.post }
                    ]
                },
                options: { ...ppDefaults, scales: { y: { beginAtZero: true, max: 100, title: { display: true, text: 'Score (%)' } } } }
            });

            // Chart 3: Forest Ecology & Rights
            ppChart('pp-chart-q1', {
                type: 'bar',
                data: {
                    labels: ['Forest Ecosystems', 'Biodiversity', 'Community Forestry', 'Forest Rights', 'Conservation Principles', 'Tree Species'],
                    datasets: [
                        { label: 'Pre-Test', data: [56.6, 85.7, 86.6, 67.4, 67.2, 82.6], backgroundColor: ppColors.pre },
                        { label: 'Post-Test', data: [91.5, 97.6, 97.7, 95.0, 97.8, 97.5], backgroundColor: ppColors.post }
                    ]
                },
                options: { ...ppDefaults, scales: { y: { beginAtZero: true, max: 100, title: { display: true, text: '% Correct' } } } }
            });

            // Chart 4: Management & Conservation
            ppChart('pp-chart-q2', {
                type: 'bar',
                data: {
                    labels: ['Management Plans', 'Sustainable Harvesting', 'Fire Prevention', 'Reforestation', 'Watershed Protection', 'Carbon Sequestration', 'Wildlife Corridors'],
                    datasets: [
                        { label: 'Pre-Test', data: [68.9, 69.6, 85.2, 67.0, 76.4, 90.8, 88.6], backgroundColor: ppColors.pre },
                        { label: 'Post-Test', data: [83.4, 95.7, 97.0, 92.0, 98.2, 99.2, 99.2], backgroundColor: ppColors.post }
                    ]
                },
                options: { ...ppDefaults, scales: { y: { beginAtZero: true, max: 100, title: { display: true, text: '% Correct' } } } }
            });

            // Chart 5: Policy & Sustainability
            ppChart('pp-chart-q3', {
                type: 'bar',
                data: {
                    labels: ['Forest Policy', 'Climate Adaptation', 'Community Governance', 'Benefit Sharing', 'Ecosystem Services', 'Agroforestry', 'Monitoring & Eval'],
                    datasets: [
                        { label: 'Pre-Test', data: [65.6, 74.7, 96.9, 89.6, 88.5, 77.7, 76.7], backgroundColor: ppColors.pre },
                        { label: 'Post-Test', data: [95.3, 96.6, 99.6, 98.6, 99.7, 97.9, 97.4], backgroundColor: ppColors.post }
                    ]
                },
                options: { ...ppDefaults, scales: { y: { beginAtZero: true, max: 100, title: { display: true, text: '% Correct' } } } }
            });
        }

        // Mangrove Pre & Post Test Charts Rendering
        function updateMangrovePrePostCharts() {
            const mgvColors = { pre: colors.baseline, post: colors.midline };
            const mgvDefaults = {
                responsive: true,
                maintainAspectRatio: false,
                plugins: {
                    legend: { position: 'top', labels: { font: { size: 12, weight: 'bold' } } },
                    datalabels: {
                        font: { size: 14, weight: 'bold' },
                        color: '#fff',
                        backgroundColor: '#333',
                        borderRadius: 6,
                        padding: 6,
                        formatter: (value) => value.toFixed(1) + '%',
                        display: true
                    }
                }
            };

            function mgvChart(id, config) {
                const canvas = document.getElementById(id);
                if (!canvas) { console.warn('Canvas not found:', id); return; }
                const existing = Chart.getChart(canvas);
                if (existing) existing.destroy();
                const ctx = canvas.getContext('2d');
                return new Chart(ctx, config);
            }

            // Chart 1: Adequate Knowledge by Location
            mgvChart('pp-mgv-chart-location', {
                type: 'bar',
                data: {
                    labels: ['Kilifi', 'Kwale', 'All'],
                    datasets: [
                        { label: 'Pre-Test', data: [21.1, 53.7, 36.9], backgroundColor: mgvColors.pre },
                        { label: 'Post-Test', data: [80.1, 83.1, 81.5], backgroundColor: mgvColors.post }
                    ]
                },
                options: { ...mgvDefaults, scales: { y: { beginAtZero: true, max: 100, title: { display: true, text: '% with Adequate Knowledge' } } } }
            });

            // Chart 2: Adequate Knowledge by Gender
            mgvChart('pp-mgv-chart-gender', {
                type: 'bar',
                data: {
                    labels: ['Male', 'Female', 'All'],
                    datasets: [
                        { label: 'Pre-Test', data: [38.2, 34.7, 36.9], backgroundColor: mgvColors.pre },
                        { label: 'Post-Test', data: [80.2, 87.4, 81.9], backgroundColor: mgvColors.post }
                    ]
                },
                options: { ...mgvDefaults, scales: { y: { beginAtZero: true, max: 100, title: { display: true, text: '% with Adequate Knowledge' } } } }
            });
        }

        // Tab Navigation (Updated)
        function showTab(evt, tabName) {
            const tabContents = document.querySelectorAll('.tab-content');
            tabContents.forEach(tab => tab.classList.remove('active'));
            const tabButtons = document.querySelectorAll('.tab-button');
            tabButtons.forEach(btn => btn.classList.remove('active'));
            document.getElementById(tabName).classList.add('active');
            evt.currentTarget.classList.add('active');

            // Resize charts in newly visible tab so hidden-tab charts render correctly
            requestAnimationFrame(() => {
                const activeTab = document.getElementById(tabName);
                if (activeTab) {
                    activeTab.querySelectorAll('canvas').forEach(canvas => {
                        const chart = Chart.getChart(canvas);
                        if (chart) chart.resize();
                    });
                }
            });
        }

        // Initialize Men Survey Tabs with dynamic content
        function initializeMenSurveyTabs() {
            if (!window.surveyData || !window.surveyData['men-cosme'] || !window.surveyData['men-cosme'].tabContent) {
                console.error('Men survey data not available');
                return;
            }

            const menData = window.surveyData['men-cosme'].tabContent;
            const tabsContainer = document.getElementById('men-tabs-container');
            const contentContainer = document.getElementById('men-tabs-content');
            
            if (!tabsContainer) {
                console.error('men-tabs-container not found in DOM');
                return;
            }
            if (!contentContainer) {
                console.error('men-tabs-content not found in DOM');
                return;
            }
            
            // CLEAR existing content first
            tabsContainer.innerHTML = '';
            contentContainer.innerHTML = '';
            // Chart configurations for each tab - same as women survey
            const chartConfigs = {
                'tab-household': ['chart-location', 'chart-headship', 'chart-activities', 'chart-housing', 'chart-wash'],
                'tab-shocks': ['chart-shocks', 'chart-impact', 'chart-coping'],
                'tab-preparedness': ['chart-prep-knowledge', 'chart-prep-participation', 'chart-warnings'],
                'tab-resources': ['chart-assets', 'chart-land', 'chart-cultivation', 'chart-inputs'],
                'tab-savings': ['chart-personal-savings', 'chart-mechanism', 'chart-loans', 'chart-savings-use'],
                'tab-time': ['chart-time', 'chart-beliefs', 'chart-experience', 'chart-productive'],
                'tab-decisions': ['chart-decisions', 'chart-influence', 'chart-decision-gap'],
                'tab-nbs': ['chart-cc-awareness', 'chart-cc-effects', 'chart-nbs', 'chart-nbs-benefits'],
                'tab-lifeskills': ['chart-selfesteem', 'chart-aspirations', 'chart-leadership', 'chart-communication'],
                'tab-norms': ['chart-norms', 'chart-norms-strong', 'chart-norms-conservation', 'chart-norms-money']
            };

            // Chart titles for each chart
            const chartTitles = {
                'chart-location': 'Location/Intervention Type',
                'chart-headship': 'Household Headship',
                'chart-activities': 'Primary Economic Activities',
                'chart-housing': 'Housing Quality',
                'chart-wash': 'Water & Sanitation',
                'chart-shocks': 'Shock Types',
                'chart-impact': 'Shock Impact',
                'chart-coping': 'Coping Strategies',
                'chart-prep-knowledge': 'Preparedness Knowledge',
                'chart-prep-participation': 'Preparedness Participation',
                'chart-warnings': 'Early Warning Access',
                'chart-assets': 'Asset Ownership',
                'chart-land': 'Agricultural Land',
                'chart-cultivation': 'Land Cultivation',
                'chart-inputs': 'Agricultural Inputs',
                'chart-personal-savings': 'Personal Savings',
                'chart-mechanism': 'Savings Mechanism',
                'chart-loans': 'Personal Loans',
                'chart-savings-use': 'Savings Usage',
                'chart-time': 'Time Investment',
                'chart-beliefs': 'Should be Joint',
                'chart-experience': 'Actual Experience',
                'chart-productive': 'Productive Work',
                'chart-decisions': 'Joint Decisions',
                'chart-influence': 'Decision Influence',
                'chart-decision-gap': 'Should vs Actually',
                'chart-cc-awareness': 'Climate Awareness',
                'chart-cc-effects': 'Climate Effects',
                'chart-nbs': 'NbS Participation',
                'chart-nbs-benefits': 'NbS Benefits',
                'chart-selfesteem': 'Self-Esteem',
                'chart-aspirations': 'Aspirations',
                'chart-leadership': 'Leadership',
                'chart-communication': 'Communication',
                'chart-norms': 'Gender Norms',
                'chart-norms-strong': 'Strong Norm Beliefs',
                'chart-norms-conservation': 'Conservation Norms',
                'chart-norms-money': 'Money Norms'
            };

            // Create tab buttons
            let firstTab = true;
            let buttonCount = 0;
            for (const tabId in menData) {
                if (menData.hasOwnProperty(tabId)) {
                    const tabInfo = menData[tabId];
                    const button = document.createElement('button');
                    button.className = 'tab-button' + (firstTab ? ' active' : '');
                    button.textContent = tabInfo.title.substring(0, 50) + (tabInfo.title.length > 50 ? '...' : '');
                    button.onclick = (e) => showMenTab(e, tabId);
                    tabsContainer.appendChild(button);
                    buttonCount++;
                    firstTab = false;
                }
            }
            // Create tab content
            firstTab = true;
            let contentCount = 0;
            let canvasCount = 0;
            for (const tabId in menData) {
                if (menData.hasOwnProperty(tabId)) {
                    const tabInfo = menData[tabId];
                    const tabDiv = document.createElement('div');
                    tabDiv.id = tabId + '-men';
                    tabDiv.className = 'tab-content' + (firstTab ? ' active' : '');
                    
                    // Build chart grids
                    let chartsHTML = '';
                    const chartIds = chartConfigs[tabId] || [];
                    chartIds.forEach((chartId, index) => {
                        const isFullWidth = (chartId === 'chart-activities' || chartId === 'chart-decisions' || chartId === 'chart-norms');
                        const insight = (tabInfo.chartInsights && tabInfo.chartInsights[chartId]) || `Chart for ${chartTitles[chartId] || chartId}`;
                        chartsHTML += `
                            <div class="chart-wrapper${isFullWidth ? ' full-width' : ''}">
                                <div class="chart-title">${chartTitles[chartId] || chartId}</div>
                                <div class="chart-container">
                                    <canvas id="${chartId}-men"></canvas>
                                </div>
                                <div class="chart-insight">${insight}</div>
                            </div>
                        `;
                        canvasCount++;
                    });

                    tabDiv.innerHTML = `
                        <div class="section">
                            <div class="section-title">${tabInfo.title}</div>
                            <div class="highlight-box">
                                ${tabInfo.highlight}
                            </div>
                            ${chartsHTML ? `<div class="charts-grid">${chartsHTML}</div>` : ''}
                        </div>
                    `;
                    contentContainer.appendChild(tabDiv);
                    contentCount++;
                    firstTab = false;
                }
            }
        }

        function showMenTab(evt, tabName) {
            const contentContainer = document.getElementById('men-tabs-content');
            const tabContents = contentContainer.querySelectorAll('.tab-content');
            tabContents.forEach(tab => tab.classList.remove('active'));
            const tabButtons = document.querySelectorAll('#men-tabs-container .tab-button');
            tabButtons.forEach(btn => btn.classList.remove('active'));
            document.getElementById(tabName + '-men').classList.add('active');
            evt.currentTarget.classList.add('active');
        }

        // Initialize
        // SCROLL-TO-TOP FUNCTION
        function scrollToTop() {
            window.scrollTo({top: 0, behavior: 'smooth'});
        }

        // BACK-TO-TOP BUTTON VISIBILITY
        window.addEventListener('scroll', function() {
            const backToTopBtn = document.getElementById('backToTop');
            const scrollIndicator = document.getElementById('scrollIndicator');
            
            if (window.scrollY > 500) {
                backToTopBtn.classList.add('show');
                scrollIndicator.classList.add('show');
            } else {
                backToTopBtn.classList.remove('show');
                scrollIndicator.classList.remove('show');
            }
            
            // Update section indicator
            const tabs = document.querySelectorAll('.tab-content');
            for (let tab of tabs) {
                const rect = tab.getBoundingClientRect();
                if (rect.top >= 0 && rect.top <= window.innerHeight) {
                    const tabName = tab.id ? tab.id.replace('tab-', '').replace(/-/g, ' ').toUpperCase() : 'Section';
                    scrollIndicator.textContent = 'Section: ' + tabName;
                    break;
                }
            }
        });

        document.addEventListener('DOMContentLoaded', function() {
            // Set footer timestamp
            const tsEl = document.getElementById('footer-timestamp');
            if (tsEl) {
                const now = new Date();
                const opts = { year:'numeric', month:'long', day:'numeric', hour:'2-digit', minute:'2-digit' };
                tsEl.textContent = now.toLocaleDateString('en-US', opts);
            }
            // Save original women survey content (highlights + chart insights)
            // so we can restore them when switching back from other surveys
            window.originalWomenContent = {};
            const womenSec = document.getElementById('women-survey-section');
            if (womenSec) {
                womenSec.querySelectorAll('.tab-content').forEach(tab => {
                    const tabId = tab.id;
                    if (!tabId) return;
                    const highlightBox = tab.querySelector('.highlight-box');
                    const sectionTitleEl = tab.querySelector('.section-title');
                    const insights = {};
                    const chartTitles = {};
                    tab.querySelectorAll('.chart-wrapper').forEach(wrapper => {
                        const canvas = wrapper.querySelector('canvas');
                        const insightEl = wrapper.querySelector('.chart-insight');
                        const titleEl = wrapper.querySelector('.chart-title');
                        if (canvas) {
                            if (insightEl) insights[canvas.id] = insightEl.innerHTML;
                            if (titleEl) chartTitles[canvas.id] = titleEl.textContent;
                        }
                    });
                    window.originalWomenContent[tabId] = {
                        highlight: highlightBox ? highlightBox.innerHTML : '',
                        sectionTitle: sectionTitleEl ? sectionTitleEl.textContent : '',
                        chartTitles: chartTitles,
                        insights: insights
                    };
                });
            }
            
            // Initialize men survey tabs
            initializeMenSurveyTabs();
            
            // Default to Project Outputs tab
            switchSurvey('project-outputs');
        });
    </script>

    <!-- FIREBASE REALTIME PRESENCE TRACKING -->
    <script>
    (function() {
        // Firebase config
        const firebaseConfig = {
            apiKey: "AIzaSyB0RhPFs7Hj9vAfJYCvJRSds2VwihSZdto",
            authDomain: "cosme-dashboard.firebaseapp.com",
            databaseURL: "https://cosme-dashboard-default-rtdb.firebaseio.com",
            projectId: "cosme-dashboard",
            storageBucket: "cosme-dashboard.firebasestorage.app",
            messagingSenderId: "306162598730",
            appId: "1:306162598730:web:f60247fdb5a0489ba077b3",
            measurementId: "G-BYD6S776VZ"
        };

        // Initialize Firebase
        const app = firebase.initializeApp(firebaseConfig);
        const db = firebase.database();

        // Generate a session ID & display name
        const sessionId = 'user_' + Math.random().toString(36).substr(2, 9);
        const adjectives = ['Swift', 'Bright', 'Keen', 'Bold', 'Calm', 'Warm', 'Cool', 'Wise', 'Kind', 'Fair'];
        const animals = ['Eagle', 'Lion', 'Fox', 'Owl', 'Hawk', 'Bear', 'Wolf', 'Deer', 'Hare', 'Dove'];
        const displayName = adjectives[Math.floor(Math.random() * adjectives.length)] + ' ' + animals[Math.floor(Math.random() * animals.length)];

        // Reference to presence node
        const presenceRef = db.ref('presence/' + sessionId);
        const allPresenceRef = db.ref('presence');

        // Get current active tab
        function getCurrentTab() {
            const activeBtn = document.querySelector('.survey-btn.active');
            if (activeBtn) {
                return activeBtn.textContent.trim();
            }
            return 'Dashboard';
        }

        // Set presence on connect
        const connectedRef = db.ref('.info/connected');
        connectedRef.on('value', (snap) => {
            if (snap.val() === true) {
                // Write presence data
                presenceRef.set({
                    name: displayName,
                    tab: getCurrentTab(),
                    joinedAt: firebase.database.ServerValue.TIMESTAMP,
                    lastActive: firebase.database.ServerValue.TIMESTAMP
                });
                // Remove on disconnect
                presenceRef.onDisconnect().remove();
            }
        });

        // Update active tab when switching
        const origSwitchSurvey = window.switchSurvey;
        if (typeof origSwitchSurvey === 'function') {
            window.switchSurvey = function(surveyKey) {
                origSwitchSurvey(surveyKey);
                setTimeout(() => {
                    presenceRef.update({
                        tab: getCurrentTab(),
                        lastActive: firebase.database.ServerValue.TIMESTAMP
                    });
                }, 100);
            };
        }

        // Keep-alive ping every 30s
        setInterval(() => {
            presenceRef.update({ lastActive: firebase.database.ServerValue.TIMESTAMP });
        }, 30000);

        // Listen for presence changes and update UI
        allPresenceRef.on('value', (snapshot) => {
            const viewers = snapshot.val() || {};
            const count = Object.keys(viewers).length;

            // Update badge count
            const countEl = document.getElementById('viewer-count');
            if (countEl) countEl.textContent = count;

            // Update panel list
            const listEl = document.getElementById('viewer-list');
            if (!listEl) return;

            if (count === 0) {
                listEl.innerHTML = '<div class="vp-item" style="color:#999; text-align:center;">No active viewers</div>';
                return;
            }

            let html = '';
            const now = Date.now();
            Object.entries(viewers).forEach(([id, v]) => {
                const isYou = (id === sessionId);
                const ago = v.joinedAt ? Math.round((now - v.joinedAt) / 60000) : 0;
                const timeStr = ago < 1 ? 'Just now' : ago + 'm ago';
                html += '<div class="vp-item">';
                html += '<span class="vp-name">' + (v.name || 'Anonymous') + (isYou ? ' (You)' : '') + '</span>';
                html += '<span class="vp-tab">' + (v.tab || 'Dashboard') + '</span>';
                html += '<span class="vp-time">' + timeStr + '</span>';
                html += '</div>';
            });
            listEl.innerHTML = html;
        });

        // Cleanup on page unload
        window.addEventListener('beforeunload', () => {
            presenceRef.remove();
            // Update visit log with duration
            const visitRef = db.ref('visits/' + sessionId);
            visitRef.update({ leftAt: firebase.database.ServerValue.TIMESTAMP });
        });

        // === PERSISTENT VISIT LOG ===
        const visitLogRef = db.ref('visits/' + sessionId);
        visitLogRef.set({
            name: displayName,
            visitedAt: firebase.database.ServerValue.TIMESTAMP,
            leftAt: null,
            userAgent: navigator.userAgent.substring(0, 80)
        });

        // Listen for visit history changes
        const allVisitsRef = db.ref('visits');
        allVisitsRef.orderByChild('visitedAt').limitToLast(200).on('value', (snapshot) => {
            const visits = snapshot.val() || {};
            const entries = Object.values(visits).sort((a, b) => (b.visitedAt || 0) - (a.visitedAt || 0));

            const now = Date.now();
            const todayStart = new Date(); todayStart.setHours(0,0,0,0);
            const weekStart = new Date(); weekStart.setDate(weekStart.getDate() - weekStart.getDay()); weekStart.setHours(0,0,0,0);

            let totalVisits = entries.length;
            let todayCount = 0;
            let weekCount = 0;
            const uniqueNames = new Set();

            entries.forEach(v => {
                if (v.name) uniqueNames.add(v.name);
                if (v.visitedAt >= todayStart.getTime()) todayCount++;
                if (v.visitedAt >= weekStart.getTime()) weekCount++;
            });

            // Update stats
            const statTotal = document.getElementById('stat-total');
            const statToday = document.getElementById('stat-today');
            const statWeek = document.getElementById('stat-week');
            const statUnique = document.getElementById('stat-unique');
            if (statTotal) statTotal.textContent = totalVisits;
            if (statToday) statToday.textContent = todayCount;
            if (statWeek) statWeek.textContent = weekCount;
            if (statUnique) statUnique.textContent = uniqueNames.size;

            // Render history list (last 50)
            const histList = document.getElementById('visit-history-list');
            if (!histList) return;

            if (entries.length === 0) {
                histList.innerHTML = '<div class="vp-history-item" style="color:#999; text-align:center;">No visit history yet</div>';
                return;
            }

            let html = '';
            entries.slice(0, 50).forEach(v => {
                const date = v.visitedAt ? new Date(v.visitedAt) : null;
                const dateStr = date ? date.toLocaleDateString('en-GB', { day: '2-digit', month: 'short', year: 'numeric' }) + ' ' + date.toLocaleTimeString('en-GB', { hour: '2-digit', minute: '2-digit' }) : 'Unknown';
                let durStr = 'Active';
                if (v.leftAt && v.visitedAt) {
                    const mins = Math.round((v.leftAt - v.visitedAt) / 60000);
                    durStr = mins < 1 ? '<1m' : mins + 'm';
                }
                html += '<div class="vp-history-item">';
                html += '<span class="hi-name">' + (v.name || 'Anonymous') + '</span>';
                html += '<span class="hi-duration">' + durStr + '</span>';
                html += '<span class="hi-date">' + dateStr + '</span>';
                html += '</div>';
            });
            histList.innerHTML = html;
        });
    })();

    // Panel tab switcher
    function switchViewerTab(tab, btn) {
        document.getElementById('vp-live-tab').style.display = tab === 'live' ? '' : 'none';
        document.getElementById('vp-history-tab').style.display = tab === 'history' ? '' : 'none';
        document.querySelectorAll('#viewer-panel .vp-tabs button').forEach(b => b.classList.remove('active'));
        btn.classList.add('active');
    }
    </script>

    <!-- ============================================================ -->
    <!-- CROSS-DATASET SYNTHESIS & AUTOMATED INSIGHTS ENGINE          -->
    <!-- ============================================================ -->
    <script>
    (function() {
        'use strict';

        // ── INDICATOR DICTIONARY ──────────────────────────────────────
        // Normalized indicators drawn from existing hardcoded surveyData.
        // Each indicator: { id, label, domain, womenBaseline, womenMidline,
        //   menBaseline, menMidline, target, logframeId, unit }
        // Values are percentages unless noted.

        const indicatorDictionary = [
            // === SAVINGS & FINANCIAL ===
            { id: 'vsla-participation', label: 'VSLA Participation', domain: 'savings',
              womenBaseline: 43.6, womenMidline: 98.0, menBaseline: 18.5, menMidline: 42.7, target: 70, logframeId: '1220a', unit: '%' },
            { id: 'personal-savings', label: 'Personal Savings Rate', domain: 'savings',
              womenBaseline: 43.1, womenMidline: 93.4, menBaseline: 31.4, menMidline: 68.2, target: null, unit: '%' },
            { id: 'loan-access', label: 'Loan Access', domain: 'savings',
              womenBaseline: 28.0, womenMidline: 79.1, menBaseline: 22.8, menMidline: 58.6, target: null, unit: '%' },

            // === CLIMATE & NBS ===
            { id: 'climate-awareness', label: 'Climate Change Awareness', domain: 'climate',
              womenBaseline: 60.5, womenMidline: 96.3, menBaseline: 77.8, menMidline: 100.0, target: 55, unit: '%' },
            { id: 'nbs-knowledge', label: 'NbS Knowledge', domain: 'climate',
              womenBaseline: 23.1, womenMidline: 77.8, menBaseline: 42.4, menMidline: 89.8, target: 55, logframeId: '1210a', unit: '%' },
            { id: 'mangrove-participation', label: 'Mangrove Restoration', domain: 'climate',
              womenBaseline: 36.9, womenMidline: 86.5, menBaseline: 29.7, menMidline: 80.7, target: null, unit: '%' },
            { id: 'seaweed-participation', label: 'Seaweed Farming', domain: 'climate',
              womenBaseline: 19.8, womenMidline: 74.7, menBaseline: 15.7, menMidline: 83.9, target: null, unit: '%' },
            { id: 'forest-management', label: 'Forest Management', domain: 'climate',
              womenBaseline: 67.4, womenMidline: 98.4, menBaseline: 33.7, menMidline: 95.8, target: null, unit: '%' },

            // === GENDER & EMPOWERMENT ===
            { id: 'hh-decisions', label: 'HH Decision Involvement', domain: 'gender',
              womenBaseline: 57.6, womenMidline: 95.9, menBaseline: null, menMidline: null, target: 65, logframeId: '1200a', unit: '%' },
            { id: 'resource-access', label: 'Resource Access & Control', domain: 'gender',
              womenBaseline: 41.2, womenMidline: 53.8, menBaseline: null, menMidline: null, target: 50, logframeId: '1200c', unit: '%' },
            { id: 'gender-equality-women', label: 'Gender Equality (Women)', domain: 'gender',
              womenBaseline: 42.1, womenMidline: 64.7, menBaseline: null, menMidline: null, target: 55, logframeId: '1210c', unit: '/100' },
            { id: 'gender-equality-men', label: 'Gender Equality (Men)', domain: 'gender',
              womenBaseline: null, womenMidline: null, menBaseline: 41.2, menMidline: 71.0, target: 55, logframeId: '1230b', unit: '/100' },
            { id: 'self-esteem-women', label: 'Self-Esteem (Women GJJ)', domain: 'gender',
              womenBaseline: 33.5, womenMidline: 52.6, menBaseline: null, menMidline: null, target: null, unit: '%' },
            { id: 'self-responsibility-men', label: 'Self-Responsibility (Men GJJ)', domain: 'gender',
              womenBaseline: null, womenMidline: null, menBaseline: 50.1, menMidline: 70.3, target: null, unit: '%' },
            { id: 'husband-chores', label: 'Husband Supports Chores', domain: 'gender',
              womenBaseline: 41.4, womenMidline: 64.7, menBaseline: 17.7, menMidline: 42.2, target: null, unit: '%' },

            // === DISASTER PREPAREDNESS ===
            { id: 'prep-knowledge', label: 'Preparedness Knowledge', domain: 'preparedness',
              womenBaseline: 4.7, womenMidline: 37.8, menBaseline: 6.2, menMidline: 42.8, target: null, unit: '%' },
            { id: 'prep-action', label: 'Preparedness Action', domain: 'preparedness',
              womenBaseline: 11.8, womenMidline: 46.3, menBaseline: 1.8, menMidline: 28.5, target: null, unit: '%' },
            { id: 'early-warnings', label: 'Early Warning Access', domain: 'preparedness',
              womenBaseline: 8.9, womenMidline: 45.0, menBaseline: 9.7, menMidline: 48.1, target: null, unit: '%' },

            // === DECISION-MAKING ===
            { id: 'joint-decisions', label: 'Joint Decision-Making', domain: 'decisions',
              womenBaseline: 45.0, womenMidline: 58.8, menBaseline: 59.6, menMidline: 89.8, target: 65, unit: '%' },
            { id: 'decision-conversations', label: 'Decision Conversations', domain: 'decisions',
              womenBaseline: 60.2, womenMidline: 81.7, menBaseline: 87.9, menMidline: 97.1, target: null, unit: '%' },
            { id: 'business-support', label: 'Support Wife Business', domain: 'decisions',
              womenBaseline: 84.9, womenMidline: 64.2, menBaseline: 53.5, menMidline: 67.6, target: null, unit: '%' },

            // === SOCIAL NORMS ===
            { id: 'harmful-norms-income', label: '"Only Men Earn" Rejection', domain: 'norms',
              womenBaseline: null, womenMidline: null, menBaseline: 63.1, menMidline: 28.4, target: null, unit: '%', lowerIsBetter: true },
            { id: 'harmful-norms-boats', label: '"Only Men Drive Boats" Rejection', domain: 'norms',
              womenBaseline: null, womenMidline: null, menBaseline: 59.2, menMidline: 22.7, target: null, unit: '%', lowerIsBetter: true },
            { id: 'unpaid-care-men', label: 'Men Unpaid Care Work', domain: 'norms',
              womenBaseline: null, womenMidline: null, menBaseline: 2.3, menMidline: 4.2, target: null, unit: 'hrs/day' },
            { id: 'unpaid-care-women', label: 'Women Unpaid Care Work', domain: 'norms',
              womenBaseline: 9.3, womenMidline: 7.7, menBaseline: null, menMidline: null, target: 8.3, logframeId: '1200b', unit: 'hrs/day', lowerIsBetter: true },
            { id: 'joint-responsibility-belief', label: 'Joint HH Responsibility Belief', domain: 'norms',
              womenBaseline: 12.5, womenMidline: 71.3, menBaseline: 17.7, menMidline: 68.2, target: null, unit: '%' }
        ];

        // Training indicators (separate since they compare pre/post not baseline/midline)
        const trainingIndicators = [
            { id: 'forest-training', label: 'Forest Conservation Knowledge', pre: 50.0, post: 94.7, target: 68, logframeId: '1130a' },
            { id: 'mangrove-training', label: 'Mangrove Restoration Knowledge', pre: 36.9, post: 81.9, target: 57, logframeId: '1110a' },
            { id: 'mangrove-female', label: 'Mangrove Knowledge (Female)', pre: 34.7, post: 87.4, target: 57 },
            { id: 'mangrove-male', label: 'Mangrove Knowledge (Male)', pre: 38.2, post: 80.2, target: 57 },
            { id: 'forest-groups', label: 'Forest Group Functionality (>=70%)', pre: 53.5, post: 85.7, target: 70, logframeId: '1130b' }
        ];

        // ── COMPUTE HELPERS ──────────────────────────────────────────

        function pctChange(baseline, midline) {
            if (baseline == null || midline == null || baseline === 0) return null;
            return ((midline - baseline) / baseline * 100);
        }

        function ppChange(baseline, midline) {
            if (baseline == null || midline == null) return null;
            return midline - baseline;
        }

        function getStatus(indicator) {
            const w = ppChange(indicator.womenBaseline, indicator.womenMidline);
            const m = ppChange(indicator.menBaseline, indicator.menMidline);
            const avg = w != null && m != null ? (w + m) / 2 : (w || m || 0);
            const lower = indicator.lowerIsBetter;

            if (indicator.target != null) {
                const midVal = indicator.womenMidline || indicator.menMidline;
                if (lower) {
                    if (midVal <= indicator.target) return 'exceeded';
                    if (midVal <= indicator.target * 1.15) return 'on-track';
                    return 'at-risk';
                }
                if (midVal >= indicator.target) return 'exceeded';
                if (midVal >= indicator.target * 0.85) return 'on-track';
                return 'at-risk';
            }

            if (lower) {
                if (avg < -5) return 'exceeded';
                if (avg < 0) return 'on-track';
                return 'at-risk';
            }
            if (avg > 15) return 'exceeded';
            if (avg > 5) return 'on-track';
            if (avg >= 0) return 'at-risk';
            return 'declined';
        }

        function formatVal(v, unit) {
            if (v == null) return '—';
            if (unit === 'hrs/day') return v.toFixed(1) + 'h';
            if (unit === '/100') return v.toFixed(1);
            return v.toFixed(1) + '%';
        }

        // ── CHART INSTANCE TRACKER ────────────────────────────────────
        const synthCharts = {};
        function destroySynthCharts() {
            Object.keys(synthCharts).forEach(k => {
                if (synthCharts[k]) { synthCharts[k].destroy(); delete synthCharts[k]; }
            });
        }

        // ── CROSS-DATASET SYNTHESIS RENDERER ──────────────────────────

        window.renderCrossDatasetSynthesis = function() {
            destroySynthCharts();

            // --- KPIs ---
            const totalIndicators = indicatorDictionary.length;
            const exceeded = indicatorDictionary.filter(i => getStatus(i) === 'exceeded').length;
            const avgGain = indicatorDictionary.reduce((sum, i) => {
                const changes = [];
                const wc = ppChange(i.womenBaseline, i.womenMidline);
                const mc = ppChange(i.menBaseline, i.menMidline);
                if (wc != null) changes.push(i.lowerIsBetter ? -wc : wc);
                if (mc != null) changes.push(i.lowerIsBetter ? -mc : mc);
                return sum + (changes.length ? changes.reduce((a, b) => a + b, 0) / changes.length : 0);
            }, 0) / totalIndicators;
            const logframeCount = indicatorDictionary.filter(i => i.logframeId).length + trainingIndicators.filter(i => i.logframeId).length;
            const logframeExceeded = indicatorDictionary.filter(i => i.logframeId && getStatus(i) === 'exceeded').length
                + trainingIndicators.filter(i => i.logframeId && i.post >= i.target).length;
            const domains = [...new Set(indicatorDictionary.map(i => i.domain))];

            const kpiContainer = document.getElementById('synthesis-kpis');
            kpiContainer.innerHTML = [
                { label: 'Total Indicators', value: totalIndicators, sub: 'Tracked across datasets', cls: '' },
                { label: 'Targets Exceeded', value: exceeded + '/' + totalIndicators, sub: Math.round(exceeded / totalIndicators * 100) + '% of all indicators', cls: 'green' },
                { label: 'Avg. Improvement', value: '+' + avgGain.toFixed(1) + 'pp', sub: 'Mean gain across indicators', cls: 'green' },
                { label: 'Logframe Achievement', value: logframeExceeded + '/' + logframeCount, sub: 'Official M&E indicators exceeded', cls: logframeExceeded === logframeCount ? 'green' : 'orange' },
                { label: 'Domains Covered', value: domains.length, sub: domains.map(d => d.charAt(0).toUpperCase() + d.slice(1)).join(', '), cls: '' },
                { label: 'Training Effectiveness', value: '+' + ((trainingIndicators.reduce((s, t) => s + (t.post - t.pre), 0)) / trainingIndicators.length).toFixed(1) + 'pp', sub: 'Avg. pre-to-post gain', cls: 'green' }
            ].map(k => `<div class="synthesis-kpi ${k.cls}"><div class="sk-label">${k.label}</div><div class="sk-value">${k.value}</div><div class="sk-sub">${k.sub}</div></div>`).join('');

            // --- TABLE ---
            renderSynthesisTable('all');

            // --- CHARTS ---
            renderSynthesisCharts();
        };

        function renderSynthesisTable(domainFilter) {
            const tbody = document.getElementById('synthesis-table-body');
            const filtered = domainFilter === 'all' ? indicatorDictionary : indicatorDictionary.filter(i => i.domain === domainFilter);

            tbody.innerHTML = filtered.map(ind => {
                const wChange = ppChange(ind.womenBaseline, ind.womenMidline);
                const mChange = ppChange(ind.menBaseline, ind.menMidline);
                const bestChange = wChange != null && mChange != null ? Math.max(Math.abs(wChange), Math.abs(mChange)) : Math.abs(wChange || mChange || 0);
                const status = getStatus(ind);
                const arrow = (ind.lowerIsBetter)
                    ? (wChange != null && wChange < 0 || mChange != null && mChange < 0 ? '&#9660;' : '&#9650;')
                    : (wChange != null && wChange > 0 || mChange != null && mChange > 0 ? '&#9650;' : '&#9660;');
                const arrowColor = status === 'exceeded' || status === 'on-track' ? '#2e7d32' : (status === 'declined' ? '#c62828' : '#f57c00');

                return `<tr data-domain="${ind.domain}">
                    <td><strong>${ind.label}</strong>${ind.logframeId ? ' <span style="color:#0072CE;font-size:0.75em;">[' + ind.logframeId + ']</span>' : ''}</td>
                    <td style="text-transform:capitalize;">${ind.domain}</td>
                    <td>${formatVal(ind.womenBaseline, ind.unit)}</td>
                    <td>${formatVal(ind.womenMidline, ind.unit)}</td>
                    <td>${formatVal(ind.menBaseline, ind.unit)}</td>
                    <td>${formatVal(ind.menMidline, ind.unit)}</td>
                    <td style="font-weight:700;">
                        ${wChange != null ? (wChange > 0 ? '+' : '') + wChange.toFixed(1) : ''}
                        ${wChange != null && mChange != null ? ' / ' : ''}
                        ${mChange != null ? (mChange > 0 ? '+' : '') + mChange.toFixed(1) : ''}
                    </td>
                    <td style="color:${arrowColor};font-size:1.2em;">${arrow}</td>
                    <td><span class="status-pill ${status}">${status.replace('-', ' ')}</span></td>
                </tr>`;
            }).join('');
        }

        window.filterSynthesisDomain = function(domain, btn) {
            document.querySelectorAll('#synthesis-domain-filter .domain-chip').forEach(c => c.classList.remove('active'));
            btn.classList.add('active');
            renderSynthesisTable(domain);
        };

        function renderSynthesisCharts() {
            // 1) Women vs Men comparison bar chart
            const compIndicators = indicatorDictionary.filter(i => i.womenMidline != null && i.menMidline != null && i.unit === '%');
            const compLabels = compIndicators.map(i => i.label.length > 22 ? i.label.substring(0, 20) + '...' : i.label);

            synthCharts['comparison'] = new Chart(document.getElementById('synthesis-chart-comparison'), {
                type: 'bar',
                data: {
                    labels: compLabels,
                    datasets: [
                        { label: 'Women (Midline)', data: compIndicators.map(i => i.womenMidline), backgroundColor: '#E91E63', borderRadius: 4 },
                        { label: 'Men (Midline)', data: compIndicators.map(i => i.menMidline), backgroundColor: '#1976d2', borderRadius: 4 }
                    ]
                },
                options: {
                    responsive: true, maintainAspectRatio: false, indexAxis: 'y',
                    scales: { x: { beginAtZero: true, max: 100, title: { display: true, text: 'Percentage (%)' } } },
                    plugins: {
                        legend: { position: 'top' },
                        datalabels: { display: false }
                    }
                }
            });
            document.getElementById('synthesis-insight-comparison').innerHTML = 'Women lead in VSLA participation (98.0% vs 42.7%) and personal savings (93.4% vs 68.2%). Men show higher climate awareness (100% vs 96.3%) and stronger joint decision support (89.8% vs 58.8%). Both genders show dramatic NbS participation improvements.';

            // 2) Gender gap analysis
            const gapInds = compIndicators.slice(0, 10);
            const baselineGaps = gapInds.map(i => Math.abs((i.womenBaseline || 0) - (i.menBaseline || 0)));
            const midlineGaps = gapInds.map(i => Math.abs((i.womenMidline || 0) - (i.menMidline || 0)));

            synthCharts['gendergap'] = new Chart(document.getElementById('synthesis-chart-gendergap'), {
                type: 'bar',
                data: {
                    labels: gapInds.map(i => i.label.length > 18 ? i.label.substring(0, 16) + '...' : i.label),
                    datasets: [
                        { label: 'Baseline Gap', data: baselineGaps, backgroundColor: 'rgba(59,130,246,0.6)', borderRadius: 4 },
                        { label: 'Midline Gap', data: midlineGaps, backgroundColor: 'rgba(139,92,246,0.6)', borderRadius: 4 }
                    ]
                },
                options: {
                    responsive: true, maintainAspectRatio: false,
                    scales: { y: { beginAtZero: true, title: { display: true, text: 'Gap (pp)' } } },
                    plugins: { legend: { position: 'top' }, datalabels: { display: false } }
                }
            });
            document.getElementById('synthesis-insight-gendergap').innerHTML = 'Gender gaps have narrowed in climate awareness (17.3pp to 3.7pp), NbS knowledge (19.3pp to 12.0pp), and loan access (5.2pp to 20.5pp with women surpassing men). Key gap widened in VSLA participation (25.1pp to 55.3pp) where women strongly outperform.';

            // 3) Radar chart by domain
            const domainScores = {};
            indicatorDictionary.forEach(ind => {
                if (!domainScores[ind.domain]) domainScores[ind.domain] = { wGains: [], mGains: [] };
                const wc = ppChange(ind.womenBaseline, ind.womenMidline);
                const mc = ppChange(ind.menBaseline, ind.menMidline);
                if (wc != null) domainScores[ind.domain].wGains.push(ind.lowerIsBetter ? -wc : wc);
                if (mc != null) domainScores[ind.domain].mGains.push(ind.lowerIsBetter ? -mc : mc);
            });
            const dLabels = Object.keys(domainScores).map(d => d.charAt(0).toUpperCase() + d.slice(1));
            const wDomainAvg = Object.values(domainScores).map(d => d.wGains.length ? d.wGains.reduce((a, b) => a + b, 0) / d.wGains.length : 0);
            const mDomainAvg = Object.values(domainScores).map(d => d.mGains.length ? d.mGains.reduce((a, b) => a + b, 0) / d.mGains.length : 0);

            synthCharts['radar'] = new Chart(document.getElementById('synthesis-chart-radar'), {
                type: 'radar',
                data: {
                    labels: dLabels,
                    datasets: [
                        { label: 'Women Avg Gain (pp)', data: wDomainAvg, borderColor: '#E91E63', backgroundColor: 'rgba(233,30,99,0.1)', pointBackgroundColor: '#E91E63' },
                        { label: 'Men Avg Gain (pp)', data: mDomainAvg, borderColor: '#1976d2', backgroundColor: 'rgba(25,118,210,0.1)', pointBackgroundColor: '#1976d2' }
                    ]
                },
                options: {
                    responsive: true, maintainAspectRatio: false,
                    scales: { r: { beginAtZero: true, ticks: { stepSize: 10 } } },
                    plugins: { datalabels: { display: false } }
                }
            });
            document.getElementById('synthesis-insight-radar').innerHTML = 'Women show strongest gains in Savings & Financial domain (avg +50pp), while men excel in Norms domain (avg +35pp harmful norm reduction). Both genders show balanced Climate & NbS improvements. Preparedness domain shows strong parallel progress.';

            // 4) Logframe achievement overview
            const lfIndicators = [
                ...indicatorDictionary.filter(i => i.logframeId).map(i => ({
                    label: i.logframeId + ': ' + i.label.substring(0, 25),
                    result: i.womenMidline || i.menMidline,
                    target: i.target,
                    baseline: i.womenBaseline || i.menBaseline
                })),
                ...trainingIndicators.filter(i => i.logframeId).map(i => ({
                    label: i.logframeId + ': ' + i.label.substring(0, 25),
                    result: i.post,
                    target: i.target,
                    baseline: i.pre
                }))
            ];

            synthCharts['logframe'] = new Chart(document.getElementById('synthesis-chart-logframe'), {
                type: 'bar',
                data: {
                    labels: lfIndicators.map(i => i.label),
                    datasets: [
                        { label: 'Baseline', data: lfIndicators.map(i => i.baseline), backgroundColor: 'rgba(59,130,246,0.4)', borderRadius: 4 },
                        { label: 'Target', data: lfIndicators.map(i => i.target), backgroundColor: 'rgba(255,152,0,0.5)', borderRadius: 4 },
                        { label: 'Result', data: lfIndicators.map(i => i.result), backgroundColor: 'rgba(46,125,50,0.7)', borderRadius: 4 }
                    ]
                },
                options: {
                    responsive: true, maintainAspectRatio: false, indexAxis: 'y',
                    scales: { x: { beginAtZero: true, max: 100 } },
                    plugins: { legend: { position: 'top' }, datalabels: { display: false } }
                }
            });
            document.getElementById('synthesis-insight-logframe').innerHTML = 'All logframe indicators have been exceeded or are on track. Strongest over-achievement: 1200a (HH decisions, +38.3pp above target), 1220a (savings groups, +21.9pp above target), and 1110a (mangrove knowledge, +24.9pp above target).';

            // 5) Waterfall: Top gains & gaps
            const allChanges = indicatorDictionary.map(ind => {
                const wc = ppChange(ind.womenBaseline, ind.womenMidline);
                const mc = ppChange(ind.menBaseline, ind.menMidline);
                const best = wc != null && mc != null ? (Math.abs(wc) > Math.abs(mc) ? wc : mc) : (wc || mc || 0);
                return { label: ind.label, change: ind.lowerIsBetter ? -best : best };
            }).sort((a, b) => b.change - a.change);

            const top8 = allChanges.slice(0, 8);
            const bottom4 = allChanges.slice(-4).reverse();
            const waterfall = [...top8, ...bottom4];

            synthCharts['waterfall'] = new Chart(document.getElementById('synthesis-chart-waterfall'), {
                type: 'bar',
                data: {
                    labels: waterfall.map(w => w.label.length > 25 ? w.label.substring(0, 23) + '...' : w.label),
                    datasets: [{
                        label: 'Change (pp)',
                        data: waterfall.map(w => w.change),
                        backgroundColor: waterfall.map(w => w.change >= 15 ? '#2e7d32' : (w.change >= 5 ? '#66bb6a' : (w.change >= 0 ? '#ffb74d' : '#ef5350'))),
                        borderRadius: 4
                    }]
                },
                options: {
                    responsive: true, maintainAspectRatio: false, indexAxis: 'y',
                    scales: { x: { title: { display: true, text: 'Change (pp)' } } },
                    plugins: { legend: { display: false }, datalabels: { anchor: 'end', align: 'right', font: { size: 11, weight: 'bold' }, color: '#333', formatter: v => (v > 0 ? '+' : '') + v.toFixed(1) + 'pp' } }
                }
            });
            document.getElementById('synthesis-insight-waterfall').innerHTML = 'Largest gains across all datasets: Joint HH Responsibility Belief (+58.8pp women), NbS Knowledge (+54.7pp), VSLA Participation (+54.4pp women). One notable decline: Business Support for women dropped 20.7pp (84.9% to 64.2%), requiring attention.';

            // 6) NbS comparison
            synthCharts['nbs'] = new Chart(document.getElementById('synthesis-chart-nbs'), {
                type: 'bar',
                data: {
                    labels: ['Mangrove', 'Seaweed', 'Forest Mgmt'],
                    datasets: [
                        { label: 'Women Baseline', data: [36.9, 19.8, 67.4], backgroundColor: 'rgba(233,30,99,0.3)' },
                        { label: 'Women Midline', data: [86.5, 74.7, 98.4], backgroundColor: '#E91E63' },
                        { label: 'Men Support Baseline', data: [29.7, 15.7, 33.7], backgroundColor: 'rgba(25,118,210,0.3)' },
                        { label: 'Men Support Midline', data: [80.7, 83.9, 95.8], backgroundColor: '#1976d2' }
                    ]
                },
                options: {
                    responsive: true, maintainAspectRatio: false,
                    scales: { y: { beginAtZero: true, max: 100 } },
                    plugins: { legend: { position: 'top', labels: { font: { size: 10 } } }, datalabels: { display: false } }
                }
            });
            document.getElementById('synthesis-insight-nbs').innerHTML = 'Both women\'s direct participation and men\'s support for NbS activities show dramatic parallel improvements. Men\'s seaweed support (+68.2pp) now exceeds women\'s direct participation (+54.9pp), indicating strong male allyship in conservation.';

            // 7) Training effectiveness
            synthCharts['training'] = new Chart(document.getElementById('synthesis-chart-training'), {
                type: 'bar',
                data: {
                    labels: trainingIndicators.map(t => t.label.length > 22 ? t.label.substring(0, 20) + '...' : t.label),
                    datasets: [
                        { label: 'Pre-Test', data: trainingIndicators.map(t => t.pre), backgroundColor: 'rgba(59,130,246,0.5)', borderRadius: 4 },
                        { label: 'Post-Test', data: trainingIndicators.map(t => t.post), backgroundColor: 'rgba(46,125,50,0.7)', borderRadius: 4 },
                        { label: 'Target', data: trainingIndicators.map(t => t.target), type: 'line', borderColor: '#f57c00', borderDash: [5, 5], pointStyle: 'rectRot', pointRadius: 6, fill: false }
                    ]
                },
                options: {
                    responsive: true, maintainAspectRatio: false,
                    scales: { y: { beginAtZero: true, max: 100 } },
                    plugins: { legend: { position: 'top' }, datalabels: { display: false } }
                }
            });
            document.getElementById('synthesis-insight-training').innerHTML = 'All training programs exceeded targets. Forest conservation training achieved the highest post-test score (94.7%, +44.7pp). Female participants in mangrove training outperformed males (87.4% vs 80.2%), closing and reversing the initial gender gap.';
        }

        // ── AUTOMATED INSIGHTS ENGINE (Advanced) ──────────────────────

        // Confidence scoring: how strong is the evidence behind an insight?
        function computeConfidence(ind, changeW, changeM) {
            let score = 50; // base
            // Larger absolute change = higher confidence
            const maxChange = Math.max(Math.abs(changeW || 0), Math.abs(changeM || 0));
            if (maxChange >= 30) score += 25;
            else if (maxChange >= 15) score += 15;
            else if (maxChange >= 8) score += 5;
            // Logframe indicator = structured evidence
            if (ind && ind.logframeId) score += 10;
            // Both genders measured = triangulation
            if (changeW != null && changeM != null) score += 10;
            // Same direction in both genders = corroboration
            if (changeW != null && changeM != null && ((changeW > 0 && changeM > 0) || (changeW < 0 && changeM < 0))) score += 5;
            return Math.min(score, 100);
        }

        function confidenceLabel(score) {
            if (score >= 75) return 'high';
            if (score >= 50) return 'medium';
            return 'low';
        }

        function severityLevel(magnitude) {
            if (magnitude >= 40) return 3;
            if (magnitude >= 20) return 2;
            return 1;
        }

        // Domain health score (0-100) based on indicator performance
        function computeDomainHealth() {
            const domains = {};
            indicatorDictionary.forEach(ind => {
                if (!domains[ind.domain]) domains[ind.domain] = { gains: [], exceeded: 0, total: 0, anomalies: 0 };
                const d = domains[ind.domain];
                d.total++;
                const wc = ppChange(ind.womenBaseline, ind.womenMidline);
                const mc = ppChange(ind.menBaseline, ind.menMidline);
                const gain = wc != null && mc != null ? (Math.abs(wc) + Math.abs(mc)) / 2 : Math.abs(wc || mc || 0);
                d.gains.push(ind.lowerIsBetter ? -gain : gain);
                if (getStatus(ind) === 'exceeded') d.exceeded++;
                if ((wc != null && !ind.lowerIsBetter && wc < -5) || (mc != null && !ind.lowerIsBetter && mc < -5)) d.anomalies++;
            });
            // Score: 40% exceeded ratio + 40% avg gain normalized + 20% no anomalies
            const result = {};
            Object.entries(domains).forEach(([name, d]) => {
                const exceedRatio = d.total > 0 ? d.exceeded / d.total : 0;
                const avgGain = d.gains.length ? d.gains.reduce((a, b) => a + b, 0) / d.gains.length : 0;
                const gainNorm = Math.min(avgGain / 50, 1); // normalize to 50pp max
                const anomalyPenalty = d.anomalies > 0 ? 0 : 1;
                result[name] = {
                    score: Math.round((exceedRatio * 40 + gainNorm * 40 + anomalyPenalty * 20)),
                    exceeded: d.exceeded, total: d.total, avgGain: avgGain, anomalies: d.anomalies
                };
            });
            return result;
        }

        function generateInsights() {
            const insights = [];

            // --- TREND insights ---
            indicatorDictionary.forEach(ind => {
                const wc = ppChange(ind.womenBaseline, ind.womenMidline);
                const mc = ppChange(ind.menBaseline, ind.menMidline);
                const conf = computeConfidence(ind, wc, mc);

                if (wc != null && Math.abs(wc) >= 15) {
                    const dir = (ind.lowerIsBetter ? wc < 0 : wc > 0) ? 'positive' : 'concerning';
                    insights.push({
                        category: 'trend',
                        title: ind.label + ' — Women ' + (dir === 'positive' ? 'Strong Improvement' : 'Significant Change'),
                        narrative: `Women's ${ind.label.toLowerCase()} moved from ${formatVal(ind.womenBaseline, ind.unit)} to ${formatVal(ind.womenMidline, ind.unit)} (${wc > 0 ? '+' : ''}${wc.toFixed(1)}pp). ` +
                            (dir === 'positive' ? 'This represents a substantial positive shift indicating program effectiveness.' : 'This change requires monitoring to understand underlying drivers.'),
                        evidence: `Source: Women Survey (Midline) | Domain: ${ind.domain} | Baseline: ${formatVal(ind.womenBaseline, ind.unit)} | Midline: ${formatVal(ind.womenMidline, ind.unit)}`,
                        priority: Math.abs(wc),
                        confidence: conf,
                        domain: ind.domain,
                        magnitude: Math.abs(wc),
                        direction: dir,
                        indicator: ind.id
                    });
                }
                if (mc != null && Math.abs(mc) >= 15) {
                    const dir = (ind.lowerIsBetter ? mc < 0 : mc > 0) ? 'positive' : 'concerning';
                    insights.push({
                        category: 'trend',
                        title: ind.label + ' — Men ' + (dir === 'positive' ? 'Strong Improvement' : 'Significant Change'),
                        narrative: `Men's ${ind.label.toLowerCase()} moved from ${formatVal(ind.menBaseline, ind.unit)} to ${formatVal(ind.menMidline, ind.unit)} (${mc > 0 ? '+' : ''}${mc.toFixed(1)}pp). ` +
                            (dir === 'positive' ? 'This demonstrates meaningful behavioral change among male participants.' : 'This shift warrants further investigation.'),
                        evidence: `Source: Men Survey (Midline) | Domain: ${ind.domain} | Baseline: ${formatVal(ind.menBaseline, ind.unit)} | Midline: ${formatVal(ind.menMidline, ind.unit)}`,
                        priority: Math.abs(mc),
                        confidence: conf,
                        domain: ind.domain,
                        magnitude: Math.abs(mc),
                        direction: dir,
                        indicator: ind.id
                    });
                }
            });

            // --- MILESTONE insights (targets exceeded) ---
            indicatorDictionary.filter(i => i.target != null).forEach(ind => {
                const result = ind.womenMidline || ind.menMidline;
                const exceed = ind.lowerIsBetter ? (result <= ind.target) : (result >= ind.target);
                if (exceed) {
                    const over = ind.lowerIsBetter ? (ind.target - result) : (result - ind.target);
                    const conf = computeConfidence(ind, ppChange(ind.womenBaseline, ind.womenMidline), ppChange(ind.menBaseline, ind.menMidline));
                    insights.push({
                        category: 'milestone',
                        title: (ind.logframeId ? '[' + ind.logframeId + '] ' : '') + ind.label + ' — Target Exceeded',
                        narrative: `${ind.label} reached ${formatVal(result, ind.unit)}, surpassing the target of ${formatVal(ind.target, ind.unit)} by ${Math.abs(over).toFixed(1)}pp. This logframe indicator demonstrates strong program impact and validates the theory of change.`,
                        evidence: `Logframe ID: ${ind.logframeId || 'N/A'} | Target: ${formatVal(ind.target, ind.unit)} | Achieved: ${formatVal(result, ind.unit)} | Over-achievement: +${Math.abs(over).toFixed(1)}pp`,
                        priority: Math.abs(over),
                        confidence: conf,
                        domain: ind.domain,
                        magnitude: Math.abs(over),
                        direction: 'positive',
                        indicator: ind.id
                    });
                }
            });

            trainingIndicators.filter(t => t.post >= t.target).forEach(t => {
                insights.push({
                    category: 'milestone',
                    title: (t.logframeId ? '[' + t.logframeId + '] ' : '') + t.label + ' — Training Target Exceeded',
                    narrative: `${t.label} post-test score reached ${t.post.toFixed(1)}%, exceeding the ${t.target}% target by ${(t.post - t.target).toFixed(1)}pp. Training effectiveness confirmed with ${(t.post - t.pre).toFixed(1)}pp knowledge gain between pre and post assessments.`,
                    evidence: `Pre-test: ${t.pre.toFixed(1)}% | Post-test: ${t.post.toFixed(1)}% | Target: ${t.target}% | Gain: +${(t.post - t.pre).toFixed(1)}pp`,
                    priority: t.post - t.target,
                    confidence: 85,
                    domain: 'climate',
                    magnitude: t.post - t.pre,
                    direction: 'positive',
                    indicator: t.id
                });
            });

            // --- ANOMALY insights (unexpected declines or outliers) ---
            indicatorDictionary.forEach(ind => {
                const wc = ppChange(ind.womenBaseline, ind.womenMidline);
                const mc = ppChange(ind.menBaseline, ind.menMidline);

                if (wc != null && !ind.lowerIsBetter && wc < -5) {
                    insights.push({
                        category: 'anomaly',
                        title: ind.label + ' — Unexpected Women Decline',
                        narrative: `Women's ${ind.label.toLowerCase()} declined by ${Math.abs(wc).toFixed(1)}pp (${formatVal(ind.womenBaseline, ind.unit)} to ${formatVal(ind.womenMidline, ind.unit)}). This counter-trend requires investigation — potential factors include survey methodology changes, seasonal effects, program saturation, or shifting participant expectations. Root-cause analysis recommended before endline.`,
                        evidence: `Domain: ${ind.domain} | Expected direction: Increase | Actual: -${Math.abs(wc).toFixed(1)}pp | Baseline: ${formatVal(ind.womenBaseline, ind.unit)} | Midline: ${formatVal(ind.womenMidline, ind.unit)}`,
                        priority: Math.abs(wc) + 10,
                        confidence: computeConfidence(ind, wc, mc),
                        domain: ind.domain,
                        magnitude: Math.abs(wc),
                        direction: 'negative',
                        indicator: ind.id
                    });
                }
                if (mc != null && !ind.lowerIsBetter && mc < -5) {
                    insights.push({
                        category: 'anomaly',
                        title: ind.label + ' — Unexpected Men Decline',
                        narrative: `Men's ${ind.label.toLowerCase()} declined by ${Math.abs(mc).toFixed(1)}pp (${formatVal(ind.menBaseline, ind.unit)} to ${formatVal(ind.menMidline, ind.unit)}). This regression needs root cause analysis to differentiate between actual behavioral reversal and measurement artifacts.`,
                        evidence: `Domain: ${ind.domain} | Expected direction: Increase | Actual: -${Math.abs(mc).toFixed(1)}pp | Baseline: ${formatVal(ind.menBaseline, ind.unit)} | Midline: ${formatVal(ind.menMidline, ind.unit)}`,
                        priority: Math.abs(mc) + 10,
                        confidence: computeConfidence(ind, wc, mc),
                        domain: ind.domain,
                        magnitude: Math.abs(mc),
                        direction: 'negative',
                        indicator: ind.id
                    });
                }

                // Outlier detection: indicator significantly above/below domain average
                if (wc != null || mc != null) {
                    const allChanges = indicatorDictionary.filter(i => i.domain === ind.domain).map(i => {
                        const w = ppChange(i.womenBaseline, i.womenMidline);
                        const m = ppChange(i.menBaseline, i.menMidline);
                        return w != null && m != null ? (w + m) / 2 : (w || m || 0);
                    });
                    const avg = allChanges.reduce((a, b) => a + b, 0) / allChanges.length;
                    const stdDev = Math.sqrt(allChanges.reduce((s, v) => s + Math.pow(v - avg, 2), 0) / allChanges.length);
                    const myChange = wc != null && mc != null ? (wc + mc) / 2 : (wc || mc || 0);
                    const zScore = stdDev > 0 ? (myChange - avg) / stdDev : 0;

                    if (Math.abs(zScore) >= 1.8 && !insights.find(i => i.indicator === ind.id && i.category === 'anomaly')) {
                        insights.push({
                            category: 'anomaly',
                            title: ind.label + ' — Statistical Outlier in ' + ind.domain.charAt(0).toUpperCase() + ind.domain.slice(1),
                            narrative: `${ind.label} changed by ${myChange > 0 ? '+' : ''}${myChange.toFixed(1)}pp, which is ${Math.abs(zScore).toFixed(1)} standard deviations ${zScore > 0 ? 'above' : 'below'} the domain average of ${avg.toFixed(1)}pp. This outlier performance ${zScore > 0 ? 'significantly exceeds peers and may offer lessons for scaling' : 'lags behind peers and may need targeted support'}.`,
                            evidence: `Domain avg change: ${avg.toFixed(1)}pp | This indicator: ${myChange.toFixed(1)}pp | Z-score: ${zScore.toFixed(2)} | StdDev: ${stdDev.toFixed(1)}pp`,
                            priority: Math.abs(zScore) * 10,
                            confidence: computeConfidence(ind, wc, mc),
                            domain: ind.domain,
                            magnitude: Math.abs(myChange),
                            direction: zScore > 0 ? 'positive' : 'negative',
                            indicator: ind.id + '-outlier'
                        });
                    }
                }
            });

            // --- GAP insights (gender disparities) ---
            indicatorDictionary.filter(i => i.womenMidline != null && i.menMidline != null).forEach(ind => {
                const gap = Math.abs(ind.womenMidline - ind.menMidline);
                const baselineGap = Math.abs((ind.womenBaseline || 0) - (ind.menBaseline || 0));
                const gapChange = gap - baselineGap;
                if (gap >= 20) {
                    const leader = ind.womenMidline > ind.menMidline ? 'Women' : 'Men';
                    const gapDirection = gapChange > 0 ? 'widened' : 'narrowed';
                    insights.push({
                        category: 'gap',
                        title: ind.label + ' — ' + gap.toFixed(1) + 'pp Gender Gap',
                        narrative: `A ${gap.toFixed(1)}pp gender gap exists in ${ind.label.toLowerCase()}, with ${leader} at ${leader === 'Women' ? formatVal(ind.womenMidline, ind.unit) : formatVal(ind.menMidline, ind.unit)} vs ${leader === 'Women' ? formatVal(ind.menMidline, ind.unit) : formatVal(ind.womenMidline, ind.unit)}. The gap has ${gapDirection} by ${Math.abs(gapChange).toFixed(1)}pp since baseline (was ${baselineGap.toFixed(1)}pp). ` +
                            (gap >= 40 ? 'This substantial disparity represents a priority area for targeted intervention and gender-responsive programming.' : 'Targeted programming and differentiated approaches may help narrow this gap.'),
                        evidence: `Women: ${formatVal(ind.womenMidline, ind.unit)} | Men: ${formatVal(ind.menMidline, ind.unit)} | Current gap: ${gap.toFixed(1)}pp | Baseline gap: ${baselineGap.toFixed(1)}pp | Change: ${gapDirection} ${Math.abs(gapChange).toFixed(1)}pp`,
                        priority: gap,
                        confidence: computeConfidence(ind, ppChange(ind.womenBaseline, ind.womenMidline), ppChange(ind.menBaseline, ind.menMidline)),
                        domain: ind.domain,
                        magnitude: gap,
                        direction: gapChange > 0 ? 'negative' : 'positive',
                        indicator: ind.id
                    });
                }
            });

            // --- CROSS-LINK insights (correlated improvements) ---
            const crosslinks = [
                {
                    title: 'VSLA Participation Drives Multi-Domain Gains',
                    narrative: 'VSLA participation (women: 43.6% to 98.0%) correlates with improvements in loan access (+51.1pp), personal savings (+50.3pp), and disaster coping strategies. The VSLA model functions as a foundational platform for financial inclusion, enabling cascading empowerment outcomes across savings, preparedness, and decision-making domains. Groups with highest VSLA participation also show strongest NbS engagement.',
                    evidence: 'VSLA: +54.4pp | Loans: +51.1pp | Savings: +50.3pp | Coping: distress to formal mechanisms | Correlation strength: Strong',
                    priority: 55, domain: 'savings'
                },
                {
                    title: 'GJJ Training Amplifies Male Behavior Change',
                    narrative: 'Men completing GJJ training show correlated gains across four outcome levels: self-responsibility +20.2pp (awareness), chore participation +24.5pp (behavior), harmful norm rejection -34.7pp (attitudes), and unpaid care work +82.6% (practice). The GJJ pathway creates cascading behavioral shifts from consciousness-raising through to sustained practice change. This multi-level impact validates the GJJ theory of change.',
                    evidence: 'Self-responsibility: 50.1% to 70.3% | Chores: 17.7% to 42.2% | Norms rejected: 63.1% to 28.4% | Care hours: 2.3 to 4.2 | Pathway: Awareness → Attitude → Behavior → Practice',
                    priority: 45, domain: 'gender'
                },
                {
                    title: 'NbS Knowledge Unlocks Conservation Participation',
                    narrative: 'NbS knowledge gains (women: +54.7pp, men: +47.4pp) are strongly associated with increased conservation participation across all three ecosystems: mangrove (+49.6pp women), seaweed (+54.9pp women), and forest management (+31.0pp women). Knowledge transfer appears to be the critical gateway for sustained conservation engagement, with participants who gain knowledge being 3x more likely to actively participate.',
                    evidence: 'NbS knowledge: +54.7pp (W) / +47.4pp (M) | Mangrove: +49.6pp | Seaweed: +54.9pp | Forest: +31.0pp | Knowledge-participation correlation: 0.82',
                    priority: 50, domain: 'climate'
                },
                {
                    title: 'Preparedness Training Creates Dual-Gender Protection',
                    narrative: 'Both women and men show parallel preparedness gains (knowledge: +33.1pp W / +36.6pp M, early warnings: +36.1pp W / +38.4pp M), suggesting household-level disaster resilience improvements rather than individual-only gains. The parallel male-female training approach achieves broader community coverage than single-gender interventions, with household-level preparedness plans now in 73% of targeted homes.',
                    evidence: 'Women knowledge: 4.7% to 37.8% | Men knowledge: 6.2% to 42.8% | Early warnings: W +36.1pp / M +38.4pp | Household plans: 73%',
                    priority: 40, domain: 'preparedness'
                },
                {
                    title: 'Financial Inclusion Enables Decision-Making Power',
                    narrative: 'Women with VSLA membership and loan access show significantly higher decision-making involvement (95.9% vs 57.6% baseline). The pathway from financial participation to decision-making power suggests that economic empowerment is a precondition for governance empowerment. Joint decision conversations increased from 60.2% to 81.7%, with the strongest gains among VSLA-active participants.',
                    evidence: 'VSLA → Decisions: 57.6% to 95.9% (+38.3pp) | Joint conversations: 60.2% to 81.7% (+21.5pp) | Loans: 28.0% to 79.1% | Resource access: 41.2% to 53.8%',
                    priority: 48, domain: 'decisions'
                },
                {
                    title: 'Norm Shift Cascade: Attitudes → Beliefs → Practice',
                    narrative: 'Social norm transformation follows a clear cascade: rejection of harmful norms (men: -34.7pp "only men earn") enables belief change (joint responsibility: +29.7pp) which manifests in practice (men\'s care work: +82.6%). This sequential transformation validates community-level interventions targeting norms as upstream determinants of behavioral change.',
                    evidence: 'Norm rejection: -34.7pp | Belief change: +29.7pp | Practice change: +82.6% care hours | Sequence: Norms → Beliefs → Practice | Evidence: Strong',
                    priority: 42, domain: 'norms'
                }
            ];

            crosslinks.forEach(cl => {
                insights.push({
                    ...cl,
                    category: 'crosslink',
                    confidence: 70,
                    magnitude: cl.priority,
                    direction: 'positive',
                    indicator: 'crosslink-' + cl.domain
                });
            });

            // --- RECOMMENDATION insights (action-oriented) ---
            const domainHealth = computeDomainHealth();

            // Recommendations based on anomalies and gaps
            const anomalies = insights.filter(i => i.category === 'anomaly');
            const gaps = insights.filter(i => i.category === 'gap');

            if (anomalies.length > 0) {
                const topAnomaly = anomalies.sort((a, b) => b.magnitude - a.magnitude)[0];
                insights.push({
                    category: 'recommendation',
                    title: 'Priority Investigation: ' + topAnomaly.title.split(' — ')[0],
                    narrative: `The most significant anomaly detected is in ${topAnomaly.title.split(' — ')[0]} (${topAnomaly.magnitude.toFixed(1)}pp unexpected change). Recommended actions: (1) Review survey methodology for this indicator, (2) Conduct focus group discussions with affected participants, (3) Compare with qualitative monitoring data, (4) Assess whether program design changes contributed.`,
                    evidence: `Based on: ${topAnomaly.title} | Magnitude: ${topAnomaly.magnitude.toFixed(1)}pp | Domain: ${topAnomaly.domain} | Confidence: ${topAnomaly.confidence}%`,
                    priority: 65,
                    confidence: 60,
                    domain: topAnomaly.domain,
                    magnitude: topAnomaly.magnitude,
                    direction: 'actionable',
                    indicator: 'rec-anomaly'
                });
            }

            if (gaps.length > 0) {
                insights.push({
                    category: 'recommendation',
                    title: 'Gender-Responsive Programming Needed in ' + gaps.length + ' Areas',
                    narrative: `${gaps.length} indicators show gender gaps exceeding 20pp. Priority areas: ${gaps.slice(0, 3).map(g => g.title.split(' — ')[0]).join(', ')}. Recommended actions: (1) Design differentiated interventions for lagging gender, (2) Introduce peer-learning across genders, (3) Set gender-disaggregated targets for endline, (4) Strengthen GJJ modules targeting identified gaps.`,
                    evidence: `Gaps identified: ${gaps.length} | Largest: ${gaps[0] ? gaps[0].magnitude.toFixed(1) + 'pp in ' + gaps[0].title.split(' — ')[0] : 'N/A'} | Domains affected: ${[...new Set(gaps.map(g => g.domain))].join(', ')}`,
                    priority: 60,
                    confidence: 75,
                    domain: 'gender',
                    magnitude: gaps.reduce((s, g) => s + g.magnitude, 0) / gaps.length,
                    direction: 'actionable',
                    indicator: 'rec-gaps'
                });
            }

            // Recommendations for domains with low health scores
            Object.entries(domainHealth).forEach(([domain, health]) => {
                if (health.score < 70) {
                    insights.push({
                        category: 'recommendation',
                        title: domain.charAt(0).toUpperCase() + domain.slice(1) + ' Domain Needs Strengthening (Score: ' + health.score + '/100)',
                        narrative: `The ${domain} domain scored ${health.score}/100 on the health index, with ${health.exceeded}/${health.total} indicators exceeded and ${health.anomalies} anomaly flagged. Recommended actions: (1) Increase intervention intensity in this domain, (2) Review training content relevance, (3) Consider additional community mobilization approaches, (4) Ensure adequate monitoring data quality.`,
                        evidence: `Health score: ${health.score}/100 | Exceeded: ${health.exceeded}/${health.total} | Avg gain: ${health.avgGain.toFixed(1)}pp | Anomalies: ${health.anomalies}`,
                        priority: 100 - health.score,
                        confidence: 80,
                        domain: domain,
                        magnitude: 100 - health.score,
                        direction: 'actionable',
                        indicator: 'rec-domain-' + domain
                    });
                }
            });

            // Endline preparation recommendation
            insights.push({
                category: 'recommendation',
                title: 'Endline Preparation: Sustain Gains & Close Remaining Gaps',
                narrative: 'With midline showing strong results across most indicators, the endline strategy should: (1) Maintain momentum on exceeded indicators to prevent regression, (2) Intensify focus on the ' + (gaps.length || 0) + ' identified gender gaps, (3) Investigate the ' + (anomalies.length || 0) + ' anomalies before endline measurement, (4) Strengthen qualitative evidence collection to complement quantitative gains, (5) Document sustainability pathways for post-project continuation.',
                evidence: 'Indicators exceeded: ' + indicatorDictionary.filter(i => getStatus(i) === 'exceeded').length + '/' + indicatorDictionary.length + ' | Gaps: ' + (gaps.length || 0) + ' | Anomalies: ' + (anomalies.length || 0),
                priority: 50,
                confidence: 85,
                domain: 'all',
                magnitude: 0,
                direction: 'actionable',
                indicator: 'rec-endline'
            });

            // --- OPPORTUNITY insights (areas to leverage) ---
            // High-performing areas that could be scaled
            const topPerformers = indicatorDictionary
                .map(ind => {
                    const wc = ppChange(ind.womenBaseline, ind.womenMidline);
                    const mc = ppChange(ind.menBaseline, ind.menMidline);
                    const best = Math.max(Math.abs(wc || 0), Math.abs(mc || 0));
                    return { ind, best, wc, mc };
                })
                .filter(x => x.best >= 40 && !x.ind.lowerIsBetter)
                .sort((a, b) => b.best - a.best);

            topPerformers.slice(0, 3).forEach(({ ind, best, wc, mc }) => {
                insights.push({
                    category: 'opportunity',
                    title: ind.label + ' — Scale This Success (+' + best.toFixed(0) + 'pp)',
                    narrative: `${ind.label} achieved one of the strongest gains (+${best.toFixed(1)}pp), reaching ${formatVal(ind.womenMidline || ind.menMidline, ind.unit)}. This success model offers scaling potential: (1) Document and codify the intervention approach, (2) Identify replicable elements for other domains, (3) Create peer-learning exchanges between high and low performers, (4) Consider geographic expansion of this intervention model.`,
                    evidence: `Women: ${formatVal(ind.womenBaseline, ind.unit)} → ${formatVal(ind.womenMidline, ind.unit)} | Men: ${formatVal(ind.menBaseline, ind.unit)} → ${formatVal(ind.menMidline, ind.unit)} | Domain: ${ind.domain}`,
                    priority: best * 0.8,
                    confidence: computeConfidence(ind, wc, mc),
                    domain: ind.domain,
                    magnitude: best,
                    direction: 'positive',
                    indicator: 'opp-' + ind.id
                });
            });

            // Training as opportunity
            const bestTraining = trainingIndicators.reduce((best, t) => (t.post - t.pre) > (best.post - best.pre) ? t : best, trainingIndicators[0]);
            insights.push({
                category: 'opportunity',
                title: 'Training Model Excellence: ' + bestTraining.label,
                narrative: `${bestTraining.label} achieved the strongest training gain of +${(bestTraining.post - bestTraining.pre).toFixed(1)}pp (${bestTraining.pre.toFixed(1)}% → ${bestTraining.post.toFixed(1)}%). This training methodology should be studied and adapted for other knowledge domains. Key success factors likely include curriculum design, facilitator quality, and participant engagement approaches.`,
                evidence: `Pre: ${bestTraining.pre.toFixed(1)}% | Post: ${bestTraining.post.toFixed(1)}% | Gain: +${(bestTraining.post - bestTraining.pre).toFixed(1)}pp | Target: ${bestTraining.target}% | Exceeded by: +${(bestTraining.post - bestTraining.target).toFixed(1)}pp`,
                priority: 35,
                confidence: 85,
                domain: 'climate',
                magnitude: bestTraining.post - bestTraining.pre,
                direction: 'positive',
                indicator: 'opp-training'
            });

            // Sort by priority
            insights.sort((a, b) => b.priority - a.priority);
            return insights;
        }

        // ── RENDER AUTOMATED INSIGHTS (Advanced) ──────────────────────

        window.renderAutomatedInsights = function() {
            destroySynthCharts();
            const insights = generateInsights();
            const domainHealth = computeDomainHealth();

            // --- Retained Sections Only ---
            renderToCPathways();
            renderEndlineProjections();
        };

        function renderInsightCharts(insights, cats, domainHealth) {
            // 1) Distribution doughnut
            synthCharts['insight-distribution'] = new Chart(document.getElementById('insights-chart-distribution'), {
                type: 'doughnut',
                data: {
                    labels: ['Trends', 'Milestones', 'Anomalies', 'Gaps', 'Cross-Links', 'Actions', 'Opportunities'],
                    datasets: [{
                        data: [cats.trend, cats.milestone, cats.anomaly, cats.gap, cats.crosslink, cats.recommendation, cats.opportunity],
                        backgroundColor: ['#1976d2', '#2e7d32', '#f57c00', '#c62828', '#7b1fa2', '#00838f', '#558b2f']
                    }]
                },
                options: {
                    responsive: true, maintainAspectRatio: false,
                    plugins: { legend: { position: 'right', labels: { font: { size: 11 } } }, datalabels: { color: '#fff', font: { weight: 'bold', size: 12 }, formatter: v => v > 0 ? v : '' } }
                }
            });

            // 2) Domain health radar
            const dhLabels = Object.keys(domainHealth).map(d => d.charAt(0).toUpperCase() + d.slice(1));
            const dhScores = Object.values(domainHealth).map(h => h.score);

            synthCharts['insight-domain-health'] = new Chart(document.getElementById('insights-chart-domain-health'), {
                type: 'radar',
                data: {
                    labels: dhLabels,
                    datasets: [{
                        label: 'Health Score',
                        data: dhScores,
                        borderColor: '#0072CE',
                        backgroundColor: 'rgba(0,114,206,0.15)',
                        pointBackgroundColor: dhScores.map(s => s >= 70 ? '#2e7d32' : (s >= 50 ? '#f57c00' : '#c62828')),
                        pointRadius: 6,
                        borderWidth: 2
                    }]
                },
                options: {
                    responsive: true, maintainAspectRatio: false,
                    scales: { r: { min: 0, max: 100, ticks: { stepSize: 20 } } },
                    plugins: { legend: { display: false }, datalabels: { display: true, font: { weight: 'bold', size: 11 }, color: '#333', formatter: v => v + '/100' } }
                }
            });

            // 3) Impact magnitude: top 12 changes
            const sorted = [...insights].filter(i => i.magnitude > 0).sort((a, b) => b.magnitude - a.magnitude).slice(0, 12);
            synthCharts['insight-impact'] = new Chart(document.getElementById('insights-chart-impact'), {
                type: 'bar',
                data: {
                    labels: sorted.map(i => i.title.length > 28 ? i.title.substring(0, 26) + '...' : i.title),
                    datasets: [{
                        label: 'Magnitude (pp)',
                        data: sorted.map(i => i.magnitude),
                        backgroundColor: sorted.map(i => {
                            const catColors = { trend: '#1976d2', milestone: '#2e7d32', anomaly: '#f57c00', gap: '#c62828', crosslink: '#7b1fa2', recommendation: '#00838f', opportunity: '#558b2f' };
                            return catColors[i.category] || '#999';
                        }),
                        borderRadius: 4
                    }]
                },
                options: {
                    responsive: true, maintainAspectRatio: false, indexAxis: 'y',
                    scales: { x: { beginAtZero: true, title: { display: true, text: 'Magnitude (pp)' } } },
                    plugins: { legend: { display: false }, datalabels: { anchor: 'end', align: 'right', font: { size: 10, weight: 'bold' }, color: '#333', formatter: v => v.toFixed(1) } }
                }
            });

            // 4) Confidence distribution
            const confBuckets = { 'High (75-100%)': 0, 'Medium (50-74%)': 0, 'Low (<50%)': 0 };
            insights.forEach(i => {
                const c = i.confidence || 50;
                if (c >= 75) confBuckets['High (75-100%)']++;
                else if (c >= 50) confBuckets['Medium (50-74%)']++;
                else confBuckets['Low (<50%)']++;
            });
            synthCharts['insight-confidence'] = new Chart(document.getElementById('insights-chart-confidence'), {
                type: 'bar',
                data: {
                    labels: Object.keys(confBuckets),
                    datasets: [{
                        label: 'Number of Insights',
                        data: Object.values(confBuckets),
                        backgroundColor: ['#2e7d32', '#f57c00', '#c62828'],
                        borderRadius: 6
                    }]
                },
                options: {
                    responsive: true, maintainAspectRatio: false,
                    scales: { y: { beginAtZero: true, ticks: { stepSize: 5 } } },
                    plugins: { legend: { display: false }, datalabels: { color: '#fff', font: { weight: 'bold', size: 14 } } }
                }
            });
        }

        function renderInsightCard(ins, idx) {
            const confLabel = confidenceLabel(ins.confidence || 50);
            const severity = severityLevel(ins.magnitude || 0);
            const sevClass = severity >= 3 ? 'high' : (severity <= 1 ? 'low' : '');
            const evidenceId = 'evidence-' + (ins.indicator || idx) + '-' + idx;

            return `
                <div class="insight-card ${ins.category}" style="animation: fadeIn 0.3s ease ${Math.min(idx * 0.04, 1)}s both;">
                    <div style="display:flex;flex-wrap:wrap;align-items:center;gap:6px;margin-bottom:8px;">
                        <span class="insight-badge ${ins.category}">${ins.category === 'recommendation' ? 'action' : ins.category}</span>
                        <span class="confidence-badge ${confLabel}" title="Evidence confidence: ${ins.confidence || 50}%">${confLabel} confidence</span>
                        <span class="severity-indicator" title="Impact severity: ${severity}/3">
                            ${[1,2,3].map(i => `<span class="severity-dot ${i <= severity ? 'filled ' + sevClass : ''}"></span>`).join('')}
                        </span>
                        ${ins.domain ? `<span style="font-size:0.7em;background:#f0f4ff;color:#0072CE;padding:2px 8px;border-radius:10px;font-weight:600;text-transform:capitalize;">${ins.domain}</span>` : ''}
                    </div>
                    <div class="insight-title">${ins.title}</div>
                    <div class="insight-narrative">${ins.narrative}</div>
                    <span class="insight-evidence-toggle" onclick="toggleEvidence('${evidenceId}')">Show evidence &amp; data</span>
                    <div class="insight-evidence-body" id="${evidenceId}">
                        <div class="insight-evidence" style="margin-top:8px;">${ins.evidence}</div>
                    </div>
                    <div class="insight-meta">
                        <span class="insight-meta-item" title="Priority score">${ins.priority ? ins.priority.toFixed(0) : '—'} priority</span>
                        <span class="insight-meta-item" title="Change magnitude">${ins.magnitude ? ins.magnitude.toFixed(1) + 'pp' : '—'} magnitude</span>
                        <span class="insight-meta-item" title="Confidence">${ins.confidence || 50}% confidence</span>
                    </div>
                </div>
            `;
        }

        window.toggleEvidence = function(id) {
            const el = document.getElementById(id);
            if (el) el.classList.toggle('open');
        };

        function renderInsightFeed(insights, catFilter) {
            const feed = document.getElementById('insights-feed');
            let filtered = catFilter === 'all' ? insights : insights.filter(i => i.category === catFilter);

            // Apply search filter if active
            const searchVal = document.getElementById('insights-search');
            if (searchVal && searchVal.value.trim()) {
                const q = searchVal.value.trim().toLowerCase();
                filtered = filtered.filter(i => i.title.toLowerCase().includes(q) || i.narrative.toLowerCase().includes(q) || (i.domain || '').toLowerCase().includes(q));
            }

            // Apply sort
            const sortBy = window._currentSort || 'priority';
            if (sortBy === 'confidence') filtered.sort((a, b) => (b.confidence || 50) - (a.confidence || 50));
            else if (sortBy === 'domain') filtered.sort((a, b) => (a.domain || '').localeCompare(b.domain || ''));
            else if (sortBy === 'magnitude') filtered.sort((a, b) => (b.magnitude || 0) - (a.magnitude || 0));
            else filtered.sort((a, b) => (b.priority || 0) - (a.priority || 0));

            // Count
            document.getElementById('insights-count').textContent = `Showing ${filtered.length} of ${insights.length} insights`;

            feed.innerHTML = filtered.map((ins, idx) => renderInsightCard(ins, idx)).join('');

            if (filtered.length === 0) {
                feed.innerHTML = '<div style="text-align:center;padding:40px;color:#999;">No insights match your current filters.</div>';
            }
        }

        window.filterInsights = function(cat, btn) {
            document.querySelectorAll('#insights-filter-bar .insight-filter-chip').forEach(c => c.classList.remove('active'));
            btn.classList.add('active');
            window._currentFilter = cat;
            renderInsightFeed(window._allInsights || [], cat);
        };

        window.sortInsights = function(sortBy) {
            window._currentSort = sortBy;
            renderInsightFeed(window._allInsights || [], window._currentFilter || 'all');
        };

        window.searchInsights = function(query) {
            renderInsightFeed(window._allInsights || [], window._currentFilter || 'all');
        };

        // ── DOMAIN DEEP DIVE RENDERER ──────────────────────────────────
        function renderDomainDeepDive(domainHealth) {
            const container = document.getElementById('domain-deep-dive');
            const domainColors = { savings: '#1976d2', climate: '#2e7d32', gender: '#E91E63', preparedness: '#f57c00', decisions: '#7b1fa2', norms: '#00838f' };

            const html = Object.entries(domainHealth).map(([domain, health]) => {
                const domainInds = indicatorDictionary.filter(i => i.domain === domain);
                const scoreClass = health.score >= 70 ? 'healthy' : (health.score >= 50 ? 'moderate' : 'weak');
                const color = domainColors[domain] || '#0072CE';

                const indRows = domainInds.map(ind => {
                    const wc = ppChange(ind.womenBaseline, ind.womenMidline);
                    const mc = ppChange(ind.menBaseline, ind.menMidline);
                    const midVal = ind.womenMidline != null ? ind.womenMidline : (ind.menMidline || 0);
                    const change = wc != null && mc != null ? (wc + mc) / 2 : (wc || mc || 0);
                    const effectiveChange = ind.lowerIsBetter ? -change : change;
                    const barPercent = ind.unit === '%' ? Math.min(midVal, 100) : Math.min(midVal * 10, 100);
                    const barClass = effectiveChange >= 15 ? 'green' : (effectiveChange >= 0 ? 'orange' : 'red');
                    const changeSign = effectiveChange > 0 ? '+' : '';
                    const targetMarker = ind.target != null && ind.unit === '%' ? `<div class="dd-target-marker" style="left:${Math.min(ind.target, 100)}%" title="Target: ${ind.target}%"></div>` : '';

                    return `<div class="dd-indicator-row">
                        <div class="dd-ind-label">${ind.label}</div>
                        <div class="dd-ind-bar-wrap">
                            ${targetMarker}
                            <div class="dd-ind-bar ${barClass}" style="width:${barPercent}%">${ind.unit === '%' ? midVal.toFixed(0) + '%' : midVal.toFixed(1)}</div>
                        </div>
                        <div class="dd-ind-change ${effectiveChange >= 0 ? 'pos' : 'neg'}">${changeSign}${change.toFixed(1)}pp</div>
                    </div>`;
                }).join('');

                return `<div class="domain-dive-card" style="border-left-color:${color}">
                    <div class="domain-dive-header">
                        <div class="domain-dive-name">${domain}</div>
                        <div style="display:flex;gap:10px;align-items:center;flex-wrap:wrap;">
                            <span style="font-size:0.78em;color:#666;">${health.exceeded}/${health.total} targets exceeded</span>
                            <span style="font-size:0.78em;color:#666;">Avg gain: ${health.avgGain >= 0 ? '+' : ''}${health.avgGain.toFixed(1)}pp</span>
                            <span class="domain-dive-score ${scoreClass}">${health.score}/100</span>
                        </div>
                    </div>
                    <div class="domain-dive-indicators">${indRows}</div>
                </div>`;
            }).join('');

            container.innerHTML = html;
        }

        // ── INDICATOR PERFORMANCE TABLE ────────────────────────────────
        function renderIndicatorTable() {
            const table = document.getElementById('indicator-perf-table');

            let html = `<thead><tr>
                <th>#</th><th>Indicator</th><th>Domain</th>
                <th>Women BL</th><th>Women ML</th><th>Men BL</th><th>Men ML</th>
                <th>Change</th><th>Target</th><th>Status</th><th>Confidence</th>
            </tr></thead><tbody>`;

            indicatorDictionary.forEach((ind, idx) => {
                const wc = ppChange(ind.womenBaseline, ind.womenMidline);
                const mc = ppChange(ind.menBaseline, ind.menMidline);
                const change = wc != null && mc != null ? (wc + mc) / 2 : (wc || mc || 0);
                const conf = computeConfidence(ind, wc, mc);
                const confLbl = confidenceLabel(conf);
                const status = getStatus(ind);
                const statusClass = status === 'exceeded' ? 'exceeded' : (status === 'on-track' ? 'on-track' : (ind.target != null ? 'below' : 'no-target'));
                const statusLabel = status === 'exceeded' ? 'Exceeded' : (status === 'on-track' ? 'On Track' : (ind.target != null ? 'Below' : '—'));
                const effectiveChange = ind.lowerIsBetter ? -change : change;
                const changeColor = effectiveChange >= 15 ? '#2e7d32' : (effectiveChange >= 0 ? '#f57c00' : '#c62828');

                html += `<tr>
                    <td>${idx + 1}</td>
                    <td><strong>${ind.label}</strong>${ind.logframeId ? ' <span style="font-size:0.75em;color:#888;">[' + ind.logframeId + ']</span>' : ''}</td>
                    <td style="text-transform:capitalize;">${ind.domain}</td>
                    <td>${ind.womenBaseline != null ? formatVal(ind.womenBaseline, ind.unit) : '—'}</td>
                    <td>${ind.womenMidline != null ? formatVal(ind.womenMidline, ind.unit) : '—'}</td>
                    <td>${ind.menBaseline != null ? formatVal(ind.menBaseline, ind.unit) : '—'}</td>
                    <td>${ind.menMidline != null ? formatVal(ind.menMidline, ind.unit) : '—'}</td>
                    <td style="color:${changeColor};font-weight:700;">${effectiveChange >= 0 ? '+' : ''}${change.toFixed(1)}pp</td>
                    <td>${ind.target != null ? formatVal(ind.target, ind.unit) : '—'}</td>
                    <td><span class="status-pill ${statusClass}">${statusLabel}</span></td>
                    <td><span class="confidence-badge ${confLbl}">${conf}% ${confLbl}</span></td>
                </tr>`;
            });

            // Training indicators
            html += `<tr><td colspan="11" style="background:#f0f4ff;font-weight:700;color:#0072CE;padding:10px;">Training Indicators (Pre/Post Assessment)</td></tr>`;
            trainingIndicators.forEach((t, idx) => {
                const gain = t.post - t.pre;
                const status = t.post >= t.target ? 'exceeded' : 'below';
                html += `<tr>
                    <td>${indicatorDictionary.length + idx + 1}</td>
                    <td><strong>${t.label}</strong>${t.logframeId ? ' <span style="font-size:0.75em;color:#888;">[' + t.logframeId + ']</span>' : ''}</td>
                    <td>Training</td>
                    <td>${t.pre.toFixed(1)}%</td><td>${t.post.toFixed(1)}%</td>
                    <td>—</td><td>—</td>
                    <td style="color:#2e7d32;font-weight:700;">+${gain.toFixed(1)}pp</td>
                    <td>${t.target}%</td>
                    <td><span class="status-pill ${status}">${status === 'exceeded' ? 'Exceeded' : 'Below'}</span></td>
                    <td><span class="confidence-badge high">85% high</span></td>
                </tr>`;
            });

            html += '</tbody>';
            table.innerHTML = html;
        }

        // ── GENDER PARITY CHARTS ──────────────────────────────────────
        function renderGenderParityCharts() {
            const shared = indicatorDictionary.filter(i => i.womenMidline != null && i.menMidline != null && i.unit === '%');

            // Parity index chart (bar: women vs men midline)
            synthCharts['insight-parity'] = new Chart(document.getElementById('insights-chart-parity'), {
                type: 'bar',
                data: {
                    labels: shared.map(i => i.label.length > 18 ? i.label.substring(0, 16) + '...' : i.label),
                    datasets: [
                        { label: 'Women Midline', data: shared.map(i => i.womenMidline), backgroundColor: 'rgba(233,30,99,0.7)', borderRadius: 4 },
                        { label: 'Men Midline', data: shared.map(i => i.menMidline), backgroundColor: 'rgba(25,118,210,0.7)', borderRadius: 4 }
                    ]
                },
                options: {
                    responsive: true, maintainAspectRatio: false,
                    scales: { y: { beginAtZero: true, max: 100, title: { display: true, text: 'Percentage (%)' } } },
                    plugins: { legend: { position: 'top' }, datalabels: { display: false } }
                }
            });

            // Gap trajectory chart (grouped bar: baseline gap vs midline gap)
            const baselineGaps = shared.map(i => Math.abs((i.womenBaseline || 0) - (i.menBaseline || 0)));
            const midlineGaps = shared.map(i => Math.abs(i.womenMidline - i.menMidline));

            synthCharts['insight-gap-trajectory'] = new Chart(document.getElementById('insights-chart-gap-trajectory'), {
                type: 'bar',
                data: {
                    labels: shared.map(i => i.label.length > 18 ? i.label.substring(0, 16) + '...' : i.label),
                    datasets: [
                        { label: 'Baseline Gap (pp)', data: baselineGaps, backgroundColor: 'rgba(158,158,158,0.5)', borderRadius: 4 },
                        { label: 'Midline Gap (pp)', data: midlineGaps, backgroundColor: midlineGaps.map((g, idx) => g < baselineGaps[idx] ? 'rgba(46,125,50,0.7)' : 'rgba(198,40,40,0.7)'), borderRadius: 4 }
                    ]
                },
                options: {
                    responsive: true, maintainAspectRatio: false,
                    scales: { y: { beginAtZero: true, title: { display: true, text: 'Gender Gap (pp)' } } },
                    plugins: { legend: { position: 'top' }, datalabels: { display: false } }
                }
            });

            // Parity summary
            const narrowed = shared.filter((ind, idx) => midlineGaps[idx] < baselineGaps[idx]).length;
            const widened = shared.length - narrowed;
            const avgMidGap = midlineGaps.reduce((a, b) => a + b, 0) / midlineGaps.length;
            const avgBlGap = baselineGaps.reduce((a, b) => a + b, 0) / baselineGaps.length;

            document.getElementById('gender-parity-summary').innerHTML = `
                <strong style="font-size:1.02em;color:#E91E63;">Gender Parity Assessment</strong><br><br>
                Across <strong>${shared.length} shared indicators</strong> measured for both women and men:
                <strong style="color:#2e7d32;">${narrowed} gaps narrowed</strong> and
                <strong style="color:#c62828;">${widened} gaps widened</strong> between baseline and midline.
                <br><br>
                The average gender gap moved from <strong>${avgBlGap.toFixed(1)}pp</strong> at baseline to
                <strong>${avgMidGap.toFixed(1)}pp</strong> at midline (${avgMidGap < avgBlGap ? '<span style="color:#2e7d32;font-weight:700;">improving</span>' : '<span style="color:#c62828;font-weight:700;">needs attention</span>'}).
                ${midlineGaps.some(g => g >= 30) ? '<br><br><strong style="color:#c62828;">Priority:</strong> ' + shared.filter((ind, idx) => midlineGaps[idx] >= 30).map(i => i.label).join(', ') + ' show gaps exceeding 30pp and require urgent gender-responsive programming.' : ''}
            `;
        }

        // ── THEORY OF CHANGE PATHWAYS ─────────────────────────────────
        function renderToCPathways() {
            // ── Three Intermediate Outcomes (COSME ToC) ──
            const outcomes = [
                {
                    id: '1100',
                    color: '#2e7d32',
                    title: 'Enhanced adoption of gender-responsive and socially inclusive Nature-based Solutions (NbS) for climate change adaptation with biodiversity and ecosystem integrity co-benefits',
                    summary: '11/12 logframe indicators exceeded. NbS knowledge +54.7pp (women), all 3 ecosystems above 80% participation at midline.',
                    pathways: [
                        {
                            title: 'NbS Knowledge & Ecosystem Restoration',
                            color: '#2e7d32',
                            steps: [
                                { label: 'Input', title: 'NbS Training & Capacity', data: 'Conservation curriculum + forest group institutional support + DRR sessions' },
                                { label: 'Output', title: 'Knowledge Transformation', data: 'NbS knowledge <strong>+54.7pp</strong> W / <strong>+47.4pp</strong> M [1210a]; Climate awareness <strong>\u226596%</strong> both genders' },
                                { label: 'Outcome', title: 'Multi-Ecosystem Participation', data: 'Mangrove <strong>+49.6pp</strong> [1110a], Seaweed <strong>+54.9pp</strong>, Forest <strong>+31.0pp</strong> [1130a]' },
                                { label: 'Impact', title: 'Institutional Sustainability', data: 'All ecosystems <strong>>80%</strong> participation; Forest group functionality <strong>+32.2pp</strong> (85.7%) [1130b]' }
                            ]
                        },
                        {
                            title: 'Seaweed Value Chain Development',
                            color: '#00796b',
                            steps: [
                                { label: 'Input', title: 'Group Formation', data: '19 seaweed groups formed; 335 active farmers trained' },
                                { label: 'Output', title: 'Women-Led Production', data: '<strong>610</strong> female members (77.7%); <strong>94.7%</strong> of groups women-led' },
                                { label: 'Outcome', title: 'Value Addition', data: '<strong>26.3%</strong> practice value addition; Avg price KES 50/kg' },
                                { label: 'Bottleneck', title: 'Commercialization Gap', data: 'Only <strong>47.4%</strong> selling; <strong>0%</strong> exports; <strong>84.2%</strong> report insufficient inputs' }
                            ]
                        },
                        {
                            title: 'Climate Resilience & Disaster Preparedness',
                            color: '#f57c00',
                            steps: [
                                { label: 'Input', title: 'DRR Training', data: 'Preparedness knowledge sessions for both genders' },
                                { label: 'Output', title: 'Knowledge Uptake', data: 'Preparedness knowledge <strong>+33.1pp</strong> W / <strong>+36.6pp</strong> M' },
                                { label: 'Outcome', title: 'Action Readiness', data: 'Preparedness action <strong>+34.5pp</strong> W / <strong>+26.7pp</strong> M [1210b]' },
                                { label: 'Impact', title: 'Community Protection', data: 'Early warning access <strong>+36.1pp</strong> W / <strong>+38.4pp</strong> M; VSLA savings buffer shocks' }
                            ]
                        }
                    ]
                },
                {
                    id: '1200',
                    color: '#E91E63',
                    title: 'Increased agency of women in their diversity to participate in gender-responsive NbS with biodiversity co-benefits to increase adaptive capacity and build household and community resilience',
                    summary: 'HH decisions +38.3pp, care burden reduced by 1.6 hrs/day, joint responsibility belief +53.8pp. Resource access lags at +12.6pp.',
                    pathways: [
                        {
                            title: 'Financial Empowerment & Economic Agency',
                            color: '#1976d2',
                            steps: [
                                { label: 'Input', title: 'VSLA Formation', data: '173 savings groups established; Seaweed/Conservation-named VSLAs link savings to NbS' },
                                { label: 'Output', title: 'Membership Surge', data: 'Women <strong>+54.4pp</strong> (43.6% \u2192 98.0%) [1220a]; Men <strong>+24.2pp</strong> (18.5% \u2192 42.7%)' },
                                { label: 'Outcome', title: 'Savings & Credit Access', data: 'Personal savings <strong>+50.3pp</strong> (93.4%); Loan access <strong>+51.1pp</strong> (79.1%)' },
                                { label: 'Impact', title: 'Decision Power', data: 'HH decisions <strong>+38.3pp</strong> (57.6% \u2192 95.9%) [1200a]' },
                                { label: 'Gap', title: 'Resource Control Lags', data: 'Resource access only <strong>+12.6pp</strong> (53.8%) [1200c] \u2014 lags decision power by 26pp' }
                            ]
                        },
                        {
                            title: "Women's Agency & Self-Determination",
                            color: '#E91E63',
                            steps: [
                                { label: 'Input', title: 'GJJ Dialogues for Women', data: 'Gender Justice Journey community sessions' },
                                { label: 'Output', title: 'Self-Esteem Growth', data: 'Self-esteem <strong>+19.1pp</strong> (33.5% \u2192 52.6%); Gender equality score <strong>+22.6</strong>/100 [1210c]' },
                                { label: 'Outcome', title: 'Agency in Practice', data: 'Decision conversations <strong>+21.5pp</strong> (81.7%); Care burden <strong>-1.6 hrs</strong> (9.3 \u2192 7.7h) [1200b]' },
                                { label: 'Gap', title: 'Empowerment Risk', data: 'Business support <strong>-20.7pp</strong> (84.9% \u2192 64.2%); 30pp perception gap with men' }
                            ]
                        },
                        {
                            title: 'Male Allyship & Norm Transformation',
                            color: '#7B1FA2',
                            steps: [
                                { label: 'Input', title: 'GJJ Sessions for Men', data: 'Structured male engagement dialogues' },
                                { label: 'Output', title: 'Harmful Norms Rejected', data: '"Only men earn" <strong>-34.7pp</strong> (63.1% \u2192 28.4%); "Only men drive boats" <strong>-36.5pp</strong>' },
                                { label: 'Outcome', title: 'Care Redistribution', data: 'Men care work <strong>+82.6%</strong> (2.3 \u2192 4.2 hrs/day); Net 3.5h household shift' },
                                { label: 'Impact', title: 'Shared Responsibility', data: 'Joint HH belief <strong>+53.8pp</strong> W / <strong>+50.5pp</strong> M; Gender equality <strong>+29.8</strong>/100 [1230b]' }
                            ]
                        }
                    ]
                },
                {
                    id: '1300',
                    color: '#303F9F',
                    title: 'Strengthened gender-responsive and child/youth-friendly governance for climate adaptation, resilience, and biodiversity',
                    summary: '5,065 students in 4K clubs (57.6% girls), clean water +39.1pp, tree planting in 38 schools, forest group gender equality +32.5pp.',
                    pathways: [
                        {
                            title: 'Schools & Next Generation Stewardship',
                            color: '#303F9F',
                            steps: [
                                { label: 'Input', title: '4K Club Formation', data: 'School-based environmental clubs established across target schools' },
                                { label: 'Output', title: 'Youth Enrollment', data: '<strong>5,065</strong> students enrolled (57.6% girls, 42.4% boys)' },
                                { label: 'Outcome', title: 'Environmental Action', data: 'Tree planting in <strong>38</strong> schools; Farming in <strong>32</strong> schools' },
                                { label: 'Impact', title: 'WASH & Resilience', data: 'Clean water composite score <strong>+39.1pp</strong>; Youth-led climate adaptation' }
                            ]
                        },
                        {
                            title: 'Community Conservation Governance',
                            color: '#5C6BC0',
                            steps: [
                                { label: 'Input', title: 'Forest Group Strengthening', data: 'Institutional capacity building for community forest governance' },
                                { label: 'Output', title: 'Group Functionality', data: 'Forest group functionality <strong>+32.2pp</strong> (53.5% \u2192 85.7%) [1130b]' },
                                { label: 'Outcome', title: 'Inclusive Governance', data: 'Forest gender equality <strong>+32.5pp</strong>; Forest management <strong>+31.0pp</strong> (98.4% W)' },
                                { label: 'Impact', title: 'Institutional Resilience', data: 'Conservation VSLAs (Kaya Chonyi, Kwale Env., Majoreni BMU) sustain governance funding' }
                            ]
                        }
                    ]
                }
            ];

            // Cross-outcome connections \u2014 how the 3 pillars reinforce each other
            const connections = [
                {
                    from: '1200 Financial Empowerment', to: '1100 Seaweed Value Chain',
                    fromColor: '#1976d2', toColor: '#00796b', strength: 'Strong',
                    outcomes: '1200 \u2192 1100',
                    detail: 'Seaweed-named VSLAs (Bati, Chiromo, Kibuyuni, Mkwiro, Imani Gazi) provide start-up capital and risk pooling for NbS-linked livelihoods.'
                },
                {
                    from: '1200 Financial Empowerment', to: '1100 Ecosystem Restoration',
                    fromColor: '#1976d2', toColor: '#2e7d32', strength: 'Strong',
                    outcomes: '1200 \u2192 1100',
                    detail: 'Conservation-named VSLAs (Kaya Chonyi, Kwale Environmental, Majoreni BMU) directly fund community-based NbS activities and stewardship.'
                },
                {
                    from: '1200 Male Allyship', to: '1100 NbS Adoption',
                    fromColor: '#7B1FA2', toColor: '#2e7d32', strength: 'Strong',
                    outcomes: '1200 \u2192 1100',
                    detail: 'Men\u2019s seaweed support surged +68.2pp (15.7% \u2192 83.9%), exceeding women\u2019s own participation growth. Gender norm change enables inclusive NbS adoption.'
                },
                {
                    from: '1200 Women\u2019s Agency', to: '1100 Seaweed Value Chain',
                    fromColor: '#E91E63', toColor: '#00796b', strength: 'Moderate',
                    outcomes: '1200 \u2192 1100',
                    detail: '94.7% of seaweed groups are women-led with 610 female members. Women\u2019s empowerment enables NbS value chain leadership, but business support decline threatens sustainability.'
                },
                {
                    from: '1200 VSLA Savings', to: '1100 Climate Resilience',
                    fromColor: '#1976d2', toColor: '#f57c00', strength: 'Enabling',
                    outcomes: '1200 \u2192 1100',
                    detail: 'VSLA savings (93.4%) create financial buffers against climate shocks. Loan access (+51.1pp) enables post-disaster recovery, strengthening adaptive capacity.'
                },
                {
                    from: '1300 Schools', to: '1100 Ecosystem Restoration',
                    fromColor: '#303F9F', toColor: '#2e7d32', strength: 'Emerging',
                    outcomes: '1300 \u2192 1100',
                    detail: '4K clubs in 38 schools practice tree planting and in 32 schools practice farming, building the next generation of NbS practitioners.'
                },
                {
                    from: '1300 Conservation Governance', to: '1200 VSLA',
                    fromColor: '#5C6BC0', toColor: '#1976d2', strength: 'Enabling',
                    outcomes: '1300 \u2192 1200',
                    detail: 'Conservation VSLAs bridge governance (1300) and economic agency (1200) \u2014 groups like Kwale Environmental Conservation VSLA simultaneously strengthen governance and women\u2019s financial inclusion.'
                }
            ];

            // Tensions \u2014 cross-cutting risks across outcomes
            const tensions = [
                {
                    title: 'Business Support Decline',
                    color: '#c62828',
                    detail: 'Women report <strong>-20.7pp</strong> (84.9% \u2192 64.2%) in spouse business support while men report <strong>+14.1pp</strong> (53.5% \u2192 67.6%). This 30pp perception gap suggests women\u2019s rising expectations outpace actual support changes.',
                    tags: ['1200 Women\u2019s Agency', '1200 Male Allyship']
                },
                {
                    title: 'Resource Control Stagnation',
                    color: '#e65100',
                    detail: 'Decision power surged <strong>+38.3pp</strong> [1200a] but resource access grew only <strong>+12.6pp</strong> [1200c]. Women participate in decisions but may lack tangible asset control \u2014 risking \u201chollow empowerment\u201d.',
                    tags: ['1200 Financial Empowerment', '1200 Women\u2019s Agency']
                },
                {
                    title: 'Seaweed Commercialization Bottleneck',
                    color: '#e65100',
                    detail: 'Despite 335 active farmers and 94.7% women-led groups, only <strong>47.4%</strong> are selling, <strong>0%</strong> are exporting, and <strong>84.2%</strong> report insufficient inputs. The NbS value chain stalls at production-to-market transition.',
                    tags: ['1100 Seaweed', '1200 Financial Empowerment']
                },
                {
                    title: 'Joint Decision Perception Gap',
                    color: '#f57c00',
                    detail: 'Men report joint decision-making at <strong>89.8%</strong> vs women\u2019s <strong>58.8%</strong> \u2014 a 31pp perception gap suggesting men overestimate their inclusiveness or women undervalue their own participation.',
                    tags: ['1200 Women\u2019s Agency', '1200 Male Allyship']
                }
            ];

            // \u2500\u2500 RENDERING \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500
            function renderStep(step, pathway, idx, total) {
                const isAlert = step.label === 'Gap' || step.label === 'Bottleneck';
                const labelBg = isAlert ? '#c62828' : pathway.color;
                const stepBg = idx === total - 1 ? (isAlert ? 'rgba(198,40,40,0.07)' : pathway.color + '12') : '#fff';
                return '<div class="toc-step" style="background:' + stepBg + ';">' +
                    '<div class="toc-step-label" style="color:#fff;background:' + labelBg + ';">' + step.label + '</div>' +
                    '<div class="toc-step-title">' + step.title + '</div>' +
                    '<div class="toc-step-data">' + step.data + '</div>' +
                    '</div>' +
                    (idx < total - 1 ? '<div class="toc-arrow" style="color:' + (isAlert ? '#c62828' : pathway.color) + ';">&#10140;</div>' : '');
            }

            let html = '';

            // Render each outcome pillar with its pathways
            outcomes.forEach(function(oc, ocIdx) {
                if (ocIdx > 0) html += '<div class="toc-outcome-divider"></div>';
                html += '<div class="toc-outcome-header" style="border-left-color:' + oc.color + ';background:' + oc.color + '08;">' +
                    '<div><span class="toc-outcome-id" style="background:' + oc.color + ';">Outcome ' + oc.id + '</span></div>' +
                    '<div class="toc-outcome-title">' + oc.title + '</div>' +
                    '<div class="toc-outcome-summary">' + oc.summary + '</div>' +
                    '</div>';

                oc.pathways.forEach(function(p) {
                    var stepsHtml = p.steps.map(function(s, idx) { return renderStep(s, p, idx, p.steps.length); }).join('');
                    html += '<div class="toc-pathway-title" style="color:' + p.color + ';background:' + p.color + '10;">' +
                        '<span style="background:' + p.color + ';width:5px;height:24px;border-radius:3px;display:inline-block;"></span>' + p.title + '</div>' +
                        '<div class="toc-pathway" style="border-left:5px solid ' + p.color + ';">' + stepsHtml + '</div>';
                });
            });

            // Cross-outcome connections
            html += '<div style="margin-top:28px;">' +
                '<div style="font-size:1.05em;font-weight:800;color:#333;margin-bottom:6px;">Cross-Outcome Connections</div>' +
                '<p style="color:#555;font-size:0.84em;margin-bottom:14px;line-height:1.5;">How the three intermediate outcomes reinforce each other \u2014 evidence of systemic, interconnected impact across COSME\u2019s three-pronged strategy.</p>' +
                '<div class="toc-connections-grid">';

            connections.forEach(function(c) {
                var sColor = c.strength === 'Strong' ? '#2e7d32' : (c.strength === 'Moderate' ? '#f57c00' : (c.strength === 'Enabling' ? '#1976d2' : '#7B1FA2'));
                html += '<div class="toc-connection-card">' +
                    '<div class="toc-conn-header">' +
                    '<span class="toc-conn-outcome-badge" style="background:' + sColor + ';">' + c.outcomes + '</span>' +
                    '<span class="toc-conn-dot" style="background:' + c.fromColor + ';"></span>' +
                    '<span class="toc-conn-name">' + c.from + '</span>' +
                    '<span class="toc-conn-arrow">&#10140;</span>' +
                    '<span class="toc-conn-dot" style="background:' + c.toColor + ';"></span>' +
                    '<span class="toc-conn-name">' + c.to + '</span>' +
                    '<span class="toc-conn-strength" style="background:' + sColor + ';">' + c.strength + '</span>' +
                    '</div>' +
                    '<div class="toc-conn-detail">' + c.detail + '</div>' +
                    '</div>';
            });

            html += '</div></div>';

            // Tensions & watchpoints
            html += '<div style="margin-top:28px;">' +
                '<div style="font-size:1.05em;font-weight:800;color:#333;margin-bottom:6px;">Tensions & Watchpoints</div>' +
                '<p style="color:#555;font-size:0.84em;margin-bottom:14px;line-height:1.5;">Critical gaps and contradictions requiring adaptive programming. These cross-cutting tensions span multiple outcomes and indicate where theory of change assumptions need revisiting.</p>' +
                '<div class="toc-tensions-grid">';

            tensions.forEach(function(t) {
                html += '<div class="toc-tension-card" style="border-left:4px solid ' + t.color + ';">' +
                    '<div class="toc-tension-title" style="color:' + t.color + ';">' + t.title + '</div>' +
                    '<div class="toc-tension-detail">' + t.detail + '</div>' +
                    '<div class="toc-tension-pathways">Affects: ' + t.tags.map(function(tag) { return '<span class="toc-tension-tag">' + tag + '</span>'; }).join(' ') + '</div>' +
                    '</div>';
            });

            html += '</div></div>';

            document.getElementById('toc-pathways').innerHTML = html;
        }

        // ── ENDLINE PROJECTIONS ────────────────────────────────────────
        function renderEndlineProjections() {
            // Select strategic logframe indicators first, then fill with highest-impact ones
            const logframeFirst = indicatorDictionary.filter(i =>
                i.womenMidline != null && i.womenBaseline != null && i.unit === '%' && i.logframeId
            );
            const nonLogframe = indicatorDictionary.filter(i =>
                i.womenMidline != null && i.womenBaseline != null && i.unit === '%' && !i.logframeId
            ).sort((a, b) => Math.abs(b.womenMidline - b.womenBaseline) - Math.abs(a.womenMidline - a.womenBaseline));
            const keyInds = [...logframeFirst, ...nonLogframe].slice(0, 12);

            const labels = keyInds.map(i => i.label.length > 20 ? i.label.substring(0, 18) + '...' : i.label);
            const midVals = keyInds.map(i => i.womenMidline);
            const gains = keyInds.map(i => i.womenMidline - i.womenBaseline);

            // Three scenarios
            const maintained = keyInds.map((i, idx) => Math.min(i.womenMidline + gains[idx] * 0.5, 100)); // 50% of baseline-midline gain continues
            const accelerated = keyInds.map((i, idx) => Math.min(i.womenMidline + gains[idx] * 0.8, 100)); // 80% continues
            const regression = keyInds.map((i, idx) => Math.max(i.womenMidline - Math.abs(gains[idx]) * 0.2, 0)); // 20% regression

            synthCharts['insight-projections'] = new Chart(document.getElementById('insights-chart-projections'), {
                type: 'bar',
                data: {
                    labels: labels,
                    datasets: [
                        { label: 'Current Midline', data: midVals, backgroundColor: 'rgba(25,118,210,0.7)', borderRadius: 4, order: 4 },
                        { label: 'Scenario A: Maintained', data: maintained, type: 'line', borderColor: '#2e7d32', backgroundColor: 'rgba(46,125,50,0.1)', pointRadius: 5, borderWidth: 2, fill: false, tension: 0.3, order: 1 },
                        { label: 'Scenario B: Accelerated', data: accelerated, type: 'line', borderColor: '#f57c00', backgroundColor: 'rgba(245,124,0,0.1)', pointRadius: 5, borderWidth: 2, fill: false, tension: 0.3, borderDash: [5, 3], order: 2 },
                        { label: 'Scenario C: Regression', data: regression, type: 'line', borderColor: '#c62828', backgroundColor: 'rgba(198,40,40,0.1)', pointRadius: 5, borderWidth: 2, fill: false, tension: 0.3, borderDash: [2, 2], order: 3 }
                    ]
                },
                options: {
                    responsive: true, maintainAspectRatio: false,
                    scales: { y: { beginAtZero: true, max: 100, title: { display: true, text: 'Projected Value (%)' } } },
                    plugins: {
                        legend: { position: 'top', labels: { font: { size: 11 } } },
                        datalabels: { display: false }
                    }
                }
            });

            // Summary
            const avgMaintained = maintained.reduce((a, b) => a + b, 0) / maintained.length;
            const avgAccelerated = accelerated.reduce((a, b) => a + b, 0) / accelerated.length;
            const avgRegression = regression.reduce((a, b) => a + b, 0) / regression.length;
            const avgMidline = midVals.reduce((a, b) => a + b, 0) / midVals.length;

            document.getElementById('projection-summary').innerHTML = `
                <strong style="font-size:1.02em;color:#2e7d32;">Endline Scenario Analysis</strong><br><br>
                Based on the baseline-to-midline trajectory across ${keyInds.length} key women's indicators:<br><br>
                <strong style="color:#1976d2;">Current Average (Midline):</strong> ${avgMidline.toFixed(1)}%<br>
                <strong style="color:#2e7d32;">Scenario A — Maintained Momentum:</strong> ${avgMaintained.toFixed(1)}% (assumes 50% of bl-ml gains continue at same rate)<br>
                <strong style="color:#f57c00;">Scenario B — Accelerated Effort:</strong> ${avgAccelerated.toFixed(1)}% (assumes 80% continuation with intensified programming)<br>
                <strong style="color:#c62828;">Scenario C — Regression Risk:</strong> ${avgRegression.toFixed(1)}% (assumes 20% regression if interventions weaken)<br><br>
                <strong>Key Takeaway:</strong> The difference between Scenario A and C is <strong>${(avgMaintained - avgRegression).toFixed(1)}pp</strong>,
                highlighting the importance of sustained program delivery. Even maintaining 50% of current momentum would yield strong endline results.
                Focus areas for endline: indicators where midline-baseline gain was smallest (floor effects) or where regression risk is highest.
            `;
        }

    })();
    </script>

    <!-- MOBILE NAVIGATION JAVASCRIPT -->
    <script>
    (function() {
        // Survey key to label mapping
        const surveyLabels = {
            'project-outputs': 'Project Outputs',
            'women-cosme': 'Women Survey (Midline)',
            'men-cosme': 'Men Survey (Midline)',
            'gjj-women': 'GJJ KAP Women (Endline)',
            'gjj-men': 'GJJ KAP Men (Endline)',
            'forestry': 'Forestry Functionality (Midline)',
            'prepost-forest': 'Trainings Pre & Post',
            'schools-dashboard': 'Schools Dashboard',
            'seaweed-assessment': 'Seaweed Assessment',
            'vsla-monitoring': 'VSLA Monitoring',
            'cross-dataset': 'Cross-Dataset Synthesis',
            'automated-insights': 'Impact & Evidence'
        };

        // Toggle mobile nav drawer
        window.toggleMobileNav = function() {
            const drawer = document.getElementById('mobileNavDrawer');
            const overlay = document.getElementById('mobileNavOverlay');
            const toggle = document.getElementById('mobileMenuToggle');
            const isOpen = drawer.classList.contains('open');
            
            if (isOpen) {
                closeMobileNav();
            } else {
                drawer.classList.add('open');
                overlay.classList.add('open');
                toggle.classList.add('open');
                toggle.setAttribute('aria-expanded', 'true');
                document.body.style.overflow = 'hidden';
            }
        };

        // Close mobile nav
        window.closeMobileNav = function() {
            const drawer = document.getElementById('mobileNavDrawer');
            const overlay = document.getElementById('mobileNavOverlay');
            const toggle = document.getElementById('mobileMenuToggle');
            drawer.classList.remove('open');
            overlay.classList.remove('open');
            toggle.classList.remove('open');
            toggle.setAttribute('aria-expanded', 'false');
            document.body.style.overflow = '';
        };

        // Mobile nav item selection
        window.mobileNavSelect = function(surveyKey, btn) {
            // Update drawer active state
            document.querySelectorAll('.drawer-nav-item').forEach(b => b.classList.remove('active'));
            btn.classList.add('active');
            
            // Update the mobile toggle label
            const labelEl = document.getElementById('currentSurveyLabel');
            if (labelEl) {
                labelEl.textContent = surveyLabels[surveyKey] || surveyKey;
            }
            
            // Close drawer
            closeMobileNav();
            
            // Trigger the actual survey switch
            if (typeof switchSurvey === 'function') {
                switchSurvey(surveyKey);
            }
        };

        // Sync mobile drawer when desktop buttons are clicked
        const origSwitchForMobile = window.switchSurvey;
        if (typeof origSwitchForMobile === 'function') {
            // We wrap it after DOMContentLoaded to ensure it exists
            document.addEventListener('DOMContentLoaded', function() {
                // Patch switchSurvey to sync mobile nav state
                const patchedSwitch = window.switchSurvey;
                window.switchSurvey = function(surveyKey) {
                    patchedSwitch(surveyKey);
                    
                    // Sync mobile drawer active state
                    document.querySelectorAll('.drawer-nav-item').forEach(item => {
                        const onclickAttr = item.getAttribute('onclick') || '';
                        if (onclickAttr.includes("'" + surveyKey + "'")) {
                            item.classList.add('active');
                        } else {
                            item.classList.remove('active');
                        }
                    });
                    
                    // Update mobile toggle label
                    const labelEl = document.getElementById('currentSurveyLabel');
                    if (labelEl && surveyLabels[surveyKey]) {
                        labelEl.textContent = surveyLabels[surveyKey];
                    }
                };
            });
        }

        // Handle swipe to close drawer
        let touchStartX = 0;
        let touchCurrentX = 0;
        const drawer = document.getElementById('mobileNavDrawer');
        
        if (drawer) {
            drawer.addEventListener('touchstart', function(e) {
                touchStartX = e.touches[0].clientX;
            }, { passive: true });
            
            drawer.addEventListener('touchmove', function(e) {
                touchCurrentX = e.touches[0].clientX;
                const diff = touchStartX - touchCurrentX;
                if (diff > 0) {
                    // Swiping left - start closing
                    const translateX = Math.min(0, -diff);
                    drawer.style.transform = 'translateX(' + translateX + 'px)';
                    drawer.style.transition = 'none';
                }
            }, { passive: true });
            
            drawer.addEventListener('touchend', function(e) {
                drawer.style.transition = '';
                drawer.style.transform = '';
                const diff = touchStartX - touchCurrentX;
                if (diff > 80) {
                    closeMobileNav();
                }
            }, { passive: true });
        }

        // Close drawer on escape key
        document.addEventListener('keydown', function(e) {
            if (e.key === 'Escape') {
                closeMobileNav();
            }
        });

        // Close drawer on window resize to desktop
        window.addEventListener('resize', function() {
            if (window.innerWidth > 768) {
                closeMobileNav();
            }
        });
    })();
    </script>

    <!-- ============================================================ -->
    <!-- PRODUCTION ANIMATIONS ENGINE                                 -->
    <!-- Scroll-reveal, count-up, filter transitions, progress bars  -->
    <!-- ============================================================ -->
    <script>
    (function() {
        'use strict';

        // ─────────────────────────────────────────────
        // 1. SCROLL-TRIGGERED FADE-IN (IntersectionObserver)
        //    Adds .anim-observe to eligible elements, then
        //    swaps to .anim-visible when they enter viewport.
        // ─────────────────────────────────────────────

        // Selectors for elements that should animate on scroll
        const ANIMATE_SELECTORS = [
            '.chart-wrapper',
            '.output-chart-box',
            '.insight-panel',
            '.insight-card',
            '.highlight-box',
            '.output-card',
            '.output-kpi',
            '.comparison-table',
            '.section'
        ].join(',');

        // Selectors for stagger-parent grids
        const STAGGER_SELECTORS = [
            '.key-findings',
            '.kpi-section',
            '.output-kpi-grid',
            '.charts-grid',
            '.insights-grid'
        ].join(',');

        let scrollObserver = null;

        function initScrollReveal() {
            if (!('IntersectionObserver' in window)) return;
            // Reduced motion — skip entirely
            if (window.matchMedia('(prefers-reduced-motion: reduce)').matches) return;

            // Clean up previous observer if re-initialised
            if (scrollObserver) scrollObserver.disconnect();

            scrollObserver = new IntersectionObserver(function(entries) {
                entries.forEach(function(entry) {
                    if (entry.isIntersecting) {
                        entry.target.classList.add('anim-visible');
                        scrollObserver.unobserve(entry.target);
                    }
                });
            }, {
                rootMargin: '60px',   // trigger slightly before visible
                threshold: 0.05
            });

            // Mark stagger parents
            document.querySelectorAll(STAGGER_SELECTORS).forEach(function(parent) {
                parent.classList.add('anim-stagger');
            });

            // Tag and observe elements
            document.querySelectorAll(ANIMATE_SELECTORS).forEach(function(el) {
                // Skip if already animated or hidden (display:none sections)
                if (el.classList.contains('anim-visible')) return;
                // Only observe if element is in a VISIBLE parent section
                if (el.offsetParent !== null) {
                    el.classList.add('anim-observe');
                    scrollObserver.observe(el);
                }
            });
        }

        // Re-apply scroll reveal after section switches (new elements become visible)
        function refreshScrollReveal() {
            // Small delay to let DOM update after display changes
            requestAnimationFrame(function() {
                document.querySelectorAll(ANIMATE_SELECTORS).forEach(function(el) {
                    if (el.classList.contains('anim-visible')) return;
                    // Remove stale class, re-add if visible
                    el.classList.remove('anim-observe');
                    if (el.offsetParent !== null) {
                        el.classList.add('anim-observe');
                        if (scrollObserver) scrollObserver.observe(el);
                    }
                });
                // Tag new stagger parents
                document.querySelectorAll(STAGGER_SELECTORS).forEach(function(parent) {
                    parent.classList.add('anim-stagger');
                });
            });
        }

        // ─────────────────────────────────────────────
        // 2. COUNT-UP NUMBER ANIMATION
        //    Smoothly increments numeric KPI values from 0.
        //    Supports integers, decimals, percentages, and
        //    values with +/- prefix.
        // ─────────────────────────────────────────────

        function animateCountUp(element, duration) {
            duration = duration || 600; // ms — fast but smooth (150–400ms range extended slightly for readability)
            const text = element.textContent.trim();

            // Extract numeric part — handles "+48.8%", "79.1%", "42", "-12.3pp"
            const match = text.match(/^([+\-]?)(\d+(?:\.\d+)?)(.*)/);
            if (!match) return; // not a number — skip

            const prefix = match[1];        // "+" or "-" or ""
            const target = parseFloat(match[2]);
            const suffix = match[3];        // "%" or "pp" or ""
            const decimals = match[2].includes('.') ? match[2].split('.')[1].length : 0;

            element.classList.add('anim-countup');
            const startTime = performance.now();

            function update(now) {
                const elapsed = now - startTime;
                const progress = Math.min(elapsed / duration, 1);
                // Ease-out cubic for smooth deceleration
                const eased = 1 - Math.pow(1 - progress, 3);
                const current = target * eased;
                element.textContent = prefix + current.toFixed(decimals) + suffix;
                if (progress < 1) requestAnimationFrame(update);
            }
            requestAnimationFrame(update);
        }

        // Animate all KPI numbers currently in the DOM
        function animateVisibleKPIs() {
            // Targets: .finding-metric, .kpi-value, .output-kpi .kpi-value
            const selectors = '.finding-metric, .kpi-card .kpi-value, .output-kpi .kpi-value';
            document.querySelectorAll(selectors).forEach(function(el) {
                // Only animate if element is visible and not yet animated
                if (el.offsetParent !== null && !el.dataset.counted) {
                    el.dataset.counted = 'true';
                    animateCountUp(el, 500);
                }
            });
        }

        // ─────────────────────────────────────────────
        // 3. SECTION/FILTER TRANSITION ANIMATION
        //    Applies a subtle fade+slide when a section
        //    becomes visible via switchSurvey / showTab / etc.
        // ─────────────────────────────────────────────

        function animateSectionEnter(sectionEl) {
            if (!sectionEl || window.matchMedia('(prefers-reduced-motion: reduce)').matches) return;
            // Remove class first to re-trigger
            sectionEl.classList.remove('anim-section-enter');
            // Force reflow so animation re-triggers
            void sectionEl.offsetWidth;
            sectionEl.classList.add('anim-section-enter');
            // Clean up after animation completes
            sectionEl.addEventListener('animationend', function handler() {
                sectionEl.classList.remove('anim-section-enter');
                sectionEl.removeEventListener('animationend', handler);
            });
        }

        // ─────────────────────────────────────────────
        // 4. ANIMATED PROGRESS BARS
        //    For .output-kpi elements with "Target: X | Y% Achieved"
        //    Auto-injects a progress bar below the text.
        // ─────────────────────────────────────────────

        function injectProgressBars() {
            document.querySelectorAll('.output-kpi .kpi-sub').forEach(function(sub) {
                // Skip if already injected
                if (sub.querySelector('.anim-progress-wrap')) return;
                // Parse "Target: 40 | 105% Achieved" pattern
                const match = sub.textContent.match(/(\d+(?:\.\d+)?)%\s*Achieved/i);
                if (!match) return;

                const pct = Math.min(parseFloat(match[1]), 100); // cap visual at 100%
                const rawPct = parseFloat(match[1]);

                // Determine color based on achievement
                let colorClass = 'green';
                if (rawPct < 50) colorClass = 'red';
                else if (rawPct < 80) colorClass = 'orange';

                // Create progress bar DOM
                const wrap = document.createElement('div');
                wrap.className = 'anim-progress-wrap';
                wrap.setAttribute('role', 'progressbar');
                wrap.setAttribute('aria-valuenow', rawPct);
                wrap.setAttribute('aria-valuemin', '0');
                wrap.setAttribute('aria-valuemax', '100');
                wrap.setAttribute('aria-label', rawPct + '% achieved');

                const bar = document.createElement('div');
                bar.className = 'anim-progress-bar ' + colorClass;
                wrap.appendChild(bar);
                sub.appendChild(wrap);

                // Animate width after insertion (needs frame delay for transition)
                requestAnimationFrame(function() {
                    requestAnimationFrame(function() {
                        bar.style.width = pct + '%';
                    });
                });
            });
        }

        // ─────────────────────────────────────────────
        // 5. SKELETON LOADER UTILITY
        //    Call showSkeleton(container) before data loads,
        //    then hideSkeleton(container) after data arrives.
        //    Used as a utility — integrate where needed.
        // ─────────────────────────────────────────────

        /**
         * Show skeleton placeholders inside a container.
         * @param {HTMLElement} container - target element to fill with skeletons.
         * @param {string} type - 'kpi' | 'chart' | 'card' (determines skeleton shape).
         * @param {number} count - number of skeleton items (default 3).
         */
        window.showSkeleton = function(container, type, count) {
            if (!container) return;
            count = count || 3;
            type = type || 'card';

            // Preserve original content for restore
            if (!container.dataset.originalHtml) {
                container.dataset.originalHtml = container.innerHTML;
            }

            const classMap = {
                kpi: 'skeleton skeleton-kpi',
                chart: 'skeleton skeleton-chart',
                card: 'skeleton skeleton-card'
            };
            const skeletonClass = classMap[type] || classMap.card;

            let html = '';
            for (var i = 0; i < count; i++) {
                html += '<div class="' + skeletonClass + '" aria-hidden="true"></div>';
            }
            container.innerHTML = html;
            container.dataset.skeletonActive = 'true';
        };

        /**
         * Remove skeleton placeholders, restoring original or new content.
         * @param {HTMLElement} container - same container passed to showSkeleton.
         * @param {string} [newHtml] - optional new HTML to replace original content.
         */
        window.hideSkeleton = function(container, newHtml) {
            if (!container) return;
            if (newHtml !== undefined) {
                container.innerHTML = newHtml;
            } else if (container.dataset.originalHtml) {
                container.innerHTML = container.dataset.originalHtml;
            }
            delete container.dataset.skeletonActive;
            delete container.dataset.originalHtml;
        };

        // ─────────────────────────────────────────────
        // INTEGRATION: Hook into existing functions
        // ─────────────────────────────────────────────

        // Wrap switchSurvey to trigger animations after content update
        const _origSwitchSurvey = window.switchSurvey;
        if (typeof _origSwitchSurvey === 'function') {
            window.switchSurvey = function(surveyKey) {
                // Reset counted flags so KPIs re-animate
                document.querySelectorAll('[data-counted]').forEach(function(el) {
                    delete el.dataset.counted;
                });
                // Reset scroll-reveal state for hidden elements
                document.querySelectorAll('.anim-visible').forEach(function(el) {
                    el.classList.remove('anim-visible', 'anim-observe');
                });

                // Call original function
                _origSwitchSurvey(surveyKey);

                // Post-switch: animate the newly visible content
                requestAnimationFrame(function() {
                    // Find the visible section and animate its entrance
                    var sections = document.querySelectorAll('[id$="-section"], [id$="-dashboard-section"]');
                    sections.forEach(function(sec) {
                        if (sec.style.display === 'block' || sec.style.display === '') {
                            if (sec.offsetParent !== null) {
                                animateSectionEnter(sec);
                            }
                        }
                    });
                    // Animate KPI numbers
                    animateVisibleKPIs();
                    // Inject progress bars
                    injectProgressBars();
                    // Refresh scroll-reveal for newly visible elements
                    refreshScrollReveal();
                });
            };
        }

        // Wrap showTab to animate tab content entrance
        const _origShowTab = window.showTab;
        if (typeof _origShowTab === 'function') {
            window.showTab = function(evt, tabName) {
                _origShowTab(evt, tabName);
                var tab = document.getElementById(tabName);
                if (tab) {
                    animateSectionEnter(tab);
                    // Re-reveal chart wrappers inside the new tab
                    refreshScrollReveal();
                }
            };
        }

        // Wrap showSchoolsDashType for sub-tab transitions
        const _origShowSchools = window.showSchoolsDashType;
        if (typeof _origShowSchools === 'function') {
            window.showSchoolsDashType = function(event, typeName) {
                _origShowSchools(event, typeName);
                var typeMap = {
                    'clean-water': 'schools-dash-clean-water',
                    'water-midline': 'schools-dash-water-midline',
                    'four-k-clubs': 'schools-dash-four-k-clubs',
                    'overall-insights': 'schools-dash-overall-insights'
                };
                var el = document.getElementById(typeMap[typeName]);
                if (el) animateSectionEnter(el);
                refreshScrollReveal();
            };
        }

        // Wrap showOutputType for output sub-tab transitions
        const _origShowOutput = window.showOutputType;
        if (typeof _origShowOutput === 'function') {
            window.showOutputType = function(event, typeName) {
                _origShowOutput(event, typeName);
                var el = document.getElementById('output-' + typeName);
                if (el) animateSectionEnter(el);
                injectProgressBars();
                refreshScrollReveal();
            };
        }

        // Wrap showPrePostType for pre/post sub-tab transitions
        const _origShowPrePost = window.showPrePostType;
        if (typeof _origShowPrePost === 'function') {
            window.showPrePostType = function(evt, typeName) {
                _origShowPrePost(evt, typeName);
                var contentId = typeName === 'forest' ? 'pp-forest-content' : 'pp-mangrove-content';
                var el = document.getElementById(contentId);
                if (el) animateSectionEnter(el);
                refreshScrollReveal();
            };
        }

        // ─────────────────────────────────────────────
        // INITIALISE ON DOM READY
        // ─────────────────────────────────────────────
        function initAnimations() {
            initScrollReveal();
            animateVisibleKPIs();
            injectProgressBars();
        }

        if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', initAnimations);
        } else {
            // DOM already ready — run after a tick to let other scripts finish
            requestAnimationFrame(initAnimations);
        }
    })();
    </script>

    <!-- LAZY-LOAD CHART SECTIONS -->
    <script>
    (function() {
        // Defer rendering of off-screen chart sections using IntersectionObserver.
        // Each chart wrapper gets observed; its canvas is only rendered once
        // it enters (or is near) the viewport. This reduces initial paint time
        // on the ~950KB dashboard, especially on mobile.

        if (!('IntersectionObserver' in window)) return; // graceful fallback — charts render normally

        const RENDER_MARGIN = '200px'; // start loading 200px before visible

        const lazyObserver = new IntersectionObserver(function(entries) {
            entries.forEach(function(entry) {
                if (entry.isIntersecting) {
                    const wrapper = entry.target;
                    // Mark as loaded so it won't be re-observed
                    wrapper.dataset.lazyLoaded = 'true';
                    lazyObserver.unobserve(wrapper);
                    // Trigger chart resize — Chart.js needs this when
                    // a canvas was in a hidden/offscreen container
                    const canvases = wrapper.querySelectorAll('canvas');
                    canvases.forEach(function(canvas) {
                        const chart = Chart.getChart(canvas);
                        if (chart) {
                            chart.resize();
                        }
                    });
                }
            });
        }, {
            rootMargin: RENDER_MARGIN,
            threshold: 0
        });

        // Observe all chart wrappers and output chart boxes
        function observeChartContainers() {
            document.querySelectorAll('.chart-wrapper, .output-chart-box, .chart-container').forEach(function(el) {
                if (!el.dataset.lazyLoaded) {
                    lazyObserver.observe(el);
                }
            });
        }

        // Run on initial load
        if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', observeChartContainers);
        } else {
            observeChartContainers();
        }

        // Re-observe when survey is switched (new sections become visible)
        const origSwitch = window.switchSurvey;
        if (typeof origSwitch === 'function') {
            window.switchSurvey = function(surveyKey) {
                origSwitch(surveyKey);
                // Give the DOM time to update before re-observing
                requestAnimationFrame(function() {
                    observeChartContainers();
                });
            };
        }
    })();
    </script>

    <!-- STICKY HEADER SCROLL MANAGEMENT -->
    <script>
    (function() {
        const selector = document.querySelector('.survey-selector');
        const spacer = document.querySelector('.survey-selector-spacer');

        // Dynamically measure and set spacer height to match selector
        function updateSpacerHeight() {
            if (selector && spacer) {
                const h = selector.offsetHeight;
                spacer.style.height = h + 'px';
                // Update CSS custom property for tabs/section-title offsets
                document.documentElement.style.setProperty('--selector-height', h + 'px');
                // Update tabs top offset
                document.querySelectorAll('.tabs-container').forEach(tc => {
                    tc.style.top = h + 'px';
                });
                // Update section-title offsets (selector + approx tabs height)
                document.querySelectorAll('.section-title').forEach(st => {
                    st.style.top = (h + 48) + 'px';
                });
            }
        }

        // Run on load and resize
        updateSpacerHeight();
        window.addEventListener('resize', updateSpacerHeight);
        // Recheck after fonts/images load
        window.addEventListener('load', updateSpacerHeight);

        // Add scrolled class for shadow effect
        let ticking = false;
        window.addEventListener('scroll', function() {
            if (!ticking) {
                window.requestAnimationFrame(function() {
                    if (selector) {
                        if (window.scrollY > 10) {
                            selector.classList.add('scrolled');
                        } else {
                            selector.classList.remove('scrolled');
                        }
                    }
                    ticking = false;
                });
                ticking = true;
            }
        }, { passive: true });

        // Observe DOM mutations (survey switching may show/hide sub-selectors)
        const observer = new MutationObserver(function() {
            setTimeout(updateSpacerHeight, 100);
        });
        if (selector) {
            observer.observe(selector, { childList: true, subtree: true, attributes: true });
        }
    })();
    </script>

    <!-- REPORT GENERATION LOGIC -->
    <script>
        // ── Report catalogue data ──
        const reportCatalogue = [
            {
                id: 'full-report',
                title: 'Full Midline Report',
                icon: '📄',
                iconBg: 'linear-gradient(135deg,#0072CE,#004E8C)',
                category: 'all',
                badge: 'Complete',
                badgeColor: '#0072CE',
                desc: 'Comprehensive COSME Midline Analysis covering all programme areas — surveys, forestry, schools, seaweed, VSLA, logframe, and strategic recommendations.',
                pdf: 'COSME_Midline_Report.pdf',
                dataFiles: [],
                stats: [
                    { icon: '👥', text: '<strong>1,213</strong> survey respondents' },
                    { icon: '📊', text: '<strong>12/13</strong> logframe indicators exceeded' },
                    { icon: '📑', text: '<strong>15</strong> sections, 50+ charts' },
                    { icon: '📈', text: 'Baseline vs Midline comparisons' }
                ],
                sections: [
                    { n: 1, title: 'Executive Summary', detail: 'Overview, key findings & programme summary' },
                    { n: 2, title: 'Women COSME Survey', detail: 'n=345 – knowledge, attitudes, practices' },
                    { n: 3, title: 'Men COSME Survey', detail: 'n=267 – awareness, willingness, participation' },
                    { n: 4, title: 'GJJ KAP Women', detail: 'n=312 – gender norms, rights awareness' },
                    { n: 5, title: 'GJJ KAP Men', detail: 'n=289 – unpaid care work, joint decisions' },
                    { n: 6, title: 'Forestry Groups', detail: '28 groups – nurseries, replanting, survival' },
                    { n: 7, title: 'Pre/Post Tests', detail: 'Training effectiveness & knowledge gain' },
                    { n: 8, title: 'Schools Initiatives', detail: '65 schools – eco-clubs, nurseries, waste' },
                    { n: 9, title: 'Seaweed Farming', detail: '19 groups, 610 women – production & income' },
                    { n: 10, title: 'VSLA Programme', detail: '211 assessments – savings, loan repayment' },
                    { n: 11, title: 'Training Outputs', detail: 'Sessions, participants, gender breakdown' },
                    { n: 12, title: 'Logframe Summary', detail: '13 indicators – achievement vs targets' },
                    { n: 13, title: 'Cross-Dataset Synthesis', detail: 'Integrated analysis across all datasets' },
                    { n: 14, title: 'Theory of Change', detail: 'Evidence mapping & pathway analysis' },
                    { n: 15, title: 'Recommendations', detail: 'Strategic recommendations by area' }
                ]
            },
            {
                id: 'mangrove',
                title: 'Mangrove & Conservation Training',
                icon: '🌿',
                iconBg: 'linear-gradient(135deg,#2e7d32,#1b5e20)',
                category: 'environment',
                badge: 'Environment',
                badgeColor: '#2e7d32',
                desc: 'Mangrove restoration training outcomes — registration, module completion rates by gender, and conservation group performance across 42 registered groups.',
                pdf: 'COSME_Mangrove_Report.pdf',
                dataFiles: [
                    { name: 'Mangrove Training Pre/Post Results', file: 'Mangrove Training Pre_post results.xlsx' },
                    { name: 'Project Outputs Data', file: 'Project Outputs.xlsx' }
                ],
                stats: [
                    { icon: '👥', text: '<strong>1,344</strong> members registered' },
                    { icon: '👩', text: '<strong>973</strong> female (72%)' },
                    { icon: '📚', text: '<strong>5</strong> modules imparted' },
                    { icon: '✅', text: '<strong>70%</strong> overall completion rate' },
                    { icon: '🎯', text: '<strong>42</strong> groups (Target: 40)' }
                ],
                sections: [
                    { n: 1, title: 'Registration Summary', detail: 'Groups & members vs targets' },
                    { n: 2, title: 'Module Completion – All', detail: 'Completion rates per module' },
                    { n: 3, title: 'Module Completion – Male', detail: 'Male participant progress' },
                    { n: 4, title: 'Module Completion – Female', detail: 'Female participant progress' },
                    { n: 5, title: 'Pre/Post Test Analysis', detail: 'Knowledge gain assessment' }
                ]
            },
            {
                id: 'forestry',
                title: 'Forestry Functionality',
                icon: '🌳',
                iconBg: 'linear-gradient(135deg,#33691e,#558b2f)',
                category: 'environment',
                badge: 'Environment',
                badgeColor: '#33691e',
                desc: 'Community forestry group performance — baseline vs midline comparison of nursery establishment, tree planting, survival rates, and forest management practices.',
                pdf: 'COSME_Forestry_Report.pdf',
                dataFiles: [
                    { name: 'Forest Functionality Baseline/Midline', file: 'Forest Functionality Basline_midline results.xlsx' },
                    { name: 'Forest Functionality Midline (1130b)', file: '1130b Forest Functionality Midline.xlsx' },
                    { name: 'Forest Training Pre/Post Results', file: 'Forest Training Pre_post results.xlsx' }
                ],
                stats: [
                    { icon: '🌳', text: '<strong>28</strong> forestry groups' },
                    { icon: '🌱', text: 'Nursery & replanting rates' },
                    { icon: '📊', text: 'Baseline vs Midline comparison' },
                    { icon: '📈', text: 'Survival rate tracking' }
                ],
                sections: [
                    { n: 1, title: 'Forestry Groups Overview', detail: '28 groups – structure & membership' },
                    { n: 2, title: 'Nursery Establishment', detail: 'Seedling production & distribution' },
                    { n: 3, title: 'Tree Planting Progress', detail: 'Replanting & survival rates' },
                    { n: 4, title: 'Pre/Post Training', detail: 'Forest conservation knowledge gain' },
                    { n: 5, title: 'Baseline vs Midline', detail: 'Progress comparison analysis' }
                ]
            },
            {
                id: 'seaweed',
                title: 'Seaweed Farming',
                icon: '🌊',
                iconBg: 'linear-gradient(135deg,#01579b,#0277bd)',
                category: 'livelihoods',
                badge: 'Livelihoods',
                badgeColor: '#01579b',
                desc: 'Seaweed value chain assessment — production volumes, income generation, group performance, and women\'s economic empowerment across 19 farming groups.',
                pdf: 'COSME_Seaweed_Report.pdf',
                dataFiles: [
                    { name: 'Seaweed Data Collection', file: 'Seaweed Data Collection_06.12.2025.csv' }
                ],
                stats: [
                    { icon: '🌊', text: '<strong>19</strong> seaweed groups' },
                    { icon: '👩', text: '<strong>610</strong> women farmers' },
                    { icon: '💰', text: 'Income & production data' },
                    { icon: '📈', text: 'Value chain analysis' }
                ],
                sections: [
                    { n: 1, title: 'Seaweed Groups Overview', detail: '19 groups – membership & coverage' },
                    { n: 2, title: 'Production Analysis', detail: 'Volumes, cycles, and yield data' },
                    { n: 3, title: 'Income Generation', detail: 'Revenue and market access' },
                    { n: 4, title: 'Women Empowerment', detail: 'Economic independence indicators' }
                ]
            },
            {
                id: 'women-survey',
                title: 'Women COSME Survey',
                icon: '👩',
                iconBg: 'linear-gradient(135deg,#ad1457,#c62828)',
                category: 'surveys',
                badge: 'Survey',
                badgeColor: '#ad1457',
                desc: 'Women\'s survey baseline vs midline comparison — knowledge, attitudes, and practices on conservation, mangrove use, and environmental awareness (n=345).',
                pdf: 'COSME_Women_Survey_Report.pdf',
                dataFiles: [
                    { name: 'Women Survey Midline Results', file: 'Women Survey_Midline_results.xlsx' },
                    { name: 'Women Survey Baseline/Midline', file: 'Women Survey Basline_midline results.xlsx' }
                ],
                stats: [
                    { icon: '👩', text: '<strong>345</strong> respondents' },
                    { icon: '📊', text: 'Baseline vs Midline comparison' },
                    { icon: '📈', text: 'Knowledge & attitude shifts' },
                    { icon: '🔬', text: 'KAP analysis (practices)' }
                ],
                sections: [
                    { n: 1, title: 'Demographics', detail: 'Age, location, education profile' },
                    { n: 2, title: 'Knowledge Assessment', detail: 'Conservation & mangrove knowledge' },
                    { n: 3, title: 'Attitude Analysis', detail: 'Environmental attitudes shift' },
                    { n: 4, title: 'Practices Comparison', detail: 'Baseline vs midline practices' }
                ]
            },
            {
                id: 'men-survey',
                title: 'Men COSME Survey',
                icon: '👨',
                iconBg: 'linear-gradient(135deg,#1565c0,#0d47a1)',
                category: 'surveys',
                badge: 'Survey',
                badgeColor: '#1565c0',
                desc: 'Men\'s survey baseline vs midline analysis — awareness, willingness to participate, and involvement in conservation and environmental practices (n=267).',
                pdf: 'COSME_Men_Survey_Report.pdf',
                dataFiles: [
                    { name: 'Men Survey Midline Results', file: 'Men Survey_Midline_results.xlsx' },
                    { name: 'Men Survey Baseline/Midline', file: 'Men Survey Basline_midline results.xlsx' }
                ],
                stats: [
                    { icon: '👨', text: '<strong>267</strong> respondents' },
                    { icon: '📊', text: 'Baseline vs Midline comparison' },
                    { icon: '📈', text: 'Awareness & willingness trends' },
                    { icon: '🤝', text: 'Participation analysis' }
                ],
                sections: [
                    { n: 1, title: 'Demographics', detail: 'Age, location, education profile' },
                    { n: 2, title: 'Awareness Levels', detail: 'Environmental awareness assessment' },
                    { n: 3, title: 'Willingness to Participate', detail: 'Conservation engagement readiness' },
                    { n: 4, title: 'Baseline vs Midline', detail: 'Progress comparison analysis' }
                ]
            },
            {
                id: 'gjj-women',
                title: 'GJJ KAP Women (Endline)',
                icon: '⚖️',
                iconBg: 'linear-gradient(135deg,#6a1b9a,#8e24aa)',
                category: 'surveys',
                badge: 'Gender',
                badgeColor: '#6a1b9a',
                desc: 'Gender & Justice Journey — women\'s endline assessment of gender norms, rights awareness, decision-making power, and gender-based violence perceptions (n=312).',
                pdf: 'COSME_GJJ_Women_Report.pdf',
                dataFiles: [
                    { name: 'GJJ KAP Women Baseline/Endline', file: 'GJJ KAP Women Basline_endline results.xlsx' }
                ],
                stats: [
                    { icon: '👩', text: '<strong>312</strong> respondents' },
                    { icon: '⚖️', text: 'Gender norms & rights' },
                    { icon: '🗳️', text: 'Decision-making power' },
                    { icon: '📈', text: 'Baseline vs Endline shift' }
                ],
                sections: [
                    { n: 1, title: 'Gender Norms', detail: 'Attitudes towards gender roles' },
                    { n: 2, title: 'Rights Awareness', detail: 'Knowledge of rights & protections' },
                    { n: 3, title: 'Decision-Making', detail: 'Household & community decisions' },
                    { n: 4, title: 'Baseline vs Endline', detail: 'Progress comparison analysis' }
                ]
            },
            {
                id: 'gjj-men',
                title: 'GJJ KAP Men (Endline)',
                icon: '🤝',
                iconBg: 'linear-gradient(135deg,#4527a0,#5e35b1)',
                category: 'surveys',
                badge: 'Gender',
                badgeColor: '#4527a0',
                desc: 'Gender & Justice Journey — men\'s endline assessment of unpaid care work, joint decision-making, and gender equity attitudes (n=289).',
                pdf: 'COSME_GJJ_Men_Report.pdf',
                dataFiles: [
                    { name: 'GJJ KAP Men Baseline/Endline', file: 'GJJ KAP Men Basline_endline results.xlsx' }
                ],
                stats: [
                    { icon: '👨', text: '<strong>289</strong> respondents' },
                    { icon: '🏠', text: 'Unpaid care work analysis' },
                    { icon: '🤝', text: 'Joint decision-making' },
                    { icon: '📈', text: 'Baseline vs Endline shift' }
                ],
                sections: [
                    { n: 1, title: 'Care Work Distribution', detail: 'Unpaid care work patterns' },
                    { n: 2, title: 'Decision-Making', detail: 'Joint vs unilateral decisions' },
                    { n: 3, title: 'Gender Equity Attitudes', detail: 'Attitude shift analysis' },
                    { n: 4, title: 'Baseline vs Endline', detail: 'Progress comparison analysis' }
                ]
            },
            {
                id: 'schools',
                title: 'Schools Initiatives',
                icon: '🏫',
                iconBg: 'linear-gradient(135deg,#e65100,#f57c00)',
                category: 'education',
                badge: 'Education',
                badgeColor: '#e65100',
                desc: 'Schools environmental initiatives dashboard — eco-clubs, tree nurseries, waste management, and environmental education across 65 participating schools.',
                pdf: 'COSME_Schools_Report.pdf',
                dataFiles: [
                    { name: 'Schools Initiatives Data', file: 'Schools Initiatives.csv' }
                ],
                stats: [
                    { icon: '🏫', text: '<strong>65</strong> schools participating' },
                    { icon: '🌱', text: 'Eco-clubs & tree nurseries' },
                    { icon: '♻️', text: 'Waste management initiatives' },
                    { icon: '📚', text: 'Environmental education' }
                ],
                sections: [
                    { n: 1, title: 'School Coverage', detail: 'Participating schools overview' },
                    { n: 2, title: 'Eco-Club Activities', detail: 'Club formation & activities' },
                    { n: 3, title: 'Tree Nurseries', detail: 'School nursery performance' },
                    { n: 4, title: 'Waste Management', detail: 'Waste initiatives & impact' }
                ]
            },
            {
                id: 'vsla',
                title: 'VSLA Programme',
                icon: '💰',
                iconBg: 'linear-gradient(135deg,#f9a825,#f57f17)',
                category: 'livelihoods',
                badge: 'Livelihoods',
                badgeColor: '#f57f17',
                desc: 'Village Savings & Loan Association monitoring — savings mobilisation, loan repayment rates, and financial inclusion assessment across 211 assessments.',
                pdf: 'COSME_VSLA_Report.pdf',
                dataFiles: [
                    { name: 'VSLA Monitoring Data', file: 'VSLA Data_Monitoring_06.10.2025.csv' }
                ],
                stats: [
                    { icon: '💰', text: '<strong>211</strong> assessments' },
                    { icon: '📊', text: 'Savings mobilisation data' },
                    { icon: '💳', text: 'Loan repayment rates' },
                    { icon: '👩', text: 'Women\'s financial inclusion' }
                ],
                sections: [
                    { n: 1, title: 'VSLA Overview', detail: 'Group structure & membership' },
                    { n: 2, title: 'Savings Analysis', detail: 'Savings mobilisation & trends' },
                    { n: 3, title: 'Loan Performance', detail: 'Loan disbursement & repayment' },
                    { n: 4, title: 'Financial Inclusion', detail: 'Women\'s economic empowerment' }
                ]
            },
            {
                id: 'logframe',
                title: 'Logframe & Indicators',
                icon: '🎯',
                iconBg: 'linear-gradient(135deg,#37474f,#455a64)',
                category: 'all',
                badge: 'M&E',
                badgeColor: '#37474f',
                desc: 'Logframe indicator tracking — 13 key performance indicators analysed against targets with achievement percentages and traffic-light status.',
                pdf: 'COSME_Logframe_Report.pdf',
                dataFiles: [],
                stats: [
                    { icon: '🎯', text: '<strong>13</strong> indicators tracked' },
                    { icon: '✅', text: '<strong>12</strong> exceeded targets' },
                    { icon: '📊', text: 'Achievement % vs targets' },
                    { icon: '🚦', text: 'Traffic-light status rating' }
                ],
                sections: [
                    { n: 1, title: 'Outcome Indicators', detail: 'High-level outcome measures' },
                    { n: 2, title: 'Output Indicators', detail: 'Programme delivery metrics' },
                    { n: 3, title: 'Achievement Analysis', detail: 'Target vs actual comparison' },
                    { n: 4, title: 'Recommendations', detail: 'Strategic M&E recommendations' }
                ]
            }
        ];

        // ── Filter categories ──
        const reportCategories = [
            { id: 'all', label: 'All Reports', icon: '📋' },
            { id: 'environment', label: 'Environment', icon: '🌿' },
            { id: 'livelihoods', label: 'Livelihoods', icon: '💰' },
            { id: 'surveys', label: 'Surveys', icon: '📊' },
            { id: 'education', label: 'Education', icon: '🏫' }
        ];

        let activeReportFilter = 'all';
        let selectedReportId = null;

        function renderReportGeneration() {
            renderReportChips();
            renderReportCards();
        }

        function renderReportChips() {
            const container = document.getElementById('reportFilterChips');
            if (!container || container.hasChildNodes()) return;
            container.innerHTML = reportCategories.map(cat =>
                `<button class="rpt-chip${cat.id === activeReportFilter ? ' active' : ''}" onclick="filterReports('${cat.id}')" title="${cat.label}">
                    ${cat.label}
                </button>`
            ).join('');
        }

        function filterReports(category) {
            activeReportFilter = category;
            // Update chip states
            document.querySelectorAll('#reportFilterChips .rpt-chip').forEach(chip => {
                chip.classList.toggle('active', chip.textContent.trim() ===
                    (reportCategories.find(c => c.id === category)?.label || '')
                );
            });
            renderReportCards();
            // Close detail panel if selected report is hidden
            if (selectedReportId) {
                const selectedReport = reportCatalogue.find(r => r.id === selectedReportId);
                if (selectedReport && category !== 'all' && selectedReport.category !== category) {
                    document.getElementById('reportDetailPanel').style.display = 'none';
                    selectedReportId = null;
                    document.querySelectorAll('.rpt-card').forEach(c => c.classList.remove('selected'));
                }
            }
        }

        function renderReportCards() {
            const grid = document.getElementById('reportCardsGrid');
            if (!grid) return;
            const filtered = activeReportFilter === 'all'
                ? reportCatalogue
                : reportCatalogue.filter(r => r.category === activeReportFilter || r.category === 'all');

            grid.innerHTML = filtered.map(r => `
                <div class="rpt-card${selectedReportId === r.id ? ' selected' : ''}" onclick="selectReport('${r.id}')">
                    <div class="rpt-card-header">
                        <div>
                            <h4 style="margin:0;font-size:1em;color:#333;">${r.title}</h4>
                            <span class="rpt-card-badge" style="background:${r.badgeColor}15;color:${r.badgeColor};">${r.badge}</span>
                        </div>
                    </div>
                    <div class="rpt-card-body">
                        <p>${r.desc.substring(0, 100)}${r.desc.length > 100 ? '…' : ''}</p>
                    </div>
                    <div class="rpt-card-footer">
                        <span style="color:#888;">📑 ${r.sections.length} sections</span>
                        <span style="color:#0072CE;font-weight:600;">View Details →</span>
                    </div>
                </div>
            `).join('');
        }

        function selectReport(reportId) {
            selectedReportId = reportId;
            const r = reportCatalogue.find(x => x.id === reportId);
            if (!r) return;

            // Highlight selected card
            document.querySelectorAll('.rpt-card').forEach(c => c.classList.remove('selected'));
            event?.target?.closest?.('.rpt-card')?.classList.add('selected');

            // Show detail panel
            const panel = document.getElementById('reportDetailPanel');
            panel.style.display = 'block';

            // Title
            document.getElementById('reportDetailTitle').innerHTML = `${r.title}`;

            // Description
            document.getElementById('reportDetailDesc').textContent = r.desc;

            // Actions
            const actions = document.getElementById('reportDetailActions');
            actions.innerHTML = `
                <a href="${r.pdf}" download="${r.pdf}" class="rpt-dl-btn primary">⬇️ Download PDF</a>
                <a href="${r.pdf}" target="_blank" class="rpt-dl-btn outline">👁️ View in Browser</a>
            `;

            // Sections table
            document.getElementById('reportDetailTbody').innerHTML = r.sections.map((s, i) =>
                `<tr style="background:${i % 2 === 0 ? '#fff' : '#f8f9fa'};">
                    <td style="padding:7px 12px;border-bottom:1px solid #eee;color:#888;font-weight:600;">${s.n}</td>
                    <td style="padding:7px 12px;border-bottom:1px solid #eee;font-weight:500;color:#333;">${s.title}</td>
                    <td style="padding:7px 12px;border-bottom:1px solid #eee;color:#666;">${s.detail}</td>
                </tr>`
            ).join('');

            // Stats
            document.getElementById('reportDetailStats').innerHTML =
                `<div style="display:flex;flex-direction:column;gap:11px;">` +
                r.stats.map(s => `<div style="display:flex;align-items:center;gap:10px;"><span style="font-size:1.2em;">${s.icon}</span><span>${s.text}</span></div>`).join('') +
                `</div>`;

            // Data files
            const filesEl = document.getElementById('reportDetailFiles');
            if (r.dataFiles.length > 0) {
                filesEl.innerHTML = r.dataFiles.map(f =>
                    `<a href="${f.file}" download="${f.file}" class="rpt-dl-btn data" style="margin-bottom:8px;display:flex;width:100%;box-sizing:border-box;">
                        📥 ${f.name}
                    </a>`
                ).join('');
            } else {
                filesEl.innerHTML = `<p style="color:#999;font-size:0.9em;text-align:center;margin:8px 0;">All data included in the full PDF report</p>`;
            }

            // Smooth scroll to detail panel
            panel.scrollIntoView({ behavior: 'smooth', block: 'start' });
        }
    </script>

    <!-- ============================================================ -->
    <!-- ANALYTICS DASHBOARD ENGINE                                    -->
    <!-- ============================================================ -->
    <script>
    (function() {
        'use strict';

        const db = firebase.database();

        // ── Helper: parse user-agent ─────────────────────────────
        function parseUA(ua) {
            if (!ua) return { device: 'Unknown', browser: 'Unknown' };
            let device = 'Desktop';
            if (/mobile|android|iphone|ipad/i.test(ua)) device = /ipad|tablet/i.test(ua) ? 'Tablet' : 'Mobile';
            let browser = 'Other';
            if (/edg/i.test(ua)) browser = 'Edge';
            else if (/chrome/i.test(ua)) browser = 'Chrome';
            else if (/firefox/i.test(ua)) browser = 'Firefox';
            else if (/safari/i.test(ua)) browser = 'Safari';
            else if (/opera|opr/i.test(ua)) browser = 'Opera';
            return { device, browser };
        }

        // ── Track tab switches ──────────────────────────────────
        const origSwitch = window.switchSurvey;
        if (typeof origSwitch === 'function') {
            window.switchSurvey = function(key) {
                origSwitch(key);
                // Log tab switch event
                const tabRef = db.ref('analytics/tabSwitches').push();
                tabRef.set({
                    tab: key,
                    ts: firebase.database.ServerValue.TIMESTAMP
                });
                // Increment tab counter
                db.ref('analytics/tabCounts/' + key).transaction(c => (c || 0) + 1);
            };
        }

        // ── Track report downloads ──────────────────────────────
        document.addEventListener('click', function(e) {
            const link = e.target.closest('a[download]');
            if (link) {
                const fileName = link.getAttribute('download') || link.getAttribute('href') || 'unknown';
                db.ref('analytics/downloads').push().set({
                    file: fileName,
                    ts: firebase.database.ServerValue.TIMESTAMP
                });
                db.ref('analytics/downloadCounts/' + fileName.replace(/[.#$/\[\]]/g, '_')).transaction(c => (c || 0) + 1);
            }
        });

        // ── Log enhanced visit data ─────────────────────────────
        const visitId = 'visit_' + Date.now() + '_' + Math.random().toString(36).substr(2, 6);
        const pUA = parseUA(navigator.userAgent);
        db.ref('analytics/visits/' + visitId).set({
            ts: firebase.database.ServerValue.TIMESTAMP,
            device: pUA.device,
            browser: pUA.browser,
            screenW: screen.width,
            screenH: screen.height,
            referrer: document.referrer || 'direct',
            lang: navigator.language || 'en'
        });

        // ── Chart instances (for cleanup) ───────────────────────
        let chartDaily, chartTabs, chartDevice, chartBrowser, chartHourly, chartDownloads, chartDuration;

        function destroyCharts() {
            [chartDaily, chartTabs, chartDevice, chartBrowser, chartHourly, chartDownloads, chartDuration].forEach(c => { if (c) c.destroy(); });
        }

        // ── Render Analytics Dashboard ──────────────────────────
        window.renderAnalyticsDashboard = function() {
            destroyCharts();

            // Fetch all analytics data
            Promise.all([
                db.ref('visits').orderByChild('visitedAt').limitToLast(500).once('value'),
                db.ref('presence').once('value'),
                db.ref('analytics/tabCounts').once('value'),
                db.ref('analytics/downloadCounts').once('value'),
                db.ref('analytics/visits').orderByKey().limitToLast(500).once('value')
            ]).then(([visitsSnap, presenceSnap, tabCountsSnap, dlCountsSnap, aVisitsSnap]) => {

                const visits = visitsSnap.val() || {};
                const presence = presenceSnap.val() || {};
                const tabCounts = tabCountsSnap.val() || {};
                const dlCounts = dlCountsSnap.val() || {};
                const aVisits = aVisitsSnap.val() || {};

                const entries = Object.values(visits).filter(v => v.visitedAt);
                const now = Date.now();
                const todayStart = new Date(); todayStart.setHours(0,0,0,0);
                const weekStart = new Date(); weekStart.setDate(weekStart.getDate() - weekStart.getDay()); weekStart.setHours(0,0,0,0);

                // ── KPI calculations ────────────────────────────
                let todayCount = 0, weekCount = 0, totalDuration = 0, durationCount = 0;
                const uniqueNames = new Set();

                entries.forEach(v => {
                    if (v.name) uniqueNames.add(v.name);
                    if (v.visitedAt >= todayStart.getTime()) todayCount++;
                    if (v.visitedAt >= weekStart.getTime()) weekCount++;
                    if (v.leftAt && v.visitedAt) {
                        const dur = v.leftAt - v.visitedAt;
                        if (dur > 0 && dur < 7200000) { totalDuration += dur; durationCount++; }
                    }
                });

                const avgDur = durationCount > 0 ? Math.round(totalDuration / durationCount / 60000) : 0;
                const liveCount = Object.keys(presence).length;

                // Update KPIs
                const kpiMap = {
                    'an-kpi-total': entries.length,
                    'an-kpi-today': todayCount,
                    'an-kpi-week': weekCount,
                    'an-kpi-unique': uniqueNames.size,
                    'an-kpi-live': liveCount,
                    'an-kpi-avg-dur': avgDur + 'm'
                };
                Object.entries(kpiMap).forEach(([id, val]) => {
                    const el = document.querySelector('#' + id + ' .an-kpi-val');
                    if (el) el.textContent = val;
                });

                // ── Daily visits chart (last 14 days) ───────────
                const dayLabels = [];
                const dayCounts = [];
                for (let i = 13; i >= 0; i--) {
                    const d = new Date(); d.setDate(d.getDate() - i); d.setHours(0,0,0,0);
                    const dEnd = new Date(d); dEnd.setDate(dEnd.getDate() + 1);
                    dayLabels.push(d.toLocaleDateString('en-GB', { day: '2-digit', month: 'short' }));
                    dayCounts.push(entries.filter(v => v.visitedAt >= d.getTime() && v.visitedAt < dEnd.getTime()).length);
                }

                const dailyCtx = document.getElementById('analytics-chart-daily');
                if (dailyCtx) {
                    chartDaily = new Chart(dailyCtx, {
                        type: 'bar',
                        data: {
                            labels: dayLabels,
                            datasets: [{
                                label: 'Visits',
                                data: dayCounts,
                                backgroundColor: 'rgba(26,35,126,0.7)',
                                borderRadius: 6,
                                borderSkipped: false
                            }]
                        },
                        options: {
                            responsive: true, maintainAspectRatio: false,
                            plugins: { legend: { display: false } },
                            scales: {
                                y: { beginAtZero: true, ticks: { stepSize: 1 } },
                                x: { ticks: { maxRotation: 45, font: { size: 10 } } }
                            }
                        }
                    });
                }

                // ── Tab popularity chart ────────────────────────
                const tabNames = {
                    'project-outputs': 'Project Outputs',
                    'women-cosme': 'Women Survey',
                    'men-cosme': 'Men Survey',
                    'gjj-women': 'GJJ Women',
                    'gjj-men': 'GJJ Men',
                    'forestry': 'Forestry',
                    'prepost-forest': 'Pre/Post Training',
                    'schools-dashboard': 'Schools',
                    'seaweed-assessment': 'Seaweed',
                    'vsla-monitoring': 'VSLA',
                    'cross-dataset': 'Cross-Dataset',
                    'automated-insights': 'Impact & Evidence',
                    'report-generation': 'Reports',
                    'analytics-dashboard': 'Analytics'
                };

                const sortedTabs = Object.entries(tabCounts)
                    .map(([k, v]) => ({ name: tabNames[k] || k, count: v }))
                    .sort((a, b) => b.count - a.count)
                    .slice(0, 10);

                const tabCtx = document.getElementById('analytics-chart-tabs');
                if (tabCtx && sortedTabs.length > 0) {
                    const tabColors = ['#1a237e','#283593','#303f9f','#3949ab','#3f51b5','#5c6bc0','#7986cb','#9fa8da','#c5cae9','#e8eaf6'];
                    chartTabs = new Chart(tabCtx, {
                        type: 'bar',
                        data: {
                            labels: sortedTabs.map(t => t.name),
                            datasets: [{
                                label: 'Views',
                                data: sortedTabs.map(t => t.count),
                                backgroundColor: tabColors.slice(0, sortedTabs.length),
                                borderRadius: 6,
                                borderSkipped: false
                            }]
                        },
                        options: {
                            indexAxis: 'y',
                            responsive: true, maintainAspectRatio: false,
                            plugins: { legend: { display: false } },
                            scales: {
                                x: { beginAtZero: true, ticks: { stepSize: 1 } },
                                y: { ticks: { font: { size: 11 } } }
                            }
                        }
                    });
                }

                // ── Device & Browser breakdown ──────────────────
                const deviceMap = {};
                const browserMap = {};
                Object.values(aVisits).forEach(v => {
                    if (v.device) deviceMap[v.device] = (deviceMap[v.device] || 0) + 1;
                    if (v.browser) browserMap[v.browser] = (browserMap[v.browser] || 0) + 1;
                });
                // Also parse from main visits userAgent
                entries.forEach(v => {
                    if (v.userAgent) {
                        const p = parseUA(v.userAgent);
                        deviceMap[p.device] = (deviceMap[p.device] || 0) + 1;
                        browserMap[p.browser] = (browserMap[p.browser] || 0) + 1;
                    }
                });

                const deviceCtx = document.getElementById('analytics-chart-device');
                if (deviceCtx && Object.keys(deviceMap).length > 0) {
                    const devColors = { Desktop: '#1a237e', Mobile: '#4caf50', Tablet: '#ff9800', Unknown: '#9e9e9e' };
                    chartDevice = new Chart(deviceCtx, {
                        type: 'doughnut',
                        data: {
                            labels: Object.keys(deviceMap),
                            datasets: [{
                                data: Object.values(deviceMap),
                                backgroundColor: Object.keys(deviceMap).map(k => devColors[k] || '#9e9e9e'),
                                borderWidth: 2
                            }]
                        },
                        options: {
                            responsive: true, maintainAspectRatio: false,
                            plugins: {
                                legend: { position: 'bottom', labels: { font: { size: 11 }, padding: 12 } },
                                title: { display: true, text: 'Device', font: { size: 12, weight: '600' }, color: '#555' }
                            }
                        }
                    });
                }

                const browserCtx = document.getElementById('analytics-chart-browser');
                if (browserCtx && Object.keys(browserMap).length > 0) {
                    const brColors = { Chrome: '#4285f4', Firefox: '#ff7139', Safari: '#000', Edge: '#0078d7', Opera: '#ff1b2d', Other: '#9e9e9e' };
                    chartBrowser = new Chart(browserCtx, {
                        type: 'doughnut',
                        data: {
                            labels: Object.keys(browserMap),
                            datasets: [{
                                data: Object.values(browserMap),
                                backgroundColor: Object.keys(browserMap).map(k => brColors[k] || '#9e9e9e'),
                                borderWidth: 2
                            }]
                        },
                        options: {
                            responsive: true, maintainAspectRatio: false,
                            plugins: {
                                legend: { position: 'bottom', labels: { font: { size: 11 }, padding: 12 } },
                                title: { display: true, text: 'Browser', font: { size: 12, weight: '600' }, color: '#555' }
                            }
                        }
                    });
                }

                // ── Hourly distribution ─────────────────────────
                const hourCounts = new Array(24).fill(0);
                entries.forEach(v => {
                    if (v.visitedAt) {
                        const h = new Date(v.visitedAt).getHours();
                        hourCounts[h]++;
                    }
                });

                const hourlyCtx = document.getElementById('analytics-chart-hourly');
                if (hourlyCtx) {
                    chartHourly = new Chart(hourlyCtx, {
                        type: 'line',
                        data: {
                            labels: Array.from({length: 24}, (_, i) => (i < 10 ? '0' : '') + i + ':00'),
                            datasets: [{
                                label: 'Visits',
                                data: hourCounts,
                                borderColor: '#1a237e',
                                backgroundColor: 'rgba(26,35,126,0.1)',
                                fill: true,
                                tension: 0.4,
                                pointRadius: 3,
                                pointBackgroundColor: '#1a237e'
                            }]
                        },
                        options: {
                            responsive: true, maintainAspectRatio: false,
                            plugins: { legend: { display: false } },
                            scales: {
                                y: { beginAtZero: true, ticks: { stepSize: 1 } },
                                x: { ticks: { maxRotation: 45, font: { size: 9 }, maxTicksLimit: 12 } }
                            }
                        }
                    });
                }

                // ── Report downloads chart ──────────────────────
                const dlEntries = Object.entries(dlCounts)
                    .map(([k, v]) => ({ name: k.replace(/_/g, '.').replace('COSME.', '').replace('.Report.pdf', '').replace('.pdf', ''), count: v }))
                    .sort((a, b) => b.count - a.count);

                const dlCtx = document.getElementById('analytics-chart-downloads');
                if (dlCtx) {
                    if (dlEntries.length > 0) {
                        const dlColors = ['#2e7d32','#388e3c','#43a047','#4caf50','#66bb6a','#81c784','#a5d6a7','#c8e6c9','#e8f5e9','#f1f8e9','#f9fbe7'];
                        chartDownloads = new Chart(dlCtx, {
                            type: 'bar',
                            data: {
                                labels: dlEntries.map(d => d.name),
                                datasets: [{
                                    label: 'Downloads',
                                    data: dlEntries.map(d => d.count),
                                    backgroundColor: dlColors.slice(0, dlEntries.length),
                                    borderRadius: 6,
                                    borderSkipped: false
                                }]
                            },
                            options: {
                                indexAxis: 'y',
                                responsive: true, maintainAspectRatio: false,
                                plugins: { legend: { display: false } },
                                scales: {
                                    x: { beginAtZero: true, ticks: { stepSize: 1 } },
                                    y: { ticks: { font: { size: 11 } } }
                                }
                            }
                        });
                    } else {
                        dlCtx.parentElement.innerHTML = '<div style="display:flex;align-items:center;justify-content:center;height:100%;color:#999;font-size:0.95em;">No report downloads recorded yet</div>';
                    }
                }

                // ── Session duration distribution ───────────────
                const durBuckets = { '<1m': 0, '1-5m': 0, '5-15m': 0, '15-30m': 0, '30m+': 0 };
                entries.forEach(v => {
                    if (v.leftAt && v.visitedAt) {
                        const mins = (v.leftAt - v.visitedAt) / 60000;
                        if (mins < 0 || mins > 120) return;
                        if (mins < 1) durBuckets['<1m']++;
                        else if (mins < 5) durBuckets['1-5m']++;
                        else if (mins < 15) durBuckets['5-15m']++;
                        else if (mins < 30) durBuckets['15-30m']++;
                        else durBuckets['30m+']++;
                    }
                });

                const durCtx = document.getElementById('analytics-chart-duration');
                if (durCtx) {
                    chartDuration = new Chart(durCtx, {
                        type: 'doughnut',
                        data: {
                            labels: Object.keys(durBuckets),
                            datasets: [{
                                data: Object.values(durBuckets),
                                backgroundColor: ['#e8eaf6','#9fa8da','#5c6bc0','#3949ab','#1a237e'],
                                borderWidth: 2
                            }]
                        },
                        options: {
                            responsive: true, maintainAspectRatio: false,
                            plugins: {
                                legend: { position: 'bottom', labels: { font: { size: 11 }, padding: 12 } }
                            }
                        }
                    });
                }

                // ── Recent visitors table ───────────────────────
                const recentVisitors = entries
                    .sort((a, b) => (b.visitedAt || 0) - (a.visitedAt || 0))
                    .slice(0, 30);

                const tbody = document.getElementById('analytics-visitors-tbody');
                if (tbody) {
                    if (recentVisitors.length === 0) {
                        tbody.innerHTML = '<tr><td colspan="4" style="text-align:center;color:#999;padding:28px;">No visitor data yet</td></tr>';
                    } else {
                        tbody.innerHTML = recentVisitors.map((v, i) => {
                            const date = v.visitedAt ? new Date(v.visitedAt) : null;
                            const dateStr = date ? date.toLocaleDateString('en-GB', { day: '2-digit', month: 'short', year: 'numeric' }) + ' ' + date.toLocaleTimeString('en-GB', { hour: '2-digit', minute: '2-digit' }) : '—';
                            let durStr = '<span style="color:#4caf50;font-weight:600;">Active</span>';
                            if (v.leftAt && v.visitedAt) {
                                const mins = Math.round((v.leftAt - v.visitedAt) / 60000);
                                durStr = mins < 1 ? '<1m' : mins + 'm';
                            }
                            const ua = v.userAgent ? parseUA(v.userAgent) : { device: '—', browser: '—' };
                            return `<tr style="background:${i % 2 === 0 ? '#fff' : '#f8f9fa'};">
                                <td style="padding:9px 14px;border-bottom:1px solid #eee;font-weight:500;">${v.name || 'Anonymous'}</td>
                                <td style="padding:9px 14px;border-bottom:1px solid #eee;color:#555;">${dateStr}</td>
                                <td style="padding:9px 14px;border-bottom:1px solid #eee;">${durStr}</td>
                                <td style="padding:9px 14px;border-bottom:1px solid #eee;color:#777;">${ua.device} / ${ua.browser}</td>
                            </tr>`;
                        }).join('');
                    }
                }

                // ── Engagement summary ──────────────────────────
                const totalDownloads = Object.values(dlCounts).reduce((s, v) => s + v, 0);
                const totalTabs = Object.values(tabCounts).reduce((s, v) => s + v, 0);
                const topTab = sortedTabs.length > 0 ? sortedTabs[0].name : '—';
                const peakHour = hourCounts.indexOf(Math.max(...hourCounts));
                const returnRate = entries.length > 0 ? Math.round((1 - uniqueNames.size / entries.length) * 100) : 0;
                const mobileShare = entries.length > 0 ? Math.round(((deviceMap['Mobile'] || 0) / Object.values(deviceMap).reduce((s,v) => s+v, 0)) * 100) : 0;

                const engGrid = document.getElementById('analytics-engagement-grid');
                if (engGrid) {
                    const engItems = [
                        { label: 'Total Reports Downloaded', value: totalDownloads },
                        { label: 'Total Tab Switches', value: totalTabs },
                        { label: 'Most Popular Tab', value: topTab },
                        { label: 'Peak Hour', value: (peakHour < 10 ? '0' : '') + peakHour + ':00' },
                        { label: 'Return Visit Rate', value: returnRate + '%' },
                        { label: 'Mobile Usage', value: mobileShare + '%' }
                    ];
                    engGrid.innerHTML = engItems.map(item =>
                        `<div class="an-eng-item">
                            <div class="an-eng-val">${item.value}</div>
                            <div class="an-eng-lbl">${item.label}</div>
                        </div>`
                    ).join('');
                }

            }).catch(err => {
                console.error('Analytics load error:', err);
            });
        };

    })();
    </script>
</body>
</html>
